import{j as d,S as xd,F as k0,H as xn,Z as bd,C as C0,a as on,b as E0,c as wd,d as bs,e as P0,U as A0,L as vd,f as Et,g as _t,X as Ct,h as ws,W as R1,T as O1,M as j0,i as vs,B as N0,k as T0,A as vf,K as I1,l as aa,m as R0,n as M1,o as O0,p as Ya,D as Ja,P as D1,q as Sd,r as L1,s as I0,t as $1,u as F1,E as U1,v as M0,w as B1,x as D0,y as V1,z as L0,G as W1,Q as Sf,I as z1,J as Vc,N as H1,O as K1,R as Wc,V as zc,Y as G1,_ as Hc,$ as bi,a0 as Kc,a1 as q1,a2 as Y1,a3 as J1,a4 as $0,a5 as _d,a6 as X1,a7 as Q1,a8 as Un,a9 as F0,aa as _f,ab as Z1,ac as kf,ad as ek,ae as tk,af as U0,ag as nk,ah as Gc,ai as rk,aj as Cf,ak as sk,al as ik,am as ok,an as ak,ao as lk,ap as ck,aq as uk,ar as dk,as as Fl,at as Ef,au as hk}from"./vendor-ui-BNKBsgxT.js";import{d as fk,a as x,g as pk,r as mk,R as fe,e as gk,c as Xa,f as kd,u as ks,h as yk,i as B0,j as xk,k as bk,l as Ge,N as wk,B as vk}from"./vendor-react-CcXfOzU6.js";import{l as Sk}from"./vendor-tf-DT4C3GAj.js";import{L as zn,f as xe,M as V0,T as W0,u as _k,a as Cd,t as kk,s as Ck,e as Ek,b as Pk,c as Ak,d as jk,i as Nk,g as z0,h as Tk,j as Rk,k as Ok,P as Ik,l as H0,m as Mk,E as K0,p as Ul,_ as Dk}from"./vendor-utils-DMIzHWEf.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var so={},Pf;function Lk(){if(Pf)return so;Pf=1;var t=fk();return so.createRoot=t.createRoot,so.hydrateRoot=t.hydrateRoot,so}var $k=Lk();let Fk={data:""},Uk=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||Fk},Bk=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Vk=/\/\*[^]*?\*\/|  +/g,Af=/\n+/g,Ln=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?Ln(o,i):i+"{"+Ln(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=Ln(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Ln.p?Ln.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},hn={},G0=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+G0(t[n]);return e}return t},Wk=(t,e,n,r,s)=>{let i=G0(t),o=hn[i]||(hn[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!hn[o]){let l=i!==t?t:(c=>{let u,h,f=[{}];for(;u=Bk.exec(c.replace(Vk,""));)u[4]?f.shift():u[3]?(h=u[3].replace(Af," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][u[1]]=u[2].replace(Af," ").trim();return f[0]})(t);hn[o]=Ln(s?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&hn.g?hn.g:null;return n&&(hn.g=hn[o]),((l,c,u,h)=>{h?c.data=c.data.replace(h,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(hn[o],e,r,a),o},zk=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Ln(a,""):a===!1?"":a}return r+s+(o??"")},"");function Qa(t){let e=this||{},n=t.call?t(e.p):t;return Wk(n.unshift?n.raw?zk(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,Uk(e.target),e.g,e.o,e.k)}let q0,qc,Yc;Qa.bind({g:1});let bn=Qa.bind({k:1});function Hk(t,e,n,r){Ln.p=e,q0=t,qc=n,Yc=r}function Yn(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),l=a.className||s.className;n.p=Object.assign({theme:qc&&qc()},a),n.o=/ *go\d+/.test(l),a.className=Qa.apply(n,r)+(l?" "+l:"");let c=t;return t[0]&&(c=a.as||t,delete a.as),Yc&&c[0]&&Yc(a),q0(c,a)}return s}}var Kk=t=>typeof t=="function",la=(t,e)=>Kk(t)?t(e):t,Gk=(()=>{let t=0;return()=>(++t).toString()})(),Y0=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),qk=20,Ed="default",J0=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return J0(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},$o=[],X0={toasts:[],pausedAt:void 0,settings:{toastLimit:qk}},Zt={},Q0=(t,e=Ed)=>{Zt[e]=J0(Zt[e]||X0,t),$o.forEach(([n,r])=>{n===e&&r(Zt[e])})},Z0=t=>Object.keys(Zt).forEach(e=>Q0(t,e)),Yk=t=>Object.keys(Zt).find(e=>Zt[e].toasts.some(n=>n.id===t)),Za=(t=Ed)=>e=>{Q0(e,t)},Jk={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Xk=(t={},e=Ed)=>{let[n,r]=x.useState(Zt[e]||X0),s=x.useRef(Zt[e]);x.useEffect(()=>(s.current!==Zt[e]&&r(Zt[e]),$o.push([e,r]),()=>{let o=$o.findIndex(([a])=>a===e);o>-1&&$o.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var a,l,c;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((a=t[o.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((l=t[o.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||Jk[o.type],style:{...t.style,...(c=t[o.type])==null?void 0:c.style,...o.style}}});return{...n,toasts:i}},Qk=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||Gk()}),Li=t=>(e,n)=>{let r=Qk(e,t,n);return Za(r.toasterId||Yk(r.id))({type:2,toast:r}),r.id},le=(t,e)=>Li("blank")(t,e);le.error=Li("error");le.success=Li("success");le.loading=Li("loading");le.custom=Li("custom");le.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Za(e)(n):Z0(n)};le.dismissAll=t=>le.dismiss(void 0,t);le.remove=(t,e)=>{let n={type:4,toastId:t};e?Za(e)(n):Z0(n)};le.removeAll=t=>le.remove(void 0,t);le.promise=(t,e,n)=>{let r=le.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?la(e.success,s):void 0;return i?le.success(i,{id:r,...n,...n==null?void 0:n.success}):le.dismiss(r),s}).catch(s=>{let i=e.error?la(e.error,s):void 0;i?le.error(i,{id:r,...n,...n==null?void 0:n.error}):le.dismiss(r)}),t};var Zk=1e3,eC=(t,e="default")=>{let{toasts:n,pausedAt:r}=Xk(t,e),s=x.useRef(new Map).current,i=x.useCallback((h,f=Zk)=>{if(s.has(h))return;let p=setTimeout(()=>{s.delete(h),o({type:4,toastId:h})},f);s.set(h,p)},[]);x.useEffect(()=>{if(r)return;let h=Date.now(),f=n.map(p=>{if(p.duration===1/0)return;let m=(p.duration||0)+p.pauseDuration-(h-p.createdAt);if(m<0){p.visible&&le.dismiss(p.id);return}return setTimeout(()=>le.dismiss(p.id,e),m)});return()=>{f.forEach(p=>p&&clearTimeout(p))}},[n,r,e]);let o=x.useCallback(Za(e),[e]),a=x.useCallback(()=>{o({type:5,time:Date.now()})},[o]),l=x.useCallback((h,f)=>{o({type:1,toast:{id:h,height:f}})},[o]),c=x.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=x.useCallback((h,f)=>{let{reverseOrder:p=!1,gutter:m=8,defaultPosition:y}=f||{},v=n.filter(k=>(k.position||y)===(h.position||y)&&k.height),S=v.findIndex(k=>k.id===h.id),E=v.filter((k,g)=>g<S&&k.visible).length;return v.filter(k=>k.visible).slice(...p?[E+1]:[0,E]).reduce((k,g)=>k+(g.height||0)+m,0)},[n]);return x.useEffect(()=>{n.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let f=s.get(h.id);f&&(clearTimeout(f),s.delete(h.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:l,startPause:a,endPause:c,calculateOffset:u}}},tC=bn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,nC=bn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,rC=bn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,sC=Yn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${tC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${nC} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${rC} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,iC=bn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,oC=Yn("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${iC} 1s linear infinite;
`,aC=bn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,lC=bn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,cC=Yn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${aC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${lC} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,uC=Yn("div")`
  position: absolute;
`,dC=Yn("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,hC=bn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fC=Yn("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${hC} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,pC=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?x.createElement(fC,null,e):e:n==="blank"?null:x.createElement(dC,null,x.createElement(oC,{...r}),n!=="loading"&&x.createElement(uC,null,n==="error"?x.createElement(sC,{...r}):x.createElement(cC,{...r})))},mC=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,gC=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,yC="0%{opacity:0;} 100%{opacity:1;}",xC="0%{opacity:1;} 100%{opacity:0;}",bC=Yn("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,wC=Yn("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,vC=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=Y0()?[yC,xC]:[mC(n),gC(n)];return{animation:e?`${bn(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${bn(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},SC=x.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?vC(t.position||e||"top-center",t.visible):{opacity:0},i=x.createElement(pC,{toast:t}),o=x.createElement(wC,{...t.ariaProps},la(t.message,t));return x.createElement(bC,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):x.createElement(x.Fragment,null,i,o))});Hk(x.createElement);var _C=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=x.useCallback(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;r(t,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return x.createElement("div",{ref:i,className:e,style:n},s)},kC=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Y0()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},CC=Qa`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,io=16,EC=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:l,handlers:c}=eC(n,i);return x.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:io,left:io,right:io,bottom:io,pointerEvents:"none",...o},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let h=u.position||e,f=c.calculateOffset(u,{reverseOrder:t,gutter:r,defaultPosition:e}),p=kC(h,f);return x.createElement(_C,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?CC:"",style:p},u.type==="custom"?la(u.message,u):s?s(u):x.createElement(SC,{toast:u,position:h}))}))};function PC(t,e){return e.forEach((function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach((function(r){if(r!=="default"&&!(r in t)){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}}))})),Object.freeze(t)}function ey(t,e){return new Promise((function(n,r){let s;return AC(t).then((function(i){try{return s=i,n(new Blob([e.slice(0,2),s,e.slice(2)],{type:"image/jpeg"}))}catch(o){return r(o)}}),r)}))}const AC=t=>new Promise(((e,n)=>{const r=new FileReader;r.addEventListener("load",(({target:{result:s}})=>{const i=new DataView(s);let o=0;if(i.getUint16(o)!==65496)return n("not a valid JPEG");for(o+=2;;){const a=i.getUint16(o);if(a===65498)break;const l=i.getUint16(o+2);if(a===65505&&i.getUint32(o+4)===1165519206){const c=o+10;let u;switch(i.getUint16(c)){case 18761:u=!0;break;case 19789:u=!1;break;default:return n("TIFF header contains invalid endian")}if(i.getUint16(c+2,u)!==42)return n("TIFF header contains invalid version");const h=i.getUint32(c+4,u),f=c+h+2+12*i.getUint16(c+h,u);for(let p=c+h+2;p<f;p+=12)if(i.getUint16(p,u)==274){if(i.getUint16(p+2,u)!==3)return n("Orientation data type is invalid");if(i.getUint32(p+4,u)!==1)return n("Orientation data count is invalid");i.setUint16(p+8,1,u);break}return e(s.slice(o,o+2+l))}o+=2+l}return e(new Blob)})),r.readAsArrayBuffer(t)}));var ca={},jC={get exports(){return ca},set exports(t){ca=t}};(function(t){var e,n,r={};jC.exports=r,r.parse=function(s,i){for(var o=r.bin.readUshort,a=r.bin.readUint,l=0,c={},u=new Uint8Array(s),h=u.length-4;a(u,h)!=101010256;)h--;l=h,l+=4;var f=o(u,l+=4);o(u,l+=2);var p=a(u,l+=2),m=a(u,l+=4);l+=4,l=m;for(var y=0;y<f;y++){a(u,l),l+=4,l+=4,l+=4,a(u,l+=4),p=a(u,l+=4);var v=a(u,l+=4),S=o(u,l+=4),E=o(u,l+2),k=o(u,l+4);l+=6;var g=a(u,l+=8);l+=4,l+=S+E+k,r._readLocal(u,g,c,p,v,i)}return c},r._readLocal=function(s,i,o,a,l,c){var u=r.bin.readUshort,h=r.bin.readUint;h(s,i),u(s,i+=4),u(s,i+=2);var f=u(s,i+=2);h(s,i+=2),h(s,i+=4),i+=4;var p=u(s,i+=8),m=u(s,i+=2);i+=2;var y=r.bin.readUTF8(s,i,p);if(i+=p,i+=m,c)o[y]={size:l,csize:a};else{var v=new Uint8Array(s.buffer,i);if(f==0)o[y]=new Uint8Array(v.buffer.slice(i,i+a));else{if(f!=8)throw"unknown compression method: "+f;var S=new Uint8Array(l);r.inflateRaw(v,S),o[y]=S}}},r.inflateRaw=function(s,i){return r.F.inflate(s,i)},r.inflate=function(s,i){return s[0],s[1],r.inflateRaw(new Uint8Array(s.buffer,s.byteOffset+2,s.length-6),i)},r.deflate=function(s,i){i==null&&(i={level:6});var o=0,a=new Uint8Array(50+Math.floor(1.1*s.length));a[o]=120,a[o+1]=156,o+=2,o=r.F.deflateRaw(s,a,o,i.level);var l=r.adler(s,0,s.length);return a[o+0]=l>>>24&255,a[o+1]=l>>>16&255,a[o+2]=l>>>8&255,a[o+3]=l>>>0&255,new Uint8Array(a.buffer,0,o+4)},r.deflateRaw=function(s,i){i==null&&(i={level:6});var o=new Uint8Array(50+Math.floor(1.1*s.length)),a=r.F.deflateRaw(s,o,a,i.level);return new Uint8Array(o.buffer,0,a)},r.encode=function(s,i){i==null&&(i=!1);var o=0,a=r.bin.writeUint,l=r.bin.writeUshort,c={};for(var u in s){var h=!r._noNeed(u)&&!i,f=s[u],p=r.crc.crc(f,0,f.length);c[u]={cpr:h,usize:f.length,crc:p,file:h?r.deflateRaw(f):f}}for(var u in c)o+=c[u].file.length+30+46+2*r.bin.sizeUTF8(u);o+=22;var m=new Uint8Array(o),y=0,v=[];for(var u in c){var S=c[u];v.push(y),y=r._writeHeader(m,y,u,S,0)}var E=0,k=y;for(var u in c)S=c[u],v.push(y),y=r._writeHeader(m,y,u,S,1,v[E++]);var g=y-k;return a(m,y,101010256),y+=4,l(m,y+=4,E),l(m,y+=2,E),a(m,y+=2,g),a(m,y+=4,k),y+=4,y+=2,m.buffer},r._noNeed=function(s){var i=s.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(i)!=-1},r._writeHeader=function(s,i,o,a,l,c){var u=r.bin.writeUint,h=r.bin.writeUshort,f=a.file;return u(s,i,l==0?67324752:33639248),i+=4,l==1&&(i+=2),h(s,i,20),h(s,i+=2,0),h(s,i+=2,a.cpr?8:0),u(s,i+=2,0),u(s,i+=4,a.crc),u(s,i+=4,f.length),u(s,i+=4,a.usize),h(s,i+=4,r.bin.sizeUTF8(o)),h(s,i+=2,0),i+=2,l==1&&(i+=2,i+=2,u(s,i+=6,c),i+=4),i+=r.bin.writeUTF8(s,i,o),l==0&&(s.set(f,i),i+=f.length),i},r.crc={table:(function(){for(var s=new Uint32Array(256),i=0;i<256;i++){for(var o=i,a=0;a<8;a++)1&o?o=3988292384^o>>>1:o>>>=1;s[i]=o}return s})(),update:function(s,i,o,a){for(var l=0;l<a;l++)s=r.crc.table[255&(s^i[o+l])]^s>>>8;return s},crc:function(s,i,o){return 4294967295^r.crc.update(4294967295,s,i,o)}},r.adler=function(s,i,o){for(var a=1,l=0,c=i,u=i+o;c<u;){for(var h=Math.min(c+5552,u);c<h;)l+=a+=s[c++];a%=65521,l%=65521}return l<<16|a},r.bin={readUshort:function(s,i){return s[i]|s[i+1]<<8},writeUshort:function(s,i,o){s[i]=255&o,s[i+1]=o>>8&255},readUint:function(s,i){return 16777216*s[i+3]+(s[i+2]<<16|s[i+1]<<8|s[i])},writeUint:function(s,i,o){s[i]=255&o,s[i+1]=o>>8&255,s[i+2]=o>>16&255,s[i+3]=o>>24&255},readASCII:function(s,i,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(s[i+l]);return a},writeASCII:function(s,i,o){for(var a=0;a<o.length;a++)s[i+a]=o.charCodeAt(a)},pad:function(s){return s.length<2?"0"+s:s},readUTF8:function(s,i,o){for(var a,l="",c=0;c<o;c++)l+="%"+r.bin.pad(s[i+c].toString(16));try{a=decodeURIComponent(l)}catch{return r.bin.readASCII(s,i,o)}return a},writeUTF8:function(s,i,o){for(var a=o.length,l=0,c=0;c<a;c++){var u=o.charCodeAt(c);if((4294967168&u)==0)s[i+l]=u,l++;else if((4294965248&u)==0)s[i+l]=192|u>>6,s[i+l+1]=128|u>>0&63,l+=2;else if((4294901760&u)==0)s[i+l]=224|u>>12,s[i+l+1]=128|u>>6&63,s[i+l+2]=128|u>>0&63,l+=3;else{if((4292870144&u)!=0)throw"e";s[i+l]=240|u>>18,s[i+l+1]=128|u>>12&63,s[i+l+2]=128|u>>6&63,s[i+l+3]=128|u>>0&63,l+=4}}return l},sizeUTF8:function(s){for(var i=s.length,o=0,a=0;a<i;a++){var l=s.charCodeAt(a);if((4294967168&l)==0)o++;else if((4294965248&l)==0)o+=2;else if((4294901760&l)==0)o+=3;else{if((4292870144&l)!=0)throw"e";o+=4}}return o}},r.F={},r.F.deflateRaw=function(s,i,o,a){var l=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][a],c=r.F.U,u=r.F._goodIndex;r.F._hash;var h=r.F._putsE,f=0,p=o<<3,m=0,y=s.length;if(a==0){for(;f<y;)h(i,p,f+(N=Math.min(65535,y-f))==y?1:0),p=r.F._copyExact(s,f,N,i,p+8),f+=N;return p>>>3}var v=c.lits,S=c.strt,E=c.prev,k=0,g=0,w=0,_=0,P=0,b=0;for(y>2&&(S[b=r.F._hash(s,0)]=0),f=0;f<y;f++){if(P=b,f+1<y-2){b=r.F._hash(s,f+1);var C=f+1&32767;E[C]=S[b],S[b]=C}if(m<=f){(k>14e3||g>26697)&&y-f>100&&(m<f&&(v[k]=f-m,k+=2,m=f),p=r.F._writeBlock(f==y-1||m==y?1:0,v,k,_,s,w,f-w,i,p),k=g=_=0,w=f);var A=0;f<y-2&&(A=r.F._bestMatch(s,f,E,P,Math.min(l[2],y-f),l[3]));var N=A>>>16,O=65535&A;if(A!=0){O=65535&A;var I=u(N=A>>>16,c.of0);c.lhst[257+I]++;var T=u(O,c.df0);c.dhst[T]++,_+=c.exb[I]+c.dxb[T],v[k]=N<<23|f-m,v[k+1]=O<<16|I<<8|T,k+=2,m=f+N}else c.lhst[s[f]]++;g++}}for(w==f&&s.length!=0||(m<f&&(v[k]=f-m,k+=2,m=f),p=r.F._writeBlock(1,v,k,_,s,w,f-w,i,p),k=0,g=0,k=g=_=0,w=f);(7&p)!=0;)p++;return p>>>3},r.F._bestMatch=function(s,i,o,a,l,c){var u=32767&i,h=o[u],f=u-h+32768&32767;if(h==u||a!=r.F._hash(s,i-f))return 0;for(var p=0,m=0,y=Math.min(32767,i);f<=y&&--c!=0&&h!=u;){if(p==0||s[i+p]==s[i+p-f]){var v=r.F._howLong(s,i,f);if(v>p){if(m=f,(p=v)>=l)break;f+2<v&&(v=f+2);for(var S=0,E=0;E<v-2;E++){var k=i-f+E+32768&32767,g=k-o[k]+32768&32767;g>S&&(S=g,h=k)}}}f+=(u=h)-(h=o[u])+32768&32767}return p<<16|m},r.F._howLong=function(s,i,o){if(s[i]!=s[i-o]||s[i+1]!=s[i+1-o]||s[i+2]!=s[i+2-o])return 0;var a=i,l=Math.min(s.length,i+258);for(i+=3;i<l&&s[i]==s[i-o];)i++;return i-a},r.F._hash=function(s,i){return(s[i]<<8|s[i+1])+(s[i+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(s,i,o,a,l,c,u,h,f){var p,m,y,v,S,E,k,g,w,_=r.F.U,P=r.F._putsF,b=r.F._putsE;_.lhst[256]++,m=(p=r.F.getTrees())[0],y=p[1],v=p[2],S=p[3],E=p[4],k=p[5],g=p[6],w=p[7];var C=32+((f+3&7)==0?0:8-(f+3&7))+(u<<3),A=a+r.F.contSize(_.fltree,_.lhst)+r.F.contSize(_.fdtree,_.dhst),N=a+r.F.contSize(_.ltree,_.lhst)+r.F.contSize(_.dtree,_.dhst);N+=14+3*k+r.F.contSize(_.itree,_.ihst)+(2*_.ihst[16]+3*_.ihst[17]+7*_.ihst[18]);for(var O=0;O<286;O++)_.lhst[O]=0;for(O=0;O<30;O++)_.dhst[O]=0;for(O=0;O<19;O++)_.ihst[O]=0;var I=C<A&&C<N?0:A<N?1:2;if(P(h,f,s),P(h,f+1,I),f+=3,I==0){for(;(7&f)!=0;)f++;f=r.F._copyExact(l,c,u,h,f)}else{var T,M;if(I==1&&(T=_.fltree,M=_.fdtree),I==2){r.F.makeCodes(_.ltree,m),r.F.revCodes(_.ltree,m),r.F.makeCodes(_.dtree,y),r.F.revCodes(_.dtree,y),r.F.makeCodes(_.itree,v),r.F.revCodes(_.itree,v),T=_.ltree,M=_.dtree,b(h,f,S-257),b(h,f+=5,E-1),b(h,f+=5,k-4),f+=4;for(var R=0;R<k;R++)b(h,f+3*R,_.itree[1+(_.ordr[R]<<1)]);f+=3*k,f=r.F._codeTiny(g,_.itree,h,f),f=r.F._codeTiny(w,_.itree,h,f)}for(var j=c,D=0;D<o;D+=2){for(var $=i[D],F=$>>>23,K=j+(8388607&$);j<K;)f=r.F._writeLit(l[j++],T,h,f);if(F!=0){var z=i[D+1],U=z>>16,V=z>>8&255,W=255&z;b(h,f=r.F._writeLit(257+V,T,h,f),F-_.of0[V]),f+=_.exb[V],P(h,f=r.F._writeLit(W,M,h,f),U-_.df0[W]),f+=_.dxb[W],j+=F}}f=r.F._writeLit(256,T,h,f)}return f},r.F._copyExact=function(s,i,o,a,l){var c=l>>>3;return a[c]=o,a[c+1]=o>>>8,a[c+2]=255-a[c],a[c+3]=255-a[c+1],c+=4,a.set(new Uint8Array(s.buffer,i,o),c),l+(o+4<<3)},r.F.getTrees=function(){for(var s=r.F.U,i=r.F._hufTree(s.lhst,s.ltree,15),o=r.F._hufTree(s.dhst,s.dtree,15),a=[],l=r.F._lenCodes(s.ltree,a),c=[],u=r.F._lenCodes(s.dtree,c),h=0;h<a.length;h+=2)s.ihst[a[h]]++;for(h=0;h<c.length;h+=2)s.ihst[c[h]]++;for(var f=r.F._hufTree(s.ihst,s.itree,7),p=19;p>4&&s.itree[1+(s.ordr[p-1]<<1)]==0;)p--;return[i,o,f,l,u,p,a,c]},r.F.getSecond=function(s){for(var i=[],o=0;o<s.length;o+=2)i.push(s[o+1]);return i},r.F.nonZero=function(s){for(var i="",o=0;o<s.length;o+=2)s[o+1]!=0&&(i+=(o>>1)+",");return i},r.F.contSize=function(s,i){for(var o=0,a=0;a<i.length;a++)o+=i[a]*s[1+(a<<1)];return o},r.F._codeTiny=function(s,i,o,a){for(var l=0;l<s.length;l+=2){var c=s[l],u=s[l+1];a=r.F._writeLit(c,i,o,a);var h=c==16?2:c==17?3:7;c>15&&(r.F._putsE(o,a,u,h),a+=h)}return a},r.F._lenCodes=function(s,i){for(var o=s.length;o!=2&&s[o-1]==0;)o-=2;for(var a=0;a<o;a+=2){var l=s[a+1],c=a+3<o?s[a+3]:-1,u=a+5<o?s[a+5]:-1,h=a==0?-1:s[a-1];if(l==0&&c==l&&u==l){for(var f=a+5;f+2<o&&s[f+2]==l;)f+=2;(p=Math.min(f+1-a>>>1,138))<11?i.push(17,p-3):i.push(18,p-11),a+=2*p-2}else if(l==h&&c==l&&u==l){for(f=a+5;f+2<o&&s[f+2]==l;)f+=2;var p=Math.min(f+1-a>>>1,6);i.push(16,p-3),a+=2*p-2}else i.push(l,0)}return o>>>1},r.F._hufTree=function(s,i,o){var a=[],l=s.length,c=i.length,u=0;for(u=0;u<c;u+=2)i[u]=0,i[u+1]=0;for(u=0;u<l;u++)s[u]!=0&&a.push({lit:u,f:s[u]});var h=a.length,f=a.slice(0);if(h==0)return 0;if(h==1){var p=a[0].lit;return f=p==0?1:0,i[1+(p<<1)]=1,i[1+(f<<1)]=1,1}a.sort((function(g,w){return g.f-w.f}));var m=a[0],y=a[1],v=0,S=1,E=2;for(a[0]={lit:-1,f:m.f+y.f,l:m,r:y,d:0};S!=h-1;)m=v!=S&&(E==h||a[v].f<a[E].f)?a[v++]:a[E++],y=v!=S&&(E==h||a[v].f<a[E].f)?a[v++]:a[E++],a[S++]={lit:-1,f:m.f+y.f,l:m,r:y};var k=r.F.setDepth(a[S-1],0);for(k>o&&(r.F.restrictDepth(f,o,k),k=o),u=0;u<h;u++)i[1+(f[u].lit<<1)]=f[u].d;return k},r.F.setDepth=function(s,i){return s.lit!=-1?(s.d=i,i):Math.max(r.F.setDepth(s.l,i+1),r.F.setDepth(s.r,i+1))},r.F.restrictDepth=function(s,i,o){var a=0,l=1<<o-i,c=0;for(s.sort((function(h,f){return f.d==h.d?h.f-f.f:f.d-h.d})),a=0;a<s.length&&s[a].d>i;a++){var u=s[a].d;s[a].d=i,c+=l-(1<<o-u)}for(c>>>=o-i;c>0;)(u=s[a].d)<i?(s[a].d++,c-=1<<i-u-1):a++;for(;a>=0;a--)s[a].d==i&&c<0&&(s[a].d--,c++);c!=0&&console.log("debt left")},r.F._goodIndex=function(s,i){var o=0;return i[16|o]<=s&&(o|=16),i[8|o]<=s&&(o|=8),i[4|o]<=s&&(o|=4),i[2|o]<=s&&(o|=2),i[1|o]<=s&&(o|=1),o},r.F._writeLit=function(s,i,o,a){return r.F._putsF(o,a,i[s<<1]),a+i[1+(s<<1)]},r.F.inflate=function(s,i){var o=Uint8Array;if(s[0]==3&&s[1]==0)return i||new o(0);var a=r.F,l=a._bitsF,c=a._bitsE,u=a._decodeTiny,h=a.makeCodes,f=a.codes2map,p=a._get17,m=a.U,y=i==null;y&&(i=new o(s.length>>>2<<3));for(var v,S,E=0,k=0,g=0,w=0,_=0,P=0,b=0,C=0,A=0;E==0;)if(E=l(s,A,1),k=l(s,A+1,2),A+=3,k!=0){if(y&&(i=r.F._check(i,C+(1<<17))),k==1&&(v=m.flmap,S=m.fdmap,P=511,b=31),k==2){g=c(s,A,5)+257,w=c(s,A+5,5)+1,_=c(s,A+10,4)+4,A+=14;for(var N=0;N<38;N+=2)m.itree[N]=0,m.itree[N+1]=0;var O=1;for(N=0;N<_;N++){var I=c(s,A+3*N,3);m.itree[1+(m.ordr[N]<<1)]=I,I>O&&(O=I)}A+=3*_,h(m.itree,O),f(m.itree,O,m.imap),v=m.lmap,S=m.dmap,A=u(m.imap,(1<<O)-1,g+w,s,A,m.ttree);var T=a._copyOut(m.ttree,0,g,m.ltree);P=(1<<T)-1;var M=a._copyOut(m.ttree,g,w,m.dtree);b=(1<<M)-1,h(m.ltree,T),f(m.ltree,T,v),h(m.dtree,M),f(m.dtree,M,S)}for(;;){var R=v[p(s,A)&P];A+=15&R;var j=R>>>4;if(!(j>>>8))i[C++]=j;else{if(j==256)break;var D=C+j-254;if(j>264){var $=m.ldef[j-257];D=C+($>>>3)+c(s,A,7&$),A+=7&$}var F=S[p(s,A)&b];A+=15&F;var K=F>>>4,z=m.ddef[K],U=(z>>>4)+l(s,A,15&z);for(A+=15&z,y&&(i=r.F._check(i,C+(1<<17)));C<D;)i[C]=i[C++-U],i[C]=i[C++-U],i[C]=i[C++-U],i[C]=i[C++-U];C=D}}}else{(7&A)!=0&&(A+=8-(7&A));var V=4+(A>>>3),W=s[V-4]|s[V-3]<<8;y&&(i=r.F._check(i,C+W)),i.set(new o(s.buffer,s.byteOffset+V,W),C),A=V+W<<3,C+=W}return i.length==C?i:i.slice(0,C)},r.F._check=function(s,i){var o=s.length;if(i<=o)return s;var a=new Uint8Array(Math.max(o<<1,i));return a.set(s,0),a},r.F._decodeTiny=function(s,i,o,a,l,c){for(var u=r.F._bitsE,h=r.F._get17,f=0;f<o;){var p=s[h(a,l)&i];l+=15&p;var m=p>>>4;if(m<=15)c[f]=m,f++;else{var y=0,v=0;m==16?(v=3+u(a,l,2),l+=2,y=c[f-1]):m==17?(v=3+u(a,l,3),l+=3):m==18&&(v=11+u(a,l,7),l+=7);for(var S=f+v;f<S;)c[f]=y,f++}}return l},r.F._copyOut=function(s,i,o,a){for(var l=0,c=0,u=a.length>>>1;c<o;){var h=s[c+i];a[c<<1]=0,a[1+(c<<1)]=h,h>l&&(l=h),c++}for(;c<u;)a[c<<1]=0,a[1+(c<<1)]=0,c++;return l},r.F.makeCodes=function(s,i){for(var o,a,l,c,u=r.F.U,h=s.length,f=u.bl_count,p=0;p<=i;p++)f[p]=0;for(p=1;p<h;p+=2)f[s[p]]++;var m=u.next_code;for(o=0,f[0]=0,a=1;a<=i;a++)o=o+f[a-1]<<1,m[a]=o;for(l=0;l<h;l+=2)(c=s[l+1])!=0&&(s[l]=m[c],m[c]++)},r.F.codes2map=function(s,i,o){for(var a=s.length,l=r.F.U.rev15,c=0;c<a;c+=2)if(s[c+1]!=0)for(var u=c>>1,h=s[c+1],f=u<<4|h,p=i-h,m=s[c]<<p,y=m+(1<<p);m!=y;)o[l[m]>>>15-i]=f,m++},r.F.revCodes=function(s,i){for(var o=r.F.U.rev15,a=15-i,l=0;l<s.length;l+=2){var c=s[l]<<i-s[l+1];s[l]=o[c]>>>a}},r.F._putsE=function(s,i,o){o<<=7&i;var a=i>>>3;s[a]|=o,s[a+1]|=o>>>8},r.F._putsF=function(s,i,o){o<<=7&i;var a=i>>>3;s[a]|=o,s[a+1]|=o>>>8,s[a+2]|=o>>>16},r.F._bitsE=function(s,i,o){return(s[i>>>3]|s[1+(i>>>3)]<<8)>>>(7&i)&(1<<o)-1},r.F._bitsF=function(s,i,o){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16)>>>(7&i)&(1<<o)-1},r.F._get17=function(s,i){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16)>>>(7&i)},r.F._get25=function(s,i){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16|s[3+(i>>>3)]<<24)>>>(7&i)},r.F.U=(e=Uint16Array,n=Uint32Array,{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new n(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new n(286),dhst:new n(30),ihst:new n(19),lits:new n(15e3),strt:new e(65536),prev:new e(32768)}),(function(){for(var s=r.F.U,i=0;i<32768;i++){var o=i;o=(4278255360&(o=(4042322160&(o=(3435973836&(o=(2863311530&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,s.rev15[i]=(o>>>16|o<<16)>>>17}function a(l,c,u){for(;c--!=0;)l.push(0,u)}for(i=0;i<32;i++)s.ldef[i]=s.of0[i]<<3|s.exb[i],s.ddef[i]=s.df0[i]<<4|s.dxb[i];a(s.fltree,144,8),a(s.fltree,112,9),a(s.fltree,24,7),a(s.fltree,8,8),r.F.makeCodes(s.fltree,9),r.F.codes2map(s.fltree,9,s.flmap),r.F.revCodes(s.fltree,9),a(s.fdtree,32,5),r.F.makeCodes(s.fdtree,5),r.F.codes2map(s.fdtree,5,s.fdmap),r.F.revCodes(s.fdtree,5),a(s.itree,19,0),a(s.ltree,286,0),a(s.dtree,30,0),a(s.ttree,320,0)})()})();var NC=PC({__proto__:null,default:ca},[ca]);const Dt=(function(){var t={nextZero(u,h){for(;u[h]!=0;)h++;return h},readUshort:(u,h)=>u[h]<<8|u[h+1],writeUshort(u,h,f){u[h]=f>>8&255,u[h+1]=255&f},readUint:(u,h)=>16777216*u[h]+(u[h+1]<<16|u[h+2]<<8|u[h+3]),writeUint(u,h,f){u[h]=f>>24&255,u[h+1]=f>>16&255,u[h+2]=f>>8&255,u[h+3]=255&f},readASCII(u,h,f){let p="";for(let m=0;m<f;m++)p+=String.fromCharCode(u[h+m]);return p},writeASCII(u,h,f){for(let p=0;p<f.length;p++)u[h+p]=f.charCodeAt(p)},readBytes(u,h,f){const p=[];for(let m=0;m<f;m++)p.push(u[h+m]);return p},pad:u=>u.length<2?`0${u}`:u,readUTF8(u,h,f){let p,m="";for(let y=0;y<f;y++)m+=`%${t.pad(u[h+y].toString(16))}`;try{p=decodeURIComponent(m)}catch{return t.readASCII(u,h,f)}return p}};function e(u,h,f,p){const m=h*f,y=i(p),v=Math.ceil(h*y/8),S=new Uint8Array(4*m),E=new Uint32Array(S.buffer),{ctype:k}=p,{depth:g}=p,w=t.readUshort;if(k==6){const $=m<<2;if(g==8)for(var _=0;_<$;_+=4)S[_]=u[_],S[_+1]=u[_+1],S[_+2]=u[_+2],S[_+3]=u[_+3];if(g==16)for(_=0;_<$;_++)S[_]=u[_<<1]}else if(k==2){const $=p.tabs.tRNS;if($==null){if(g==8)for(_=0;_<m;_++){var P=3*_;E[_]=255<<24|u[P+2]<<16|u[P+1]<<8|u[P]}if(g==16)for(_=0;_<m;_++)P=6*_,E[_]=255<<24|u[P+4]<<16|u[P+2]<<8|u[P]}else{var b=$[0];const F=$[1],K=$[2];if(g==8)for(_=0;_<m;_++){var C=_<<2;P=3*_,E[_]=255<<24|u[P+2]<<16|u[P+1]<<8|u[P],u[P]==b&&u[P+1]==F&&u[P+2]==K&&(S[C+3]=0)}if(g==16)for(_=0;_<m;_++)C=_<<2,P=6*_,E[_]=255<<24|u[P+4]<<16|u[P+2]<<8|u[P],w(u,P)==b&&w(u,P+2)==F&&w(u,P+4)==K&&(S[C+3]=0)}}else if(k==3){const $=p.tabs.PLTE,F=p.tabs.tRNS,K=F?F.length:0;if(g==1)for(var A=0;A<f;A++){var N=A*v,O=A*h;for(_=0;_<h;_++){C=O+_<<2;var I=3*(T=u[N+(_>>3)]>>7-((7&_)<<0)&1);S[C]=$[I],S[C+1]=$[I+1],S[C+2]=$[I+2],S[C+3]=T<K?F[T]:255}}if(g==2)for(A=0;A<f;A++)for(N=A*v,O=A*h,_=0;_<h;_++)C=O+_<<2,I=3*(T=u[N+(_>>2)]>>6-((3&_)<<1)&3),S[C]=$[I],S[C+1]=$[I+1],S[C+2]=$[I+2],S[C+3]=T<K?F[T]:255;if(g==4)for(A=0;A<f;A++)for(N=A*v,O=A*h,_=0;_<h;_++)C=O+_<<2,I=3*(T=u[N+(_>>1)]>>4-((1&_)<<2)&15),S[C]=$[I],S[C+1]=$[I+1],S[C+2]=$[I+2],S[C+3]=T<K?F[T]:255;if(g==8)for(_=0;_<m;_++){var T;C=_<<2,I=3*(T=u[_]),S[C]=$[I],S[C+1]=$[I+1],S[C+2]=$[I+2],S[C+3]=T<K?F[T]:255}}else if(k==4){if(g==8)for(_=0;_<m;_++){C=_<<2;var M=u[R=_<<1];S[C]=M,S[C+1]=M,S[C+2]=M,S[C+3]=u[R+1]}if(g==16)for(_=0;_<m;_++){var R;C=_<<2,M=u[R=_<<2],S[C]=M,S[C+1]=M,S[C+2]=M,S[C+3]=u[R+2]}}else if(k==0)for(b=p.tabs.tRNS?p.tabs.tRNS:-1,A=0;A<f;A++){const $=A*v,F=A*h;if(g==1)for(var j=0;j<h;j++){var D=(M=255*(u[$+(j>>>3)]>>>7-(7&j)&1))==255*b?0:255;E[F+j]=D<<24|M<<16|M<<8|M}else if(g==2)for(j=0;j<h;j++)D=(M=85*(u[$+(j>>>2)]>>>6-((3&j)<<1)&3))==85*b?0:255,E[F+j]=D<<24|M<<16|M<<8|M;else if(g==4)for(j=0;j<h;j++)D=(M=17*(u[$+(j>>>1)]>>>4-((1&j)<<2)&15))==17*b?0:255,E[F+j]=D<<24|M<<16|M<<8|M;else if(g==8)for(j=0;j<h;j++)D=(M=u[$+j])==b?0:255,E[F+j]=D<<24|M<<16|M<<8|M;else if(g==16)for(j=0;j<h;j++)M=u[$+(j<<1)],D=w(u,$+(j<<1))==b?0:255,E[F+j]=D<<24|M<<16|M<<8|M}return S}function n(u,h,f,p){const m=i(u),y=Math.ceil(f*m/8),v=new Uint8Array((y+1+u.interlace)*p);return h=u.tabs.CgBI?s(h,v):r(h,v),u.interlace==0?h=o(h,u,0,f,p):u.interlace==1&&(h=(function(E,k){const g=k.width,w=k.height,_=i(k),P=_>>3,b=Math.ceil(g*_/8),C=new Uint8Array(w*b);let A=0;const N=[0,0,4,0,2,0,1],O=[0,4,0,2,0,1,0],I=[8,8,8,4,4,2,2],T=[8,8,4,4,2,2,1];let M=0;for(;M<7;){const j=I[M],D=T[M];let $=0,F=0,K=N[M];for(;K<w;)K+=j,F++;let z=O[M];for(;z<g;)z+=D,$++;const U=Math.ceil($*_/8);o(E,k,A,$,F);let V=0,W=N[M];for(;W<w;){let ee=O[M],ne=A+V*U<<3;for(;ee<g;){var R;if(_==1&&(R=(R=E[ne>>3])>>7-(7&ne)&1,C[W*b+(ee>>3)]|=R<<7-((7&ee)<<0)),_==2&&(R=(R=E[ne>>3])>>6-(7&ne)&3,C[W*b+(ee>>2)]|=R<<6-((3&ee)<<1)),_==4&&(R=(R=E[ne>>3])>>4-(7&ne)&15,C[W*b+(ee>>1)]|=R<<4-((1&ee)<<2)),_>=8){const pe=W*b+ee*P;for(let se=0;se<P;se++)C[pe+se]=E[(ne>>3)+se]}ne+=_,ee+=D}V++,W+=j}$*F!=0&&(A+=F*(1+U)),M+=1}return C})(h,u)),h}function r(u,h){return s(new Uint8Array(u.buffer,2,u.length-6),h)}var s=(function(){const u={H:{}};return u.H.N=function(h,f){const p=Uint8Array;let m,y,v=0,S=0,E=0,k=0,g=0,w=0,_=0,P=0,b=0;if(h[0]==3&&h[1]==0)return f||new p(0);const C=u.H,A=C.b,N=C.e,O=C.R,I=C.n,T=C.A,M=C.Z,R=C.m,j=f==null;for(j&&(f=new p(h.length>>>2<<5));v==0;)if(v=A(h,b,1),S=A(h,b+1,2),b+=3,S!=0){if(j&&(f=u.H.W(f,P+(1<<17))),S==1&&(m=R.J,y=R.h,w=511,_=31),S==2){E=N(h,b,5)+257,k=N(h,b+5,5)+1,g=N(h,b+10,4)+4,b+=14;let $=1;for(var D=0;D<38;D+=2)R.Q[D]=0,R.Q[D+1]=0;for(D=0;D<g;D++){const z=N(h,b+3*D,3);R.Q[1+(R.X[D]<<1)]=z,z>$&&($=z)}b+=3*g,I(R.Q,$),T(R.Q,$,R.u),m=R.w,y=R.d,b=O(R.u,(1<<$)-1,E+k,h,b,R.v);const F=C.V(R.v,0,E,R.C);w=(1<<F)-1;const K=C.V(R.v,E,k,R.D);_=(1<<K)-1,I(R.C,F),T(R.C,F,m),I(R.D,K),T(R.D,K,y)}for(;;){const $=m[M(h,b)&w];b+=15&$;const F=$>>>4;if(!(F>>>8))f[P++]=F;else{if(F==256)break;{let K=P+F-254;if(F>264){const ee=R.q[F-257];K=P+(ee>>>3)+N(h,b,7&ee),b+=7&ee}const z=y[M(h,b)&_];b+=15&z;const U=z>>>4,V=R.c[U],W=(V>>>4)+A(h,b,15&V);for(b+=15&V;P<K;)f[P]=f[P++-W],f[P]=f[P++-W],f[P]=f[P++-W],f[P]=f[P++-W];P=K}}}}else{(7&b)!=0&&(b+=8-(7&b));const $=4+(b>>>3),F=h[$-4]|h[$-3]<<8;j&&(f=u.H.W(f,P+F)),f.set(new p(h.buffer,h.byteOffset+$,F),P),b=$+F<<3,P+=F}return f.length==P?f:f.slice(0,P)},u.H.W=function(h,f){const p=h.length;if(f<=p)return h;const m=new Uint8Array(p<<1);return m.set(h,0),m},u.H.R=function(h,f,p,m,y,v){const S=u.H.e,E=u.H.Z;let k=0;for(;k<p;){const g=h[E(m,y)&f];y+=15&g;const w=g>>>4;if(w<=15)v[k]=w,k++;else{let _=0,P=0;w==16?(P=3+S(m,y,2),y+=2,_=v[k-1]):w==17?(P=3+S(m,y,3),y+=3):w==18&&(P=11+S(m,y,7),y+=7);const b=k+P;for(;k<b;)v[k]=_,k++}}return y},u.H.V=function(h,f,p,m){let y=0,v=0;const S=m.length>>>1;for(;v<p;){const E=h[v+f];m[v<<1]=0,m[1+(v<<1)]=E,E>y&&(y=E),v++}for(;v<S;)m[v<<1]=0,m[1+(v<<1)]=0,v++;return y},u.H.n=function(h,f){const p=u.H.m,m=h.length;let y,v,S,E;const k=p.j;for(var g=0;g<=f;g++)k[g]=0;for(g=1;g<m;g+=2)k[h[g]]++;const w=p.K;for(y=0,k[0]=0,v=1;v<=f;v++)y=y+k[v-1]<<1,w[v]=y;for(S=0;S<m;S+=2)E=h[S+1],E!=0&&(h[S]=w[E],w[E]++)},u.H.A=function(h,f,p){const m=h.length,y=u.H.m.r;for(let v=0;v<m;v+=2)if(h[v+1]!=0){const S=v>>1,E=h[v+1],k=S<<4|E,g=f-E;let w=h[v]<<g;const _=w+(1<<g);for(;w!=_;)p[y[w]>>>15-f]=k,w++}},u.H.l=function(h,f){const p=u.H.m.r,m=15-f;for(let y=0;y<h.length;y+=2){const v=h[y]<<f-h[y+1];h[y]=p[v]>>>m}},u.H.M=function(h,f,p){p<<=7&f;const m=f>>>3;h[m]|=p,h[m+1]|=p>>>8},u.H.I=function(h,f,p){p<<=7&f;const m=f>>>3;h[m]|=p,h[m+1]|=p>>>8,h[m+2]|=p>>>16},u.H.e=function(h,f,p){return(h[f>>>3]|h[1+(f>>>3)]<<8)>>>(7&f)&(1<<p)-1},u.H.b=function(h,f,p){return(h[f>>>3]|h[1+(f>>>3)]<<8|h[2+(f>>>3)]<<16)>>>(7&f)&(1<<p)-1},u.H.Z=function(h,f){return(h[f>>>3]|h[1+(f>>>3)]<<8|h[2+(f>>>3)]<<16)>>>(7&f)},u.H.i=function(h,f){return(h[f>>>3]|h[1+(f>>>3)]<<8|h[2+(f>>>3)]<<16|h[3+(f>>>3)]<<24)>>>(7&f)},u.H.m=(function(){const h=Uint16Array,f=Uint32Array;return{K:new h(16),j:new h(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new h(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new f(32),J:new h(512),_:[],h:new h(32),$:[],w:new h(32768),C:[],v:[],d:new h(32768),D:[],u:new h(512),Q:[],r:new h(32768),s:new f(286),Y:new f(30),a:new f(19),t:new f(15e3),k:new h(65536),g:new h(32768)}})(),(function(){const h=u.H.m;for(var f=0;f<32768;f++){let m=f;m=(2863311530&m)>>>1|(1431655765&m)<<1,m=(3435973836&m)>>>2|(858993459&m)<<2,m=(4042322160&m)>>>4|(252645135&m)<<4,m=(4278255360&m)>>>8|(16711935&m)<<8,h.r[f]=(m>>>16|m<<16)>>>17}function p(m,y,v){for(;y--!=0;)m.push(0,v)}for(f=0;f<32;f++)h.q[f]=h.S[f]<<3|h.T[f],h.c[f]=h.p[f]<<4|h.z[f];p(h._,144,8),p(h._,112,9),p(h._,24,7),p(h._,8,8),u.H.n(h._,9),u.H.A(h._,9,h.J),u.H.l(h._,9),p(h.$,32,5),u.H.n(h.$,5),u.H.A(h.$,5,h.h),u.H.l(h.$,5),p(h.Q,19,0),p(h.C,286,0),p(h.D,30,0),p(h.v,320,0)})(),u.H.N})();function i(u){return[1,null,3,1,2,null,4][u.ctype]*u.depth}function o(u,h,f,p,m){let y=i(h);const v=Math.ceil(p*y/8);let S,E;y=Math.ceil(y/8);let k=u[f],g=0;if(k>1&&(u[f]=[0,0,1][k-2]),k==3)for(g=y;g<v;g++)u[g+1]=u[g+1]+(u[g+1-y]>>>1)&255;for(let w=0;w<m;w++)if(S=f+w*v,E=S+w+1,k=u[E-1],g=0,k==0)for(;g<v;g++)u[S+g]=u[E+g];else if(k==1){for(;g<y;g++)u[S+g]=u[E+g];for(;g<v;g++)u[S+g]=u[E+g]+u[S+g-y]}else if(k==2)for(;g<v;g++)u[S+g]=u[E+g]+u[S+g-v];else if(k==3){for(;g<y;g++)u[S+g]=u[E+g]+(u[S+g-v]>>>1);for(;g<v;g++)u[S+g]=u[E+g]+(u[S+g-v]+u[S+g-y]>>>1)}else{for(;g<y;g++)u[S+g]=u[E+g]+a(0,u[S+g-v],0);for(;g<v;g++)u[S+g]=u[E+g]+a(u[S+g-y],u[S+g-v],u[S+g-y-v])}return u}function a(u,h,f){const p=u+h-f,m=p-u,y=p-h,v=p-f;return m*m<=y*y&&m*m<=v*v?u:y*y<=v*v?h:f}function l(u,h,f){f.width=t.readUint(u,h),h+=4,f.height=t.readUint(u,h),h+=4,f.depth=u[h],h++,f.ctype=u[h],h++,f.compress=u[h],h++,f.filter=u[h],h++,f.interlace=u[h],h++}function c(u,h,f,p,m,y,v,S,E){const k=Math.min(h,m),g=Math.min(f,y);let w=0,_=0;for(let M=0;M<g;M++)for(let R=0;R<k;R++)if(v>=0&&S>=0?(w=M*h+R<<2,_=(S+M)*m+v+R<<2):(w=(-S+M)*h-v+R<<2,_=M*m+R<<2),E==0)p[_]=u[w],p[_+1]=u[w+1],p[_+2]=u[w+2],p[_+3]=u[w+3];else if(E==1){var P=u[w+3]*.00392156862745098,b=u[w]*P,C=u[w+1]*P,A=u[w+2]*P,N=p[_+3]*(1/255),O=p[_]*N,I=p[_+1]*N,T=p[_+2]*N;const j=1-P,D=P+N*j,$=D==0?0:1/D;p[_+3]=255*D,p[_+0]=(b+O*j)*$,p[_+1]=(C+I*j)*$,p[_+2]=(A+T*j)*$}else if(E==2)P=u[w+3],b=u[w],C=u[w+1],A=u[w+2],N=p[_+3],O=p[_],I=p[_+1],T=p[_+2],P==N&&b==O&&C==I&&A==T?(p[_]=0,p[_+1]=0,p[_+2]=0,p[_+3]=0):(p[_]=b,p[_+1]=C,p[_+2]=A,p[_+3]=P);else if(E==3){if(P=u[w+3],b=u[w],C=u[w+1],A=u[w+2],N=p[_+3],O=p[_],I=p[_+1],T=p[_+2],P==N&&b==O&&C==I&&A==T)continue;if(P<220&&N>20)return!1}return!0}return{decode:function(h){const f=new Uint8Array(h);let p=8;const m=t,y=m.readUshort,v=m.readUint,S={tabs:{},frames:[]},E=new Uint8Array(f.length);let k,g=0,w=0;const _=[137,80,78,71,13,10,26,10];for(var P=0;P<8;P++)if(f[P]!=_[P])throw"The input is not a PNG file!";for(;p<f.length;){const M=m.readUint(f,p);p+=4;const R=m.readASCII(f,p,4);if(p+=4,R=="IHDR")l(f,p,S);else if(R=="iCCP"){for(var b=p;f[b]!=0;)b++;m.readASCII(f,p,b-p),f[b+1];const j=f.slice(b+2,p+M);let D=null;try{D=r(j)}catch{D=s(j)}S.tabs[R]=D}else if(R=="CgBI")S.tabs[R]=f.slice(p,p+4);else if(R=="IDAT"){for(P=0;P<M;P++)E[g+P]=f[p+P];g+=M}else if(R=="acTL")S.tabs[R]={num_frames:v(f,p),num_plays:v(f,p+4)},k=new Uint8Array(f.length);else if(R=="fcTL"){w!=0&&((T=S.frames[S.frames.length-1]).data=n(S,k.slice(0,w),T.rect.width,T.rect.height),w=0);const j={x:v(f,p+12),y:v(f,p+16),width:v(f,p+4),height:v(f,p+8)};let D=y(f,p+22);D=y(f,p+20)/(D==0?100:D);const $={rect:j,delay:Math.round(1e3*D),dispose:f[p+24],blend:f[p+25]};S.frames.push($)}else if(R=="fdAT"){for(P=0;P<M-4;P++)k[w+P]=f[p+P+4];w+=M-4}else if(R=="pHYs")S.tabs[R]=[m.readUint(f,p),m.readUint(f,p+4),f[p+8]];else if(R=="cHRM")for(S.tabs[R]=[],P=0;P<8;P++)S.tabs[R].push(m.readUint(f,p+4*P));else if(R=="tEXt"||R=="zTXt"){S.tabs[R]==null&&(S.tabs[R]={});var C=m.nextZero(f,p),A=m.readASCII(f,p,C-p),N=p+M-C-1;if(R=="tEXt")I=m.readASCII(f,C+1,N);else{var O=r(f.slice(C+2,C+2+N));I=m.readUTF8(O,0,O.length)}S.tabs[R][A]=I}else if(R=="iTXt"){S.tabs[R]==null&&(S.tabs[R]={}),C=0,b=p,C=m.nextZero(f,b),A=m.readASCII(f,b,C-b);const j=f[b=C+1];var I;f[b+1],b+=2,C=m.nextZero(f,b),m.readASCII(f,b,C-b),b=C+1,C=m.nextZero(f,b),m.readUTF8(f,b,C-b),N=M-((b=C+1)-p),j==0?I=m.readUTF8(f,b,N):(O=r(f.slice(b,b+N)),I=m.readUTF8(O,0,O.length)),S.tabs[R][A]=I}else if(R=="PLTE")S.tabs[R]=m.readBytes(f,p,M);else if(R=="hIST"){const j=S.tabs.PLTE.length/3;for(S.tabs[R]=[],P=0;P<j;P++)S.tabs[R].push(y(f,p+2*P))}else if(R=="tRNS")S.ctype==3?S.tabs[R]=m.readBytes(f,p,M):S.ctype==0?S.tabs[R]=y(f,p):S.ctype==2&&(S.tabs[R]=[y(f,p),y(f,p+2),y(f,p+4)]);else if(R=="gAMA")S.tabs[R]=m.readUint(f,p)/1e5;else if(R=="sRGB")S.tabs[R]=f[p];else if(R=="bKGD")S.ctype==0||S.ctype==4?S.tabs[R]=[y(f,p)]:S.ctype==2||S.ctype==6?S.tabs[R]=[y(f,p),y(f,p+2),y(f,p+4)]:S.ctype==3&&(S.tabs[R]=f[p]);else if(R=="IEND")break;p+=M,m.readUint(f,p),p+=4}var T;return w!=0&&((T=S.frames[S.frames.length-1]).data=n(S,k.slice(0,w),T.rect.width,T.rect.height)),S.data=n(S,E,S.width,S.height),delete S.compress,delete S.interlace,delete S.filter,S},toRGBA8:function(h){const f=h.width,p=h.height;if(h.tabs.acTL==null)return[e(h.data,f,p,h).buffer];const m=[];h.frames[0].data==null&&(h.frames[0].data=h.data);const y=f*p*4,v=new Uint8Array(y),S=new Uint8Array(y),E=new Uint8Array(y);for(let g=0;g<h.frames.length;g++){const w=h.frames[g],_=w.rect.x,P=w.rect.y,b=w.rect.width,C=w.rect.height,A=e(w.data,b,C,h);if(g!=0)for(var k=0;k<y;k++)E[k]=v[k];if(w.blend==0?c(A,b,C,v,f,p,_,P,0):w.blend==1&&c(A,b,C,v,f,p,_,P,1),m.push(v.buffer.slice(0)),w.dispose!=0){if(w.dispose==1)c(S,b,C,v,f,p,_,P,0);else if(w.dispose==2)for(k=0;k<y;k++)v[k]=E[k]}}return m},_paeth:a,_copyTile:c,_bin:t}})();(function(){const{_copyTile:t}=Dt,{_bin:e}=Dt,n=Dt._paeth;var r={table:(function(){const b=new Uint32Array(256);for(let C=0;C<256;C++){let A=C;for(let N=0;N<8;N++)1&A?A=3988292384^A>>>1:A>>>=1;b[C]=A}return b})(),update(b,C,A,N){for(let O=0;O<N;O++)b=r.table[255&(b^C[A+O])]^b>>>8;return b},crc:(b,C,A)=>4294967295^r.update(4294967295,b,C,A)};function s(b,C,A,N){C[A]+=b[0]*N>>4,C[A+1]+=b[1]*N>>4,C[A+2]+=b[2]*N>>4,C[A+3]+=b[3]*N>>4}function i(b){return Math.max(0,Math.min(255,b))}function o(b,C){const A=b[0]-C[0],N=b[1]-C[1],O=b[2]-C[2],I=b[3]-C[3];return A*A+N*N+O*O+I*I}function a(b,C,A,N,O,I,T){T==null&&(T=1);const M=N.length,R=[];for(var j=0;j<M;j++){const W=N[j];R.push([W>>>0&255,W>>>8&255,W>>>16&255,W>>>24&255])}for(j=0;j<M;j++){let W=4294967295;for(var D=0,$=0;$<M;$++){var F=o(R[j],R[$]);$!=j&&F<W&&(W=F,D=$)}}const K=new Uint32Array(O.buffer),z=new Int16Array(C*A*4),U=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(j=0;j<U.length;j++)U[j]=255*((U[j]+.5)/16-.5);for(let W=0;W<A;W++)for(let ee=0;ee<C;ee++){var V;j=4*(W*C+ee),T!=2?V=[i(b[j]+z[j]),i(b[j+1]+z[j+1]),i(b[j+2]+z[j+2]),i(b[j+3]+z[j+3])]:(F=U[4*(3&W)+(3&ee)],V=[i(b[j]+F),i(b[j+1]+F),i(b[j+2]+F),i(b[j+3]+F)]),D=0;let ne=16777215;for($=0;$<M;$++){const me=o(V,R[$]);me<ne&&(ne=me,D=$)}const pe=R[D],se=[V[0]-pe[0],V[1]-pe[1],V[2]-pe[2],V[3]-pe[3]];T==1&&(ee!=C-1&&s(se,z,j+4,7),W!=A-1&&(ee!=0&&s(se,z,j+4*C-4,3),s(se,z,j+4*C,5),ee!=C-1&&s(se,z,j+4*C+4,1))),I[j>>2]=D,K[j>>2]=N[D]}}function l(b,C,A,N,O){O==null&&(O={});const{crc:I}=r,T=e.writeUint,M=e.writeUshort,R=e.writeASCII;let j=8;const D=b.frames.length>1;let $,F=!1,K=33+(D?20:0);if(O.sRGB!=null&&(K+=13),O.pHYs!=null&&(K+=21),O.iCCP!=null&&($=pako.deflate(O.iCCP),K+=21+$.length+4),b.ctype==3){for(var z=b.plte.length,U=0;U<z;U++)b.plte[U]>>>24!=255&&(F=!0);K+=8+3*z+4+(F?8+1*z+4:0)}for(var V=0;V<b.frames.length;V++)D&&(K+=38),K+=(pe=b.frames[V]).cimg.length+12,V!=0&&(K+=4);K+=12;const W=new Uint8Array(K),ee=[137,80,78,71,13,10,26,10];for(U=0;U<8;U++)W[U]=ee[U];if(T(W,j,13),j+=4,R(W,j,"IHDR"),j+=4,T(W,j,C),j+=4,T(W,j,A),j+=4,W[j]=b.depth,j++,W[j]=b.ctype,j++,W[j]=0,j++,W[j]=0,j++,W[j]=0,j++,T(W,j,I(W,j-17,17)),j+=4,O.sRGB!=null&&(T(W,j,1),j+=4,R(W,j,"sRGB"),j+=4,W[j]=O.sRGB,j++,T(W,j,I(W,j-5,5)),j+=4),O.iCCP!=null){const se=13+$.length;T(W,j,se),j+=4,R(W,j,"iCCP"),j+=4,R(W,j,"ICC profile"),j+=11,j+=2,W.set($,j),j+=$.length,T(W,j,I(W,j-(se+4),se+4)),j+=4}if(O.pHYs!=null&&(T(W,j,9),j+=4,R(W,j,"pHYs"),j+=4,T(W,j,O.pHYs[0]),j+=4,T(W,j,O.pHYs[1]),j+=4,W[j]=O.pHYs[2],j++,T(W,j,I(W,j-13,13)),j+=4),D&&(T(W,j,8),j+=4,R(W,j,"acTL"),j+=4,T(W,j,b.frames.length),j+=4,T(W,j,O.loop!=null?O.loop:0),j+=4,T(W,j,I(W,j-12,12)),j+=4),b.ctype==3){for(T(W,j,3*(z=b.plte.length)),j+=4,R(W,j,"PLTE"),j+=4,U=0;U<z;U++){const se=3*U,me=b.plte[U],ve=255&me,Se=me>>>8&255,it=me>>>16&255;W[j+se+0]=ve,W[j+se+1]=Se,W[j+se+2]=it}if(j+=3*z,T(W,j,I(W,j-3*z-4,3*z+4)),j+=4,F){for(T(W,j,z),j+=4,R(W,j,"tRNS"),j+=4,U=0;U<z;U++)W[j+U]=b.plte[U]>>>24&255;j+=z,T(W,j,I(W,j-z-4,z+4)),j+=4}}let ne=0;for(V=0;V<b.frames.length;V++){var pe=b.frames[V];D&&(T(W,j,26),j+=4,R(W,j,"fcTL"),j+=4,T(W,j,ne++),j+=4,T(W,j,pe.rect.width),j+=4,T(W,j,pe.rect.height),j+=4,T(W,j,pe.rect.x),j+=4,T(W,j,pe.rect.y),j+=4,M(W,j,N[V]),j+=2,M(W,j,1e3),j+=2,W[j]=pe.dispose,j++,W[j]=pe.blend,j++,T(W,j,I(W,j-30,30)),j+=4);const se=pe.cimg;T(W,j,(z=se.length)+(V==0?0:4)),j+=4;const me=j;R(W,j,V==0?"IDAT":"fdAT"),j+=4,V!=0&&(T(W,j,ne++),j+=4),W.set(se,j),j+=z,T(W,j,I(W,me,j-me)),j+=4}return T(W,j,0),j+=4,R(W,j,"IEND"),j+=4,T(W,j,I(W,j-4,4)),j+=4,W.buffer}function c(b,C,A){for(let N=0;N<b.frames.length;N++){const O=b.frames[N];O.rect.width;const I=O.rect.height,T=new Uint8Array(I*O.bpl+I);O.cimg=p(O.img,I,O.bpp,O.bpl,T,C,A)}}function u(b,C,A,N,O){const I=O[0],T=O[1],M=O[2],R=O[3],j=O[4],D=O[5];let $=6,F=8,K=255;for(var z=0;z<b.length;z++){const Me=new Uint8Array(b[z]);for(var U=Me.length,V=0;V<U;V+=4)K&=Me[V+3]}const W=K!=255,ee=(function(G,q,ue,be,we,$e){const Ae=[];for(var _e=0;_e<G.length;_e++){const at=new Uint8Array(G[_e]),It=new Uint32Array(at.buffer);var yt;let At=0,dn=0,Kt=q,tr=ue,Ll=be?1:0;if(_e!=0){const N1=$e||be||_e==1||Ae[_e-2].dispose!=0?1:2;let $l=0,bf=1e9;for(let $s=0;$s<N1;$s++){var En=new Uint8Array(G[_e-1-$s]);const T1=new Uint32Array(G[_e-1-$s]);let Pn=q,An=ue,Rr=-1,Fs=-1;for(let nr=0;nr<ue;nr++)for(let rr=0;rr<q;rr++)It[nt=nr*q+rr]!=T1[nt]&&(rr<Pn&&(Pn=rr),rr>Rr&&(Rr=rr),nr<An&&(An=nr),nr>Fs&&(Fs=nr));Rr==-1&&(Pn=An=Rr=Fs=0),we&&((1&Pn)==1&&Pn--,(1&An)==1&&An--);const wf=(Rr-Pn+1)*(Fs-An+1);wf<bf&&(bf=wf,$l=$s,At=Pn,dn=An,Kt=Rr-Pn+1,tr=Fs-An+1)}En=new Uint8Array(G[_e-1-$l]),$l==1&&(Ae[_e-1].dispose=2),yt=new Uint8Array(Kt*tr*4),t(En,q,ue,yt,Kt,tr,-At,-dn,0),Ll=t(at,q,ue,yt,Kt,tr,-At,-dn,3)?1:0,Ll==1?f(at,q,ue,yt,{x:At,y:dn,width:Kt,height:tr}):t(at,q,ue,yt,Kt,tr,-At,-dn,0)}else yt=at.slice(0);Ae.push({rect:{x:At,y:dn,width:Kt,height:tr},img:yt,blend:Ll,dispose:0})}if(be)for(_e=0;_e<Ae.length;_e++){if((er=Ae[_e]).blend==1)continue;const at=er.rect,It=Ae[_e-1].rect,At=Math.min(at.x,It.x),dn=Math.min(at.y,It.y),Kt={x:At,y:dn,width:Math.max(at.x+at.width,It.x+It.width)-At,height:Math.max(at.y+at.height,It.y+It.height)-dn};Ae[_e-1].dispose=1,_e-1!=0&&h(G,q,ue,Ae,_e-1,Kt,we),h(G,q,ue,Ae,_e,Kt,we)}let ro=0;if(G.length!=1)for(var nt=0;nt<Ae.length;nt++){var er;ro+=(er=Ae[nt]).rect.width*er.rect.height}return Ae})(b,C,A,I,T,M),ne={},pe=[],se=[];if(N!=0){const Me=[];for(V=0;V<ee.length;V++)Me.push(ee[V].img.buffer);const G=(function(we){let $e=0;for(var Ae=0;Ae<we.length;Ae++)$e+=we[Ae].byteLength;const _e=new Uint8Array($e);let yt=0;for(Ae=0;Ae<we.length;Ae++){const En=new Uint8Array(we[Ae]),ro=En.length;for(let nt=0;nt<ro;nt+=4){let er=En[nt],at=En[nt+1],It=En[nt+2];const At=En[nt+3];At==0&&(er=at=It=0),_e[yt+nt]=er,_e[yt+nt+1]=at,_e[yt+nt+2]=It,_e[yt+nt+3]=At}yt+=ro}return _e.buffer})(Me),q=y(G,N);for(V=0;V<q.plte.length;V++)pe.push(q.plte[V].est.rgba);let ue=0;for(V=0;V<ee.length;V++){const be=(ve=ee[V]).img.length;var me=new Uint8Array(q.inds.buffer,ue>>2,be>>2);se.push(me);const we=new Uint8Array(q.abuf,ue,be);D&&a(ve.img,ve.rect.width,ve.rect.height,pe,we,me),ve.img.set(we),ue+=be}}else for(z=0;z<ee.length;z++){var ve=ee[z];const Me=new Uint32Array(ve.img.buffer);var Se=ve.rect.width;for(U=Me.length,me=new Uint8Array(U),se.push(me),V=0;V<U;V++){const G=Me[V];if(V!=0&&G==Me[V-1])me[V]=me[V-1];else if(V>Se&&G==Me[V-Se])me[V]=me[V-Se];else{let q=ne[G];if(q==null&&(ne[G]=q=pe.length,pe.push(G),pe.length>=300))break;me[V]=q}}}const it=pe.length;for(it<=256&&j==0&&(F=it<=2?1:it<=4?2:it<=16?4:8,F=Math.max(F,R)),z=0;z<ee.length;z++){(ve=ee[z]).rect.x,ve.rect.y,Se=ve.rect.width;const Me=ve.rect.height;let G=ve.img;new Uint32Array(G.buffer);let q=4*Se,ue=4;if(it<=256&&j==0){q=Math.ceil(F*Se/8);var ot=new Uint8Array(q*Me);const be=se[z];for(let we=0;we<Me;we++){V=we*q;const $e=we*Se;if(F==8)for(var Ce=0;Ce<Se;Ce++)ot[V+Ce]=be[$e+Ce];else if(F==4)for(Ce=0;Ce<Se;Ce++)ot[V+(Ce>>1)]|=be[$e+Ce]<<4-4*(1&Ce);else if(F==2)for(Ce=0;Ce<Se;Ce++)ot[V+(Ce>>2)]|=be[$e+Ce]<<6-2*(3&Ce);else if(F==1)for(Ce=0;Ce<Se;Ce++)ot[V+(Ce>>3)]|=be[$e+Ce]<<7-1*(7&Ce)}G=ot,$=3,ue=1}else if(W==0&&ee.length==1){ot=new Uint8Array(Se*Me*3);const be=Se*Me;for(V=0;V<be;V++){const we=3*V,$e=4*V;ot[we]=G[$e],ot[we+1]=G[$e+1],ot[we+2]=G[$e+2]}G=ot,$=2,ue=3,q=3*Se}ve.img=G,ve.bpl=q,ve.bpp=ue}return{ctype:$,depth:F,plte:pe,frames:ee}}function h(b,C,A,N,O,I,T){const M=Uint8Array,R=Uint32Array,j=new M(b[O-1]),D=new R(b[O-1]),$=O+1<b.length?new M(b[O+1]):null,F=new M(b[O]),K=new R(F.buffer);let z=C,U=A,V=-1,W=-1;for(let ne=0;ne<I.height;ne++)for(let pe=0;pe<I.width;pe++){const se=I.x+pe,me=I.y+ne,ve=me*C+se,Se=K[ve];Se==0||N[O-1].dispose==0&&D[ve]==Se&&($==null||$[4*ve+3]!=0)||(se<z&&(z=se),se>V&&(V=se),me<U&&(U=me),me>W&&(W=me))}V==-1&&(z=U=V=W=0),T&&((1&z)==1&&z--,(1&U)==1&&U--),I={x:z,y:U,width:V-z+1,height:W-U+1};const ee=N[O];ee.rect=I,ee.blend=1,ee.img=new Uint8Array(I.width*I.height*4),N[O-1].dispose==0?(t(j,C,A,ee.img,I.width,I.height,-I.x,-I.y,0),f(F,C,A,ee.img,I)):t(F,C,A,ee.img,I.width,I.height,-I.x,-I.y,0)}function f(b,C,A,N,O){t(b,C,A,N,O.width,O.height,-O.x,-O.y,2)}function p(b,C,A,N,O,I,T){const M=[];let R,j=[0,1,2,3,4];I!=-1?j=[I]:(C*N>5e5||A==1)&&(j=[0]),T&&(R={level:0});const D=NC;for(var $=0;$<j.length;$++){for(let z=0;z<C;z++)m(O,b,z,N,A,j[$]);M.push(D.deflate(O,R))}let F,K=1e9;for($=0;$<M.length;$++)M[$].length<K&&(F=$,K=M[$].length);return M[F]}function m(b,C,A,N,O,I){const T=A*N;let M=T+A;if(b[M]=I,M++,I==0)if(N<500)for(var R=0;R<N;R++)b[M+R]=C[T+R];else b.set(new Uint8Array(C.buffer,T,N),M);else if(I==1){for(R=0;R<O;R++)b[M+R]=C[T+R];for(R=O;R<N;R++)b[M+R]=C[T+R]-C[T+R-O]+256&255}else if(A==0){for(R=0;R<O;R++)b[M+R]=C[T+R];if(I==2)for(R=O;R<N;R++)b[M+R]=C[T+R];if(I==3)for(R=O;R<N;R++)b[M+R]=C[T+R]-(C[T+R-O]>>1)+256&255;if(I==4)for(R=O;R<N;R++)b[M+R]=C[T+R]-n(C[T+R-O],0,0)+256&255}else{if(I==2)for(R=0;R<N;R++)b[M+R]=C[T+R]+256-C[T+R-N]&255;if(I==3){for(R=0;R<O;R++)b[M+R]=C[T+R]+256-(C[T+R-N]>>1)&255;for(R=O;R<N;R++)b[M+R]=C[T+R]+256-(C[T+R-N]+C[T+R-O]>>1)&255}if(I==4){for(R=0;R<O;R++)b[M+R]=C[T+R]+256-n(0,C[T+R-N],0)&255;for(R=O;R<N;R++)b[M+R]=C[T+R]+256-n(C[T+R-O],C[T+R-N],C[T+R-O-N])&255}}}function y(b,C){const A=new Uint8Array(b),N=A.slice(0),O=new Uint32Array(N.buffer),I=v(N,C),T=I[0],M=I[1],R=A.length,j=new Uint8Array(R>>2);let D;if(A.length<2e7)for(var $=0;$<R;$+=4)D=S(T,F=A[$]*(1/255),K=A[$+1]*(1/255),z=A[$+2]*(1/255),U=A[$+3]*(1/255)),j[$>>2]=D.ind,O[$>>2]=D.est.rgba;else for($=0;$<R;$+=4){var F=A[$]*.00392156862745098,K=A[$+1]*(1/255),z=A[$+2]*(1/255),U=A[$+3]*(1/255);for(D=T;D.left;)D=E(D.est,F,K,z,U)<=0?D.left:D.right;j[$>>2]=D.ind,O[$>>2]=D.est.rgba}return{abuf:N.buffer,inds:j,plte:M}}function v(b,C,A){A==null&&(A=1e-4);const N=new Uint32Array(b.buffer),O={i0:0,i1:b.length,bst:null,est:null,tdst:0,left:null,right:null};O.bst=w(b,O.i0,O.i1),O.est=_(O.bst);const I=[O];for(;I.length<C;){let M=0,R=0;for(var T=0;T<I.length;T++)I[T].est.L>M&&(M=I[T].est.L,R=T);if(M<A)break;const j=I[R],D=k(b,N,j.i0,j.i1,j.est.e,j.est.eMq255);if(j.i0>=D||j.i1<=D){j.est.L=0;continue}const $={i0:j.i0,i1:D,bst:null,est:null,tdst:0,left:null,right:null};$.bst=w(b,$.i0,$.i1),$.est=_($.bst);const F={i0:D,i1:j.i1,bst:null,est:null,tdst:0,left:null,right:null};for(F.bst={R:[],m:[],N:j.bst.N-$.bst.N},T=0;T<16;T++)F.bst.R[T]=j.bst.R[T]-$.bst.R[T];for(T=0;T<4;T++)F.bst.m[T]=j.bst.m[T]-$.bst.m[T];F.est=_(F.bst),j.left=$,j.right=F,I[R]=$,I.push(F)}for(I.sort(((M,R)=>R.bst.N-M.bst.N)),T=0;T<I.length;T++)I[T].ind=T;return[O,I]}function S(b,C,A,N,O){if(b.left==null)return b.tdst=(function($,F,K,z,U){const V=F-$[0],W=K-$[1],ee=z-$[2],ne=U-$[3];return V*V+W*W+ee*ee+ne*ne})(b.est.q,C,A,N,O),b;const I=E(b.est,C,A,N,O);let T=b.left,M=b.right;I>0&&(T=b.right,M=b.left);const R=S(T,C,A,N,O);if(R.tdst<=I*I)return R;const j=S(M,C,A,N,O);return j.tdst<R.tdst?j:R}function E(b,C,A,N,O){const{e:I}=b;return I[0]*C+I[1]*A+I[2]*N+I[3]*O-b.eMq}function k(b,C,A,N,O,I){for(N-=4;A<N;){for(;g(b,A,O)<=I;)A+=4;for(;g(b,N,O)>I;)N-=4;if(A>=N)break;const T=C[A>>2];C[A>>2]=C[N>>2],C[N>>2]=T,A+=4,N-=4}for(;g(b,A,O)>I;)A-=4;return A+4}function g(b,C,A){return b[C]*A[0]+b[C+1]*A[1]+b[C+2]*A[2]+b[C+3]*A[3]}function w(b,C,A){const N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],O=[0,0,0,0],I=A-C>>2;for(let T=C;T<A;T+=4){const M=b[T]*.00392156862745098,R=b[T+1]*(1/255),j=b[T+2]*(1/255),D=b[T+3]*(1/255);O[0]+=M,O[1]+=R,O[2]+=j,O[3]+=D,N[0]+=M*M,N[1]+=M*R,N[2]+=M*j,N[3]+=M*D,N[5]+=R*R,N[6]+=R*j,N[7]+=R*D,N[10]+=j*j,N[11]+=j*D,N[15]+=D*D}return N[4]=N[1],N[8]=N[2],N[9]=N[6],N[12]=N[3],N[13]=N[7],N[14]=N[11],{R:N,m:O,N:I}}function _(b){const{R:C}=b,{m:A}=b,{N}=b,O=A[0],I=A[1],T=A[2],M=A[3],R=N==0?0:1/N,j=[C[0]-O*O*R,C[1]-O*I*R,C[2]-O*T*R,C[3]-O*M*R,C[4]-I*O*R,C[5]-I*I*R,C[6]-I*T*R,C[7]-I*M*R,C[8]-T*O*R,C[9]-T*I*R,C[10]-T*T*R,C[11]-T*M*R,C[12]-M*O*R,C[13]-M*I*R,C[14]-M*T*R,C[15]-M*M*R],D=j,$=P;let F=[Math.random(),Math.random(),Math.random(),Math.random()],K=0,z=0;if(N!=0)for(let V=0;V<16&&(F=$.multVec(D,F),z=Math.sqrt($.dot(F,F)),F=$.sml(1/z,F),!(V!=0&&Math.abs(z-K)<1e-9));V++)K=z;const U=[O*R,I*R,T*R,M*R];return{Cov:j,q:U,e:F,L:K,eMq255:$.dot($.sml(255,U),F),eMq:$.dot(F,U),rgba:(Math.round(255*U[3])<<24|Math.round(255*U[2])<<16|Math.round(255*U[1])<<8|Math.round(255*U[0])<<0)>>>0}}var P={multVec:(b,C)=>[b[0]*C[0]+b[1]*C[1]+b[2]*C[2]+b[3]*C[3],b[4]*C[0]+b[5]*C[1]+b[6]*C[2]+b[7]*C[3],b[8]*C[0]+b[9]*C[1]+b[10]*C[2]+b[11]*C[3],b[12]*C[0]+b[13]*C[1]+b[14]*C[2]+b[15]*C[3]],dot:(b,C)=>b[0]*C[0]+b[1]*C[1]+b[2]*C[2]+b[3]*C[3],sml:(b,C)=>[b*C[0],b*C[1],b*C[2],b*C[3]]};Dt.encode=function(C,A,N,O,I,T,M){O==null&&(O=0),M==null&&(M=!1);const R=u(C,A,N,O,[!1,!1,!1,0,M,!1]);return c(R,-1),l(R,A,N,I,T)},Dt.encodeLL=function(C,A,N,O,I,T,M,R){const j={ctype:0+(O==1?0:2)+(I==0?0:4),depth:T,frames:[]},D=(O+I)*T,$=D*A;for(let F=0;F<C.length;F++)j.frames.push({rect:{x:0,y:0,width:A,height:N},img:new Uint8Array(C[F]),blend:0,dispose:1,bpp:Math.ceil(D/8),bpl:Math.ceil($/8)});return c(j,0,!0),l(j,A,N,M,R)},Dt.encode.compress=u,Dt.encode.dither=a,Dt.quantize=y,Dt.quantize.getKDtree=v,Dt.quantize.getNearest=S})();const ty={toArrayBuffer(t,e){const n=t.width,r=t.height,s=n<<2,i=t.getContext("2d").getImageData(0,0,n,r),o=new Uint32Array(i.data.buffer),a=(32*n+31)/32<<2,l=a*r,c=122+l,u=new ArrayBuffer(c),h=new DataView(u),f=1<<20;let p,m,y,v,S=f,E=0,k=0,g=0;function w(b){h.setUint16(k,b,!0),k+=2}function _(b){h.setUint32(k,b,!0),k+=4}function P(b){k+=b}w(19778),_(c),P(4),_(122),_(108),_(n),_(-r>>>0),w(1),w(32),_(3),_(l),_(2835),_(2835),P(8),_(16711680),_(65280),_(255),_(4278190080),_(1466527264),(function b(){for(;E<r&&S>0;){for(v=122+E*a,p=0;p<s;)S--,m=o[g++],y=m>>>24,h.setUint32(v+p,m<<8|y),p+=4;E++}g<o.length?(S=f,setTimeout(b,ty._dly)):e(u)})()},toBlob(t,e){this.toArrayBuffer(t,(n=>{e(new Blob([n],{type:"image/bmp"}))}))},_dly:9};var mt={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},TC={[mt.CHROME]:16384,[mt.FIREFOX]:11180,[mt.DESKTOP_SAFARI]:16384,[mt.IE]:8192,[mt.IOS]:4096,[mt.ETC]:8192};const Pd=typeof window<"u",ny=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,ua=Pd&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),RC=(Pd||ny)&&(ua&&ua.getOriginalSymbol(window,"File")||typeof File<"u"&&File),ry=(Pd||ny)&&(ua&&ua.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function Ad(t,e,n=Date.now()){return new Promise((r=>{const s=t.split(","),i=s[0].match(/:(.*?);/)[1],o=globalThis.atob(s[1]);let a=o.length;const l=new Uint8Array(a);for(;a--;)l[a]=o.charCodeAt(a);const c=new Blob([l],{type:i});c.name=e,c.lastModified=n,r(c)}))}function sy(t){return new Promise(((e,n)=>{const r=new ry;r.onload=()=>e(r.result),r.onerror=s=>n(s),r.readAsDataURL(t)}))}function iy(t){return new Promise(((e,n)=>{const r=new Image;r.onload=()=>e(r),r.onerror=s=>n(s),r.src=t}))}function pr(){if(pr.cachedResult!==void 0)return pr.cachedResult;let t=mt.ETC;const{userAgent:e}=navigator;return/Chrom(e|ium)/i.test(e)?t=mt.CHROME:/iP(ad|od|hone)/i.test(e)&&/WebKit/i.test(e)?t=mt.IOS:/Safari/i.test(e)?t=mt.DESKTOP_SAFARI:/Firefox/i.test(e)?t=mt.FIREFOX:(/MSIE/i.test(e)||document.documentMode)&&(t=mt.IE),pr.cachedResult=t,pr.cachedResult}function oy(t,e){const n=pr(),r=TC[n];let s=t,i=e,o=s*i;const a=s>i?i/s:s/i;for(;o>r*r;){const l=(r+s)/2,c=(r+i)/2;l<c?(i=c,s=c*a):(i=l*a,s=l),o=s*i}return{width:s,height:i}}function el(t,e){let n,r;try{if(n=new OffscreenCanvas(t,e),r=n.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{n=document.createElement("canvas"),r=n.getContext("2d")}return n.width=t,n.height=e,[n,r]}function ay(t,e){const{width:n,height:r}=oy(t.width,t.height),[s,i]=el(n,r);return e&&/jpe?g/.test(e)&&(i.fillStyle="white",i.fillRect(0,0,s.width,s.height)),i.drawImage(t,0,0,s.width,s.height),s}function Fo(){return Fo.cachedResult!==void 0||(Fo.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Fo.cachedResult}function da(t,e={}){return new Promise((function(n,r){let s,i;var o=function(){try{return i=ay(s,e.fileType||t.type),n([s,i])}catch(l){return r(l)}},a=function(l){try{var c=function(u){try{throw u}catch(h){return r(h)}};try{let u;return sy(t).then((function(h){try{return u=h,iy(u).then((function(f){try{return s=f,(function(){try{return o()}catch(p){return r(p)}})()}catch(p){return c(p)}}),c)}catch(f){return c(f)}}),c)}catch(u){c(u)}}catch(u){return r(u)}};try{if(Fo()||[mt.DESKTOP_SAFARI,mt.MOBILE_SAFARI].includes(pr()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(t).then((function(l){try{return s=l,o()}catch{return a()}}),a)}catch{a()}}))}function ha(t,e,n,r,s=1){return new Promise((function(i,o){let a;if(e==="image/png"){let c,u,h;return c=t.getContext("2d"),{data:u}=c.getImageData(0,0,t.width,t.height),h=Dt.encode([u.buffer],t.width,t.height,4096*s),a=new Blob([h],{type:e}),a.name=n,a.lastModified=r,l.call(this)}{let c=function(){return l.call(this)};if(e==="image/bmp")return new Promise((u=>ty.toBlob(t,u))).then((function(u){try{return a=u,a.name=n,a.lastModified=r,c.call(this)}catch(h){return o(h)}}).bind(this),o);{let u=function(){return c.call(this)};if(typeof OffscreenCanvas=="function"&&t instanceof OffscreenCanvas)return t.convertToBlob({type:e,quality:s}).then((function(h){try{return a=h,a.name=n,a.lastModified=r,u.call(this)}catch(f){return o(f)}}).bind(this),o);{let h;return h=t.toDataURL(e,s),Ad(h,n,r).then((function(f){try{return a=f,u.call(this)}catch(p){return o(p)}}).bind(this),o)}}}function l(){return i(a)}}))}function Xt(t){t.width=0,t.height=0}function ns(){return new Promise((function(t,e){let n,r,s,i;return ns.cachedResult!==void 0?t(ns.cachedResult):Ad("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(o){try{return n=o,da(n).then((function(a){try{return r=a[1],ha(r,n.type,n.name,n.lastModified).then((function(l){try{return s=l,Xt(r),da(s).then((function(c){try{return i=c[0],ns.cachedResult=i.width===1&&i.height===2,t(ns.cachedResult)}catch(u){return e(u)}}),e)}catch(c){return e(c)}}),e)}catch(l){return e(l)}}),e)}catch(a){return e(a)}}),e)}))}function ly(t){return new Promise(((e,n)=>{const r=new ry;r.onload=s=>{const i=new DataView(s.target.result);if(i.getUint16(0,!1)!=65496)return e(-2);const o=i.byteLength;let a=2;for(;a<o;){if(i.getUint16(a+2,!1)<=8)return e(-1);const l=i.getUint16(a,!1);if(a+=2,l==65505){if(i.getUint32(a+=2,!1)!=1165519206)return e(-1);const c=i.getUint16(a+=6,!1)==18761;a+=i.getUint32(a+4,c);const u=i.getUint16(a,c);a+=2;for(let h=0;h<u;h++)if(i.getUint16(a+12*h,c)==274)return e(i.getUint16(a+12*h+8,c))}else{if((65280&l)!=65280)break;a+=i.getUint16(a,!1)}}return e(-1)},r.onerror=s=>n(s),r.readAsArrayBuffer(t)}))}function cy(t,e){const{width:n}=t,{height:r}=t,{maxWidthOrHeight:s}=e;let i,o=t;return isFinite(s)&&(n>s||r>s)&&([o,i]=el(n,r),n>r?(o.width=s,o.height=r/n*s):(o.width=n/r*s,o.height=s),i.drawImage(t,0,0,o.width,o.height),Xt(t)),o}function uy(t,e){const{width:n}=t,{height:r}=t,[s,i]=el(n,r);switch(e>4&&e<9?(s.width=r,s.height=n):(s.width=n,s.height=r),e){case 2:i.transform(-1,0,0,1,n,0);break;case 3:i.transform(-1,0,0,-1,n,r);break;case 4:i.transform(1,0,0,-1,0,r);break;case 5:i.transform(0,1,1,0,0,0);break;case 6:i.transform(0,1,-1,0,r,0);break;case 7:i.transform(0,-1,-1,0,r,n);break;case 8:i.transform(0,-1,1,0,0,n)}return i.drawImage(t,0,0,n,r),Xt(t),s}function jf(t,e,n=0){return new Promise((function(r,s){let i,o,a,l,c,u,h,f,p,m,y,v,S,E,k,g,w,_,P,b;function C(N=5){if(e.signal&&e.signal.aborted)throw e.signal.reason;i+=N,e.onProgress(Math.min(i,100))}function A(N){if(e.signal&&e.signal.aborted)throw e.signal.reason;i=Math.min(Math.max(N,i),100),e.onProgress(i)}return i=n,o=e.maxIteration||10,a=1024*e.maxSizeMB*1024,C(),da(t,e).then((function(N){try{return[,l]=N,C(),c=cy(l,e),C(),new Promise((function(O,I){var T;if(!(T=e.exifOrientation))return ly(t).then((function(R){try{return T=R,M.call(this)}catch(j){return I(j)}}).bind(this),I);function M(){return O(T)}return M.call(this)})).then((function(O){try{return u=O,C(),ns().then((function(I){try{return h=I?c:uy(c,u),C(),f=e.initialQuality||1,p=e.fileType||t.type,ha(h,p,t.name,t.lastModified,f).then((function(T){try{{let R=function(){if(o--&&(k>a||k>S)){let D,$;return D=b?.95*P.width:P.width,$=b?.95*P.height:P.height,[w,_]=el(D,$),_.drawImage(P,0,0,D,$),f*=p==="image/png"?.85:.95,ha(w,p,t.name,t.lastModified,f).then((function(F){try{return g=F,Xt(P),P=w,k=g.size,A(Math.min(99,Math.floor((E-k)/(E-a)*100))),R}catch(K){return s(K)}}),s)}return[1]},j=function(){return Xt(P),Xt(w),Xt(c),Xt(h),Xt(l),A(100),r(g)};if(m=T,C(),y=m.size>a,v=m.size>t.size,!y&&!v)return A(100),r(m);var M;return S=t.size,E=m.size,k=E,P=h,b=!e.alwaysKeepResolution&&y,(M=(function(D){for(;D;){if(D.then)return void D.then(M,s);try{if(D.pop){if(D.length)return D.pop()?j.call(this):D;D=R}else D=D.call(this)}catch($){return s($)}}}).bind(this))(R)}}catch(R){return s(R)}}).bind(this),s)}catch(T){return s(T)}}).bind(this),s)}catch(I){return s(I)}}).bind(this),s)}catch(O){return s(O)}}).bind(this),s)}))}const OC=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let Bl;function IC(t,e){return new Promise(((n,r)=>{Bl||(Bl=(function(o){const a=[];return a.push(o),URL.createObjectURL(new Blob(a))})(OC));const s=new Worker(Bl);s.addEventListener("message",(function(o){if(e.signal&&e.signal.aborted)s.terminate();else if(o.data.progress===void 0){if(o.data.error)return r(new Error(o.data.error)),void s.terminate();n(o.data.file),s.terminate()}else e.onProgress(o.data.progress)})),s.addEventListener("error",r),e.signal&&e.signal.addEventListener("abort",(()=>{r(e.signal.reason),s.terminate()})),s.postMessage({file:t,imageCompressionLibUrl:e.libURL,options:{...e,onProgress:void 0,signal:void 0}})}))}function st(t,e){return new Promise((function(n,r){let s,i,o,a,l,c;if(s={...e},o=0,{onProgress:a}=s,s.maxSizeMB=s.maxSizeMB||Number.POSITIVE_INFINITY,l=typeof s.useWebWorker!="boolean"||s.useWebWorker,delete s.useWebWorker,s.onProgress=p=>{o=p,typeof a=="function"&&a(o)},!(t instanceof Blob||t instanceof RC))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(t.type))return r(new Error("The file given is not an image"));if(c=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!l||typeof Worker!="function"||c)return jf(t,s).then((function(p){try{return i=p,f.call(this)}catch(m){return r(m)}}).bind(this),r);var u=(function(){try{return f.call(this)}catch(p){return r(p)}}).bind(this),h=function(p){try{return jf(t,s).then((function(m){try{return i=m,u()}catch(y){return r(y)}}),r)}catch(m){return r(m)}};try{return s.libURL=s.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",IC(t,s).then((function(p){try{return i=p,u()}catch{return h()}}),h)}catch{h()}function f(){try{i.name=t.name,i.lastModified=t.lastModified}catch{}try{s.preserveExif&&t.type==="image/jpeg"&&(!s.fileType||s.fileType&&s.fileType===t.type)&&(i=ey(t,i))}catch{}return n(i)}}))}st.getDataUrlFromFile=sy,st.getFilefromDataUrl=Ad,st.loadImage=iy,st.drawImageInCanvas=ay,st.drawFileInCanvas=da,st.canvasToFile=ha,st.getExifOrientation=ly,st.handleMaxWidthOrHeight=cy,st.followExifOrientation=uy,st.cleanupCanvasMemory=Xt,st.isAutoOrientationInBrowser=ns,st.approximateBelowMaximumCanvasSizeOfBrowser=oy,st.copyExifWithoutOrientation=ey,st.getBrowserName=pr,st.version="2.0.2";var Qt=function(){return Qt=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Qt.apply(this,arguments)};function Cs(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function MC(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function DC(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}const LC=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class jd extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class $C extends jd{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Nf extends jd{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Tf extends jd{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Jc;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Jc||(Jc={}));class FC{constructor(e,{headers:n={},customFetch:r,region:s=Jc.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=LC(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return MC(this,arguments,void 0,function*(n,r={}){var s;let i,o;try{const{headers:a,method:l,body:c,signal:u,timeout:h}=r;let f={},{region:p}=r;p||(p=this.region);const m=new URL(`${this.url}/${n}`);p&&p!=="any"&&(f["x-region"]=p,m.searchParams.set("forceFunctionRegion",p));let y;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",y=c):typeof c=="string"?(f["Content-Type"]="text/plain",y=c):typeof FormData<"u"&&c instanceof FormData?y=c:(f["Content-Type"]="application/json",y=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?y=JSON.stringify(c):y=c;let v=u;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),u?(v=o.signal,u.addEventListener("abort",()=>o.abort())):v=o.signal);const S=yield this.fetch(m.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:y,signal:v}).catch(w=>{throw new $C(w)}),E=S.headers.get("x-relay-error");if(E&&E==="true")throw new Nf(S);if(!S.ok)throw new Tf(S);let k=((s=S.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),g;return k==="application/json"?g=yield S.json():k==="application/octet-stream"||k==="application/pdf"?g=yield S.blob():k==="text/event-stream"?g=S:k==="multipart/form-data"?g=yield S.formData():g=yield S.text(),{data:g,error:null,response:S}}catch(a){return{data:null,error:a,response:a instanceof Tf||a instanceof Nf?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var UC=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},BC=class{constructor(t){var e,n,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,this.urlLengthLimit=(r=t.urlLengthLimit)!==null&&r!==void 0?r:8e3,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,a=null,l=null,c=i.status,u=i.statusText;if(i.ok){var h,f;if(n.method!=="HEAD"){var p;const S=await i.text();S===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((p=n.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?a=S:a=JSON.parse(S))}const y=(h=n.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),v=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");y&&v&&v.length>1&&(l=parseInt(v[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,c=406,u="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var m;const y=await i.text();try{o=JSON.parse(y),Array.isArray(o)&&i.status===404&&(a=[],o=null,c=200,u="OK")}catch{i.status===404&&y===""?(c=204,u="No Content"):o={message:y}}if(o&&n.isMaybeSingle&&(!(o==null||(m=o.details)===null||m===void 0)&&m.includes("0 rows"))&&(o=null,c=200,u="OK"),o&&n.shouldThrowOnError)throw new UC(o)}return{error:o,data:a,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(s=s.catch(i=>{var o;let a="",l="",c="";const u=i==null?void 0:i.cause;if(u){var h,f,p,m;const S=(h=u==null?void 0:u.message)!==null&&h!==void 0?h:"",E=(f=u==null?void 0:u.code)!==null&&f!==void 0?f:"";a=`${(p=i==null?void 0:i.name)!==null&&p!==void 0?p:"FetchError"}: ${i==null?void 0:i.message}`,a+=`

Caused by: ${(m=u==null?void 0:u.name)!==null&&m!==void 0?m:"Error"}: ${S}`,E&&(a+=` (${E})`),u!=null&&u.stack&&(a+=`
${u.stack}`)}else{var y;a=(y=i==null?void 0:i.stack)!==null&&y!==void 0?y:""}const v=this.url.toString().length;return(i==null?void 0:i.name)==="AbortError"||(i==null?void 0:i.code)==="ABORT_ERR"?(c="",l="Request was aborted (timeout or manual cancellation)",v>this.urlLengthLimit&&(l+=`. Note: Your request URL is ${v} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((u==null?void 0:u.name)==="HeadersOverflowError"||(u==null?void 0:u.code)==="UND_ERR_HEADERS_OVERFLOW")&&(c="",l="HTTP headers exceeded server limits (typically 16KB)",v>this.urlLengthLimit&&(l+=`. Your request URL is ${v} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:a,hint:l,code:c},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}},VC=class extends BC{select(t){let e=!1;const n=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"offset":`${r}.offset`,i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:i="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Rf=new RegExp("[,()]");var Yr=class extends VC{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Rf.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Rf.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},WC=class{constructor(t,{headers:e={},schema:n,fetch:r,urlLengthLimit:s=8e3}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=r,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:n=!1,count:r}=e??{},s=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join(""),{url:a,headers:l}=this.cloneRequestState();return a.searchParams.set("select",o),r&&l.append("Prefer",`count=${r}`),new Yr({method:s,url:a,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(t,{count:e,defaultToNull:n=!0}={}){var r;const s="POST",{url:i,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),n||o.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);i.searchParams.set("columns",l.join(","))}}return new Yr({method:s,url:i,headers:o,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}={}){var i;const o="POST",{url:a,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&a.searchParams.set("on_conflict",e),r&&l.append("Prefer",`count=${r}`),s||l.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);a.searchParams.set("columns",u.join(","))}}return new Yr({method:o,url:a,headers:l,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}update(t,{count:e}={}){var n;const r="PATCH",{url:s,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Yr({method:r,url:s,headers:i,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:t}={}){var e;const n="DELETE",{url:r,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Yr({method:n,url:r,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function wi(t){"@babel/helpers - typeof";return wi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wi(t)}function zC(t,e){if(wi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(wi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HC(t){var e=zC(t,"string");return wi(e)=="symbol"?e:e+""}function KC(t,e,n){return(e=HC(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Of(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function oo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Of(Object(n),!0).forEach(function(r){KC(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Of(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var GC=class dy{constructor(e,{headers:n={},schema:r,fetch:s,timeout:i,urlLengthLimit:o=8e3}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.urlLengthLimit=o;const a=s??globalThis.fetch;i!==void 0&&i>0?this.fetch=(l,c)=>{const u=new AbortController,h=setTimeout(()=>u.abort(),i),f=c==null?void 0:c.signal;if(f){if(f.aborted)return clearTimeout(h),a(l,c);const p=()=>{clearTimeout(h),u.abort()};return f.addEventListener("abort",p,{once:!0}),a(l,oo(oo({},c),{},{signal:u.signal})).finally(()=>{clearTimeout(h),f.removeEventListener("abort",p)})}return a(l,oo(oo({},c),{},{signal:u.signal})).finally(()=>clearTimeout(h))}:this.fetch=a}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new WC(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new dy(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,n={},{head:r=!1,get:s=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let c;const u=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(u)),h=r&&Object.values(n).some(u);h?(a="POST",c=n):r||s?(a=r?"HEAD":"GET",Object.entries(n).filter(([p,m])=>m!==void 0).map(([p,m])=>[p,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([p,m])=>{l.searchParams.append(p,m)})):(a="POST",c=n);const f=new Headers(this.headers);return h?f.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&f.set("Prefer",`count=${i}`),new Yr({method:a,url:l,headers:f,schema:this.schemaName,body:c,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}};class qC{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const r=n.versions;if(r&&r.node){const s=r.node,i=parseInt(s.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const YC="2.95.3",JC=`realtime-js/${YC}`,XC="1.0.0",hy="2.0.0",If=hy,Xc=1e4,QC=1e3,ZC=100;var Dn;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Dn||(Dn={}));var Be;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Be||(Be={}));var Bt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Bt||(Bt={}));var Qc;(function(t){t.websocket="websocket"})(Qc||(Qc={}));var dr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(dr||(dr={}));class eE{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,r){var s,i;const o=e.topic,a=(s=e.ref)!==null&&s!==void 0?s:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",c=e.payload.event,u=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+c.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let m=new DataView(p),y=0;m.setUint8(y++,this.KINDS.userBroadcastPush),m.setUint8(y++,l.length),m.setUint8(y++,a.length),m.setUint8(y++,o.length),m.setUint8(y++,c.length),m.setUint8(y++,h.length),m.setUint8(y++,n),Array.from(l,S=>m.setUint8(y++,S.charCodeAt(0))),Array.from(a,S=>m.setUint8(y++,S.charCodeAt(0))),Array.from(o,S=>m.setUint8(y++,S.charCodeAt(0))),Array.from(c,S=>m.setUint8(y++,S.charCodeAt(0))),Array.from(h,S=>m.setUint8(y++,S.charCodeAt(0)));var v=new Uint8Array(p.byteLength+r.byteLength);return v.set(new Uint8Array(p),0),v.set(new Uint8Array(r),p.byteLength),v.buffer}decode(e,n){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return n(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,i,o,a,l]=r;return n({join_ref:s,ref:i,topic:o,event:a,payload:l})}return n({})}_binaryDecode(e){const n=new DataView(e),r=n.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,s)}}_decodeUserBroadcast(e,n,r){const s=n.getUint8(1),i=n.getUint8(2),o=n.getUint8(3),a=n.getUint8(4);let l=this.HEADER_LENGTH+4;const c=r.decode(e.slice(l,l+s));l=l+s;const u=r.decode(e.slice(l,l+i));l=l+i;const h=r.decode(e.slice(l,l+o));l=l+o;const f=e.slice(l,e.byteLength),p=a===this.JSON_ENCODING?JSON.parse(r.decode(f)):f,m={type:this.BROADCAST_EVENT,event:u,payload:p};return o>0&&(m.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:m}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>n.includes(r)))}}class fy{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ee;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ee||(Ee={}));const Mf=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=tE(o,t,e,s),i),{}):{}},tE=(t,e,n,r)=>{const s=e.find(a=>a.name===t),i=s==null?void 0:s.type,o=n[t];return i&&!r.includes(i)?py(i,o):Zc(o)},py=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return iE(e,n)}switch(t){case Ee.bool:return nE(e);case Ee.float4:case Ee.float8:case Ee.int2:case Ee.int4:case Ee.int8:case Ee.numeric:case Ee.oid:return rE(e);case Ee.json:case Ee.jsonb:return sE(e);case Ee.timestamp:return oE(e);case Ee.abstime:case Ee.date:case Ee.daterange:case Ee.int4range:case Ee.int8range:case Ee.money:case Ee.reltime:case Ee.text:case Ee.time:case Ee.timestamptz:case Ee.timetz:case Ee.tsrange:case Ee.tstzrange:return Zc(e);default:return Zc(e)}},Zc=t=>t,nE=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},rE=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},sE=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},iE=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>py(e,a))}return t},oE=t=>typeof t=="string"?t.replace(" ","T"):t,my=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Vl{constructor(e,n,r={},s=Xc){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Df;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Df||(Df={}));class ii{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ii.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=ii.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ii.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const i=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const f=u.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),m=u.filter(v=>p.indexOf(v.presence_ref)<0),y=h.filter(v=>f.indexOf(v.presence_ref)<0);m.length>0&&(a[c]=m),y.length>0&&(l[c]=y)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,n,r,s){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...f)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lf;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Lf||(Lf={}));var oi;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(oi||(oi={}));var gn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(gn||(gn={}));class rs{constructor(e,n={config:{}},r){var s,i;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Be.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Vl(this,Bt.join,this.params,this.timeout),this.rejoinTimer=new fy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Be.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Be.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Bt.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new ii(this),this.broadcastEndpointURL=my(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Be.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(p=>p.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[oi.PRESENCE]&&this.bindings[oi.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(gn.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(gn.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(gn.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,v=(m=y==null?void 0:y.length)!==null&&m!==void 0?m:0,S=[];for(let E=0;E<v;E++){const k=y[E],{filter:{event:g,schema:w,table:_,filter:P}}=k,b=p&&p[E];if(b&&b.event===g&&rs.isFilterValueEqual(b.schema,w)&&rs.isFilterValueEqual(b.table,_)&&rs.isFilterValueEqual(b.filter,P))S.push(Object.assign(Object.assign({},k),{id:b.id}));else{this.unsubscribe(),this.state=Be.errored,e==null||e(gn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(gn.SUBSCRIBED);return}}).receive("error",p=>{this.state=Be.errored,e==null||e(gn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(gn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Be.joined&&e===oi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,r)}async httpSend(e,n,r={}){var s;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const c=await a.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Be.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Bt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Vl(this,Bt.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Be.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Vl(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ZC){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Bt;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var m,y,v;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(y=p.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(p=>p.callback(f,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var m,y,v,S,E,k;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const g=p.id,w=(m=p.filter)===null||m===void 0?void 0:m.event;return g&&((y=n.ids)===null||y===void 0?void 0:y.includes(g))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const g=(E=(S=p==null?void 0:p.filter)===null||S===void 0?void 0:S.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return g==="*"||g===((k=n==null?void 0:n.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:y,table:v,commit_timestamp:S,type:E,errors:k}=m;f=Object.assign(Object.assign({},{schema:y,table:v,commit_timestamp:S,eventType:E,new:{},old:{},errors:k}),this._getPayloadRecords(m))}p.callback(f,r)})}_isClosed(){return this.state===Be.closed}_isJoined(){return this.state===Be.joined}_isJoining(){return this.state===Be.joining}_isLeaving(){return this.state===Be.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&rs.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Bt.close,{},e)}_onError(e){this._on(Bt.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Be.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Mf(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Mf(e.columns,e.old_record)),n}}const Wl=()=>{},ao={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},aE=[1e3,2e3,5e3,1e4],lE=1e4,cE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class uE{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Xc,this.transport=null,this.heartbeatIntervalMs=ao.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Wl,this.ref=0,this.reconnectTimer=null,this.vsn=If,this.logger=Wl,this.conn=null,this.sendBuffer=[],this.serializer=new eE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Qc.websocket}`,this.httpEndpoint=my(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=qC.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return n==="ok"&&this._remove(e),this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Dn.connecting:return dr.Connecting;case Dn.open:return dr.Open;case Dn.closing:return dr.Closing;default:return dr.Closed}}isConnected(){return this.connectionState()===dr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new rs(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(QC,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ao.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",c)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:s,payload:i,ref:o}=n,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${r} ${s} ${a}`.trim(),i),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(s,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Dn.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Dn.open||this.conn.readyState===Dn.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(n){this.log("error","error in heartbeat callback",n)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(Bt.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([cE],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,r=!1;if(e)n=e,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const i={access_token:n,version:JC};n&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(Bt.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new fy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ao.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,i,o,a,l,c,u,h,f,p;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Xc,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:ao.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Wl,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:If,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:(m=>aE[m-1]||lE),this.vsn){case XC:this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:((m,y)=>y(JSON.stringify(m))),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:((m,y)=>y(JSON.parse(m)));break;case hy:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var vi=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function dE(t,e,n){const r=new URL(e,t);if(n)for(const[s,i]of Object.entries(n))i!==void 0&&r.searchParams.set(s,i);return r.toString()}async function hE(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function fE(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:s,body:i,headers:o}){const a=dE(t.baseUrl,r,s),l=await hE(t.auth),c=await e(a,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),u=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),f=h&&u?JSON.parse(u):u;if(!c.ok){const p=h?f:void 0,m=p==null?void 0:p.error;throw new vi((m==null?void 0:m.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:m==null?void 0:m.type,icebergCode:m==null?void 0:m.code,details:p})}return{status:c.status,headers:c.headers,data:f}}}}function lo(t){return t.join("")}var pE=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:lo(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lo(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lo(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lo(t.namespace)}`}),!0}catch(e){if(e instanceof vi&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof vi&&n.status===409)return;throw n}}};function Or(t){return t.join("")}var mE=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Or(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Or(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Or(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Or(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Or(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Or(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof vi&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof vi&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},gE=class{constructor(t){var r;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=fE({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(r=t.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new pE(this.client,e),this.tableOps=new mE(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},tl=class extends Error{constructor(t,e="storage",n,r){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=r}};function nl(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var co=class extends tl{constructor(t,e,n,r="storage"){super(t,r,e,n),this.name=r==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},gy=class extends tl{constructor(t,e,n="storage"){super(t,n),this.name=n==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const yE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),xE=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},eu=t=>{if(Array.isArray(t))return t.map(n=>eu(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=eu(r)}),e},bE=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Si(t){"@babel/helpers - typeof";return Si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Si(t)}function wE(t,e){if(Si(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Si(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vE(t){var e=wE(t,"string");return Si(e)=="symbol"?e:e+""}function SE(t,e,n){return(e=vE(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$f(Object(n),!0).forEach(function(r){SE(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$f(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const Ff=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},_E=async(t,e,n,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const s=t,i=s.status||500;if(typeof s.json=="function")s.json().then(o=>{const a=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||i+"";e(new co(Ff(o),i,a,r))}).catch(()=>{if(r==="vectors"){const o=i+"";e(new co(s.statusText||`HTTP ${i} error`,i,o,r))}else{const o=i+"";e(new co(s.statusText||`HTTP ${i} error`,i,o,r))}});else{const o=i+"";e(new co(s.statusText||`HTTP ${i} error`,i,o,r))}}else e(new gy(Ff(t),t,r))},kE=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||t==="HEAD"||!r?oe(oe({},s),n):(xE(r)?(s.headers=oe({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),oe(oe({},s),n))};async function Us(t,e,n,r,s,i,o){return new Promise((a,l)=>{t(n,kE(e,r,s,i)).then(c=>{if(!c.ok)throw c;if(r!=null&&r.noResolveJson)return c;if(o==="vectors"){const u=c.headers.get("content-type");if(c.headers.get("content-length")==="0"||c.status===204)return{};if(!u||!u.includes("application/json"))return{}}return c.json()}).then(c=>a(c)).catch(c=>_E(c,l,r,o))})}function yy(t="storage"){return{get:async(e,n,r,s)=>Us(e,"GET",n,r,s,void 0,t),post:async(e,n,r,s,i)=>Us(e,"POST",n,s,i,r,t),put:async(e,n,r,s,i)=>Us(e,"PUT",n,s,i,r,t),head:async(e,n,r,s)=>Us(e,"HEAD",n,oe(oe({},r),{},{noResolveJson:!0}),s,void 0,t),remove:async(e,n,r,s,i)=>Us(e,"DELETE",n,s,i,r,t)}}const CE=yy("storage"),{get:_i,post:Ft,put:tu,head:EE,remove:Nd}=CE,kt=yy("vectors");var Es=class{constructor(t,e={},n,r="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=yE(n),this.namespace=r}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(nl(n))return{data:null,error:n};throw n}}},PE=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(nl(e))return{data:null,error:e};throw e}}};let xy;xy=Symbol.toStringTag;var AE=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[xy]="BlobDownloadBuilder",this.promise=null}asStream(){return new PE(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(nl(e))return{data:null,error:e};throw e}}};const jE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Uf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var NE=class extends Es{constructor(t,e={},n,r){super(t,e,r,"storage"),this.bucketId=n}async uploadOrUpdate(t,e,n,r){var s=this;return s.handleOperation(async()=>{let i;const o=oe(oe({},Uf),r);let a=oe(oe({},s.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",s.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=s.toBase64(s.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),r!=null&&r.headers&&(a=oe(oe({},a),r.headers));const c=s._removeEmptyFolders(e),u=s._getFinalPath(c),h=await(t=="PUT"?tu:Ft)(s.fetch,`${s.url}/object/${u}`,i,oe({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{path:c,id:h.Id,fullPath:h.Key}})}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,r){var s=this;const i=s._removeEmptyFolders(t),o=s._getFinalPath(i),a=new URL(s.url+`/object/upload/sign/${o}`);return a.searchParams.set("token",e),s.handleOperation(async()=>{let l;const c=oe({upsert:Uf.upsert},r),u=oe(oe({},s.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{path:i,fullPath:(await tu(s.fetch,a.toString(),l,{headers:u})).Key}})}async createSignedUploadUrl(t,e){var n=this;return n.handleOperation(async()=>{let r=n._getFinalPath(t);const s=oe({},n.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const i=await Ft(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(n.url+i.url),a=o.searchParams.get("token");if(!a)throw new tl("No token returned by API");return{signedUrl:o.toString(),path:t,token:a}})}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var r=this;return r.handleOperation(async()=>await Ft(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers}))}async copy(t,e,n){var r=this;return r.handleOperation(async()=>({path:(await Ft(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers})).Key}))}async createSignedUrl(t,e,n){var r=this;return r.handleOperation(async()=>{let s=r._getFinalPath(t),i=await Ft(r.fetch,`${r.url}/object/sign/${s}`,oe({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:r.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{signedUrl:encodeURI(`${r.url}${i.signedURL}${o}`)}})}async createSignedUrls(t,e,n){var r=this;return r.handleOperation(async()=>{const s=await Ft(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s.map(o=>oe(oe({},o),{},{signedUrl:o.signedURL?encodeURI(`${r.url}${o.signedURL}${i}`):null}))})}download(t,e,n){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=s?`?${s}`:"",o=this._getFinalPath(t),a=()=>_i(this.fetch,`${this.url}/${r}/${o}${i}`,{headers:this.headers,noResolveJson:!0},n);return new AE(a,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);return e.handleOperation(async()=>eu(await _i(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})))}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await EE(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(nl(r)&&r instanceof gy){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}}getPublicUrl(t,e){const n=this._getFinalPath(t),r=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&r.push(s);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&r.push(o);let a=r.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${a}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await Nd(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,n){var r=this;return r.handleOperation(async()=>{const s=oe(oe(oe({},jE),e),{},{prefix:t||""});return await Ft(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},n)})}async listV2(t,e){var n=this;return n.handleOperation(async()=>{const r=oe({},t);return await Ft(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const TE="2.95.3",$i={"X-Client-Info":`storage-js/${TE}`};var RE=class extends Es{constructor(t,e={},n,r){const s=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const i=s.href.replace(/\/$/,""),o=oe(oe({},$i),e);super(i,o,n,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=e.listBucketOptionsToQueryString(t);return await _i(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await _i(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var n=this;return n.handleOperation(async()=>await Ft(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async updateBucket(t,e){var n=this;return n.handleOperation(async()=>await tu(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await Ft(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Nd(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},OE=class extends Es{constructor(t,e={},n){const r=t.replace(/\/$/,""),s=oe(oe({},$i),e);super(r,s,n,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await Ft(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const r=n.toString(),s=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return await _i(e.fetch,s,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Nd(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!bE(t))throw new tl("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new gE({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(s,i){const o=s[i];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(s,a),error:null}}catch(l){if(r)throw l;return{data:null,error:l}}}}})}},IE=class extends Es{constructor(t,e={},n){const r=t.replace(/\/$/,""),s=oe(oe({},$i),{},{"Content-Type":"application/json"},e);super(r,s,n,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var n=this;return n.handleOperation(async()=>await kt.post(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var n=this;return n.handleOperation(async()=>await kt.post(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{})}},ME=class extends Es{constructor(t,e={},n){const r=t.replace(/\/$/,""),s=oe(oe({},$i),{},{"Content-Type":"application/json"},e);super(r,s,n,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},DE=class extends Es{constructor(t,e={},n){const r=t.replace(/\/$/,""),s=oe(oe({},$i),{},{"Content-Type":"application/json"},e);super(r,s,n,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await kt.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},LE=class extends DE{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new $E(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},$E=class extends IE{constructor(t,e,n,r){super(t,e,r),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,oe(oe({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,oe(oe({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new FE(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},FE=class extends ME{constructor(t,e,n,r,s){super(t,e,s),this.vectorBucketName=n,this.indexName=r}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,oe(oe({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,oe(oe({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,oe(oe({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,oe(oe({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,oe(oe({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},UE=class extends RE{constructor(t,e={},n,r){super(t,e,n,r)}from(t){return new NE(this.url,this.headers,t,this.fetch)}get vectors(){return new LE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new OE(this.url+"/iceberg",this.headers,this.fetch)}};const by="2.95.3",Jr=30*1e3,nu=3,zl=nu*Jr,BE="http://localhost:9999",VE="supabase.auth.token",WE={"X-Client-Info":`gotrue-js/${by}`},ru="X-Supabase-Api-Version",wy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},zE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,HE=600*1e3;class ki extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function te(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class KE extends ki{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function GE(t){return te(t)&&t.name==="AuthApiError"}class hr extends ki{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class kn extends ki{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class xt extends kn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Hl(t){return te(t)&&t.name==="AuthSessionMissingError"}class Ir extends kn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class uo extends kn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ho extends kn{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function qE(t){return te(t)&&t.name==="AuthImplicitGrantRedirectError"}class Bf extends kn{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class YE extends kn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class su extends kn{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Kl(t){return te(t)&&t.name==="AuthRetryableFetchError"}class Vf extends kn{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class iu extends kn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const fa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Wf=` 	
\r=`.split(""),JE=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Wf.length;e+=1)t[Wf[e].charCodeAt(0)]=-2;for(let e=0;e<fa.length;e+=1)t[fa[e].charCodeAt(0)]=e;return t})();function zf(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(fa[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(fa[r]),e.queuedBits-=6}}function vy(t,e,n){const r=JE[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Hf(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{ZE(o,r,n)};for(let o=0;o<t.length;o+=1)vy(t.charCodeAt(o),s,i);return e.join("")}function XE(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function QE(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}XE(r,e)}}function ZE(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function ds(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)vy(t.charCodeAt(s),n,r);return new Uint8Array(e)}function eP(t){const e=[];return QE(t,n=>e.push(n)),new Uint8Array(e)}function mr(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>zf(s,n,r)),zf(null,n,r),e.join("")}function tP(t){return Math.round(Date.now()/1e3)+t}function nP(){return Symbol("auth-callback")}const Ye=()=>typeof window<"u"&&typeof document<"u",sr={tested:!1,writable:!1},Sy=()=>{if(!Ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(sr.tested)return sr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),sr.tested=!0,sr.writable=!0}catch{sr.tested=!0,sr.writable=!1}return sr.writable};function rP(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const _y=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),sP=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Xr=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},ir=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},qe=async(t,e)=>{await t.removeItem(e)};class rl{constructor(){this.promise=new rl.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}rl.promiseConstructor=Promise;function fo(t){const e=t.split(".");if(e.length!==3)throw new iu("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!zE.test(e[r]))throw new iu("JWT not in base64url format");return{header:JSON.parse(Hf(e[0])),payload:JSON.parse(Hf(e[1])),signature:ds(e[2]),raw:{header:e[0],payload:e[1]}}}async function iP(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function oP(t,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function aP(t){return("0"+t.toString(16)).substr(-2)}function lP(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,aP).join("")}async function cP(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function uP(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await cP(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mr(t,e,n=!1){const r=lP();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await Xr(t,`${e}-code-verifier`,s);const i=await uP(r);return[i,r===i?"plain":"s256"]}const dP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function hP(t){const e=t.headers.get(ru);if(!e||!e.match(dP))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function fP(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function pP(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const mP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Dr(t){if(!mP.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gl(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function gP(t,e){return new Proxy(t,{get:(n,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,r,s)}})}function Kf(t){return JSON.parse(JSON.stringify(t))}const lr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),yP=[502,503,504];async function Gf(t){var e;if(!sP(t))throw new su(lr(t),0);if(yP.includes(t.status))throw new su(lr(t),t.status);let n;try{n=await t.json()}catch(i){throw new hr(lr(i),i)}let r;const s=hP(t);if(s&&s.getTime()>=wy["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Vf(lr(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new xt}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Vf(lr(n),t.status,n.weak_password.reasons);throw new KE(lr(n),t.status||500,r)}const xP=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function ie(t,e,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[ru]||(i[ru]=wy["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await bP(t,e,n+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function bP(t,e,n,r,s,i){const o=xP(e,r,s,i);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new su(lr(l),0)}if(a.ok||await Gf(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await Gf(l)}}function Lt(t){var e;let n=null;SP(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=tP(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function qf(t){const e=Lt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function $n(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function wP(t){return{data:t,error:null}}function vP(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=t,o=Cs(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Yf(t){return t}function SP(t){return t.access_token&&t.refresh_token&&t.expires_in}const ql=["global","local","others"];class _P{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=_y(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=ql[0]){if(ql.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ql.join(", ")}`);try{return await ie(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(te(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:$n})}catch(r){if(te(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Cs(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:vP,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(te(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:$n})}catch(n){if(te(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Yf});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const y=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=y}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(te(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Dr(e);try{return await ie(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:$n})}catch(n){if(te(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Dr(e);try{return await ie(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:$n})}catch(r){if(te(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Dr(e);try{return await ie(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:$n})}catch(r){if(te(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Dr(e.userId);try{const{data:n,error:r}=await ie(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(te(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Dr(e.userId),Dr(e.id);try{return{data:await ie(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(te(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ie(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Yf});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const y=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=y}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(te(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(te(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ie(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(te(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await ie(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(te(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await ie(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(te(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(te(n))return{data:null,error:n};throw n}}}function Jf(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Lr={debug:!!(globalThis&&Sy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ky extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class kP extends ky{}async function CP(t,e,n){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new kP(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Lr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function EP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Cy(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function PP(t){return parseInt(t,16)}function AP(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function jP(t){var e;const{chainId:n,domain:r,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:h,version:f}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=Cy(t.address),m=u?`${u}://${r}`:r,y=t.statement?`${t.statement}
`:"",v=`${m} wants you to sign in with your Ethereum account:
${p}

${y}`;let S=`URI: ${h}
Version: ${f}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(S+=`
Expiration Time: ${s.toISOString()}`),a&&(S+=`
Not Before: ${a.toISOString()}`),l&&(S+=`
Request ID: ${l}`),c){let E=`
Resources:`;for(const k of c){if(!k||typeof k!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${k}`);E+=`
- ${k}`}S+=E}return`${v}
${S}`}class De extends Error{constructor({message:e,code:n,cause:r,name:s}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=s??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class pa extends De{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function NP({error:t,options:e}){var n,r,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new De({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new De({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new De({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new De({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new De({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new De({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new De({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new De({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(Ey(o)){if(i.rp.id!==o)return new De({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new De({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new De({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new De({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new De({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function TP({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new De({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new De({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(Ey(r)){if(n.rpId!==r)return new De({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new De({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new De({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new De({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class RP{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const OP=new RP;function IP(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,s=Cs(t,["challenge","user","excludeCredentials"]),i=ds(e).buffer,o=Object.assign(Object.assign({},n),{id:ds(n.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:i,user:o});if(r&&r.length>0){a.excludeCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];a.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:ds(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function MP(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=Cs(t,["challenge","allowCredentials"]),s=ds(e).buffer,i=Object.assign(Object.assign({},r),{challenge:s});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const a=n[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:ds(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function DP(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:mr(new Uint8Array(t.response.attestationObject)),clientDataJSON:mr(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function LP(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:mr(new Uint8Array(s.authenticatorData)),clientDataJSON:mr(new Uint8Array(s.clientDataJSON)),signature:mr(new Uint8Array(s.signature)),userHandle:s.userHandle?mr(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Ey(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Xf(){var t,e;return!!(Ye()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function $P(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new pa("Browser returned unexpected credential type",e)}:{data:null,error:new pa("Empty credential response",e)}}catch(e){return{data:null,error:NP({error:e,options:t})}}}async function FP(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new pa("Browser returned unexpected credential type",e)}:{data:null,error:new pa("Empty credential response",e)}}catch(e){return{data:null,error:TP({error:e,options:t})}}}const UP={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},BP={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ma(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),n=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of t)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))r[i]=o;else if(n(o))r[i]=o;else if(e(o)){const a=r[i];e(a)?r[i]=ma(a,o):r[i]=ma(o)}else r[i]=o}return r}function VP(t,e){return ma(UP,t,e||{})}function WP(t,e){return ma(BP,t,e||{})}class zP{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:s},i){var o;try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!a)return{data:null,error:l};const c=s??OP.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;if(!u.name){const h=r;if(h)u.name=`${u.id}:${h}`;else{const p=(await this.client.getUser()).data.user,m=((o=p==null?void 0:p.user_metadata)===null||o===void 0?void 0:o.name)||(p==null?void 0:p.email)||(p==null?void 0:p.id)||"User";u.name=`${u.id}:${m}`}}u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=VP(a.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:h,error:f}=await $P({publicKey:u,signal:c});return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}case"request":{const u=WP(a.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:h,error:f}=await FP(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:c}));return h?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}}}catch(a){return te(a)?{data:null,error:a}:{data:null,error:new hr("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!n)return{data:null,error:new ki("rpId is required for WebAuthn authentication")};try{if(!Xf())return{data:null,error:new hr("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:s},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:r,credential_response:l.credential_response}})}catch(o){return te(o)?{data:null,error:o}:{data:null,error:new hr("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!n)return{data:null,error:new ki("rpId is required for WebAuthn registration")};try{if(!Xf())return{data:null,error:new hr("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:a};const{data:l,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:s},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:r,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(o){return te(o)?{data:null,error:o}:{data:null,error:new hr("Unexpected error in register",o)}}}}EP();const HP={url:BE,storageKey:VE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:WE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Qf(t,e,n){return await n()}const $r={};class Ci{get jwks(){var e,n;return(n=(e=$r[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){$r[this.storageKey]=Object.assign(Object.assign({},$r[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=$r[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$r[this.storageKey]=Object.assign(Object.assign({},$r[this.storageKey]),{cachedAt:e})}constructor(e){var n,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},HP),e);if(this.storageKey=i.storageKey,this.instanceID=(n=Ci.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Ci.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Ye()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new _P({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=_y(i.fetch),this.lock=i.lock||Qf,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Ye()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=CP:this.lock=Qf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new zP(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Sy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Jf(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Jf(this.memoryStorage)),Ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(a){this._debug("#broadcastChannel","error",a)}})}this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${by}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},r="none";if(Ye()&&(n=rP(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),Ye()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),qE(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return te(n)?this._returnResult({error:n}):this._returnResult({error:new hr("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const i=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Lt}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,r,s;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Mr(this.storage,this.storageKey)),i=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:m},xform:Lt})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Lt})}else throw new uo("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return await qe(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:a}=e;n=await ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:qf})}else if("phone"in e){const{phone:i,password:o,options:a}=e;n=await ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:qf})}else throw new uo("You must provide either an email or phone number and a password");const{data:r,error:s}=n;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const i=new Ir;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(te(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,s,i,o,a,l,c,u,h,f;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:y,wallet:v,statement:S,options:E}=e;let k;if(Ye())if(typeof v=="object")k=v;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")k=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(E!=null&&E.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=v}const g=new URL((n=E==null?void 0:E.url)!==null&&n!==void 0?n:window.location.href),w=await k.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!w||w.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=Cy(w[0]);let P=(r=E==null?void 0:E.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!P){const C=await k.request({method:"eth_chainId"});P=PP(C)}const b={domain:g.host,address:_,statement:S,uri:g.href,version:"1",chainId:P,nonce:(s=E==null?void 0:E.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=E==null?void 0:E.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=E==null?void 0:E.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=E==null?void 0:E.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=E==null?void 0:E.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=E==null?void 0:E.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=jP(b),m=await k.request({method:"personal_sign",params:[AP(p),_]})}try{const{data:y,error:v}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:m},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Lt});if(v)throw v;if(!y||!y.session||!y.user){const S=new Ir;return this._returnResult({data:{user:null,session:null},error:S})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:v})}catch(y){if(te(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async signInWithSolana(e){var n,r,s,i,o,a,l,c,u,h,f,p;let m,y;if("message"in e)m=e.message,y=e.signature;else{const{chain:v,wallet:S,statement:E,options:k}=e;let g;if(Ye())if(typeof S=="object")g=S;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))g=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=S}const w=new URL((n=k==null?void 0:k.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in g&&g.signIn){const _=await g.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),E?{statement:E}:null));let P;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")P=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)P=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)m=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),y=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in g)||typeof g.signMessage!="function"||!("publicKey"in g)||typeof g!="object"||!g.publicKey||!("toBase58"in g.publicKey)||typeof g.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${w.host} wants you to sign in with your Solana account:`,g.publicKey.toBase58(),...E?["",E,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(s=(r=k==null?void 0:k.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=k==null?void 0:k.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((o=k==null?void 0:k.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((a=k==null?void 0:k.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((l=k==null?void 0:k.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((c=k==null?void 0:k.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((h=(u=k==null?void 0:k.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...k.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const _=await g.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=_}}try{const{data:v,error:S}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:mr(y)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Lt});if(S)throw S;if(!v||!v.session||!v.user){const E=new Ir;return this._returnResult({data:{user:null,session:null},error:E})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:S})}catch(v){if(te(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(e){const n=await ir(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new YE;const{data:i,error:o}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Lt});if(await qe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new Ir;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:i,nonce:o}=e,a=await ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Lt}),{data:l,error:c}=a;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Ir;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(n){if(te(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,r,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Mr(this.storage,this.storageKey));const{error:h}=await ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new uo("You must provide either an email or phone number.")}catch(a){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,r;try{let s,i;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Lt});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var n,r,s,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await Mr(this.storage,this.storageKey));const c=await ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:wP});return!((i=c.data)===null||i===void 0)&&i.url&&Ye()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(a){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new xt;const{error:s}=await ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(te(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await ie(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:a}=await ie(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new uo("You must provide either an email or phone number and a type")}catch(n){if(te(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await ir(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<zl:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await ir(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Gl()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=gP(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:$n}):await this._useSession(async n=>{var r,s,i;const{data:o,error:a}=n;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new xt}:await ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:$n})})}catch(n){if(te(n))return Hl(n)&&(await this._removeSession(),await qe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new xt;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Mr(this.storage,this.storageKey));const{data:c,error:u}=await ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:$n});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new xt;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:o}=fo(e.access_token);if(o.exp&&(r=o.exp,s=r<=n),s){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(te(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new xt;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(te(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Ye())throw new ho("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ho(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Bf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ho("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Bf("No code detected.");const{data:E,error:k}=await this._exchangeCodeForSession(e.code);if(k)throw k;const g=new URL(window.location.href);return g.searchParams.delete("code"),window.history.replaceState(window.history.state,"",g.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new ho("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let f=u+h;l&&(f=parseInt(l));const p=f-u;p*1e3<=Jr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const m=f-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,u);const{data:y,error:v}=await this._getUser(i);if(v)throw v;const S={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:S,redirectType:e.type},error:null})}catch(r){if(te(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await ir(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i&&!Hl(i))return this._returnResult({error:i});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(GE(a)&&(a.status===404||a.status===401||a.status===403)||Hl(a)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await qe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=nP(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Mr(this.storage,this.storageKey,!0));try{return await ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ie(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Ye()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(te(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:s,data:{session:i}}=n;if(s)throw s;const{options:o,provider:a,token:l,access_token:c,nonce:u}=e,h=await ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i==null?void 0:i.access_token)!==null&&r!==void 0?r:void 0,body:{provider:a,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Lt}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Ir}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(s){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)throw o;return await ie(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await oP(async s=>(s>0&&await iP(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Lt})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Kl(i)&&Date.now()+o-r<Jr})}catch(r){if(this._debug(n,"error",r),te(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Ye()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await ir(this.storage,this.storageKey);if(s&&this.userStorage){let o=await ir(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Xr(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Gl()}else if(s&&!s.user&&!s.user){const o=await ir(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await qe(this.storage,this.storageKey+"-user"),await Xr(this.storage,this.storageKey,s)):s.user=Gl()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<zl;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${zl}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Kl(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new xt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new rl;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new xt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),te(i)){const o={data:null,error:i};return Kl(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await qe(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Xr(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const i=Kf(s);await Xr(this.storage,this.storageKey,i)}else{const s=Kf(n);await Xr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await qe(this.storage,this.storageKey),await qe(this.storage,this.storageKey+"-code-verifier"),await qe(this.storage,this.storageKey+"-user"),this.userStorage&&await qe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ye()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Jr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Jr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Jr}ms, refresh threshold is ${nu} ticks`),s<=nu&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ky)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ye()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Mr(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?this._returnResult({data:null,error:i}):await ie(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await ie(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?DP(e.webauthn.credential_response):LP(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await ie(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=await ie(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:IP(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:MP(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(e){var n,r,s,i;if(e)try{const{payload:p}=fo(e);let m=null;p.aal&&(m=p.aal);let y=m;const{data:{user:v},error:S}=await this.getUser(e);if(S)return this._returnResult({data:null,error:S});((r=(n=v==null?void 0:v.factors)===null||n===void 0?void 0:n.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(y="aal2");const k=p.amr||[];return{data:{currentLevel:m,nextLevel:y,currentAuthenticationMethods:k},error:null}}catch(p){if(te(p))return this._returnResult({data:null,error:p});throw p}const{data:{session:o},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=fo(o.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((i=(s=o.user.factors)===null||s===void 0?void 0:s.filter(p=>p.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(u="aal2");const f=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?await ie(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new xt})})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new xt});const o=await ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&Ye()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(te(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new xt});const o=await ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&Ye()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(te(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;return r?this._returnResult({data:null,error:r}):n?await ie(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new xt})})}catch(e){if(te(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?(await ie(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new xt})})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+HE>s)return r;const{data:i,error:o}=await ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:p,error:m}=await this.getSession();if(m||!p.session)return this._returnResult({data:null,error:m});r=p.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=fo(r);n!=null&&n.allowExpired||fP(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:s,signature:o},error:null}}const u=pP(s.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,eP(`${a}.${l}`)))throw new iu("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(te(r))return this._returnResult({data:null,error:r});throw r}}}Ci.nextInstanceID={};const KP=Ci,GP="2.95.3";let Hs="";typeof Deno<"u"?Hs="deno":typeof document<"u"?Hs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hs="react-native":Hs="node";const qP={"X-Client-Info":`supabase-js-${Hs}/${GP}`},YP={headers:qP},JP={schema:"public"},XP={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},QP={};function Ei(t){"@babel/helpers - typeof";return Ei=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(t)}function ZP(t,e){if(Ei(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ei(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eA(t){var e=ZP(t,"string");return Ei(e)=="symbol"?e:e+""}function tA(t,e,n){return(e=eA(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Zf(Object(n),!0).forEach(function(r){tA(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zf(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const nA=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),rA=()=>Headers,sA=(t,e,n)=>{const r=nA(n),s=rA();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:t;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Re(Re({},o),{},{headers:c}))}};function iA(t){return t.endsWith("/")?t:t+"/"}function oA(t,e){var n,r;const{db:s,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,f={db:Re(Re({},l),s),auth:Re(Re({},c),i),realtime:Re(Re({},u),o),storage:{},global:Re(Re(Re({},h),a),{},{headers:Re(Re({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function aA(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(iA(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var lA=class extends KP{constructor(t){super(t)}},cA=class{constructor(t,e,n){var r,s;this.supabaseUrl=t,this.supabaseKey=e;const i=aA(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a={db:JP,realtime:QP,auth:Re(Re({},XP),{},{storageKey:o}),global:YP},l=oA(n??{},a);if(this.storageKey=(r=l.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=l.global.headers)!==null&&s!==void 0?s:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=sA(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Re({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new GC(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch,timeout:l.db.timeout,urlLengthLimit:l.db.urlLengthLimit}),this.storage=new UE(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new FC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:r}=await t.auth.getSession();return(e=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:c},u,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lA({url:this.authUrl.href,headers:Re(Re({},f),u),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,flowType:o,lock:a,debug:l,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new uE(this.realtimeUrl.href,Re(Re({},t),{},{params:Re(Re({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const uA=(t,e,n)=>new cA(t,e,n);function dA(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const n=e.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}dA()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Py="https://mrutwrrtzyjfrqddqcve.supabase.co",Ay="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ydXR3cnJ0enlqZnJxZGRxY3ZlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3MTI2MTgsImV4cCI6MjA4NDI4ODYxOH0.tSGc5L3J92T9UCazKipFTLrG-b8L27vdA3jGt-z8EoA",ye=uA(Py,Ay),jy=x.createContext(void 0);function hA({children:t}){const[e,n]=x.useState(null),[r,s]=x.useState(null),[i,o]=x.useState(!0);x.useEffect(()=>{ye.auth.getSession().then(({data:{session:c}})=>{s(c),n((c==null?void 0:c.user)??null),o(!1)});const{data:{subscription:l}}=ye.auth.onAuthStateChange((c,u)=>{s(u),n((u==null?void 0:u.user)??null),o(!1)});return()=>l.unsubscribe()},[]);const a=async()=>{await ye.auth.signOut()};return d.jsx(jy.Provider,{value:{user:e,session:r,loading:i,signOut:a},children:t})}function Ps(){const t=x.useContext(jy);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const Ny=x.createContext(void 0);function fA({children:t}){const{user:e}=Ps(),[n,r]=x.useState([]),[s,i]=x.useState(null);x.useEffect(()=>{if(!e){r([]);return}const h=async()=>{const{data:p,error:m}=await ye.from("group_members").select(`
          group_id,
          role,
          group:group_id (
            id, name, invite_code, color, created_by
          )
        `).eq("user_id",e.id);if(m||!p){console.error("Error fetching groups:",m);return}const y=await Promise.all(p.map(async v=>{const S=v.group,{data:E}=await ye.from("group_members").select(`
            role,
            user:user_id (id, full_name, avatar_url)
          `).eq("group_id",S.id),k=(E||[]).map(_=>({id:_.user.id,name:_.user.full_name||"Unknown",avatar:_.user.avatar_url,role:_.role})),{data:g}=await ye.from("diary_entries").select(`
            id, date, photo_url, caption, mood, location, user_id
          `).eq("group_id",S.id).order("date",{ascending:!1}),w=(g||[]).map(_=>{var P,b;return{id:_.id,date:_.date,photo:_.photo_url,caption:_.caption,mood:_.mood,location:_.location,userId:_.user_id,userName:((P=k.find(C=>C.id===_.user_id))==null?void 0:P.name)||"Unknown",userAvatar:(b=k.find(C=>C.id===_.user_id))==null?void 0:b.avatar}});return console.log(`Fetched ${w.length} entries for group ${S.name}`),{id:S.id,name:S.name,inviteCode:S.invite_code,color:S.color||"#blue",members:k,entries:w}}));r(y)};h();const f=ye.channel("group_updates").on("postgres_changes",{event:"*",schema:"public",table:"group_members"},()=>h()).subscribe();return()=>{f.unsubscribe()}},[e]);const o=async h=>{if(!e)return null;const f=Math.random().toString(36).substring(2,8).toUpperCase(),p="#"+Math.floor(Math.random()*16777215).toString(16),{data:m,error:y}=await ye.from("groups").insert({name:h,invite_code:f,color:p,created_by:e.id}).select().single();if(y||!m)return console.error("Error creating group:",y),null;const{error:v}=await ye.from("group_members").insert({group_id:m.id,user_id:e.id,role:"owner"});if(v)return console.error("CRITICAL ERROR adding owner to group:",v),alert(`Error creating group membership: ${v.message}`),null;console.log("Successfully created group and added owner:",m);const S={id:m.id,name:m.name,inviteCode:m.invite_code,color:m.color,members:[{id:e.id,name:e.email||"Me",role:"owner"}],entries:[]};return r(E=>[...E,S]),S},a=async h=>{if(!e||!h.trim())return!1;const{data:f,error:p}=await ye.from("groups").select("id").eq("invite_code",h).single();if(p||!f)return alert("Invalid invite code"),!1;const{error:m}=await ye.from("group_members").insert({group_id:f.id,user_id:e.id,role:"member"});return m?(m.code==="23505"?alert("You are already in this group"):alert("Failed to join group"),!1):(alert("Successfully joined group!"),!0)},l=h=>{var f;return((f=n.find(p=>p.id===h))==null?void 0:f.entries)||[]},c=async h=>{e&&(await ye.from("group_members").delete().eq("group_id",h).eq("user_id",e.id),r(f=>f.filter(p=>p.id!==h)),s===h&&i(null))},u=async h=>{await ye.from("groups").delete().eq("id",h),r(f=>f.filter(p=>p.id!==h)),s===h&&i(null)};return d.jsx(Ny.Provider,{value:{groups:n,currentGroupId:s,createGroup:o,joinGroup:a,setCurrentGroupId:i,getGroupEntries:l,leaveGroup:c,deleteGroup:u},children:t})}function Fi(){const t=x.useContext(Ny);if(t===void 0)throw new Error("useGroup must be used within a GroupProvider");return t}const Td=[{name:"Happy",icon:xd,color:"bg-yellow-100 text-yellow-700",hex:"#fcd34d"},{name:"Sad",icon:k0,color:"bg-blue-100 text-blue-700",hex:"#60a5fa"},{name:"Grateful",icon:xn,color:"bg-pink-100 text-pink-700",hex:"#f472b6"},{name:"Excited",icon:bd,color:"bg-purple-100 text-purple-700",hex:"#a78bfa"},{name:"Calm",icon:C0,color:"bg-green-100 text-green-700",hex:"#4ade80"},{name:"Inspired",icon:on,color:"bg-indigo-100 text-indigo-700",hex:"#818cf8"},{name:"Stressed",icon:E0,color:"bg-gray-100 text-gray-700",hex:"#9ca3af"},{name:"Energetic",icon:wd,color:"bg-orange-100 text-orange-700",hex:"#fb923c"}],ce=t=>typeof t=="string",Bs=()=>{let t,e;const n=new Promise((r,s)=>{t=r,e=s});return n.resolve=t,n.reject=e,n},ep=t=>t==null?"":""+t,pA=(t,e,n)=>{t.forEach(r=>{e[r]&&(n[r]=e[r])})},mA=/###/g,tp=t=>t&&t.indexOf("###")>-1?t.replace(mA,"."):t,np=t=>!t||ce(t),ai=(t,e,n)=>{const r=ce(e)?e.split("."):e;let s=0;for(;s<r.length-1;){if(np(t))return{};const i=tp(r[s]);!t[i]&&n&&(t[i]=new n),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={},++s}return np(t)?{}:{obj:t,k:tp(r[s])}},rp=(t,e,n)=>{const{obj:r,k:s}=ai(t,e,Object);if(r!==void 0||e.length===1){r[s]=n;return}let i=e[e.length-1],o=e.slice(0,e.length-1),a=ai(t,o,Object);for(;a.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),a=ai(t,o,Object),a!=null&&a.obj&&typeof a.obj[`${a.k}.${i}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${i}`]=n},gA=(t,e,n,r)=>{const{obj:s,k:i}=ai(t,e,Object);s[i]=s[i]||[],s[i].push(n)},ga=(t,e)=>{const{obj:n,k:r}=ai(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,r))return n[r]},yA=(t,e,n)=>{const r=ga(t,n);return r!==void 0?r:ga(e,n)},Ty=(t,e,n)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?ce(t[r])||t[r]instanceof String||ce(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):Ty(t[r],e[r],n):t[r]=e[r]);return t},Fr=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var xA={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const bA=t=>ce(t)?t.replace(/[&<>"'\/]/g,e=>xA[e]):t;class wA{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const vA=[" ",",","?","!",";"],SA=new wA(20),_A=(t,e,n)=>{e=e||"",n=n||"";const r=vA.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(r.length===0)return!0;const s=SA.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!s.test(t);if(!i){const o=t.indexOf(n);o>0&&!s.test(t.substring(0,o))&&(i=!0)}return i},ou=(t,e,n=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const r=e.split(n);let s=t;for(let i=0;i<r.length;){if(!s||typeof s!="object")return;let o,a="";for(let l=i;l<r.length;++l)if(l!==i&&(a+=n),a+=r[l],o=s[a],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<r.length-1)continue;i+=l-i+1;break}s=o}return s},Pi=t=>t==null?void 0:t.replace("_","-"),kA={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var n,r;(r=(n=console==null?void 0:console[t])==null?void 0:n.apply)==null||r.call(n,console,e)}};class ya{constructor(e,n={}){this.init(e,n)}init(e,n={}){this.prefix=n.prefix||"i18next:",this.logger=e||kA,this.options=n,this.debug=n.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,s){return s&&!this.debug?null:(ce(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new ya(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new ya(this.logger,e)}}var en=new ya;class sl{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const s=this.observers[r].get(n)||0;this.observers[r].set(n,s+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e,...n){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,i])=>{for(let o=0;o<i;o++)s.apply(s,[e,...n])})}}class sp extends sl{constructor(e,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r,s={}){var c,u;const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,n],r&&(Array.isArray(r)?a.push(...r):ce(r)&&i?a.push(...r.split(i)):a.push(r)));const l=ga(this.data,a);return!l&&!n&&!r&&e.indexOf(".")>-1&&(e=a[0],n=a[1],r=a.slice(2).join(".")),l||!o||!ce(r)?l:ou((u=(c=this.data)==null?void 0:c[e])==null?void 0:u[n],r,i)}addResource(e,n,r,s,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let a=[e,n];r&&(a=a.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(a=e.split("."),s=n,n=a[1]),this.addNamespaces(n),rp(this.data,a,s),i.silent||this.emit("added",e,n,r,s)}addResources(e,n,r,s={silent:!1}){for(const i in r)(ce(r[i])||Array.isArray(r[i]))&&this.addResource(e,n,i,r[i],{silent:!0});s.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,s,i,o={silent:!1,skipCopy:!1}){let a=[e,n];e.indexOf(".")>-1&&(a=e.split("."),s=r,r=n,n=a[1]),this.addNamespaces(n);let l=ga(this.data,a)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),s?Ty(l,r,i):l={...l,...r},rp(this.data,a,l),o.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(s=>n[s]&&Object.keys(n[s]).length>0)}toJSON(){return this.data}}var Ry={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,s){return t.forEach(i=>{var o;e=((o=this.processors[i])==null?void 0:o.process(e,n,r,s))??e}),e}};const Oy=Symbol("i18next/PATH_KEY");function CA(){const t=[],e=Object.create(null);let n;return e.get=(r,s)=>{var i;return(i=n==null?void 0:n.revoke)==null||i.call(n),s===Oy?t:(t.push(s),n=Proxy.revocable(r,e),n.proxy)},Proxy.revocable(Object.create(null),e).proxy}function xa(t,e){const{[Oy]:n}=t(CA());return n.join((e==null?void 0:e.keySeparator)??".")}const ip={},Yl=t=>!ce(t)&&typeof t!="boolean"&&typeof t!="number";class ba extends sl{constructor(e,n={}){super(),pA(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=en.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,n={interpolation:{}}){const r={...n};if(e==null)return!1;const s=this.resolve(e,r);if((s==null?void 0:s.res)===void 0)return!1;const i=Yl(s.res);return!(r.returnObjects===!1&&i)}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!_A(e,r,s);if(o&&!a){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:ce(i)?[i]:i};const c=e.split(r);(r!==s||r===s&&this.options.ns.indexOf(c[0])>-1)&&(i=c.shift()),e=c.join(s)}return{key:e,namespaces:ce(i)?[i]:i}}translate(e,n,r){let s=typeof n=="object"?{...n}:n;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),e==null)return"";typeof e=="function"&&(e=xa(e,{...this.options,...s})),Array.isArray(e)||(e=[String(e)]);const i=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:a,namespaces:l}=this.extractFromKey(e[e.length-1],s),c=l[l.length-1];let u=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;u===void 0&&(u=":");const h=s.lng||this.language,f=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((h==null?void 0:h.toLowerCase())==="cimode")return f?i?{res:`${c}${u}${a}`,usedKey:a,exactUsedKey:a,usedLng:h,usedNS:c,usedParams:this.getUsedParamsDetails(s)}:`${c}${u}${a}`:i?{res:a,usedKey:a,exactUsedKey:a,usedLng:h,usedNS:c,usedParams:this.getUsedParamsDetails(s)}:a;const p=this.resolve(e,s);let m=p==null?void 0:p.res;const y=(p==null?void 0:p.usedKey)||a,v=(p==null?void 0:p.exactUsedKey)||a,S=["[object Number]","[object Function]","[object RegExp]"],E=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,k=!this.i18nFormat||this.i18nFormat.handleAsObject,g=s.count!==void 0&&!ce(s.count),w=ba.hasDefaultValue(s),_=g?this.pluralResolver.getSuffix(h,s.count,s):"",P=s.ordinal&&g?this.pluralResolver.getSuffix(h,s.count,{ordinal:!1}):"",b=g&&!s.ordinal&&s.count===0,C=b&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${_}`]||s[`defaultValue${P}`]||s.defaultValue;let A=m;k&&!m&&w&&(A=C);const N=Yl(A),O=Object.prototype.toString.apply(A);if(k&&A&&N&&S.indexOf(O)<0&&!(ce(E)&&Array.isArray(A))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const I=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,A,{...s,ns:l}):`key '${a} (${this.language})' returned an object instead of string.`;return i?(p.res=I,p.usedParams=this.getUsedParamsDetails(s),p):I}if(o){const I=Array.isArray(A),T=I?[]:{},M=I?v:y;for(const R in A)if(Object.prototype.hasOwnProperty.call(A,R)){const j=`${M}${o}${R}`;w&&!m?T[R]=this.translate(j,{...s,defaultValue:Yl(C)?C[R]:void 0,joinArrays:!1,ns:l}):T[R]=this.translate(j,{...s,joinArrays:!1,ns:l}),T[R]===j&&(T[R]=A[R])}m=T}}else if(k&&ce(E)&&Array.isArray(m))m=m.join(E),m&&(m=this.extendTranslation(m,e,s,r));else{let I=!1,T=!1;!this.isValidLookup(m)&&w&&(I=!0,m=C),this.isValidLookup(m)||(T=!0,m=a);const R=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&T?void 0:m,j=w&&C!==m&&this.options.updateMissing;if(T||I||j){if(this.logger.log(j?"updateKey":"missingKey",h,c,a,j?C:m),o){const K=this.resolve(a,{...s,keySeparator:!1});K&&K.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let D=[];const $=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&$&&$[0])for(let K=0;K<$.length;K++)D.push($[K]);else this.options.saveMissingTo==="all"?D=this.languageUtils.toResolveHierarchy(s.lng||this.language):D.push(s.lng||this.language);const F=(K,z,U)=>{var W;const V=w&&U!==m?U:R;this.options.missingKeyHandler?this.options.missingKeyHandler(K,c,z,V,j,s):(W=this.backendConnector)!=null&&W.saveMissing&&this.backendConnector.saveMissing(K,c,z,V,j,s),this.emit("missingKey",K,c,z,m)};this.options.saveMissing&&(this.options.saveMissingPlurals&&g?D.forEach(K=>{const z=this.pluralResolver.getSuffixes(K,s);b&&s[`defaultValue${this.options.pluralSeparator}zero`]&&z.indexOf(`${this.options.pluralSeparator}zero`)<0&&z.push(`${this.options.pluralSeparator}zero`),z.forEach(U=>{F([K],a+U,s[`defaultValue${U}`]||C)})}):F(D,a,C))}m=this.extendTranslation(m,e,s,p,r),T&&m===a&&this.options.appendNamespaceToMissingKey&&(m=`${c}${u}${a}`),(T||I)&&this.options.parseMissingKeyHandler&&(m=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${u}${a}`:a,I?m:void 0,s))}return i?(p.res=m,p.usedParams=this.getUsedParamsDetails(s),p):m}extendTranslation(e,n,r,s,i){var l,c;if((l=this.i18nFormat)!=null&&l.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const u=ce(e)&&(((c=r==null?void 0:r.interpolation)==null?void 0:c.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let h;if(u){const p=e.match(this.interpolator.nestingRegexp);h=p&&p.length}let f=r.replace&&!ce(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),e=this.interpolator.interpolate(e,f,r.lng||this.language||s.usedLng,r),u){const p=e.match(this.interpolator.nestingRegexp),m=p&&p.length;h<m&&(r.nest=!1)}!r.lng&&s&&s.res&&(r.lng=this.language||s.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,(...p)=>(i==null?void 0:i[0])===p[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${p[0]} in key: ${n[0]}`),null):this.translate(...p,n),r)),r.interpolation&&this.interpolator.reset()}const o=r.postProcess||this.options.postProcess,a=ce(o)?[o]:o;return e!=null&&(a!=null&&a.length)&&r.applyPostProcessor!==!1&&(e=Ry.handle(a,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e,n={}){let r,s,i,o,a;return ce(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const c=this.extractFromKey(l,n),u=c.key;s=u;let h=c.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const f=n.count!==void 0&&!ce(n.count),p=f&&!n.ordinal&&n.count===0,m=n.context!==void 0&&(ce(n.context)||typeof n.context=="number")&&n.context!=="",y=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);h.forEach(v=>{var S,E;this.isValidLookup(r)||(a=v,!ip[`${y[0]}-${v}`]&&((S=this.utils)!=null&&S.hasLoadedNamespace)&&!((E=this.utils)!=null&&E.hasLoadedNamespace(a))&&(ip[`${y[0]}-${v}`]=!0,this.logger.warn(`key "${s}" for languages "${y.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(k=>{var _;if(this.isValidLookup(r))return;o=k;const g=[u];if((_=this.i18nFormat)!=null&&_.addLookupKeys)this.i18nFormat.addLookupKeys(g,u,k,v,n);else{let P;f&&(P=this.pluralResolver.getSuffix(k,n.count,n));const b=`${this.options.pluralSeparator}zero`,C=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(n.ordinal&&P.indexOf(C)===0&&g.push(u+P.replace(C,this.options.pluralSeparator)),g.push(u+P),p&&g.push(u+b)),m){const A=`${u}${this.options.contextSeparator||"_"}${n.context}`;g.push(A),f&&(n.ordinal&&P.indexOf(C)===0&&g.push(A+P.replace(C,this.options.pluralSeparator)),g.push(A+P),p&&g.push(A+b))}}let w;for(;w=g.pop();)this.isValidLookup(r)||(i=w,r=this.getResource(k,v,w,n))}))})}),{res:r,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r,s={}){var i;return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(e,n,r,s):this.resourceStore.getResource(e,n,r,s)}getUsedParamsDetails(e={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!ce(e.replace);let s=r?e.replace:e;if(r&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!r){s={...s};for(const i of n)delete s[i]}return s}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}class op{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=en.create("languageUtils")}getScriptPartFromCode(e){if(e=Pi(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=Pi(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(ce(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const s=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(s))&&(n=s)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const s=this.getScriptPartFromCode(r);if(this.isSupportedCode(s))return n=s;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return n=i;n=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),ce(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],e),s=[],i=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return ce(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):ce(e)&&i(this.formatLanguageCode(e)),r.forEach(o=>{s.indexOf(o)<0&&i(this.formatLanguageCode(o))}),s}}const ap={zero:0,one:1,two:2,few:3,many:4,other:5},lp={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class EA{constructor(e,n={}){this.languageUtils=e,this.options=n,this.logger=en.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(e,n={}){const r=Pi(e==="dev"?"en":e),s=n.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:s});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(r,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),lp;if(!e.match(/-|_/))return lp;const l=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(l,n)}return this.pluralRulesCache[i]=o,o}needsPlural(e,n={}){let r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),(r==null?void 0:r.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,n,r={}){return this.getSuffixes(e,r).map(s=>`${n}${s}`)}getSuffixes(e,n={}){let r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),r?r.resolvedOptions().pluralCategories.sort((s,i)=>ap[s]-ap[i]).map(s=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,n,r={}){const s=this.getRule(e,r);return s?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,r))}}const cp=(t,e,n,r=".",s=!0)=>{let i=yA(t,e,n);return!i&&s&&ce(n)&&(i=ou(t,n,r),i===void 0&&(i=ou(e,n,r))),i},Jl=t=>t.replace(/\$/g,"$$$$");class up{constructor(e={}){var n;this.logger=en.create("interpolator"),this.options=e,this.format=((n=e==null?void 0:e.interpolation)==null?void 0:n.format)||(r=>r),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:r,useRawValueToEscape:s,prefix:i,prefixEscaped:o,suffix:a,suffixEscaped:l,formatSeparator:c,unescapeSuffix:u,unescapePrefix:h,nestingPrefix:f,nestingPrefixEscaped:p,nestingSuffix:m,nestingSuffixEscaped:y,nestingOptionsSeparator:v,maxReplaces:S,alwaysFormat:E}=e.interpolation;this.escape=n!==void 0?n:bA,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=i?Fr(i):o||"{{",this.suffix=a?Fr(a):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=u?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=f?Fr(f):p||Fr("$t("),this.nestingSuffix=m?Fr(m):y||Fr(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=S||1e3,this.alwaysFormat=E!==void 0?E:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>(n==null?void 0:n.source)===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,n,r,s){var p;let i,o,a;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=m=>{if(m.indexOf(this.formatSeparator)<0){const E=cp(n,l,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(E,void 0,r,{...s,...n,interpolationkey:m}):E}const y=m.split(this.formatSeparator),v=y.shift().trim(),S=y.join(this.formatSeparator).trim();return this.format(cp(n,l,v,this.options.keySeparator,this.options.ignoreJSONStructure),S,r,{...s,...n,interpolationkey:v})};this.resetRegExp();const u=(s==null?void 0:s.missingInterpolationHandler)||this.options.missingInterpolationHandler,h=((p=s==null?void 0:s.interpolation)==null?void 0:p.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>Jl(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?Jl(this.escape(m)):Jl(m)}].forEach(m=>{for(a=0;i=m.regex.exec(e);){const y=i[1].trim();if(o=c(y),o===void 0)if(typeof u=="function"){const S=u(e,i,s);o=ce(S)?S:""}else if(s&&Object.prototype.hasOwnProperty.call(s,y))o="";else if(h){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${e}`),o="";else!ce(o)&&!this.useRawValueToEscape&&(o=ep(o));const v=m.safeValue(o);if(e=e.replace(i[0],v),h?(m.regex.lastIndex+=o.length,m.regex.lastIndex-=i[0].length):m.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,n,r={}){let s,i,o;const a=(l,c)=>{const u=this.nestingOptionsSeparator;if(l.indexOf(u)<0)return l;const h=l.split(new RegExp(`${u}[ ]*{`));let f=`{${h[1]}`;l=h[0],f=this.interpolate(f,o);const p=f.match(/'/g),m=f.match(/"/g);(((p==null?void 0:p.length)??0)%2===0&&!m||m.length%2!==0)&&(f=f.replace(/'/g,'"'));try{o=JSON.parse(f),c&&(o={...c,...o})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,y),`${l}${u}${f}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;s=this.nestingRegexp.exec(e);){let l=[];o={...r},o=o.replace&&!ce(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const c=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(c!==-1&&(l=s[1].slice(c).split(this.formatSeparator).map(u=>u.trim()).filter(Boolean),s[1]=s[1].slice(0,c)),i=n(a.call(this,s[1].trim(),o),o),i&&s[0]===e&&!ce(i))return i;ce(i)||(i=ep(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),i=""),l.length&&(i=l.reduce((u,h)=>this.format(u,h,r.lng,{...r,interpolationkey:s[1].trim()}),i.trim())),e=e.replace(s[0],i),this.regexp.lastIndex=0}return e}}const PA=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const s=r[1].substring(0,r[1].length-1);e==="currency"&&s.indexOf(":")<0?n.currency||(n.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?n.range||(n.range=s.trim()):s.split(";").forEach(o=>{if(o){const[a,...l]=o.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),u=a.trim();n[u]||(n[u]=c),c==="false"&&(n[u]=!1),c==="true"&&(n[u]=!0),isNaN(c)||(n[u]=parseInt(c,10))}})}return{formatName:e,formatOptions:n}},dp=t=>{const e={};return(n,r,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i={...i,[s.interpolationkey]:void 0});const o=r+JSON.stringify(i);let a=e[o];return a||(a=t(Pi(r),s),e[o]=a),a(n)}},AA=t=>(e,n,r)=>t(Pi(n),r)(e);class jA{constructor(e={}){this.logger=en.create("formatter"),this.options=e,this.init(e)}init(e,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const r=n.cacheInBuiltFormats?dp:AA;this.formats={number:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i});return a=>o.format(a)}),currency:r((s,i)=>{const o=new Intl.NumberFormat(s,{...i,style:"currency"});return a=>o.format(a)}),datetime:r((s,i)=>{const o=new Intl.DateTimeFormat(s,{...i});return a=>o.format(a)}),relativetime:r((s,i)=>{const o=new Intl.RelativeTimeFormat(s,{...i});return a=>o.format(a,i.range||"day")}),list:r((s,i)=>{const o=new Intl.ListFormat(s,{...i});return a=>o.format(a)})}}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=dp(n)}format(e,n,r,s={}){const i=n.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(a=>a.indexOf(")")>-1)){const a=i.findIndex(l=>l.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,a)].join(this.formatSeparator)}return i.reduce((a,l)=>{var h;const{formatName:c,formatOptions:u}=PA(l);if(this.formats[c]){let f=a;try{const p=((h=s==null?void 0:s.formatParams)==null?void 0:h[s.interpolationkey])||{},m=p.locale||p.lng||s.locale||s.lng||r;f=this.formats[c](a,m,{...u,...s,...p})}catch(p){this.logger.warn(p)}return f}else this.logger.warn(`there was no format function for ${c}`);return a},e)}}const NA=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class TA extends sl{constructor(e,n,r,s={}){var i,o;super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=s,this.logger=en.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],(o=(i=this.backend)==null?void 0:i.init)==null||o.call(i,r,s.backend,s)}queueLoad(e,n,r,s){const i={},o={},a={},l={};return e.forEach(c=>{let u=!0;n.forEach(h=>{const f=`${c}|${h}`;!r.reload&&this.store.hasResourceBundle(c,h)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?o[f]===void 0&&(o[f]=!0):(this.state[f]=1,u=!1,o[f]===void 0&&(o[f]=!0),i[f]===void 0&&(i[f]=!0),l[h]===void 0&&(l[h]=!0)))}),u||(a[c]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}loaded(e,n,r){const s=e.split("|"),i=s[0],o=s[1];n&&this.emit("failedLoading",i,o,n),!n&&r&&this.store.addResourceBundle(i,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&r&&(this.state[e]=0);const a={};this.queue.forEach(l=>{gA(l.loaded,[i],o),NA(l,e),n&&l.errors.push(n),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{a[c]||(a[c]={});const u=l.loaded[c];u.length&&u.forEach(h=>{a[c][h]===void 0&&(a[c][h]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(l=>!l.done)}read(e,n,r,s=0,i=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:s,wait:i,callback:o});return}this.readingCalls++;const a=(c,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const h=this.waitingReads.shift();this.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(c&&u&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,s+1,i*2,o)},i);return}o(c,u)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const c=l(e,n);c&&typeof c.then=="function"?c.then(u=>a(null,u)).catch(a):a(null,c)}catch(c){a(c)}return}return l(e,n,a)}prepareLoading(e,n,r={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();ce(e)&&(e=this.languageUtils.toResolveHierarchy(e)),ce(n)&&(n=[n]);const i=this.queueLoad(e,n,r,s);if(!i.toLoad.length)return i.pending.length||s(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e,n=""){const r=e.split("|"),s=r[0],i=r[1];this.read(s,i,"read",void 0,void 0,(o,a)=>{o&&this.logger.warn(`${n}loading namespace ${i} for language ${s} failed`,o),!o&&a&&this.logger.log(`${n}loaded namespace ${i} for language ${s}`,a),this.loaded(e,o,a)})}saveMissing(e,n,r,s,i,o={},a=()=>{}){var l,c,u,h,f;if((c=(l=this.services)==null?void 0:l.utils)!=null&&c.hasLoadedNamespace&&!((h=(u=this.services)==null?void 0:u.utils)!=null&&h.hasLoadedNamespace(n))){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if((f=this.backend)!=null&&f.create){const p={...o,isUpdate:i},m=this.backend.create.bind(this.backend);if(m.length<6)try{let y;m.length===5?y=m(e,n,r,s,p):y=m(e,n,r,s),y&&typeof y.then=="function"?y.then(v=>a(null,v)).catch(a):a(null,y)}catch(y){a(y)}else m(e,n,r,s,a,p)}!e||!e[0]||this.store.addResource(e[0],n,r,s)}}}const Xl=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),ce(t[1])&&(e.defaultValue=t[1]),ce(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),hp=t=>{var e,n;return ce(t.ns)&&(t.ns=[t.ns]),ce(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),ce(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((n=(e=t.supportedLngs)==null?void 0:e.indexOf)==null?void 0:n.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},po=()=>{},RA=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})},OA=t=>{var e,n,r,s,i,o,a,l,c;return!!(((r=(n=(e=t==null?void 0:t.modules)==null?void 0:e.backend)==null?void 0:n.name)==null?void 0:r.indexOf("Locize"))>0||((a=(o=(i=(s=t==null?void 0:t.modules)==null?void 0:s.backend)==null?void 0:i.constructor)==null?void 0:o.name)==null?void 0:a.indexOf("Locize"))>0||(c=(l=t==null?void 0:t.options)==null?void 0:l.backend)!=null&&c.backends&&t.options.backend.backends.some(u=>{var h,f,p;return((h=u==null?void 0:u.name)==null?void 0:h.indexOf("Locize"))>0||((p=(f=u==null?void 0:u.constructor)==null?void 0:f.name)==null?void 0:p.indexOf("Locize"))>0}))};class li extends sl{constructor(e={},n){if(super(),this.options=hp(e),this.services={},this.logger=en,this.modules={external:[]},RA(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(e={},n){this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&(ce(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=Xl();this.options={...r,...this.options,...hp(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=r.overloadTranslationOptionHandler),this.options.showSupportNotice!==!1&&!OA(this)&&typeof console<"u"&&typeof console.info<"u"&&console.info(" i18next is maintained with support from locize.com  consider powering your project with managed localization (AI, CDN, integrations): https://locize.com ");const s=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?en.init(s(this.modules.logger),this.options):en.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=jA;const u=new op(this.options);this.store=new sp(this.options.resources,this.options);const h=this.services;h.logger=en,h.resourceStore=this.store,h.languageUtils=u,h.pluralResolver=new EA(u,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),c&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(h.formatter=s(c),h.formatter.init&&h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new up(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new TA(s(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",(p,...m)=>{this.emit(p,...m)}),this.modules.languageDetector&&(h.languageDetector=s(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=s(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new ba(this.services,this.options),this.translator.on("*",(p,...m)=>{this.emit(p,...m)}),this.modules.external.forEach(p=>{p.init&&p.init(this)})}if(this.format=this.options.interpolation.format,n||(n=po),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=(...u)=>this.store[c](...u)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=(...u)=>(this.store[c](...u),this)});const a=Bs(),l=()=>{const c=(u,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(h),n(u,h)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),a}loadResources(e,n=po){var i,o;let r=n;const s=ce(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if((s==null?void 0:s.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const a=[],l=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(h=>{h!=="cimode"&&a.indexOf(h)<0&&a.push(h)})};s?l(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>l(u)),(o=(i=this.options.preload)==null?void 0:i.forEach)==null||o.call(i,c=>l(c)),this.services.backendConnector.load(a,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(c)})}else r(null)}reloadResources(e,n,r){const s=Bs();return typeof e=="function"&&(r=e,e=void 0),typeof n=="function"&&(r=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),r||(r=po),this.services.backendConnector.reload(e,n,i=>{s.resolve(),r(i)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Ry.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,n){this.isLanguageChangingTo=e;const r=Bs();this.emit("languageChanging",e);const s=a=>{this.language=a,this.languages=this.services.languageUtils.toResolveHierarchy(a),this.resolvedLanguage=void 0,this.setResolvedLanguage(a)},i=(a,l)=>{l?this.isLanguageChangingTo===e&&(s(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,r.resolve((...c)=>this.t(...c)),n&&n(a,(...c)=>this.t(...c))},o=a=>{var u,h;!e&&!a&&this.services.languageDetector&&(a=[]);const l=ce(a)?a:a&&a[0],c=this.store.hasLanguageSomeTranslations(l)?l:this.services.languageUtils.getBestMatchFromCodes(ce(a)?[a]:a);c&&(this.language||s(c),this.translator.language||this.translator.changeLanguage(c),(h=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||h.call(u,c)),this.loadResources(c,f=>{i(f,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),r}getFixedT(e,n,r){const s=(i,o,...a)=>{let l;typeof o!="object"?l=this.options.overloadTranslationOptionHandler([i,o].concat(a)):l={...o},l.lng=l.lng||s.lng,l.lngs=l.lngs||s.lngs,l.ns=l.ns||s.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||r||s.keyPrefix);const c=this.options.keySeparator||".";let u;return l.keyPrefix&&Array.isArray(i)?u=i.map(h=>(typeof h=="function"&&(h=xa(h,{...this.options,...o})),`${l.keyPrefix}${c}${h}`)):(typeof i=="function"&&(i=xa(i,{...this.options,...o})),u=l.keyPrefix?`${l.keyPrefix}${c}${i}`:i),this.t(u,l)};return ce(e)?s.lng=e:s.lngs=e,s.ns=n,s.keyPrefix=r,s}t(...e){var n;return(n=this.translator)==null?void 0:n.translate(...e)}exists(...e){var n;return(n=this.translator)==null?void 0:n.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(a,l)=>{const c=this.services.backendConnector.state[`${a}|${l}`];return c===-1||c===0||c===2};if(n.precheck){const a=n.precheck(this,o);if(a!==void 0)return a}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!s||o(i,e)))}loadNamespaces(e,n){const r=Bs();return this.options.ns?(ce(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{r.resolve(),n&&n(s)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=Bs();ce(e)&&(e=[e]);const s=this.options.preload||[],i=e.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=s.concat(i),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}dir(e){var s,i;if(e||(e=this.resolvedLanguage||(((s=this.languages)==null?void 0:s.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const o=new Intl.Locale(e);if(o&&o.getTextInfo){const a=o.getTextInfo();if(a&&a.direction)return a.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=((i=this.services)==null?void 0:i.languageUtils)||new op(Xl());return e.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},n){const r=new li(e,n);return r.createInstance=li.createInstance,r}cloneInstance(e={},n=po){const r=e.forkResourceStore;r&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},i=new li(s);if((e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(a=>{i[a]=this[a]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r){const a=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},l[c]=Object.keys(l[c]).reduce((u,h)=>(u[h]={...l[c][h]},u),l[c]),l),{});i.store=new sp(a,s),i.services.resourceStore=i.store}if(e.interpolation){const l={...Xl().interpolation,...this.options.interpolation,...e.interpolation},c={...s,interpolation:l};i.services.interpolator=new up(c)}return i.translator=new ba(i.services,s),i.translator.on("*",(a,...l)=>{i.emit(a,...l)}),i.init(s,n),i.translator.options=s,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Ke=li.createInstance();Ke.createInstance;Ke.dir;Ke.init;Ke.loadResources;Ke.reloadResources;Ke.use;Ke.changeLanguage;Ke.getFixedT;Ke.t;Ke.exists;Ke.setDefaultNamespace;Ke.hasLoadedNamespace;Ke.loadNamespaces;Ke.loadLanguages;var Ql,fp;function IA(){return fp||(fp=1,Ql={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Ql}var MA=IA();const DA=pk(MA);var LA=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function pp(t){var e={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=t.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(e.name=n[1],(DA[n[1]]||t.charAt(t.length-2)==="/")&&(e.voidElement=!0),e.name.startsWith("!--"))){var r=t.indexOf("-->");return{type:"comment",comment:r!==-1?t.slice(4,r):""}}for(var s=new RegExp(LA),i=null;(i=s.exec(t))!==null;)if(i[0].trim())if(i[1]){var o=i[1].trim(),a=[o,""];o.indexOf("=")>-1&&(a=o.split("=")),e.attrs[a[0]]=a[1],s.lastIndex--}else i[2]&&(e.attrs[i[2]]=i[3].trim().substring(1,i[3].length-1));return e}var $A=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,FA=/^\s*$/,UA=Object.create(null);function Iy(t,e){switch(e.type){case"text":return t+e.content;case"tag":return t+="<"+e.name+(e.attrs?(function(n){var r=[];for(var s in n)r.push(s+'="'+n[s]+'"');return r.length?" "+r.join(" "):""})(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?t:t+e.children.reduce(Iy,"")+"</"+e.name+">";case"comment":return t+"<!--"+e.comment+"-->"}}var BA={parse:function(t,e){e||(e={}),e.components||(e.components=UA);var n,r=[],s=[],i=-1,o=!1;if(t.indexOf("<")!==0){var a=t.indexOf("<");r.push({type:"text",content:a===-1?t:t.substring(0,a)})}return t.replace($A,function(l,c){if(o){if(l!=="</"+n.name+">")return;o=!1}var u,h=l.charAt(1)!=="/",f=l.startsWith("<!--"),p=c+l.length,m=t.charAt(p);if(f){var y=pp(l);return i<0?(r.push(y),r):((u=s[i]).children.push(y),r)}if(h&&(i++,(n=pp(l)).type==="tag"&&e.components[n.name]&&(n.type="component",o=!0),n.voidElement||o||!m||m==="<"||n.children.push({type:"text",content:t.slice(p,t.indexOf("<",p))}),i===0&&r.push(n),(u=s[i-1])&&u.children.push(n),s[i]=n),(!h||n.voidElement)&&(i>-1&&(n.voidElement||n.name===l.slice(2,-1))&&(i--,n=i===-1?r:s[i]),!o&&m!=="<"&&m)){u=i===-1?r:s[i].children;var v=t.indexOf("<",p),S=t.slice(p,v===-1?void 0:v);FA.test(S)&&(S=" "),(v>-1&&i+u.length>=0||S!==" ")&&u.push({type:"text",content:S})}}),r},stringify:function(t){return t.reduce(function(e,n){return e+Iy("",n)},"")}};const Uo=(t,e,n,r)=>{var i,o,a,l;const s=[n,{code:e,...r||{}}];if((o=(i=t==null?void 0:t.services)==null?void 0:i.logger)!=null&&o.forward)return t.services.logger.forward(s,"warn","react-i18next::",!0);gt(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),(l=(a=t==null?void 0:t.services)==null?void 0:a.logger)!=null&&l.warn?t.services.logger.warn(...s):console!=null&&console.warn&&console.warn(...s)},mp={},il=(t,e,n,r)=>{gt(n)&&mp[n]||(gt(n)&&(mp[n]=new Date),Uo(t,e,n,r))},My=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},au=(t,e,n)=>{t.loadNamespaces(e,My(t,n))},gp=(t,e,n,r)=>{if(gt(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return au(t,n,r);n.forEach(s=>{t.options.ns.indexOf(s)<0&&t.options.ns.push(s)}),t.loadLanguages(e,My(t,r))},VA=(t,e,n={})=>!e.languages||!e.languages.length?(il(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(r,s)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!s(r.isLanguageChangingTo,t))return!1}}),gt=t=>typeof t=="string",yn=t=>typeof t=="object"&&t!==null,WA=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,zA={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},HA=t=>zA[t],Dy=t=>t.replace(WA,HA);let lu={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Dy,transDefaultProps:void 0};const KA=(t={})=>{lu={...lu,...t}},Rd=()=>lu;let Ly;const GA=t=>{Ly=t},Od=()=>Ly,Bo=(t,e)=>{var r;if(!t)return!1;const n=((r=t.props)==null?void 0:r.children)??t.children;return e?n.length>0:!!n},Vo=t=>{var n,r;if(!t)return[];const e=((n=t.props)==null?void 0:n.children)??t.children;return(r=t.props)!=null&&r.i18nIsDynamicList?gr(e):e},qA=t=>Array.isArray(t)&&t.every(x.isValidElement),gr=t=>Array.isArray(t)?t:[t],YA=(t,e)=>{const n={...e};return n.props={...e.props,...t.props},n},JA=t=>{const e={};if(!t)return e;const n=r=>{gr(r).forEach(i=>{gt(i)||(Bo(i)?n(Vo(i)):yn(i)&&!x.isValidElement(i)&&Object.assign(e,i))})};return n(t),e},$y=(t,e,n,r)=>{if(!t)return"";let s="";const i=gr(t),o=e!=null&&e.transSupportBasicHtmlNodes?e.transKeepBasicHtmlNodesFor??[]:[];return i.forEach((a,l)=>{if(gt(a)){s+=`${a}`;return}if(x.isValidElement(a)){const{props:c,type:u}=a,h=Object.keys(c).length,f=o.indexOf(u)>-1,p=c.children;if(!p&&f&&!h){s+=`<${u}/>`;return}if(!p&&(!f||h)||c.i18nIsDynamicList){s+=`<${l}></${l}>`;return}if(f&&h===1&&gt(p)){s+=`<${u}>${p}</${u}>`;return}const m=$y(p,e,n,r);s+=`<${l}>${m}</${l}>`;return}if(a===null){Uo(n,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:r});return}if(yn(a)){const{format:c,...u}=a,h=Object.keys(u);if(h.length===1){const f=c?`${h[0]}, ${c}`:h[0];s+=`{{${f}}}`;return}Uo(n,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:r,child:a});return}Uo(n,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:r,child:a})}),s},XA=(t,e=[],n={})=>{if(!t)return t;const r=Object.keys(n),s=[...e,...r];let i="",o=0;for(;o<t.length;)if(t[o]==="<"){let a=!1;const l=t.slice(o).match(/^<\/(\d+|[a-zA-Z][a-zA-Z0-9_-]*)>/);if(l){const c=l[1];(/^\d+$/.test(c)||s.includes(c))&&(a=!0,i+=l[0],o+=l[0].length)}if(!a){const c=t.slice(o).match(/^<(\d+|[a-zA-Z][a-zA-Z0-9_-]*)(\s+[\w-]+(?:=(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s*(\/)?>/);if(c){const u=c[1];(/^\d+$/.test(u)||s.includes(u))&&(a=!0,i+=c[0],o+=c[0].length)}}a||(i+="&lt;",o+=1)}else i+=t[o],o+=1;return i},QA=(t,e,n,r,s,i,o)=>{if(n==="")return[];const a=s.transKeepBasicHtmlNodesFor||[],l=n&&new RegExp(a.map(E=>`<${E}`).join("|")).test(n);if(!t&&!e&&!l&&!o)return[n];const c=e??{},u=E=>{gr(E).forEach(g=>{gt(g)||(Bo(g)?u(Vo(g)):yn(g)&&!x.isValidElement(g)&&Object.assign(c,g))})};u(t);const h=XA(n,a,c),f=BA.parse(`<0>${h}</0>`),p={...c,...i},m=(E,k,g)=>{var P;const w=Vo(E),_=v(w,k.children,g);return qA(w)&&_.length===0||(P=E.props)!=null&&P.i18nIsDynamicList?w:_},y=(E,k,g,w,_)=>{E.dummy?(E.children=k,g.push(x.cloneElement(E,{key:w},_?void 0:k))):g.push(...x.Children.map([E],P=>{const b="data-i18n-is-dynamic-list",C={key:w,[b]:void 0};return P&&P.props&&Object.keys(P.props).forEach(A=>{A==="ref"||A==="children"||A==="i18nIsDynamicList"||A===b||(C[A]=P.props[A])}),x.cloneElement(P,C,_?null:k)}))},v=(E,k,g)=>{const w=gr(E);return gr(k).reduce((P,b,C)=>{var N,O;const A=((O=(N=b.children)==null?void 0:N[0])==null?void 0:O.content)&&r.services.interpolator.interpolate(b.children[0].content,p,r.language);if(b.type==="tag"){let I=w[parseInt(b.name,10)];!I&&e&&(I=e[b.name]),g.length===1&&!I&&(I=g[0][b.name]),I||(I={});const T={...b.attrs};o&&Object.keys(T).forEach(F=>{const K=T[F];gt(K)&&(T[F]=Dy(K))});const M=Object.keys(T).length!==0?YA({props:T},I):I,R=x.isValidElement(M),j=R&&Bo(b,!0)&&!b.voidElement,D=l&&yn(M)&&M.dummy&&!R,$=yn(e)&&Object.hasOwnProperty.call(e,b.name);if(gt(M)){const F=r.services.interpolator.interpolate(M,p,r.language);P.push(F)}else if(Bo(M)||j){const F=m(M,b,g);y(M,F,P,C)}else if(D){const F=v(w,b.children,g);y(M,F,P,C)}else if(Number.isNaN(parseFloat(b.name)))if($){const F=m(M,b,g);y(M,F,P,C,b.voidElement)}else if(s.transSupportBasicHtmlNodes&&a.indexOf(b.name)>-1)if(b.voidElement)P.push(x.createElement(b.name,{key:`${b.name}-${C}`}));else{const F=v(w,b.children,g);P.push(x.createElement(b.name,{key:`${b.name}-${C}`},F))}else if(b.voidElement)P.push(`<${b.name} />`);else{const F=v(w,b.children,g);P.push(`<${b.name}>${F}</${b.name}>`)}else if(yn(M)&&!R){const F=b.children[0]?A:null;F&&P.push(F)}else y(M,A,P,C,b.children.length!==1||!A)}else if(b.type==="text"){const I=s.transWrapTextNodes,T=typeof s.unescape=="function"?s.unescape:Rd().unescape,M=o?T(r.services.interpolator.interpolate(b.content,p,r.language)):r.services.interpolator.interpolate(b.content,p,r.language);I?P.push(x.createElement(I,{key:`${b.name}-${C}`},M)):P.push(M)}return P},[])},S=v([{dummy:!0,children:t||[]}],f,gr(t||[]));return Vo(S[0])},Fy=(t,e,n)=>{const r=t.key||e,s=x.cloneElement(t,{key:r});if(!s.props||!s.props.children||n.indexOf(`${e}/>`)<0&&n.indexOf(`${e} />`)<0)return s;function i(){return x.createElement(x.Fragment,null,s)}return x.createElement(i,{key:r})},ZA=(t,e)=>t.map((n,r)=>Fy(n,r,e)),ej=(t,e)=>{const n={};return Object.keys(t).forEach(r=>{Object.assign(n,{[r]:Fy(t[r],r,e)})}),n},tj=(t,e,n,r)=>t?Array.isArray(t)?ZA(t,e):yn(t)?ej(t,e):(il(n,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:r}),null):null,nj=t=>!yn(t)||Array.isArray(t)?!1:Object.keys(t).reduce((e,n)=>e&&Number.isNaN(Number.parseFloat(n)),!0);function rj({children:t,count:e,parent:n,i18nKey:r,context:s,tOptions:i={},values:o,defaults:a,components:l,ns:c,i18n:u,t:h,shouldUnescape:f,...p}){var F,K,z,U,V,W;const m=u||Od();if(!m)return il(m,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:r}),t;const y=h||m.t.bind(m)||(ee=>ee),v={...Rd(),...(F=m.options)==null?void 0:F.react};let S=c||y.ns||((K=m.options)==null?void 0:K.defaultNS);S=gt(S)?[S]:S||["translation"];const{transDefaultProps:E}=v,k=E!=null&&E.tOptions?{...E.tOptions,...i}:i,g=f??(E==null?void 0:E.shouldUnescape),w=E!=null&&E.values?{...E.values,...o}:o,_=E!=null&&E.components?{...E.components,...l}:l,P=$y(t,v,m,r),b=a||(k==null?void 0:k.defaultValue)||P||v.transEmptyNodeValue||(typeof r=="function"?xa(r):r),{hashTransKey:C}=v,A=r||(C?C(P||b):P||b);(U=(z=m.options)==null?void 0:z.interpolation)!=null&&U.defaultVariables?o=w&&Object.keys(w).length>0?{...w,...m.options.interpolation.defaultVariables}:{...m.options.interpolation.defaultVariables}:o=w;const N=JA(t);N&&typeof N.count=="number"&&e===void 0&&(e=N.count);const O=o||e!==void 0&&!((W=(V=m.options)==null?void 0:V.interpolation)!=null&&W.alwaysFormat)||!t?k.interpolation:{interpolation:{...k.interpolation,prefix:"#$?",suffix:"?$#"}},I={...k,context:s||k.context,count:e,...o,...O,defaultValue:b,ns:S};let T=A?y(A,I):b;T===A&&b&&(T=b);const M=tj(_,T,m,r);let R=M||t,j=null;nj(M)&&(j=M,R=t);const D=QA(R,j,T,m,v,I,g),$=n??v.defaultTransParent;return $?x.createElement($,p,D):D}const sj={type:"3rdParty",init(t){KA(t.options.react),GA(t)}},Uy=x.createContext();class ij{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}function oj({children:t,count:e,parent:n,i18nKey:r,context:s,tOptions:i={},values:o,defaults:a,components:l,ns:c,i18n:u,t:h,shouldUnescape:f,...p}){var E;const{i18n:m,defaultNS:y}=x.useContext(Uy)||{},v=u||m||Od(),S=h||(v==null?void 0:v.t.bind(v));return rj({children:t,count:e,parent:n,i18nKey:r,context:s,tOptions:i,values:o,defaults:a,components:l,ns:c||(S==null?void 0:S.ns)||y||((E=v==null?void 0:v.options)==null?void 0:E.defaultNS),i18n:v,t:h,shouldUnescape:f,...p})}var Zl={exports:{}},ec={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yp;function aj(){if(yp)return ec;yp=1;var t=mk();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(h,f){var p=f(),m=r({inst:{value:p,getSnapshot:f}}),y=m[0].inst,v=m[1];return i(function(){y.value=p,y.getSnapshot=f,l(y)&&v({inst:y})},[h,p,f]),s(function(){return l(y)&&v({inst:y}),h(function(){l(y)&&v({inst:y})})},[h]),o(p),p}function l(h){var f=h.getSnapshot;h=h.value;try{var p=f();return!n(h,p)}catch{return!0}}function c(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return ec.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,ec}var xp;function lj(){return xp||(xp=1,Zl.exports=aj()),Zl.exports}var cj=lj();const uj=(t,e)=>gt(e)?e:yn(e)&&gt(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,dj={t:uj,ready:!1},hj=()=>()=>{},Pe=(t,e={})=>{var C,A,N;const{i18n:n}=e,{i18n:r,defaultNS:s}=x.useContext(Uy)||{},i=n||r||Od();i&&!i.reportNamespaces&&(i.reportNamespaces=new ij),i||il(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=x.useMemo(()=>{var O;return{...Rd(),...(O=i==null?void 0:i.options)==null?void 0:O.react,...e}},[i,e]),{useSuspense:a,keyPrefix:l}=o,c=s||((C=i==null?void 0:i.options)==null?void 0:C.defaultNS),u=gt(c)?[c]:c||["translation"],h=x.useMemo(()=>u,u);(N=(A=i==null?void 0:i.reportNamespaces)==null?void 0:A.addUsedNamespaces)==null||N.call(A,h);const f=x.useRef(0),p=x.useCallback(O=>{if(!i)return hj;const{bindI18n:I,bindI18nStore:T}=o,M=()=>{f.current+=1,O()};return I&&i.on(I,M),T&&i.store.on(T,M),()=>{I&&I.split(" ").forEach(R=>i.off(R,M)),T&&T.split(" ").forEach(R=>i.store.off(R,M))}},[i,o]),m=x.useRef(),y=x.useCallback(()=>{if(!i)return dj;const O=!!(i.isInitialized||i.initializedStoreOnce)&&h.every(D=>VA(D,i,o)),I=e.lng||i.language,T=f.current,M=m.current;if(M&&M.ready===O&&M.lng===I&&M.keyPrefix===l&&M.revision===T)return M;const j={t:i.getFixedT(I,o.nsMode==="fallback"?h:h[0],l),ready:O,lng:I,keyPrefix:l,revision:T};return m.current=j,j},[i,h,l,o,e.lng]),[v,S]=x.useState(0),{t:E,ready:k}=cj.useSyncExternalStore(p,y,y);x.useEffect(()=>{if(i&&!k&&!a){const O=()=>S(I=>I+1);e.lng?gp(i,e.lng,h,O):au(i,h,O)}},[i,e.lng,h,k,a,v]);const g=i||{},w=x.useRef(null),_=x.useRef(),P=O=>{const I=Object.getOwnPropertyDescriptors(O);I.__original&&delete I.__original;const T=Object.create(Object.getPrototypeOf(O),I);if(!Object.prototype.hasOwnProperty.call(T,"__original"))try{Object.defineProperty(T,"__original",{value:O,writable:!1,enumerable:!1,configurable:!1})}catch{}return T},b=x.useMemo(()=>{const O=g,I=O==null?void 0:O.language;let T=O;O&&(w.current&&w.current.__original===O?_.current!==I?(T=P(O),w.current=T,_.current=I):T=w.current:(T=P(O),w.current=T,_.current=I));const M=[E,T,k];return M.t=E,M.i18n=T,M.ready=k,M},[E,g,k,g.resolvedLanguage,g.language,g.languages]);if(i&&a&&!k)throw new Promise(O=>{const I=()=>O();e.lng?gp(i,e.lng,h,I):au(i,h,I)});return b};async function fj(t){return new Promise((e,n)=>{const r=new Image;r.crossOrigin="Anonymous",r.src=t,r.onload=()=>{const s=document.createElement("canvas"),i=s.getContext("2d");if(!i){n(new Error("Could not get canvas context"));return}const o=50;s.width=o,s.height=o,i.drawImage(r,0,0,o,o);const a=i.getImageData(0,0,o,o).data,l={};for(let f=0;f<a.length;f+=4){const p=a[f],m=a[f+1],y=a[f+2];if(a[f+3]<128)continue;const S=Math.round(p/10)*10,E=Math.round(m/10)*10,k=Math.round(y/10)*10,g=`rgb(${S},${E},${k})`;l[g]=(l[g]||0)+1}const c=Object.entries(l).sort((f,p)=>p[1]-f[1]).map(([f])=>f),u=c[0]||"rgb(200,200,200)",h={dominant:u,vibrant:c.find(f=>{const[p,m,y]=f.match(/\d+/g).map(Number),v=Math.max(p,m,y),S=Math.min(p,m,y);return v-S>40})||u,muted:c.find(f=>{const[p,m,y]=f.match(/\d+/g).map(Number),v=Math.max(p,m,y),S=Math.min(p,m,y);return v-S<30})||u,all:c.slice(0,5)};e(h)},r.onerror=()=>n(new Error("Failed to load image"))})}const He=3.141592653589793,wa=6378245,va=.006693421622965943;function By(t,e){let n=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=(20*Math.sin(6*t*He)+20*Math.sin(2*t*He))*2/3,n+=(20*Math.sin(e*He)+40*Math.sin(e/3*He))*2/3,n+=(160*Math.sin(e/12*He)+320*Math.sin(e*He/30))*2/3,n}function Vy(t,e){let n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=(20*Math.sin(6*t*He)+20*Math.sin(2*t*He))*2/3,n+=(20*Math.sin(t*He)+40*Math.sin(t/3*He))*2/3,n+=(150*Math.sin(t/12*He)+300*Math.sin(t/30*He))*2/3,n}function hs(t,e){if(Wy(t,e))return[t,e];let n=By(e-105,t-35),r=Vy(e-105,t-35);const s=t/180*He,i=Math.sin(s),o=Math.sqrt(1-va*i*i);return n=n*180/(wa*(1-va)/(i*o)*He),r=r*180/(wa/o*Math.cos(s)*He),[t+n,e+r]}function pj(t,e){if(Wy(t,e))return[t,e];let n=By(e-105,t-35),r=Vy(e-105,t-35);const s=t/180*He,i=Math.sin(s),o=Math.sqrt(1-va*i*i);n=n*180/(wa*(1-va)/(i*o)*He),r=r*180/(wa/o*Math.cos(s)*He);const a=t+n,l=e+r;return[t*2-a,e*2-l]}function Wy(t,e){return e<72.004||e>137.8347||t<.8293||t>55.8271}const zy="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",Hy="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let mj=zn.icon({iconUrl:zy,shadowUrl:Hy,iconSize:[25,41],iconAnchor:[12,41]});zn.Marker.prototype.options.icon=mj;function gj({position:t,setPosition:e}){return _k({click(n){e({lat:n.latlng.lat,lng:n.latlng.lng})}}),t?d.jsx(Cd,{position:[t.lat,t.lng]}):null}function Ky({onAddEntry:t,onSave:e,saving:n=!1,initialData:r,isEdit:s=!1}){const{groups:i}=Fi(),{t:o}=Pe(),[a,l]=x.useState(""),[c,u]=x.useState(""),[h,f]=x.useState(""),[p,m]=x.useState(""),[y,v]=x.useState(!1),[S,E]=x.useState(),[k,g]=x.useState(!1),[w,_]=x.useState([]),[P,b]=x.useState([]),[C,A]=x.useState(),[N,O]=x.useState(""),[I,T]=x.useState(!1),[M,R]=x.useState(null),j=x.useRef(null),[D,$]=x.useState(new Date().toISOString()),[F,K]=x.useState(!1),[z,U]=x.useState(null),[V,W]=x.useState(["private"]);x.useEffect(()=>{async function G(){try{const q=await Sk();R(q)}catch(q){console.error("Failed to load MobileNet model:",q)}}G()},[]),x.useEffect(()=>{r&&(l(r.photo),m(r.photo),u(r.caption),f(r.mood),E(r.location),_(r.tags||[]),b(r.aiTags||[]),A(r.palette),$(r.date),W(r.groupIds&&r.groupIds.length>0?r.groupIds:["private"]))},[r]);const ee=G=>{W(q=>G==="private"?q.includes("private")?q.filter(ue=>ue!=="private"):[...q,"private"]:q.includes(G)?q.filter(ue=>ue!==G):[...q,G])},ne=async G=>{var ue;const q=(ue=G.target.files)==null?void 0:ue[0];if(q)try{v(!0);const we=await st(q,{maxSizeMB:.5,maxWidthOrHeight:1920,useWebWorker:!0,fileType:"image/webp"}),$e=new FileReader;$e.onloadend=async()=>{const Ae=$e.result;l(Ae),m(Ae);try{const _e=await fj(Ae);A(_e)}catch(_e){console.error("Palette extraction failed:",_e)}v(!1)},$e.readAsDataURL(we)}catch(be){console.error("Error compressing image:",be),v(!1)}},pe=()=>{if(!navigator.geolocation){alert("Geolocation is not supported by your browser");return}g(!0),navigator.geolocation.getCurrentPosition(G=>{E({lat:G.coords.latitude,lng:G.coords.longitude,name:"Current Location"}),g(!1)},G=>{console.error("Error getting location:",G),alert("Unable to retrieve your location"),g(!1)})},se=()=>{if(S){const[G,q]=hs(S.lat,S.lng);U({lat:G,lng:q})}else navigator.geolocation.getCurrentPosition(G=>{const[q,ue]=hs(G.coords.latitude,G.coords.longitude);U({lat:q,lng:ue})},()=>{U({lat:39.9042,lng:116.4074})});K(!0)},me=()=>{if(z){const[G,q]=pj(z.lat,z.lng);E({lat:G,lng:q,name:"Selected on Map"})}K(!1)},ve=G=>{G.key==="Enter"&&N.trim()&&(G.preventDefault(),w.includes(N.trim())||_([...w,N.trim()]),O(""))},Se=G=>{_(w.filter(q=>q!==G))},it=G=>{b(P.filter(q=>q!==G))},ot=async()=>{if(!c&&!a){alert("Please add a photo or write something first for analysis!");return}if(!M&&a){alert("AI model is still loading, please wait a moment...");return}T(!0);try{const G=[...P];if(c){const q=c.toLowerCase().split(" ");Object.entries({beach:["beach","sea","ocean","sand"],food:["food","eat","dinner","lunch","breakfast","yummy","delicious"],friends:["friend","friends","party","social"],pet:["cat","dog","pet","animal","kitten","puppy"],travel:["travel","trip","journey","vacation","flight"],work:["work","office","meeting","job"],love:["love","date","romantic"],nature:["nature","tree","flower","mountain","park"]}).forEach(([be,we])=>{we.some($e=>q.includes($e))&&(G.includes(be)||G.push(be))})}if(a&&M&&j.current){const q=await M.classify(j.current);console.log("AI Predictions:",q),q.forEach(ue=>{const be=ue.className.split(",")[0].split(" "),we=be[be.length-1].toLowerCase();G.includes(we)||G.push(we)})}b(G)}catch(G){console.error("Error during AI analysis:",G),alert("Something went wrong during AI analysis.")}finally{T(!1)}},Ce=G=>{if(G.preventDefault(),!a||!c||!h){alert("Please fill in all fields");return}if(V.length===0){alert("Please select at least one destination (Private or a Group)");return}let q=[...w];N.trim()&&!w.includes(N.trim())&&q.push(N.trim());const ue={id:(r==null?void 0:r.id)||Date.now().toString(),date:D,photo:a,caption:c,mood:h,location:S,tags:q,aiTags:P,palette:C,groupIds:V};e?e(ue,V):t&&t(ue,V)},Me=G=>{const q=G.target.value;if(!q)return;const ue=new Date,be=new Date(q);be.setHours(ue.getHours()),be.setMinutes(ue.getMinutes()),be.setSeconds(ue.getSeconds()),$(be.toISOString())};return d.jsxs(d.Fragment,{children:[d.jsxs("form",{onSubmit:Ce,className:"bg-white rounded-2xl shadow-sm p-6 space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h2",{className:"text-2xl mb-2",children:o(s?"form.titleEdit":"form.titleAdd")}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 text-gray-500 text-sm",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(bs,{className:"w-4 h-4"}),d.jsx("input",{type:"date",value:xe(new Date(D),"yyyy-MM-dd"),onChange:Me,className:"bg-transparent border-b border-gray-200 focus:border-blue-500 outline-none text-center w-32"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(P0,{className:"w-4 h-4"}),d.jsx("input",{type:"time",value:xe(new Date(D),"HH:mm"),onChange:G=>{const q=G.target.value;if(!q)return;const[ue,be]=q.split(":").map(Number),we=new Date(D);we.setHours(ue),we.setMinutes(be),$(we.toISOString())},className:"bg-transparent border-b border-gray-200 focus:border-blue-500 outline-none text-center w-20"})]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 flex items-center gap-2",children:[d.jsx(A0,{className:"w-4 h-4 text-blue-500"}),o("form.shareLabel")]}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsxs("button",{type:"button",onClick:()=>ee("private"),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm border transition-all ${V.includes("private")?"bg-purple-50 border-purple-200 text-purple-700 shadow-sm":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[d.jsx(vd,{className:"w-3 h-3"}),o("form.private"),V.includes("private")&&d.jsx(Et,{className:"w-3 h-3 ml-1"})]}),i.map(G=>d.jsxs("button",{type:"button",onClick:()=>ee(G.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm border transition-all ${V.includes(G.id)?"bg-blue-50 border-blue-200 text-blue-700 shadow-sm":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[d.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:G.color}}),G.name,V.includes(G.id)&&d.jsx(Et,{className:"w-3 h-3 ml-1"})]},G.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm mb-2 text-gray-700",children:"Photo"}),y?d.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-300 rounded-xl bg-gray-50",children:[d.jsx(_t,{className:"w-8 h-8 animate-spin text-blue-500 mb-2"}),d.jsx("span",{className:"text-sm text-gray-500",children:"Compressing image..."})]}):p?d.jsxs("div",{className:"relative",children:[d.jsx("img",{ref:j,src:p,alt:"Preview",className:"w-full h-64 object-cover rounded-xl",crossOrigin:"anonymous"}),d.jsx("button",{type:"button",onClick:()=>{l(""),m("");const G=document.getElementById("photo-input");G&&(G.value="")},className:"absolute top-2 right-2 bg-white/90 hover:bg-white rounded-full p-2 shadow-lg transition-colors",children:d.jsx(Ct,{className:"w-5 h-5"})})]}):d.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[d.jsx(ws,{className:"w-12 h-12 text-gray-400 mb-2"}),d.jsx("span",{className:"text-sm text-gray-500",children:o("form.upload")}),d.jsx("input",{id:"photo-input",type:"file",accept:"image/*",onChange:ne,className:"hidden"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm mb-3 text-gray-700",children:o("form.moodLabel")}),d.jsx("div",{className:"grid grid-cols-4 gap-2",children:Td.map(G=>{const q=G.icon;return d.jsxs("button",{type:"button",onClick:()=>f(G.name),className:`flex flex-col items-center justify-center p-3 rounded-xl transition-all ${h===G.name?`${G.color} ring-2 ring-offset-2 ring-current scale-105`:`${G.color} opacity-60`}`,children:[d.jsx(q,{className:"w-5 h-5 mb-1"}),d.jsx("span",{className:"text-xs",children:o(`moods.${G.name.toLowerCase()}`,G.name)})]},G.name)})})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm mb-2 text-gray-700 flex justify-between items-center",children:[d.jsx("span",{children:"Tags"}),d.jsxs("button",{type:"button",onClick:ot,disabled:I,className:"text-xs flex items-center gap-1 text-purple-600 hover:text-purple-700 disabled:opacity-50 transition-colors",children:[I?d.jsx(_t,{className:"w-3 h-3 animate-spin"}):d.jsx(R1,{className:"w-3 h-3"}),I?o("common.loading"):"Smart Tag"]})]}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:w.map(G=>d.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-50 text-blue-600 rounded-full text-sm",children:[d.jsx(O1,{className:"w-3 h-3"}),G,d.jsx("button",{type:"button",onClick:()=>Se(G),className:"hover:text-blue-800",children:d.jsx(Ct,{className:"w-3 h-3"})})]},G))}),P.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:P.map(G=>d.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-purple-50 text-purple-600 rounded-full text-sm border border-purple-100",children:[d.jsx(on,{className:"w-3 h-3"}),G,d.jsx("button",{type:"button",onClick:()=>it(G),className:"hover:text-purple-800",children:d.jsx(Ct,{className:"w-3 h-3"})})]},`ai-${G}`))}),d.jsx("input",{type:"text",value:N,onChange:G=>O(G.target.value),onKeyDown:ve,placeholder:"Type custom tag and press Enter",className:"w-full px-4 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm mb-2 text-gray-700",children:o("form.locationPlaceholder")}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{type:"button",onClick:pe,disabled:k,className:"flex items-center gap-2 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl transition-colors disabled:opacity-50",title:"Use current location",children:k?d.jsx(_t,{className:"w-4 h-4 animate-spin"}):d.jsx(j0,{className:"w-4 h-4"})}),d.jsx("button",{type:"button",onClick:se,className:"flex items-center gap-2 px-4 py-3 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-xl transition-colors",title:"Select on map",children:d.jsx(vs,{className:"w-4 h-4"})}),d.jsx("input",{type:"text",value:(S==null?void 0:S.name)||"",onChange:G=>E(q=>q?{...q,name:G.target.value}:void 0),placeholder:S?o("form.locationPlaceholder"):"Click buttons to add location",disabled:!S,className:"flex-1 px-4 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400"})]}),S&&d.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Lat: ",S.lat.toFixed(4),", Lng: ",S.lng.toFixed(4)]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm mb-2 text-gray-700",children:o("form.captionPlaceholder")}),d.jsx("textarea",{value:c,onChange:G=>u(G.target.value),placeholder:o("form.captionPlaceholder"),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),d.jsx("button",{type:"submit",disabled:n||y,className:"w-full bg-blue-600 text-white py-3 rounded-xl hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:n?d.jsxs(d.Fragment,{children:[d.jsx(_t,{className:"w-5 h-5 animate-spin"}),o("form.saving")]}):o("form.save")})]}),F&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:d.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl h-[500px] overflow-hidden flex flex-col shadow-2xl animate-in fade-in zoom-in-95 duration-200",children:[d.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-white z-10",children:[d.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[d.jsx(vs,{className:"w-5 h-5 text-blue-600"}),"Select Location"]}),d.jsx("button",{onClick:()=>K(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:d.jsx(Ct,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"flex-1 relative",children:[z?d.jsxs(V0,{center:[z.lat,z.lng],zoom:13,style:{height:"100%",width:"100%"},children:[d.jsx(W0,{attribution:'Map data  <a href="https://www.amap.com/">Gaode</a> contributors',url:"https://webrd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}"}),d.jsx(gj,{position:z,setPosition:U})]}):d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsx(_t,{className:"w-8 h-8 animate-spin text-blue-600"})}),d.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-[1000]",children:d.jsx("button",{onClick:me,className:"bg-blue-600 text-white px-6 py-2 rounded-full shadow-lg hover:bg-blue-700 transition-transform active:scale-95 font-medium",children:"Confirm Location"})})]})]})})]})}const yj=t=>{const e=t.toLowerCase();return{happy:[{platform:"Netease",title:"Happy Vibes Playlist",url:"https://music.163.com/#/search/m/?s=happy"},{platform:"Kugou",title:"Upbeat Hits",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=happy"}],sad:[{platform:"Netease",title:"Melancholy Melodies",url:"https://music.163.com/#/search/m/?s=sad%20songs"},{platform:"Kugou",title:"Comforting Ballads",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=sad"}],excited:[{platform:"Netease",title:"High Energy",url:"https://music.163.com/#/search/m/?s=party"},{platform:"Kugou",title:"Adrenaline Rush",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=energy"}],calm:[{platform:"Netease",title:"Relaxing Piano",url:"https://music.163.com/#/search/m/?s=relaxing"},{platform:"Kugou",title:"Zen Garden",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=calm"}],grateful:[{platform:"Netease",title:"Thankful Hearts",url:"https://music.163.com/#/search/m/?s=grateful"},{platform:"Kugou",title:"Warm Feelings",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=warm"}],inspired:[{platform:"Netease",title:"Creative Flow",url:"https://music.163.com/#/search/m/?s=inspiration"},{platform:"Kugou",title:"Focus & Study",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=focus"}],stressed:[{platform:"Netease",title:"Stress Relief",url:"https://music.163.com/#/search/m/?s=stress%20relief"},{platform:"Kugou",title:"Nature Sounds",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=nature"}],energetic:[{platform:"Netease",title:"Workout Mix",url:"https://music.163.com/#/search/m/?s=workout"},{platform:"Kugou",title:"Power Anthems",url:"https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord=power"}]}[e]||[{platform:"Netease",title:"Daily Recommendations",url:"https://music.163.com/#/discover"},{platform:"Kugou",title:"Top Charts",url:"https://www.kugou.com/"}]};function ae(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function B(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}let Gy=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return Gy=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function cu(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const uu=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class re extends Error{}class et extends re{constructor(e,n,r,s){super(`${et.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.requestID=s==null?void 0:s.get("x-request-id"),this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new ol({message:r,cause:uu(n)});const i=n==null?void 0:n.error;return e===400?new qy(e,i,r,s):e===401?new Yy(e,i,r,s):e===403?new Jy(e,i,r,s):e===404?new Xy(e,i,r,s):e===409?new Qy(e,i,r,s):e===422?new Zy(e,i,r,s):e===429?new ex(e,i,r,s):e>=500?new tx(e,i,r,s):new et(e,i,r,s)}}class jt extends et{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class ol extends et{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Id extends ol{constructor({message:e}={}){super({message:e??"Request timed out."})}}class qy extends et{}class Yy extends et{}class Jy extends et{}class Xy extends et{}class Qy extends et{}class Zy extends et{}class ex extends et{}class tx extends et{}class nx extends re{constructor(){super("Could not parse response content as the length limit was reached")}}class rx extends re{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ks extends Error{constructor(e){super(e)}}const xj=/^[a-z][a-z0-9+.-]*:/i,bj=t=>xj.test(t);let pt=t=>(pt=Array.isArray,pt(t)),bp=pt;function sx(t){return typeof t!="object"?{}:t??{}}function wj(t){if(!t)return!0;for(const e in t)return!1;return!0}function vj(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function tc(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const Sj=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new re(`${t} must be an integer`);if(e<0)throw new re(`${t} must be a positive integer`);return e},_j=t=>{try{return JSON.parse(t)}catch{return}},Ui=t=>new Promise(e=>setTimeout(e,t)),Qr="6.21.0",kj=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function Cj(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Ej=()=>{var n;const t=Cj();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qr,"X-Stainless-OS":vp(Deno.build.os),"X-Stainless-Arch":wp(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qr,"X-Stainless-OS":vp(globalThis.process.platform??"unknown"),"X-Stainless-Arch":wp(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=Pj();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Pj(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const wp=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",vp=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Sp;const Aj=()=>Sp??(Sp=Ej());function jj(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function ix(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function ox(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return ix({start(){},async pull(n){const{done:r,value:s}=await e.next();r?n.close():n.enqueue(s)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function ax(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Nj(t){var r,s;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((s=(r=t[Symbol.asyncIterator]()).return)==null?void 0:s.call(r));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const Tj=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),lx="RFC3986",cx=t=>String(t),_p={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:cx},Rj="RFC1738";let du=(t,e)=>(du=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),du(t,e));const Gt=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),nc=1024,Oj=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let o="";for(let a=0;a<i.length;a+=nc){const l=i.length>=nc?i.slice(a,a+nc):i,c=[];for(let u=0;u<l.length;++u){let h=l.charCodeAt(u);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===Rj&&(h===40||h===41)){c[c.length]=l.charAt(u);continue}if(h<128){c[c.length]=Gt[h];continue}if(h<2048){c[c.length]=Gt[192|h>>6]+Gt[128|h&63];continue}if(h<55296||h>=57344){c[c.length]=Gt[224|h>>12]+Gt[128|h>>6&63]+Gt[128|h&63];continue}u+=1,h=65536+((h&1023)<<10|l.charCodeAt(u)&1023),c[c.length]=Gt[240|h>>18]+Gt[128|h>>12&63]+Gt[128|h>>6&63]+Gt[128|h&63]}o+=c.join("")}return o};function Ij(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function kp(t,e){if(pt(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const ux={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},dx=function(t,e){Array.prototype.push.apply(t,pt(e)?e:[e])};let Cp;const Ve={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Oj,encodeValuesOnly:!1,format:lx,formatter:cx,indices:!1,serializeDate(t){return(Cp??(Cp=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function Mj(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const rc={};function hx(t,e,n,r,s,i,o,a,l,c,u,h,f,p,m,y,v,S){let E=t,k=S,g=0,w=!1;for(;(k=k.get(rc))!==void 0&&!w;){const A=k.get(t);if(g+=1,typeof A<"u"){if(A===g)throw new RangeError("Cyclic object value");w=!0}typeof k.get(rc)>"u"&&(g=0)}if(typeof c=="function"?E=c(e,E):E instanceof Date?E=f==null?void 0:f(E):n==="comma"&&pt(E)&&(E=kp(E,function(A){return A instanceof Date?f==null?void 0:f(A):A})),E===null){if(i)return l&&!y?l(e,Ve.encoder,v,"key",p):e;E=""}if(Mj(E)||Ij(E)){if(l){const A=y?e:l(e,Ve.encoder,v,"key",p);return[(m==null?void 0:m(A))+"="+(m==null?void 0:m(l(E,Ve.encoder,v,"value",p)))]}return[(m==null?void 0:m(e))+"="+(m==null?void 0:m(String(E)))]}const _=[];if(typeof E>"u")return _;let P;if(n==="comma"&&pt(E))y&&l&&(E=kp(E,l)),P=[{value:E.length>0?E.join(",")||null:void 0}];else if(pt(c))P=c;else{const A=Object.keys(E);P=u?A.sort(u):A}const b=a?String(e).replace(/\./g,"%2E"):String(e),C=r&&pt(E)&&E.length===1?b+"[]":b;if(s&&pt(E)&&E.length===0)return C+"[]";for(let A=0;A<P.length;++A){const N=P[A],O=typeof N=="object"&&typeof N.value<"u"?N.value:E[N];if(o&&O===null)continue;const I=h&&a?N.replace(/\./g,"%2E"):N,T=pt(E)?typeof n=="function"?n(C,I):C:C+(h?"."+I:"["+I+"]");S.set(t,g);const M=new WeakMap;M.set(rc,S),dx(_,hx(O,T,n,r,s,i,o,a,n==="comma"&&y&&pt(E)?null:l,c,u,h,f,p,m,y,v,M))}return _}function Dj(t=Ve){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Ve.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=lx;if(typeof t.format<"u"){if(!du(_p,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=_p[n];let s=Ve.filter;(typeof t.filter=="function"||pt(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in ux?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Ve.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Ve.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Ve.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Ve.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Ve.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Ve.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Ve.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Ve.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Ve.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Ve.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Ve.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Ve.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Ve.strictNullHandling}}function Lj(t,e={}){let n=t;const r=Dj(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):pt(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const a=ux[r.arrayFormat],l=a==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const c=new WeakMap;for(let f=0;f<s.length;++f){const p=s[f];r.skipNulls&&n[p]===null||dx(o,hx(n[p],p,a,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const u=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),u.length>0?h+u:""}function $j(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}let Ep;function Md(t){let e;return(Ep??(e=new globalThis.TextEncoder,Ep=e.encode.bind(e)))(t)}let Pp;function Ap(t){let e;return(Pp??(e=new globalThis.TextDecoder,Pp=e.decode.bind(e)))(t)}var bt,wt;class al{constructor(){bt.set(this,void 0),wt.set(this,void 0),ae(this,bt,new Uint8Array),ae(this,wt,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Md(e):e;ae(this,bt,$j([B(this,bt,"f"),n]));const r=[];let s;for(;(s=Fj(B(this,bt,"f"),B(this,wt,"f")))!=null;){if(s.carriage&&B(this,wt,"f")==null){ae(this,wt,s.index);continue}if(B(this,wt,"f")!=null&&(s.index!==B(this,wt,"f")+1||s.carriage)){r.push(Ap(B(this,bt,"f").subarray(0,B(this,wt,"f")-1))),ae(this,bt,B(this,bt,"f").subarray(B(this,wt,"f"))),ae(this,wt,null);continue}const i=B(this,wt,"f")!==null?s.preceding-1:s.preceding,o=Ap(B(this,bt,"f").subarray(0,i));r.push(o),ae(this,bt,B(this,bt,"f").subarray(s.index)),ae(this,wt,null)}return r}flush(){return B(this,bt,"f").length?this.decode(`
`):[]}}bt=new WeakMap,wt=new WeakMap;al.NEWLINE_CHARS=new Set([`
`,"\r"]);al.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Fj(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Uj(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}const Sa={off:0,error:200,warn:300,info:400,debug:500},jp=(t,e,n)=>{if(t){if(vj(Sa,t))return t;Je(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Sa))}`)}};function Gs(){}function mo(t,e,n){return!e||Sa[t]>Sa[n]?Gs:e[t].bind(e)}const Bj={error:Gs,warn:Gs,info:Gs,debug:Gs};let Np=new WeakMap;function Je(t){const e=t.logger,n=t.logLevel??"off";if(!e)return Bj;const r=Np.get(e);if(r&&r[0]===n)return r[1];const s={error:mo("error",e,n),warn:mo("warn",e,n),info:mo("info",e,n),debug:mo("debug",e,n)};return Np.set(e,[n,s]),s}const cr=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Vs;class tn{constructor(e,n,r){this.iterator=e,Vs.set(this,void 0),this.controller=n,ae(this,Vs,r)}static fromSSEResponse(e,n,r){let s=!1;const i=r?Je(r):console;async function*o(){if(s)throw new re("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const l of Vj(e,n))if(!a){if(l.data.startsWith("[DONE]")){a=!0;continue}if(l.event===null||!l.event.startsWith("thread.")){let c;try{c=JSON.parse(l.data)}catch(u){throw i.error("Could not parse message into JSON:",l.data),i.error("From chunk:",l.raw),u}if(c&&c.error)throw new et(void 0,c.error,void 0,e.headers);yield c}else{let c;try{c=JSON.parse(l.data)}catch(u){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),u}if(l.event=="error")throw new et(void 0,c.error,c.message,void 0);yield{event:l.event,data:c}}}a=!0}catch(l){if(cu(l))return;throw l}finally{a||n.abort()}}return new tn(o,n,r)}static fromReadableStream(e,n,r){let s=!1;async function*i(){const a=new al,l=ax(e);for await(const c of l)for(const u of a.decode(c))yield u;for(const c of a.flush())yield c}async function*o(){if(s)throw new re("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const l of i())a||l&&(yield JSON.parse(l));a=!0}catch(l){if(cu(l))return;throw l}finally{a||n.abort()}}return new tn(o,n,r)}[(Vs=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new tn(()=>s(e),this.controller,B(this,Vs,"f")),new tn(()=>s(n),this.controller,B(this,Vs,"f"))]}toReadableStream(){const e=this;let n;return ix({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:s,done:i}=await n.next();if(i)return r.close();const o=Md(JSON.stringify(s)+`
`);r.enqueue(o)}catch(s){r.error(s)}},async cancel(){var r;await((r=n.return)==null?void 0:r.call(n))}})}}async function*Vj(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new re("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new re("Attempted to iterate over a response with no body");const n=new zj,r=new al,s=ax(t.body);for await(const i of Wj(s))for(const o of r.decode(i)){const a=n.decode(o);a&&(yield a)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*Wj(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Md(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Uj(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class zj{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=Hj(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function Hj(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function fx(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:i}=e,o=await(async()=>{var h;if(e.options.stream)return Je(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):tn.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const a=n.headers.get("content-type"),l=(h=a==null?void 0:a.split(";")[0])==null?void 0:h.trim();if((l==null?void 0:l.includes("application/json"))||(l==null?void 0:l.endsWith("+json"))){if(n.headers.get("content-length")==="0")return;const p=await n.json();return px(p,n)}return await n.text()})();return Je(t).debug(`[${r}] response parsed`,cr({retryOfRequestLogID:s,url:n.url,status:n.status,body:o,durationMs:Date.now()-i})),o}function px(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var qs;class ll extends Promise{constructor(e,n,r=fx){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=r,qs.set(this,void 0),ae(this,qs,e)}_thenUnwrap(e){return new ll(B(this,qs,"f"),this.responsePromise,async(n,r)=>px(e(await this.parseResponse(n,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(B(this,qs,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}qs=new WeakMap;var go;class Dd{constructor(e,n,r,s){go.set(this,void 0),ae(this,go,e),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new re("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await B(this,go,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(go=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Kj extends ll{constructor(e,n,r){super(e,n,async(s,i)=>new r(s,i.response,await fx(s,i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}let cl=class extends Dd{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}};class Ie extends Dd{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var r;const e=this.getPaginatedItems(),n=(r=e[e.length-1])==null?void 0:r.id;return n?{...this.options,query:{...sx(this.options.query),after:n}}:null}}class _a extends Dd{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...sx(this.options.query),after:e}}:null}}const mx=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ci(t,e,n){return mx(),new File(t,e??"unknown_file",n)}function Wo(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const Ld=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",ka=async(t,e)=>hu(t.body)?{...t,body:await gx(t.body,e)}:t,kr=async(t,e)=>({...t,body:await gx(t.body,e)}),Tp=new WeakMap;function Gj(t){const e=typeof t=="function"?t:t.fetch,n=Tp.get(e);if(n)return n;const r=(async()=>{try{const s="Response"in e?e.Response:(await e("data:,")).constructor,i=new FormData;return i.toString()!==await new s(i).text()}catch{return!0}})();return Tp.set(e,r),r}const gx=async(t,e)=>{if(!await Gj(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([r,s])=>fu(n,r,s))),n},yx=t=>t instanceof Blob&&"name"in t,qj=t=>typeof t=="object"&&t!==null&&(t instanceof Response||Ld(t)||yx(t)),hu=t=>{if(qj(t))return!0;if(Array.isArray(t))return t.some(hu);if(t&&typeof t=="object"){for(const e in t)if(hu(t[e]))return!0}return!1},fu=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,ci([await n.blob()],Wo(n)));else if(Ld(n))t.append(e,ci([await new Response(ox(n)).blob()],Wo(n)));else if(yx(n))t.append(e,n,Wo(n));else if(Array.isArray(n))await Promise.all(n.map(r=>fu(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>fu(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},xx=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Yj=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&xx(t),Jj=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function Xj(t,e,n){if(mx(),t=await t,Yj(t))return t instanceof File?t:ci([await t.arrayBuffer()],t.name);if(Jj(t)){const s=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),ci(await pu(s),e,n)}const r=await pu(t);if(e||(e=Wo(t)),!(n!=null&&n.type)){const s=r.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof s=="string"&&(n={...n,type:s})}return ci(r,e,n)}async function pu(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(xx(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(Ld(t))for await(const r of t)e.push(...await pu(r));else{const r=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${r?`; constructor: ${r}`:""}${Qj(t)}`)}return e}function Qj(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class Z{constructor(e){this._client=e}}function bx(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Rp=Object.freeze(Object.create(null)),Zj=(t=bx)=>function(n,...r){if(n.length===1)return n[0];let s=!1;const i=[],o=n.reduce((u,h,f)=>{var y;/[?#]/.test(h)&&(s=!0);const p=r[f];let m=(s?encodeURIComponent:t)(""+p);return f!==r.length&&(p==null||typeof p=="object"&&p.toString===((y=Object.getPrototypeOf(Object.getPrototypeOf(p.hasOwnProperty??Rp)??Rp))==null?void 0:y.toString))&&(m=p+"",i.push({start:u.length+h.length,length:m.length,error:`Value of type ${Object.prototype.toString.call(p).slice(8,-1)} is not a valid path parameter`})),u+h+(f===r.length?"":m)},""),a=o.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(a))!==null;)i.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(i.sort((u,h)=>u.start-h.start),i.length>0){let u=0;const h=i.reduce((f,p)=>{const m=" ".repeat(p.start-u),y="^".repeat(p.length);return u=p.start+p.length,f+m+y},"");throw new re(`Path parameters result in path with invalid segments:
${i.map(f=>f.error).join(`
`)}
${o}
${h}`)}return o},H=Zj(bx);let wx=class extends Z{list(e,n={},r){return this._client.getAPIList(H`/chat/completions/${e}/messages`,Ie,{query:n,...r})}};function Ca(t){return t!==void 0&&"function"in t&&t.function!==void 0}function $d(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Bi(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function eN(t,e){return!e||!vx(e)?{...t,choices:t.choices.map(n=>(Sx(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Fd(t,e)}function Fd(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new nx;if(r.finish_reason==="content_filter")throw new rx;return Sx(r.message.tool_calls),{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>nN(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?tN(e,r.message.content):null}}});return{...t,choices:n}}function tN(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function nN(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return Ca(s)&&((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Bi(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function rN(t,e){var r;if(!t||!("tools"in t)||!t.tools)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return Ca(s)&&((i=s.function)==null?void 0:i.name)===e.function.name});return Ca(n)&&(Bi(n)||(n==null?void 0:n.function.strict)||!1)}function vx(t){var e;return $d(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Bi(n)||n.type==="function"&&n.function.strict===!0))??!1}function Sx(t){for(const e of t||[])if(e.type!=="function")throw new re(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function sN(t){for(const e of t??[]){if(e.type!=="function")throw new re(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new re(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Ea=t=>(t==null?void 0:t.role)==="assistant",_x=t=>(t==null?void 0:t.role)==="tool";var mu,zo,Ho,Ys,Js,Ko,Xs,mn,Qs,Pa,Aa,Zr,kx;class Ud{constructor(){mu.add(this),this.controller=new AbortController,zo.set(this,void 0),Ho.set(this,()=>{}),Ys.set(this,()=>{}),Js.set(this,void 0),Ko.set(this,()=>{}),Xs.set(this,()=>{}),mn.set(this,{}),Qs.set(this,!1),Pa.set(this,!1),Aa.set(this,!1),Zr.set(this,!1),ae(this,zo,new Promise((e,n)=>{ae(this,Ho,e,"f"),ae(this,Ys,n,"f")})),ae(this,Js,new Promise((e,n)=>{ae(this,Ko,e,"f"),ae(this,Xs,n,"f")})),B(this,zo,"f").catch(()=>{}),B(this,Js,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},B(this,mu,"m",kx).bind(this))},0)}_connected(){this.ended||(B(this,Ho,"f").call(this),this._emit("connect"))}get ended(){return B(this,Qs,"f")}get errored(){return B(this,Pa,"f")}get aborted(){return B(this,Aa,"f")}abort(){this.controller.abort()}on(e,n){return(B(this,mn,"f")[e]||(B(this,mn,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=B(this,mn,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(B(this,mn,"f")[e]||(B(this,mn,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{ae(this,Zr,!0),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){ae(this,Zr,!0),await B(this,Js,"f")}_emit(e,...n){if(B(this,Qs,"f"))return;e==="end"&&(ae(this,Qs,!0),B(this,Ko,"f").call(this));const r=B(this,mn,"f")[e];if(r&&(B(this,mn,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!B(this,Zr,"f")&&!(r!=null&&r.length)&&Promise.reject(s),B(this,Ys,"f").call(this,s),B(this,Xs,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!B(this,Zr,"f")&&!(r!=null&&r.length)&&Promise.reject(s),B(this,Ys,"f").call(this,s),B(this,Xs,"f").call(this,s),this._emit("end")}}_emitFinal(){}}zo=new WeakMap,Ho=new WeakMap,Ys=new WeakMap,Js=new WeakMap,Ko=new WeakMap,Xs=new WeakMap,mn=new WeakMap,Qs=new WeakMap,Pa=new WeakMap,Aa=new WeakMap,Zr=new WeakMap,mu=new WeakSet,kx=function(e){if(ae(this,Pa,!0),e instanceof Error&&e.name==="AbortError"&&(e=new jt),e instanceof jt)return ae(this,Aa,!0),this._emit("abort",e);if(e instanceof re)return this._emit("error",e);if(e instanceof Error){const n=new re(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new re(String(e)))};function iN(t){return typeof t.parse=="function"}var lt,gu,ja,yu,xu,bu,Cx,Ex;const oN=10;class Px extends Ud{constructor(){super(...arguments),lt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),_x(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Ea(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new re("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),B(this,lt,"m",gu).call(this)}async finalMessage(){return await this.done(),B(this,lt,"m",ja).call(this)}async finalFunctionToolCall(){return await this.done(),B(this,lt,"m",yu).call(this)}async finalFunctionToolCallResult(){return await this.done(),B(this,lt,"m",xu).call(this)}async totalUsage(){return await this.done(),B(this,lt,"m",bu).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=B(this,lt,"m",ja).call(this);n&&this._emit("finalMessage",n);const r=B(this,lt,"m",gu).call(this);r&&this._emit("finalContent",r);const s=B(this,lt,"m",yu).call(this);s&&this._emit("finalFunctionToolCall",s);const i=B(this,lt,"m",xu).call(this);i!=null&&this._emit("finalFunctionToolCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",B(this,lt,"m",bu).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),B(this,lt,"m",Cx).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Fd(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runTools(e,n,r){var p,m,y;const s="tool",{tool_choice:i="auto",stream:o,...a}=n,l=typeof i!="string"&&i.type==="function"&&((p=i==null?void 0:i.function)==null?void 0:p.name),{maxChatCompletions:c=oN}=r||{},u=n.tools.map(v=>{if(Bi(v)){if(!v.$callback)throw new re("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),h={};for(const v of u)v.type==="function"&&(h[v.function.name||v.function.function.name]=v.function);const f="tools"in n?u.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<c;++v){const E=(m=(await this._createChatCompletion(e,{...a,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:m.message;if(!E)throw new re("missing message in ChatCompletion response");if(!((y=E.tool_calls)!=null&&y.length))return;for(const k of E.tool_calls){if(k.type!=="function")continue;const g=k.id,{name:w,arguments:_}=k.function,P=h[w];if(P){if(l&&l!==w){const N=`Invalid tool_call: ${JSON.stringify(w)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:g,content:N});continue}}else{const N=`Invalid tool_call: ${JSON.stringify(w)}. Available options are: ${Object.keys(h).map(O=>JSON.stringify(O)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:g,content:N});continue}let b;try{b=iN(P)?await P.parse(_):_}catch(N){const O=N instanceof Error?N.message:String(N);this._addMessage({role:s,tool_call_id:g,content:O});continue}const C=await P.function(b,this),A=B(this,lt,"m",Ex).call(this,C);if(this._addMessage({role:s,tool_call_id:g,content:A}),l)return}}}}lt=new WeakSet,gu=function(){return B(this,lt,"m",ja).call(this).content??null},ja=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Ea(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new re("stream ended without producing a ChatCompletionMessage with role=assistant")},yu=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Ea(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.filter(i=>i.type==="function").at(-1))==null?void 0:n.function}},xu=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(_x(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},bu=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},Cx=function(e){if(e.n!=null&&e.n>1)throw new re("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ex=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Bd extends Px{static runTools(e,n,r){const s=new Bd,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),Ea(e)&&e.content&&this._emit("content",e.content)}}const Ax=1,jx=2,Nx=4,Tx=8,Rx=16,Ox=32,Ix=64,Mx=128,Dx=256,Lx=Mx|Dx,$x=Rx|Ox|Lx|Ix,Fx=Ax|jx|$x,Ux=Nx|Tx,aN=Fx|Ux,ze={STR:Ax,NUM:jx,ARR:Nx,OBJ:Tx,NULL:Rx,BOOL:Ox,NAN:Ix,INFINITY:Mx,MINUS_INFINITY:Dx,INF:Lx,SPECIAL:$x,ATOM:Fx,COLLECTION:Ux,ALL:aN};class lN extends Error{}class cN extends Error{}function uN(t,e=ze.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return dN(t.trim(),e)}const dN=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new lN(`${f} at position ${r}`)},i=f=>{throw new cN(`${f} at position ${r}`)},o=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?a():t[r]==="{"?l():t[r]==="["?c():t.substring(r,r+4)==="null"||ze.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||ze.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||ze.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||ze.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||ze.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||ze.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):u()),a=()=>{const f=r;let p=!1;for(r++;r<n&&(t[r]!=='"'||p&&t[r-1]==="\\");)p=t[r]==="\\"?!p:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(p)))}catch(m){i(String(m))}else if(ze.STR&e)try{return JSON.parse(t.substring(f,r-Number(p))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&ze.OBJ&e)return f;const p=a();h(),r++;try{const m=o();Object.defineProperty(f,p,{value:m,writable:!0,enumerable:!0,configurable:!0})}catch(m){if(ze.OBJ&e)return f;throw m}h(),t[r]===","&&r++}}catch{if(ze.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},c=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(o()),h(),t[r]===","&&r++}catch{if(ze.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},u=()=>{if(r===0){t==="-"&&ze.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(p){if(ze.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(p))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(ze.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&ze.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(m){i(String(m))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},Op=t=>uN(t,ze.ALL^ze.NUM);var Fe,fn,Ur,jn,sc,yo,ic,oc,ac,xo,lc,Ip;class Ai extends Px{constructor(e){super(),Fe.add(this),fn.set(this,void 0),Ur.set(this,void 0),jn.set(this,void 0),ae(this,fn,e),ae(this,Ur,[])}get currentChatCompletionSnapshot(){return B(this,jn,"f")}static fromReadableStream(e){const n=new Ai(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Ai(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),B(this,Fe,"m",sc).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const a of i)B(this,Fe,"m",ic).call(this,a);if((o=i.controller.signal)!=null&&o.aborted)throw new jt;return this._addChatCompletion(B(this,Fe,"m",xo).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),B(this,Fe,"m",sc).call(this),this._connected();const s=tn.fromReadableStream(e,this.controller);let i;for await(const a of s)i&&i!==a.id&&this._addChatCompletion(B(this,Fe,"m",xo).call(this)),B(this,Fe,"m",ic).call(this,a),i=a.id;if((o=s.controller.signal)!=null&&o.aborted)throw new jt;return this._addChatCompletion(B(this,Fe,"m",xo).call(this))}[(fn=new WeakMap,Ur=new WeakMap,jn=new WeakMap,Fe=new WeakSet,sc=function(){this.ended||ae(this,jn,void 0)},yo=function(n){let r=B(this,Ur,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},B(this,Ur,"f")[n.index]=r,r)},ic=function(n){var s,i,o,a,l,c,u,h,f,p,m,y,v,S,E;if(this.ended)return;const r=B(this,Fe,"m",Ip).call(this,n);this._emit("chunk",n,r);for(const k of n.choices){const g=r.choices[k.index];k.delta.content!=null&&((s=g.message)==null?void 0:s.role)==="assistant"&&((i=g.message)!=null&&i.content)&&(this._emit("content",k.delta.content,g.message.content),this._emit("content.delta",{delta:k.delta.content,snapshot:g.message.content,parsed:g.message.parsed})),k.delta.refusal!=null&&((o=g.message)==null?void 0:o.role)==="assistant"&&((a=g.message)!=null&&a.refusal)&&this._emit("refusal.delta",{delta:k.delta.refusal,snapshot:g.message.refusal}),((l=k.logprobs)==null?void 0:l.content)!=null&&((c=g.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(u=k.logprobs)==null?void 0:u.content,snapshot:((h=g.logprobs)==null?void 0:h.content)??[]}),((f=k.logprobs)==null?void 0:f.refusal)!=null&&((p=g.message)==null?void 0:p.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(m=k.logprobs)==null?void 0:m.refusal,snapshot:((y=g.logprobs)==null?void 0:y.refusal)??[]});const w=B(this,Fe,"m",yo).call(this,g);g.finish_reason&&(B(this,Fe,"m",ac).call(this,g),w.current_tool_call_index!=null&&B(this,Fe,"m",oc).call(this,g,w.current_tool_call_index));for(const _ of k.delta.tool_calls??[])w.current_tool_call_index!==_.index&&(B(this,Fe,"m",ac).call(this,g),w.current_tool_call_index!=null&&B(this,Fe,"m",oc).call(this,g,w.current_tool_call_index)),w.current_tool_call_index=_.index;for(const _ of k.delta.tool_calls??[]){const P=(v=g.message.tool_calls)==null?void 0:v[_.index];P!=null&&P.type&&((P==null?void 0:P.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(S=P.function)==null?void 0:S.name,index:_.index,arguments:P.function.arguments,parsed_arguments:P.function.parsed_arguments,arguments_delta:((E=_.function)==null?void 0:E.arguments)??""}):(P==null||P.type,void 0))}}},oc=function(n,r){var o,a,l;if(B(this,Fe,"m",yo).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const c=(l=(a=B(this,fn,"f"))==null?void 0:a.tools)==null?void 0:l.find(u=>Ca(u)&&u.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Bi(c)?c.$parseRaw(i.function.arguments):c!=null&&c.function.strict?JSON.parse(i.function.arguments):null})}else i.type},ac=function(n){var s,i;const r=B(this,Fe,"m",yo).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=B(this,Fe,"m",lc).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},xo=function(){if(this.ended)throw new re("stream has ended, this shouldn't happen");const n=B(this,jn,"f");if(!n)throw new re("request ended without sending any chunks");return ae(this,jn,void 0),ae(this,Ur,[]),hN(n,B(this,fn,"f"))},lc=function(){var r;const n=(r=B(this,fn,"f"))==null?void 0:r.response_format;return $d(n)?n:null},Ip=function(n){var r,s,i,o;let a=B(this,jn,"f");const{choices:l,...c}=n;a?Object.assign(a,c):a=ae(this,jn,{...c,choices:[]});for(const{delta:u,finish_reason:h,index:f,logprobs:p=null,...m}of n.choices){let y=a.choices[f];if(y||(y=a.choices[f]={finish_reason:h,index:f,message:{},logprobs:p,...m}),p)if(!y.logprobs)y.logprobs=Object.assign({},p);else{const{content:_,refusal:P,...b}=p;Object.assign(y.logprobs,b),_&&((r=y.logprobs).content??(r.content=[]),y.logprobs.content.push(..._)),P&&((s=y.logprobs).refusal??(s.refusal=[]),y.logprobs.refusal.push(...P))}if(h&&(y.finish_reason=h,B(this,fn,"f")&&vx(B(this,fn,"f")))){if(h==="length")throw new nx;if(h==="content_filter")throw new rx}if(Object.assign(y,m),!u)continue;const{content:v,refusal:S,function_call:E,role:k,tool_calls:g,...w}=u;if(Object.assign(y.message,w),S&&(y.message.refusal=(y.message.refusal||"")+S),k&&(y.message.role=k),E&&(y.message.function_call?(E.name&&(y.message.function_call.name=E.name),E.arguments&&((i=y.message.function_call).arguments??(i.arguments=""),y.message.function_call.arguments+=E.arguments)):y.message.function_call=E),v&&(y.message.content=(y.message.content||"")+v,!y.message.refusal&&B(this,Fe,"m",lc).call(this)&&(y.message.parsed=Op(y.message.content))),g){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:_,id:P,type:b,function:C,...A}of g){const N=(o=y.message.tool_calls)[_]??(o[_]={});Object.assign(N,A),P&&(N.id=P),b&&(N.type=b),C&&(N.function??(N.function={name:C.name??"",arguments:""})),C!=null&&C.name&&(N.function.name=C.name),C!=null&&C.arguments&&(N.function.arguments+=C.arguments,rN(B(this,fn,"f"),N)&&(N.function.parsed_arguments=Op(N.function.arguments)))}}}return a},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new tn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function hN(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...a}=t,l={...a,id:n,choices:r.map(({message:c,finish_reason:u,index:h,logprobs:f,...p})=>{if(!u)throw new re(`missing finish_reason for choice ${h}`);const{content:m=null,function_call:y,tool_calls:v,...S}=c,E=c.role;if(!E)throw new re(`missing role for choice ${h}`);if(y){const{arguments:k,name:g}=y;if(k==null)throw new re(`missing function_call.arguments for choice ${h}`);if(!g)throw new re(`missing function_call.name for choice ${h}`);return{...p,message:{content:m,function_call:{arguments:k,name:g},role:E,refusal:c.refusal??null},finish_reason:u,index:h,logprobs:f}}return v?{...p,index:h,finish_reason:u,logprobs:f,message:{...S,role:E,content:m,refusal:c.refusal??null,tool_calls:v.map((k,g)=>{const{function:w,type:_,id:P,...b}=k,{arguments:C,name:A,...N}=w||{};if(P==null)throw new re(`missing choices[${h}].tool_calls[${g}].id
${bo(t)}`);if(_==null)throw new re(`missing choices[${h}].tool_calls[${g}].type
${bo(t)}`);if(A==null)throw new re(`missing choices[${h}].tool_calls[${g}].function.name
${bo(t)}`);if(C==null)throw new re(`missing choices[${h}].tool_calls[${g}].function.arguments
${bo(t)}`);return{...b,id:P,type:_,function:{...N,name:A,arguments:C}}})}}:{...p,message:{...S,content:m,role:E,refusal:c.refusal??null},finish_reason:u,index:h,logprobs:f}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return eN(l,e)}function bo(t){return JSON.stringify(t)}class Na extends Ai{static fromReadableStream(e){const n=new Na(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,r){const s=new Na(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let Vd=class extends Z{constructor(){super(...arguments),this.messages=new wx(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(H`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(H`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/chat/completions",Ie,{query:e,...n})}delete(e,n){return this._client.delete(H`/chat/completions/${e}`,n)}parse(e,n){return sN(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(r=>Fd(r,e))}runTools(e,n){return e.stream?Na.runTools(this._client,e,n):Bd.runTools(this._client,e,n)}stream(e,n){return Ai.createChatCompletion(this._client,e,n)}};Vd.Messages=wx;class Wd extends Z{constructor(){super(...arguments),this.completions=new Vd(this._client)}}Wd.Completions=Vd;const Bx=Symbol("brand.privateNullableHeaders");function*fN(t){if(!t)return;if(Bx in t){const{values:r,nulls:s}=t;yield*r.entries();for(const i of s)yield[i,null];return}let e=!1,n;t instanceof Headers?n=t.entries():bp(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const i=bp(r[1])?r[1]:[r[1]];let o=!1;for(const a of i)a!==void 0&&(e&&!o&&(o=!0,yield[s,null]),yield[s,a])}}const Y=t=>{const e=new Headers,n=new Set;for(const r of t){const s=new Set;for(const[i,o]of fN(r)){const a=i.toLowerCase();s.has(a)||(e.delete(i),s.add(a)),o===null?(e.delete(i),n.add(a)):(e.append(i,o),n.delete(a))}}return{[Bx]:!0,values:e,nulls:n}};class Vx extends Z{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:Y([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class Wx extends Z{create(e,n){return this._client.post("/audio/transcriptions",kr({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class zx extends Z{create(e,n){return this._client.post("/audio/translations",kr({body:e,...n,__metadata:{model:e.model}},this._client))}}class Vi extends Z{constructor(){super(...arguments),this.transcriptions=new Wx(this._client),this.translations=new zx(this._client),this.speech=new Vx(this._client)}}Vi.Transcriptions=Wx;Vi.Translations=zx;Vi.Speech=Vx;class Hx extends Z{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(H`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",Ie,{query:e,...n})}cancel(e,n){return this._client.post(H`/batches/${e}/cancel`,n)}}class Kx extends Z{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(H`/assistants/${e}`,{...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(H`/assistants/${e}`,{body:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/assistants",Ie,{query:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(H`/assistants/${e}`,{...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let Gx=class extends Z{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}};class qx extends Z{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let ul=class extends Z{constructor(){super(...arguments),this.sessions=new Gx(this._client),this.transcriptionSessions=new qx(this._client)}};ul.Sessions=Gx;ul.TranscriptionSessions=qx;class Yx extends Z{create(e,n){return this._client.post("/chatkit/sessions",{body:e,...n,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}cancel(e,n){return this._client.post(H`/chatkit/sessions/${e}/cancel`,{...n,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}}let Jx=class extends Z{retrieve(e,n){return this._client.get(H`/chatkit/threads/${e}`,{...n,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}list(e={},n){return this._client.getAPIList("/chatkit/threads",_a,{query:e,...n,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(H`/chatkit/threads/${e}`,{...n,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}listItems(e,n={},r){return this._client.getAPIList(H`/chatkit/threads/${e}/items`,_a,{query:n,...r,headers:Y([{"OpenAI-Beta":"chatkit_beta=v1"},r==null?void 0:r.headers])})}};class dl extends Z{constructor(){super(...arguments),this.sessions=new Yx(this._client),this.threads=new Jx(this._client)}}dl.Sessions=Yx;dl.Threads=Jx;class Xx extends Z{create(e,n,r){return this._client.post(H`/threads/${e}/messages`,{body:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{thread_id:s}=n;return this._client.get(H`/threads/${s}/messages/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:s,...i}=n;return this._client.post(H`/threads/${s}/messages/${e}`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(H`/threads/${e}/messages`,Ie,{query:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{thread_id:s}=n;return this._client.delete(H`/threads/${s}/messages/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class Qx extends Z{retrieve(e,n,r){const{thread_id:s,run_id:i,...o}=n;return this._client.get(H`/threads/${s}/runs/${i}/steps/${e}`,{query:o,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n,r){const{thread_id:s,...i}=n;return this._client.getAPIList(H`/threads/${s}/runs/${e}/steps`,Ie,{query:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}const pN=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};var cc={};const Br=t=>{var e,n,r,s;if(typeof globalThis.process<"u")return((e=cc==null?void 0:cc[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(s=(r=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:s.trim()};var Qe,yr,wu,Jt,Go,Ut,xr,ss,fr,Ta,vt,qo,Yo,ui,Zs,ei,Mp,Dp,Lp,$p,Fp,Up,Bp;class di extends Ud{constructor(){super(...arguments),Qe.add(this),wu.set(this,[]),Jt.set(this,{}),Go.set(this,{}),Ut.set(this,void 0),xr.set(this,void 0),ss.set(this,void 0),fr.set(this,void 0),Ta.set(this,void 0),vt.set(this,void 0),qo.set(this,void 0),Yo.set(this,void 0),ui.set(this,void 0)}[(wu=new WeakMap,Jt=new WeakMap,Go=new WeakMap,Ut=new WeakMap,xr=new WeakMap,ss=new WeakMap,fr=new WeakMap,Ta=new WeakMap,vt=new WeakMap,qo=new WeakMap,Yo=new WeakMap,ui=new WeakMap,Qe=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new yr;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=tn.fromReadableStream(e,this.controller);for await(const o of s)B(this,Qe,"m",Zs).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new jt;return this._addRun(B(this,Qe,"m",ei).call(this))}toReadableStream(){return new tn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s){const i=new yr;return i._run(()=>i._runToolAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,n,r,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},a=await e.submitToolOutputs(n,o,{...s,signal:this.controller.signal});this._connected();for await(const c of a)B(this,Qe,"m",Zs).call(this,c);if((l=a.controller.signal)!=null&&l.aborted)throw new jt;return this._addRun(B(this,Qe,"m",ei).call(this))}static createThreadAssistantStream(e,n,r){const s=new yr;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new yr;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return B(this,qo,"f")}currentRun(){return B(this,Yo,"f")}currentMessageSnapshot(){return B(this,Ut,"f")}currentRunStepSnapshot(){return B(this,ui,"f")}async finalRunSteps(){return await this.done(),Object.values(B(this,Jt,"f"))}async finalMessages(){return await this.done(),Object.values(B(this,Go,"f"))}async finalRun(){if(await this.done(),!B(this,xr,"f"))throw Error("Final run was not received.");return B(this,xr,"f")}async _createThreadAssistantStream(e,n,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const l of o)B(this,Qe,"m",Zs).call(this,l);if((a=o.controller.signal)!=null&&a.aborted)throw new jt;return this._addRun(B(this,Qe,"m",ei).call(this))}async _createAssistantStream(e,n,r,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},a=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const c of a)B(this,Qe,"m",Zs).call(this,c);if((l=a.controller.signal)!=null&&l.aborted)throw new jt;return this._addRun(B(this,Qe,"m",ei).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(tc(i)&&tc(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!tc(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const a=o.index;if(a==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof a!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${a}`);const l=i[a];l==null?i.push(o):i[a]=this.accumulateDelta(l,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s){return await this._createToolAssistantStream(n,e,r,s)}}yr=di,Zs=function(e){if(!this.ended)switch(ae(this,qo,e),B(this,Qe,"m",Lp).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":B(this,Qe,"m",Bp).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":B(this,Qe,"m",Dp).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":B(this,Qe,"m",Mp).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ei=function(){if(this.ended)throw new re("stream has ended, this shouldn't happen");if(!B(this,xr,"f"))throw Error("Final run has not been received");return B(this,xr,"f")},Mp=function(e){const[n,r]=B(this,Qe,"m",Fp).call(this,e,B(this,Ut,"f"));ae(this,Ut,n),B(this,Go,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=B(this,ss,"f")){if(B(this,fr,"f"))switch(B(this,fr,"f").type){case"text":this._emit("textDone",B(this,fr,"f").text,B(this,Ut,"f"));break;case"image_file":this._emit("imageFileDone",B(this,fr,"f").image_file,B(this,Ut,"f"));break}ae(this,ss,s.index)}ae(this,fr,n.content[s.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(B(this,ss,"f")!==void 0){const s=e.data.content[B(this,ss,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,B(this,Ut,"f"));break;case"text":this._emit("textDone",s.text,B(this,Ut,"f"));break}}B(this,Ut,"f")&&this._emit("messageDone",e.data),ae(this,Ut,void 0)}},Dp=function(e){const n=B(this,Qe,"m",$p).call(this,e);switch(ae(this,ui,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==B(this,Ta,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(B(this,vt,"f")&&this._emit("toolCallDone",B(this,vt,"f")),ae(this,Ta,i.index),ae(this,vt,n.step_details.tool_calls[i.index]),B(this,vt,"f")&&this._emit("toolCallCreated",B(this,vt,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ae(this,ui,void 0),e.data.step_details.type=="tool_calls"&&B(this,vt,"f")&&(this._emit("toolCallDone",B(this,vt,"f")),ae(this,vt,void 0)),this._emit("runStepDone",e.data,n);break}},Lp=function(e){B(this,wu,"f").push(e),this._emit("event",e)},$p=function(e){switch(e.event){case"thread.run.step.created":return B(this,Jt,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=B(this,Jt,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=yr.accumulateDelta(n,r.delta);B(this,Jt,"f")[e.data.id]=s}return B(this,Jt,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":B(this,Jt,"f")[e.data.id]=e.data;break}if(B(this,Jt,"f")[e.data.id])return B(this,Jt,"f")[e.data.id];throw new Error("No snapshot available")},Fp=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=B(this,Qe,"m",Up).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Up=function(e,n){return yr.accumulateDelta(n,e)},Bp=function(e){switch(ae(this,Yo,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":ae(this,xr,e.data),B(this,vt,"f")&&(this._emit("toolCallDone",B(this,vt,"f")),ae(this,vt,void 0));break}};let zd=class extends Z{constructor(){super(...arguments),this.steps=new Qx(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(H`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}retrieve(e,n,r){const{thread_id:s}=n;return this._client.get(H`/threads/${s}/runs/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:s,...i}=n;return this._client.post(H`/threads/${s}/runs/${e}`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(H`/threads/${e}/runs`,Ie,{query:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{thread_id:s}=n;return this._client.post(H`/threads/${s}/runs/${e}/cancel`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(s.id,{thread_id:e},r)}createAndStream(e,n,r){return di.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){var i;const s=Y([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:a}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=a.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Ui(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,n,r){return di.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r){const{thread_id:s,...i}=n;return this._client.post(H`/threads/${s}/runs/${e}/submit_tool_outputs`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,r){const s=await this.submitToolOutputs(e,n,r);return await this.poll(s.id,n,r)}submitToolOutputsStream(e,n,r){return di.createToolAssistantStream(e,this._client.beta.threads.runs,n,r)}};zd.Steps=Qx;class hl extends Z{constructor(){super(...arguments),this.runs=new zd(this._client),this.messages=new Xx(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(H`/threads/${e}`,{...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(H`/threads/${e}`,{body:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n){return this._client.delete(H`/threads/${e}`,{...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.id,{thread_id:r.thread_id},n)}createAndRunStream(e,n){return di.createThreadAssistantStream(e,this._client.beta.threads,n)}}hl.Runs=zd;hl.Messages=Xx;class As extends Z{constructor(){super(...arguments),this.realtime=new ul(this._client),this.chatkit=new dl(this._client),this.assistants=new Kx(this._client),this.threads=new hl(this._client)}}As.Realtime=ul;As.ChatKit=dl;As.Assistants=Kx;As.Threads=hl;class Zx extends Z{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let eb=class extends Z{retrieve(e,n,r){const{container_id:s}=n;return this._client.get(H`/containers/${s}/files/${e}/content`,{...r,headers:Y([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}},Hd=class extends Z{constructor(){super(...arguments),this.content=new eb(this._client)}create(e,n,r){return this._client.post(H`/containers/${e}/files`,kr({body:n,...r},this._client))}retrieve(e,n,r){const{container_id:s}=n;return this._client.get(H`/containers/${s}/files/${e}`,r)}list(e,n={},r){return this._client.getAPIList(H`/containers/${e}/files`,Ie,{query:n,...r})}delete(e,n,r){const{container_id:s}=n;return this._client.delete(H`/containers/${s}/files/${e}`,{...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}};Hd.Content=eb;class Kd extends Z{constructor(){super(...arguments),this.files=new Hd(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(H`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",Ie,{query:e,...n})}delete(e,n){return this._client.delete(H`/containers/${e}`,{...n,headers:Y([{Accept:"*/*"},n==null?void 0:n.headers])})}}Kd.Files=Hd;class tb extends Z{create(e,n,r){const{include:s,...i}=n;return this._client.post(H`/conversations/${e}/items`,{query:{include:s},body:i,...r})}retrieve(e,n,r){const{conversation_id:s,...i}=n;return this._client.get(H`/conversations/${s}/items/${e}`,{query:i,...r})}list(e,n={},r){return this._client.getAPIList(H`/conversations/${e}/items`,_a,{query:n,...r})}delete(e,n,r){const{conversation_id:s}=n;return this._client.delete(H`/conversations/${s}/items/${e}`,r)}}class Gd extends Z{constructor(){super(...arguments),this.items=new tb(this._client)}create(e={},n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(H`/conversations/${e}`,n)}update(e,n,r){return this._client.post(H`/conversations/${e}`,{body:n,...r})}delete(e,n){return this._client.delete(H`/conversations/${e}`,n)}}Gd.Items=tb;class nb extends Z{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&Je(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?i:(Je(this._client).debug("embeddings/decoding base64 embeddings from base64"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(a=>{const l=a.embedding;a.embedding=pN(l)}),o)))}}class rb extends Z{retrieve(e,n,r){const{eval_id:s,run_id:i}=n;return this._client.get(H`/evals/${s}/runs/${i}/output_items/${e}`,r)}list(e,n,r){const{eval_id:s,...i}=n;return this._client.getAPIList(H`/evals/${s}/runs/${e}/output_items`,Ie,{query:i,...r})}}class qd extends Z{constructor(){super(...arguments),this.outputItems=new rb(this._client)}create(e,n,r){return this._client.post(H`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){const{eval_id:s}=n;return this._client.get(H`/evals/${s}/runs/${e}`,r)}list(e,n={},r){return this._client.getAPIList(H`/evals/${e}/runs`,Ie,{query:n,...r})}delete(e,n,r){const{eval_id:s}=n;return this._client.delete(H`/evals/${s}/runs/${e}`,r)}cancel(e,n,r){const{eval_id:s}=n;return this._client.post(H`/evals/${s}/runs/${e}`,r)}}qd.OutputItems=rb;class Yd extends Z{constructor(){super(...arguments),this.runs=new qd(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(H`/evals/${e}`,n)}update(e,n,r){return this._client.post(H`/evals/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/evals",Ie,{query:e,...n})}delete(e,n){return this._client.delete(H`/evals/${e}`,n)}}Yd.Runs=qd;let sb=class extends Z{create(e,n){return this._client.post("/files",kr({body:e,...n},this._client))}retrieve(e,n){return this._client.get(H`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",Ie,{query:e,...n})}delete(e,n){return this._client.delete(H`/files/${e}`,n)}content(e,n){return this._client.get(H`/files/${e}/content`,{...n,headers:Y([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=1800*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await Ui(n),o=await this.retrieve(e),Date.now()-i>r)throw new Id({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class ib extends Z{}let ob=class extends Z{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class Jd extends Z{constructor(){super(...arguments),this.graders=new ob(this._client)}}Jd.Graders=ob;class ab extends Z{create(e,n,r){return this._client.getAPIList(H`/fine_tuning/checkpoints/${e}/permissions`,cl,{body:n,method:"post",...r})}retrieve(e,n={},r){return this._client.get(H`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}delete(e,n,r){const{fine_tuned_model_checkpoint:s}=n;return this._client.delete(H`/fine_tuning/checkpoints/${s}/permissions/${e}`,r)}}let Xd=class extends Z{constructor(){super(...arguments),this.permissions=new ab(this._client)}};Xd.Permissions=ab;class lb extends Z{list(e,n={},r){return this._client.getAPIList(H`/fine_tuning/jobs/${e}/checkpoints`,Ie,{query:n,...r})}}class Qd extends Z{constructor(){super(...arguments),this.checkpoints=new lb(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(H`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",Ie,{query:e,...n})}cancel(e,n){return this._client.post(H`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return this._client.getAPIList(H`/fine_tuning/jobs/${e}/events`,Ie,{query:n,...r})}pause(e,n){return this._client.post(H`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(H`/fine_tuning/jobs/${e}/resume`,n)}}Qd.Checkpoints=lb;class js extends Z{constructor(){super(...arguments),this.methods=new ib(this._client),this.jobs=new Qd(this._client),this.checkpoints=new Xd(this._client),this.alpha=new Jd(this._client)}}js.Methods=ib;js.Jobs=Qd;js.Checkpoints=Xd;js.Alpha=Jd;class cb extends Z{}class Zd extends Z{constructor(){super(...arguments),this.graderModels=new cb(this._client)}}Zd.GraderModels=cb;class ub extends Z{createVariation(e,n){return this._client.post("/images/variations",kr({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",kr({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class db extends Z{retrieve(e,n){return this._client.get(H`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",cl,e)}delete(e,n){return this._client.delete(H`/models/${e}`,n)}}class hb extends Z{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class fb extends Z{accept(e,n,r){return this._client.post(H`/realtime/calls/${e}/accept`,{body:n,...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}hangup(e,n){return this._client.post(H`/realtime/calls/${e}/hangup`,{...n,headers:Y([{Accept:"*/*"},n==null?void 0:n.headers])})}refer(e,n,r){return this._client.post(H`/realtime/calls/${e}/refer`,{body:n,...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}reject(e,n={},r){return this._client.post(H`/realtime/calls/${e}/reject`,{body:n,...r,headers:Y([{Accept:"*/*"},r==null?void 0:r.headers])})}}class pb extends Z{create(e,n){return this._client.post("/realtime/client_secrets",{body:e,...n})}}class fl extends Z{constructor(){super(...arguments),this.clientSecrets=new pb(this._client),this.calls=new fb(this._client)}}fl.ClientSecrets=pb;fl.Calls=fb;function mN(t,e){return!e||!yN(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:mb(t,e)}function mb(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:wN(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:gN(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||vu(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function gN(t,e){var n,r,s,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function yN(t){var e;return!!$d((e=t.text)==null?void 0:e.format)}function xN(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function bN(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function wN(t,e){const n=bN(t.tools??[],e.name);return{...e,...e,parsed_arguments:xN(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function vu(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}var Vr,wo,Nn,vo,Vp,Wp,zp,Hp;class eh extends Ud{constructor(e){super(),Vr.add(this),wo.set(this,void 0),Nn.set(this,void 0),vo.set(this,void 0),ae(this,wo,e)}static createResponse(e,n,r){const s=new eh(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var a;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),B(this,Vr,"m",Vp).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const l of i)B(this,Vr,"m",Wp).call(this,l,o);if((a=i.controller.signal)!=null&&a.aborted)throw new jt;return B(this,Vr,"m",zp).call(this)}[(wo=new WeakMap,Nn=new WeakMap,vo=new WeakMap,Vr=new WeakSet,Vp=function(){this.ended||ae(this,Nn,void 0)},Wp=function(n,r){if(this.ended)return;const s=(o,a)=>{(r==null||a.sequence_number>r)&&this._emit(o,a)},i=B(this,Vr,"m",Hp).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new re(`missing output at index ${n.output_index}`);if(o.type==="message"){const a=o.content[n.content_index];if(!a)throw new re(`missing content at index ${n.content_index}`);if(a.type!=="output_text")throw new re(`expected content to be 'output_text', got ${a.type}`);s("response.output_text.delta",{...n,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new re(`missing output at index ${n.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:s(n.type,n);break}},zp=function(){if(this.ended)throw new re("stream has ended, this shouldn't happen");const n=B(this,Nn,"f");if(!n)throw new re("request ended without sending any events");ae(this,Nn,void 0);const r=vN(n,B(this,wo,"f"));return ae(this,vo,r),r},Hp=function(n){var s;let r=B(this,Nn,"f");if(!r){if(n.type!=="response.created")throw new re(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=ae(this,Nn,n.response),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const i=r.output[n.output_index];if(!i)throw new re(`missing output at index ${n.output_index}`);const o=i.type,a=n.part;o==="message"&&a.type!=="reasoning_text"?i.content.push(a):o==="reasoning"&&a.type==="reasoning_text"&&(i.content||(i.content=[]),i.content.push(a));break}case"response.output_text.delta":{const i=r.output[n.output_index];if(!i)throw new re(`missing output at index ${n.output_index}`);if(i.type==="message"){const o=i.content[n.content_index];if(!o)throw new re(`missing content at index ${n.content_index}`);if(o.type!=="output_text")throw new re(`expected content to be 'output_text', got ${o.type}`);o.text+=n.delta}break}case"response.function_call_arguments.delta":{const i=r.output[n.output_index];if(!i)throw new re(`missing output at index ${n.output_index}`);i.type==="function_call"&&(i.arguments+=n.delta);break}case"response.reasoning_text.delta":{const i=r.output[n.output_index];if(!i)throw new re(`missing output at index ${n.output_index}`);if(i.type==="reasoning"){const o=(s=i.content)==null?void 0:s[n.content_index];if(!o)throw new re(`missing content at index ${n.content_index}`);if(o.type!=="reasoning_text")throw new re(`expected content to be 'reasoning_text', got ${o.type}`);o.text+=n.delta}break}case"response.completed":{ae(this,Nn,n.response);break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=B(this,vo,"f");if(!e)throw new re("stream ended without producing a ChatCompletion");return e}}function vN(t,e){return mN(t,e)}class gb extends Z{list(e,n={},r){return this._client.getAPIList(H`/responses/${e}/input_items`,Ie,{query:n,...r})}}class yb extends Z{count(e={},n){return this._client.post("/responses/input_tokens",{body:e,...n})}}class pl extends Z{constructor(){super(...arguments),this.inputItems=new gb(this._client),this.inputTokens=new yb(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&vu(r),r))}retrieve(e,n={},r){return this._client.get(H`/responses/${e}`,{query:n,...r,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&vu(s),s))}delete(e,n){return this._client.delete(H`/responses/${e}`,{...n,headers:Y([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>mb(r,e))}stream(e,n){return eh.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(H`/responses/${e}/cancel`,n)}compact(e,n){return this._client.post("/responses/compact",{body:e,...n})}}pl.InputItems=gb;pl.InputTokens=yb;let xb=class extends Z{retrieve(e,n){return this._client.get(H`/skills/${e}/content`,{...n,headers:Y([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}},bb=class extends Z{retrieve(e,n,r){const{skill_id:s}=n;return this._client.get(H`/skills/${s}/versions/${e}/content`,{...r,headers:Y([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}};class th extends Z{constructor(){super(...arguments),this.content=new bb(this._client)}create(e,n={},r){return this._client.post(H`/skills/${e}/versions`,ka({body:n,...r},this._client))}retrieve(e,n,r){const{skill_id:s}=n;return this._client.get(H`/skills/${s}/versions/${e}`,r)}list(e,n={},r){return this._client.getAPIList(H`/skills/${e}/versions`,Ie,{query:n,...r})}delete(e,n,r){const{skill_id:s}=n;return this._client.delete(H`/skills/${s}/versions/${e}`,r)}}th.Content=bb;class ml extends Z{constructor(){super(...arguments),this.content=new xb(this._client),this.versions=new th(this._client)}create(e={},n){return this._client.post("/skills",ka({body:e,...n},this._client))}retrieve(e,n){return this._client.get(H`/skills/${e}`,n)}update(e,n,r){return this._client.post(H`/skills/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/skills",Ie,{query:e,...n})}delete(e,n){return this._client.delete(H`/skills/${e}`,n)}}ml.Content=xb;ml.Versions=th;class wb extends Z{create(e,n,r){return this._client.post(H`/uploads/${e}/parts`,kr({body:n,...r},this._client))}}class nh extends Z{constructor(){super(...arguments),this.parts=new wb(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(H`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(H`/uploads/${e}/complete`,{body:n,...r})}}nh.Parts=wb;const SN=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class vb extends Z{create(e,n,r){return this._client.post(H`/vector_stores/${e}/file_batches`,{body:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:s}=n;return this._client.get(H`/vector_stores/${s}/file_batches/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{vector_store_id:s}=n;return this._client.post(H`/vector_stores/${s}/file_batches/${e}/cancel`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r){const{vector_store_id:s,...i}=n;return this._client.getAPIList(H`/vector_stores/${s}/file_batches/${e}/files`,Ie,{query:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async poll(e,n,r){var i;const s=Y([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:a}=await this.retrieve(n,{vector_store_id:e},{...r,headers:s}).withResponse();switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=a.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Ui(l);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),a=this._client,l=n.values(),c=[...r];async function u(f){for(let p of f){const m=await a.files.create({file:p,purpose:"assistants"},s);c.push(m.id)}}const h=Array(o).fill(l).map(u);return await SN(h),await this.createAndPoll(e,{file_ids:c})}}class Sb extends Z{create(e,n,r){return this._client.post(H`/vector_stores/${e}/files`,{body:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:s}=n;return this._client.get(H`/vector_stores/${s}/files/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{vector_store_id:s,...i}=n;return this._client.post(H`/vector_stores/${s}/files/${e}`,{body:i,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(H`/vector_stores/${e}/files`,Ie,{query:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{vector_store_id:s}=n;return this._client.delete(H`/vector_stores/${s}/files/${e}`,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){var i;const s=Y([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const o=await this.retrieve(n,{vector_store_id:e},{...r,headers:s}).withResponse(),a=o.data;switch(a.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await Ui(l);break;case"failed":case"completed":return a}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){const{vector_store_id:s}=n;return this._client.getAPIList(H`/vector_stores/${s}/files/${e}/content`,cl,{...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class gl extends Z{constructor(){super(...arguments),this.files=new Sb(this._client),this.fileBatches=new vb(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(H`/vector_stores/${e}`,{...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(H`/vector_stores/${e}`,{body:n,...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",Ie,{query:e,...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(H`/vector_stores/${e}`,{...n,headers:Y([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,r){return this._client.getAPIList(H`/vector_stores/${e}/search`,cl,{body:n,method:"post",...r,headers:Y([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}gl.Files=Sb;gl.FileBatches=vb;class _b extends Z{create(e,n){return this._client.post("/videos",ka({body:e,...n},this._client))}retrieve(e,n){return this._client.get(H`/videos/${e}`,n)}list(e={},n){return this._client.getAPIList("/videos",_a,{query:e,...n})}delete(e,n){return this._client.delete(H`/videos/${e}`,n)}downloadContent(e,n={},r){return this._client.get(H`/videos/${e}/content`,{query:n,...r,headers:Y([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}remix(e,n,r){return this._client.post(H`/videos/${e}/remix`,ka({body:n,...r},this._client))}}var es,kb,Jo;class Cb extends Z{constructor(){super(...arguments),es.add(this)}async unwrap(e,n,r=this._client.webhookSecret,s=300){return await this.verifySignature(e,n,r,s),JSON.parse(e)}async verifySignature(e,n,r=this._client.webhookSecret,s=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");B(this,es,"m",kb).call(this,r);const i=Y([n]).values,o=B(this,es,"m",Jo).call(this,i,"webhook-signature"),a=B(this,es,"m",Jo).call(this,i,"webhook-timestamp"),l=B(this,es,"m",Jo).call(this,i,"webhook-id"),c=parseInt(a,10);if(isNaN(c))throw new Ks("Invalid webhook timestamp format");const u=Math.floor(Date.now()/1e3);if(u-c>s)throw new Ks("Webhook timestamp is too old");if(c>u+s)throw new Ks("Webhook timestamp is too new");const h=o.split(" ").map(y=>y.startsWith("v1,")?y.substring(3):y),f=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),p=l?`${l}.${a}.${e}`:`${a}.${e}`,m=await crypto.subtle.importKey("raw",f,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const y of h)try{const v=Buffer.from(y,"base64");if(await crypto.subtle.verify("HMAC",m,v,new TextEncoder().encode(p)))return}catch{continue}throw new Ks("The given webhook signature does not match the expected signature")}}es=new WeakSet,kb=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Jo=function(e,n){if(!e)throw new Error("Headers are required");const r=e.get(n);if(r==null)throw new Error(`Missing required header: ${n}`);return r};var Su,rh,Xo,Eb;class de{constructor({baseURL:e=Br("OPENAI_BASE_URL"),apiKey:n=Br("OPENAI_API_KEY"),organization:r=Br("OPENAI_ORG_ID")??null,project:s=Br("OPENAI_PROJECT_ID")??null,webhookSecret:i=Br("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(Su.add(this),Xo.set(this,void 0),this.completions=new Zx(this),this.chat=new Wd(this),this.embeddings=new nb(this),this.files=new sb(this),this.images=new ub(this),this.audio=new Vi(this),this.moderations=new hb(this),this.models=new db(this),this.fineTuning=new js(this),this.graders=new Zd(this),this.vectorStores=new gl(this),this.webhooks=new Cb(this),this.beta=new As(this),this.batches=new Hx(this),this.uploads=new nh(this),this.responses=new pl(this),this.realtime=new fl(this),this.conversations=new Gd(this),this.evals=new Yd(this),this.containers=new Kd(this),this.skills=new ml(this),this.videos=new _b(this),n===void 0)throw new re("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const a={apiKey:n,organization:r,project:s,webhookSecret:i,...o,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&kj())throw new re(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=a.baseURL,this.timeout=a.timeout??rh.DEFAULT_TIMEOUT,this.logger=a.logger??console;const l="warn";this.logLevel=l,this.logLevel=jp(a.logLevel,"ClientOptions.logLevel",this)??jp(Br("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??l,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??jj(),ae(this,Xo,Tj),this._options=a,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=r,this.project=s,this.webhookSecret=i}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return Y([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return Lj(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Qr}`}defaultIdempotencyKey(){return`stainless-node-retry-${Gy()}`}makeStatusError(e,n,r,s){return et.generate(e,n,r,s)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let n;try{n=await e()}catch(r){throw r instanceof re?r:new re(`Failed to get token from 'apiKey' function: ${r.message}`,{cause:r})}if(typeof n!="string"||!n)throw new re(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(e,n,r){const s=!B(this,Su,"m",Eb).call(this)&&r||this.baseURL,i=bj(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return wj(o)||(n={...o,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(s=>({method:e,path:n,...s})))}request(e,n=null){return new ll(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var S,E;const s=await e,i=s.maxRetries??this.maxRetries;n==null&&(n=i),await this.prepareOptions(s);const{req:o,url:a,timeout:l}=await this.buildRequest(s,{retryCount:i-n});await this.prepareRequest(o,{url:a,options:s});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),u=r===void 0?"":`, retryOf: ${r}`,h=Date.now();if(Je(this).debug(`[${c}] sending request`,cr({retryOfRequestLogID:r,method:s.method,url:a,options:s,headers:o.headers})),(S=s.signal)!=null&&S.aborted)throw new jt;const f=new AbortController,p=await this.fetchWithTimeout(a,o,l,f).catch(uu),m=Date.now();if(p instanceof globalThis.Error){const k=`retrying, ${n} attempts remaining`;if((E=s.signal)!=null&&E.aborted)throw new jt;const g=cu(p)||/timed? ?out/i.test(String(p)+("cause"in p?String(p.cause):""));if(n)return Je(this).info(`[${c}] connection ${g?"timed out":"failed"} - ${k}`),Je(this).debug(`[${c}] connection ${g?"timed out":"failed"} (${k})`,cr({retryOfRequestLogID:r,url:a,durationMs:m-h,message:p.message})),this.retryRequest(s,n,r??c);throw Je(this).info(`[${c}] connection ${g?"timed out":"failed"} - error; no more retries left`),Je(this).debug(`[${c}] connection ${g?"timed out":"failed"} (error; no more retries left)`,cr({retryOfRequestLogID:r,url:a,durationMs:m-h,message:p.message})),g?new Id:new ol({cause:p})}const y=[...p.headers.entries()].filter(([k])=>k==="x-request-id").map(([k,g])=>", "+k+": "+JSON.stringify(g)).join(""),v=`[${c}${u}${y}] ${o.method} ${a} ${p.ok?"succeeded":"failed"} with status ${p.status} in ${m-h}ms`;if(!p.ok){const k=await this.shouldRetry(p);if(n&&k){const C=`retrying, ${n} attempts remaining`;return await Nj(p.body),Je(this).info(`${v} - ${C}`),Je(this).debug(`[${c}] response error (${C})`,cr({retryOfRequestLogID:r,url:p.url,status:p.status,headers:p.headers,durationMs:m-h})),this.retryRequest(s,n,r??c,p.headers)}const g=k?"error; no more retries left":"error; not retryable";Je(this).info(`${v} - ${g}`);const w=await p.text().catch(C=>uu(C).message),_=_j(w),P=_?void 0:w;throw Je(this).debug(`[${c}] response error (${g})`,cr({retryOfRequestLogID:r,url:p.url,status:p.status,headers:p.headers,message:P,durationMs:Date.now()-h})),this.makeStatusError(p.status,_,P,p.headers)}return Je(this).info(v),Je(this).debug(`[${c}] response start`,cr({retryOfRequestLogID:r,url:p.url,status:p.status,headers:p.headers,durationMs:m-h})),{response:p,options:s,controller:f,requestLogID:c,retryOfRequestLogID:r,startTime:h}}getAPIList(e,n,r){return this.requestAPIList(n,r&&"then"in r?r.then(s=>({method:"get",path:e,...s})):{method:"get",path:e,...r})}requestAPIList(e,n){const r=this.makeRequest(n,null,void 0);return new Kj(this,r,e)}async fetchWithTimeout(e,n,r,s){const{signal:i,method:o,...a}=n||{},l=this._makeAbort(s);i&&i.addEventListener("abort",l,{once:!0});const c=setTimeout(l,r),u=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,h={signal:s.signal,...u?{duplex:"half"}:{},method:"GET",...a};o&&(h.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(c)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,s){let i;const o=s==null?void 0:s.get("retry-after-ms");if(o){const l=parseFloat(o);Number.isNaN(l)||(i=l)}const a=s==null?void 0:s.get("retry-after");if(a&&!i){const l=parseFloat(a);Number.isNaN(l)?i=Date.parse(a)-Date.now():i=l*1e3}if(!(i&&0<=i&&i<60*1e3)){const l=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,l)}return await Ui(i),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),a=1-Math.random()*.25;return o*a*1e3}async buildRequest(e,{retryCount:n=0}={}){const r={...e},{method:s,path:i,query:o,defaultBaseURL:a}=r,l=this.buildURL(i,o,a);"timeout"in r&&Sj("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:c,body:u}=this.buildBody({options:r}),h=await this.buildHeaders({options:e,method:s,bodyHeaders:c,retryCount:n});return{req:{method:s,headers:h,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&u instanceof globalThis.ReadableStream&&{duplex:"half"},...u&&{body:u},...this.fetchOptions??{},...r.fetchOptions??{}},url:l,timeout:r.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:s}){let i={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const o=Y([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...Aj(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(o),o.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=Y([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:ox(e)}:B(this,Xo,"f").call(this,{body:e,headers:r})}}rh=de,Xo=new WeakMap,Su=new WeakSet,Eb=function(){return this.baseURL!=="https://api.openai.com/v1"};de.OpenAI=rh;de.DEFAULT_TIMEOUT=6e5;de.OpenAIError=re;de.APIError=et;de.APIConnectionError=ol;de.APIConnectionTimeoutError=Id;de.APIUserAbortError=jt;de.NotFoundError=Xy;de.ConflictError=Qy;de.RateLimitError=ex;de.BadRequestError=qy;de.AuthenticationError=Yy;de.InternalServerError=tx;de.PermissionDeniedError=Jy;de.UnprocessableEntityError=Zy;de.InvalidWebhookSignatureError=Ks;de.toFile=Xj;de.Completions=Zx;de.Chat=Wd;de.Embeddings=nb;de.Files=sb;de.Images=ub;de.Audio=Vi;de.Moderations=hb;de.Models=db;de.FineTuning=js;de.Graders=Zd;de.VectorStores=gl;de.Webhooks=Cb;de.Beta=As;de.Batches=Hx;de.Uploads=nh;de.Responses=pl;de.Realtime=fl;de.Conversations=Gd;de.Evals=Yd;de.Containers=Kd;de.Skills=ml;de.Videos=_b;class _N{constructor(e){this.openai=null,this.apiKey="";const n=e||void 0;n&&this.init(n)}init(e){this.apiKey=e;try{this.openai=new de({apiKey:e,baseURL:"https://dashscope.aliyuncs.com/compatible-mode/v1",dangerouslyAllowBrowser:!0})}catch(n){console.error("Failed to initialize AI Service:",n),this.openai=null}}isConfigured(){return!!this.openai}hasGlobalKey(){return!1}async generateResponse(e,n,r){if(!this.openai)return"Please configure your Qwen API Key first.";const s=n.sort((a,l)=>new Date(l.date).getTime()-new Date(a.date).getTime()).slice(0,15).map(a=>{var l;return{date:new Date(a.date).toLocaleDateString(),mood:a.mood,content:a.caption,tags:(l=a.tags)==null?void 0:l.join(", ")}}),i=`
      You are "Photo Diary AI", a warm, empathetic, and insightful personal memory assistant.
      Your goal is to help the user reflect on their life, find patterns in their moods, and cherish their memories.
      
      CORE PERSONALITY:
      - Warm & Supportive: Like a close friend who knows you well.
      - Insightful: Connect dots between past and present events.
      - Gentle: If the user is sad, be comforting. If happy, celebrate with them.
      - Concise: Keep answers under 150 words unless asked for a detailed story.

      CONTEXT AWARENESS:
      - You have access to the user's recent diary entries (provided in the prompt).
      - Use specific dates and details from their diary to make your answers personal.
      - If the user asks about something NOT in the diary, politely say you don't recall that memory but ask them to tell you about it.

      LANGUAGE:
      - Detect the language of the user's query (Chinese/English/Japanese/Korean).
      - Reply in the SAME language as the user.
      - If replying in Chinese, use a natural, modern, and warm tone (e.g. "...", "...").
    `,o=`
      [User's Recent Memories]
      ${JSON.stringify(s,null,2)}

      [Current Context]
      User's Current Mood: ${r||"Unknown"}
      User's Query: "${e}"
    `;try{return console.log("Calling Qwen API..."),(await this.openai.chat.completions.create({model:"qwen-turbo",messages:[{role:"system",content:i},{role:"user",content:o}]})).choices[0].message.content||"I'm thinking..."}catch(a){return console.error("AI Service Error:",a),"I'm having trouble connecting to Qwen right now. Please check your API Key or network."}}}const Tn=new _N;function kN({entries:t,isOpen:e,onClose:n}){const{t:r}=Pe(),[s,i]=x.useState([{id:"1",role:"ai",content:`
""  ""`,timestamp:new Date}]),[o,a]=x.useState(""),[l,c]=x.useState(!1),[u,h]=x.useState(!1),[f,p]=x.useState("sk-ba2aac9abdff40f183af300ae493eb93"),m=x.useRef(null);x.useEffect(()=>{const k=localStorage.getItem("qwen_api_key");k?(p(k),Tn.init(k)):Tn.init("sk-ba2aac9abdff40f183af300ae493eb93")},[]),x.useEffect(()=>{y()},[s]);const y=()=>{var k;(k=m.current)==null||k.scrollIntoView({behavior:"smooth"})},v=()=>{f.trim()&&(localStorage.setItem("qwen_api_key",f),Tn.init(f),h(!1),i(k=>[...k,{id:Date.now().toString(),role:"ai",content:"API Key  (Qwen) ",timestamp:new Date}]))},S=async()=>{if(!o.trim())return;const k={id:Date.now().toString(),role:"user",content:o,timestamp:new Date};i(g=>[...g,k]),a(""),c(!0);try{let g="",w,_;const P=k.content.toLowerCase();if(P.includes("music")||P.includes("song")||P.includes("playlist"))if(t.length>0){const C=t[0],A=yj(C.mood);g=`Based on your latest memory ("${C.mood}"), here is a playlist for you:`,_=A,w=C.id}else g="Record a memory first, and I'll curate a playlist for you!";else if(Tn.isConfigured())g=await Tn.generateResponse(k.content,t);else{const C=E(k.content,t);g=C.content,w=C.relatedEntryId}const b={id:(Date.now()+1).toString(),role:"ai",content:g,timestamp:new Date,relatedEntryId:w,recommendations:_};i(C=>[...C,b])}catch(g){console.error("Chat Error:",g),i(w=>[...w,{id:Date.now().toString(),role:"ai",content:"Sorry, I encountered an error processing your request.",timestamp:new Date}])}finally{c(!1)}},E=(k,g)=>{const w=k.toLowerCase();if(w.includes("last year")||w.includes("year ago")){const _=new Date;_.setFullYear(_.getFullYear()-1);const P=new Date(_);P.setMonth(P.getMonth()-1);const b=new Date(_);b.setMonth(b.getMonth()+1);const C=g.find(A=>{const N=new Date(A.date);return N>=P&&N<=b});return C?{content:`(Simulated) I found a memory from around this time last year (${xe(new Date(C.date),"MMM d, yyyy")}). You were feeling "${C.mood}" and wrote: "${C.caption}".`,relatedEntryId:C.id}:{content:"(Simulated) I couldn't find any entries from exactly a year ago."}}if(w.includes("happy")||w.includes("joy")){const _=g.filter(P=>P.mood.toLowerCase()==="happy");if(_.length>0){const P=_[Math.floor(Math.random()*_.length)];return{content:`(Simulated) You've had ${_.length} happy moments! Like on ${xe(new Date(P.date),"MMM d")}: "${P.caption}".`,relatedEntryId:P.id}}}return{content:"(Simulated Mode) I'm running in basic mode. To have a real conversation with your memories, please click the settings icon and add a Google Gemini API Key."}};return e?d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 w-full max-w-2xl h-[600px] rounded-3xl shadow-2xl flex flex-col overflow-hidden animate-in fade-in zoom-in-95 duration-300",children:[d.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center bg-gradient-to-r from-purple-50 to-blue-50 dark:from-gray-800 dark:to-gray-900",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-xl",children:d.jsx(N0,{className:"w-6 h-6"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-gray-800 dark:text-white",children:"AI Companion"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:`w-2 h-2 rounded-full ${Tn.isConfigured()?"bg-green-500":"bg-orange-500"}`}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:Tn.isConfigured()?"Powered by Qwen AI":"Simulated Mode"})]})]})]}),d.jsxs("div",{className:"flex gap-2",children:[!Tn.hasGlobalKey()&&d.jsx("button",{onClick:()=>h(!u),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",title:"AI Settings",children:d.jsx(T0,{className:"w-5 h-5 text-gray-500"})}),d.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors",children:d.jsx(vf,{className:"w-5 h-5 text-gray-500"})})]})]}),u&&d.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 animate-in slide-in-from-top-5",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[d.jsx(I1,{className:"w-4 h-4"}),"Qwen API Key (Aliyun)"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"password",value:f,onChange:k=>p(k.target.value),placeholder:"sk-...",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 focus:ring-2 focus:ring-purple-500 outline-none"}),d.jsx("button",{onClick:v,className:"px-4 py-2 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors",children:"Save"})]}),d.jsxs("p",{className:"text-xs text-gray-500",children:["Get a free key from ",d.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:underline",children:"Google AI Studio"}),". Your key is stored locally in your browser."]})]})}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 bg-gray-50 dark:bg-gray-950/50",children:[s.map(k=>d.jsxs("div",{className:`flex gap-4 ${k.role==="user"?"flex-row-reverse":""}`,children:[d.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${k.role==="ai"?"bg-purple-100 text-purple-600":"bg-blue-100 text-blue-600"}`,children:k.role==="ai"?d.jsx(on,{className:"w-4 h-4"}):d.jsx(aa,{className:"w-4 h-4"})}),d.jsxs("div",{className:`flex flex-col max-w-[80%] space-y-2 ${k.role==="user"?"items-end":"items-start"}`,children:[d.jsx("div",{className:`p-4 rounded-2xl shadow-sm text-sm leading-relaxed whitespace-pre-wrap ${k.role==="user"?"bg-blue-600 text-white rounded-tr-none":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 rounded-tl-none"}`,children:k.content}),k.relatedEntryId&&d.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-xl border border-purple-100 dark:border-purple-900/30 shadow-sm w-64",children:[d.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mb-2",children:[d.jsx(P0,{className:"w-3 h-3"}),d.jsx("span",{children:"Memory Context"})]}),d.jsx("div",{className:"h-20 bg-gray-100 dark:bg-gray-700 rounded-lg mb-2 overflow-hidden relative",children:d.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:d.jsx(xn,{className:"w-8 h-8 opacity-20"})})}),d.jsx("button",{className:"text-xs text-purple-600 font-medium hover:underline",children:"View Full Entry"})]}),k.recommendations&&d.jsx("div",{className:"space-y-2 w-full",children:k.recommendations.map((g,w)=>d.jsxs("a",{href:g.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 hover:shadow-md transition-all group",children:[d.jsx("div",{className:"w-10 h-10 bg-red-50 text-red-500 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform",children:d.jsx(R0,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm truncate",children:g.title}),d.jsx("p",{className:"text-xs text-gray-500",children:g.platform})]}),d.jsx(vf,{className:"w-4 h-4 text-gray-400 group-hover:translate-x-1 transition-transform"})]},w))}),d.jsx("span",{className:"text-[10px] text-gray-400",children:xe(k.timestamp,"h:mm a")})]})]},k.id)),l&&d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center",children:d.jsx(on,{className:"w-4 h-4"})}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl rounded-tl-none shadow-sm flex items-center gap-2",children:[d.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),d.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),d.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]}),d.jsx("div",{ref:m})]}),d.jsx("div",{className:"p-4 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:o,onChange:k=>a(k.target.value),onKeyDown:k=>k.key==="Enter"&&S(),placeholder:"Ask about your memories...",className:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-800 border-none rounded-xl focus:ring-2 focus:ring-purple-500 dark:text-white"}),d.jsx("button",{onClick:S,disabled:!o.trim()||l,className:"p-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-lg shadow-purple-200 dark:shadow-none",children:d.jsx(M1,{className:"w-5 h-5"})})]})})]})}):null}const sh="-",CN=t=>{const e=PN(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const a=o.split(sh);return a[0]===""&&a.length!==1&&a.shift(),Pb(a,e)||EN(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},Pb=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?Pb(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(sh);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},Kp=/^\[(.+)\]$/,EN=t=>{if(Kp.test(t)){const e=Kp.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},PN=t=>{const{theme:e,classGroups:n}=t,r={nextPart:new Map,validators:[]};for(const s in n)_u(n[s],r,s,e);return r},_u=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:Gp(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(AN(s)){_u(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{_u(o,Gp(e,i),n,r)})})},Gp=(t,e)=>{let n=t;return e.split(sh).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},AN=t=>t.isThemeGetter,jN=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},ku="!",Cu=":",NN=Cu.length,TN=t=>{const{prefix:e,experimentalParseClassName:n}=t;let r=s=>{const i=[];let o=0,a=0,l=0,c;for(let m=0;m<s.length;m++){let y=s[m];if(o===0&&a===0){if(y===Cu){i.push(s.slice(l,m)),l=m+NN;continue}if(y==="/"){c=m;continue}}y==="["?o++:y==="]"?o--:y==="("?a++:y===")"&&a--}const u=i.length===0?s:s.substring(l),h=RN(u),f=h!==u,p=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:p}};if(e){const s=e+Cu,i=r;r=o=>o.startsWith(s)?i(o.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},RN=t=>t.endsWith(ku)?t.substring(0,t.length-1):t.startsWith(ku)?t.substring(1):t,ON=t=>{const e=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(o=>{o[0]==="["||e[o]?(s.push(...i.sort(),o),i=[]):i.push(o)}),s.push(...i.sort()),s}},IN=t=>({cache:jN(t.cacheSize),parseClassName:TN(t),sortModifiers:ON(t),...CN(t)}),MN=/\s+/,DN=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=e,o=[],a=t.trim().split(MN);let l="";for(let c=a.length-1;c>=0;c-=1){const u=a[c],{isExternal:h,modifiers:f,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:y}=n(u);if(h){l=u+(l.length>0?" "+l:l);continue}let v=!!y,S=r(v?m.substring(0,y):m);if(!S){if(!v){l=u+(l.length>0?" "+l:l);continue}if(S=r(m),!S){l=u+(l.length>0?" "+l:l);continue}v=!1}const E=i(f).join(":"),k=p?E+ku:E,g=k+S;if(o.includes(g))continue;o.push(g);const w=s(S,v);for(let _=0;_<w.length;++_){const P=w[_];o.push(k+P)}l=u+(l.length>0?" "+l:l)}return l};function LN(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=Ab(e))&&(r&&(r+=" "),r+=n);return r}const Ab=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=Ab(t[r]))&&(n&&(n+=" "),n+=e);return n};function $N(t,...e){let n,r,s,i=o;function o(l){const c=e.reduce((u,h)=>h(u),t());return n=IN(c),r=n.cache.get,s=n.cache.set,i=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=DN(l,n);return s(l,u),u}return function(){return i(LN.apply(null,arguments))}}const Ue=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},jb=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Nb=/^\((?:(\w[\w-]*):)?(.+)\)$/i,FN=/^\d+\/\d+$/,UN=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,BN=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,VN=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,WN=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,zN=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Wr=t=>FN.test(t),he=t=>!!t&&!Number.isNaN(Number(t)),Rn=t=>!!t&&Number.isInteger(Number(t)),uc=t=>t.endsWith("%")&&he(t.slice(0,-1)),pn=t=>UN.test(t),HN=()=>!0,KN=t=>BN.test(t)&&!VN.test(t),Tb=()=>!1,GN=t=>WN.test(t),qN=t=>zN.test(t),YN=t=>!J(t)&&!X(t),JN=t=>Ns(t,Ib,Tb),J=t=>jb.test(t),or=t=>Ns(t,Mb,KN),dc=t=>Ns(t,t2,he),qp=t=>Ns(t,Rb,Tb),XN=t=>Ns(t,Ob,qN),So=t=>Ns(t,Db,GN),X=t=>Nb.test(t),Ws=t=>Ts(t,Mb),QN=t=>Ts(t,n2),Yp=t=>Ts(t,Rb),ZN=t=>Ts(t,Ib),e2=t=>Ts(t,Ob),_o=t=>Ts(t,Db,!0),Ns=(t,e,n)=>{const r=jb.exec(t);return r?r[1]?e(r[1]):n(r[2]):!1},Ts=(t,e,n=!1)=>{const r=Nb.exec(t);return r?r[1]?e(r[1]):n:!1},Rb=t=>t==="position"||t==="percentage",Ob=t=>t==="image"||t==="url",Ib=t=>t==="length"||t==="size"||t==="bg-size",Mb=t=>t==="length",t2=t=>t==="number",n2=t=>t==="family-name",Db=t=>t==="shadow",r2=()=>{const t=Ue("color"),e=Ue("font"),n=Ue("text"),r=Ue("font-weight"),s=Ue("tracking"),i=Ue("leading"),o=Ue("breakpoint"),a=Ue("container"),l=Ue("spacing"),c=Ue("radius"),u=Ue("shadow"),h=Ue("inset-shadow"),f=Ue("text-shadow"),p=Ue("drop-shadow"),m=Ue("blur"),y=Ue("perspective"),v=Ue("aspect"),S=Ue("ease"),E=Ue("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],g=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],w=()=>[...g(),X,J],_=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto","contain","none"],b=()=>[X,J,l],C=()=>[Wr,"full","auto",...b()],A=()=>[Rn,"none","subgrid",X,J],N=()=>["auto",{span:["full",Rn,X,J]},Rn,X,J],O=()=>[Rn,"auto",X,J],I=()=>["auto","min","max","fr",X,J],T=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],M=()=>["start","end","center","stretch","center-safe","end-safe"],R=()=>["auto",...b()],j=()=>[Wr,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...b()],D=()=>[t,X,J],$=()=>[...g(),Yp,qp,{position:[X,J]}],F=()=>["no-repeat",{repeat:["","x","y","space","round"]}],K=()=>["auto","cover","contain",ZN,JN,{size:[X,J]}],z=()=>[uc,Ws,or],U=()=>["","none","full",c,X,J],V=()=>["",he,Ws,or],W=()=>["solid","dashed","dotted","double"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ne=()=>[he,uc,Yp,qp],pe=()=>["","none",m,X,J],se=()=>["none",he,X,J],me=()=>["none",he,X,J],ve=()=>[he,X,J],Se=()=>[Wr,"full",...b()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[pn],breakpoint:[pn],color:[HN],container:[pn],"drop-shadow":[pn],ease:["in","out","in-out"],font:[YN],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[pn],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[pn],shadow:[pn],spacing:["px",he],text:[pn],"text-shadow":[pn],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Wr,J,X,v]}],container:["container"],columns:[{columns:[he,J,X,a]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:w()}],overflow:[{overflow:_()}],"overflow-x":[{"overflow-x":_()}],"overflow-y":[{"overflow-y":_()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:C()}],"inset-x":[{"inset-x":C()}],"inset-y":[{"inset-y":C()}],start:[{start:C()}],end:[{end:C()}],top:[{top:C()}],right:[{right:C()}],bottom:[{bottom:C()}],left:[{left:C()}],visibility:["visible","invisible","collapse"],z:[{z:[Rn,"auto",X,J]}],basis:[{basis:[Wr,"full","auto",a,...b()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[he,Wr,"auto","initial","none",J]}],grow:[{grow:["",he,X,J]}],shrink:[{shrink:["",he,X,J]}],order:[{order:[Rn,"first","last","none",X,J]}],"grid-cols":[{"grid-cols":A()}],"col-start-end":[{col:N()}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":A()}],"row-start-end":[{row:N()}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":I()}],"auto-rows":[{"auto-rows":I()}],gap:[{gap:b()}],"gap-x":[{"gap-x":b()}],"gap-y":[{"gap-y":b()}],"justify-content":[{justify:[...T(),"normal"]}],"justify-items":[{"justify-items":[...M(),"normal"]}],"justify-self":[{"justify-self":["auto",...M()]}],"align-content":[{content:["normal",...T()]}],"align-items":[{items:[...M(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...M(),{baseline:["","last"]}]}],"place-content":[{"place-content":T()}],"place-items":[{"place-items":[...M(),"baseline"]}],"place-self":[{"place-self":["auto",...M()]}],p:[{p:b()}],px:[{px:b()}],py:[{py:b()}],ps:[{ps:b()}],pe:[{pe:b()}],pt:[{pt:b()}],pr:[{pr:b()}],pb:[{pb:b()}],pl:[{pl:b()}],m:[{m:R()}],mx:[{mx:R()}],my:[{my:R()}],ms:[{ms:R()}],me:[{me:R()}],mt:[{mt:R()}],mr:[{mr:R()}],mb:[{mb:R()}],ml:[{ml:R()}],"space-x":[{"space-x":b()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":b()}],"space-y-reverse":["space-y-reverse"],size:[{size:j()}],w:[{w:[a,"screen",...j()]}],"min-w":[{"min-w":[a,"screen","none",...j()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...j()]}],h:[{h:["screen",...j()]}],"min-h":[{"min-h":["screen","none",...j()]}],"max-h":[{"max-h":["screen",...j()]}],"font-size":[{text:["base",n,Ws,or]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,X,dc]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",uc,J]}],"font-family":[{font:[QN,J,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,X,J]}],"line-clamp":[{"line-clamp":[he,"none",X,dc]}],leading:[{leading:[i,...b()]}],"list-image":[{"list-image":["none",X,J]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",X,J]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:D()}],"text-color":[{text:D()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...W(),"wavy"]}],"text-decoration-thickness":[{decoration:[he,"from-font","auto",X,or]}],"text-decoration-color":[{decoration:D()}],"underline-offset":[{"underline-offset":[he,"auto",X,J]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:b()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",X,J]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",X,J]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:$()}],"bg-repeat":[{bg:F()}],"bg-size":[{bg:K()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Rn,X,J],radial:["",X,J],conic:[Rn,X,J]},e2,XN]}],"bg-color":[{bg:D()}],"gradient-from-pos":[{from:z()}],"gradient-via-pos":[{via:z()}],"gradient-to-pos":[{to:z()}],"gradient-from":[{from:D()}],"gradient-via":[{via:D()}],"gradient-to":[{to:D()}],rounded:[{rounded:U()}],"rounded-s":[{"rounded-s":U()}],"rounded-e":[{"rounded-e":U()}],"rounded-t":[{"rounded-t":U()}],"rounded-r":[{"rounded-r":U()}],"rounded-b":[{"rounded-b":U()}],"rounded-l":[{"rounded-l":U()}],"rounded-ss":[{"rounded-ss":U()}],"rounded-se":[{"rounded-se":U()}],"rounded-ee":[{"rounded-ee":U()}],"rounded-es":[{"rounded-es":U()}],"rounded-tl":[{"rounded-tl":U()}],"rounded-tr":[{"rounded-tr":U()}],"rounded-br":[{"rounded-br":U()}],"rounded-bl":[{"rounded-bl":U()}],"border-w":[{border:V()}],"border-w-x":[{"border-x":V()}],"border-w-y":[{"border-y":V()}],"border-w-s":[{"border-s":V()}],"border-w-e":[{"border-e":V()}],"border-w-t":[{"border-t":V()}],"border-w-r":[{"border-r":V()}],"border-w-b":[{"border-b":V()}],"border-w-l":[{"border-l":V()}],"divide-x":[{"divide-x":V()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":V()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...W(),"hidden","none"]}],"divide-style":[{divide:[...W(),"hidden","none"]}],"border-color":[{border:D()}],"border-color-x":[{"border-x":D()}],"border-color-y":[{"border-y":D()}],"border-color-s":[{"border-s":D()}],"border-color-e":[{"border-e":D()}],"border-color-t":[{"border-t":D()}],"border-color-r":[{"border-r":D()}],"border-color-b":[{"border-b":D()}],"border-color-l":[{"border-l":D()}],"divide-color":[{divide:D()}],"outline-style":[{outline:[...W(),"none","hidden"]}],"outline-offset":[{"outline-offset":[he,X,J]}],"outline-w":[{outline:["",he,Ws,or]}],"outline-color":[{outline:D()}],shadow:[{shadow:["","none",u,_o,So]}],"shadow-color":[{shadow:D()}],"inset-shadow":[{"inset-shadow":["none",h,_o,So]}],"inset-shadow-color":[{"inset-shadow":D()}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:D()}],"ring-offset-w":[{"ring-offset":[he,or]}],"ring-offset-color":[{"ring-offset":D()}],"inset-ring-w":[{"inset-ring":V()}],"inset-ring-color":[{"inset-ring":D()}],"text-shadow":[{"text-shadow":["none",f,_o,So]}],"text-shadow-color":[{"text-shadow":D()}],opacity:[{opacity:[he,X,J]}],"mix-blend":[{"mix-blend":[...ee(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ee()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[he]}],"mask-image-linear-from-pos":[{"mask-linear-from":ne()}],"mask-image-linear-to-pos":[{"mask-linear-to":ne()}],"mask-image-linear-from-color":[{"mask-linear-from":D()}],"mask-image-linear-to-color":[{"mask-linear-to":D()}],"mask-image-t-from-pos":[{"mask-t-from":ne()}],"mask-image-t-to-pos":[{"mask-t-to":ne()}],"mask-image-t-from-color":[{"mask-t-from":D()}],"mask-image-t-to-color":[{"mask-t-to":D()}],"mask-image-r-from-pos":[{"mask-r-from":ne()}],"mask-image-r-to-pos":[{"mask-r-to":ne()}],"mask-image-r-from-color":[{"mask-r-from":D()}],"mask-image-r-to-color":[{"mask-r-to":D()}],"mask-image-b-from-pos":[{"mask-b-from":ne()}],"mask-image-b-to-pos":[{"mask-b-to":ne()}],"mask-image-b-from-color":[{"mask-b-from":D()}],"mask-image-b-to-color":[{"mask-b-to":D()}],"mask-image-l-from-pos":[{"mask-l-from":ne()}],"mask-image-l-to-pos":[{"mask-l-to":ne()}],"mask-image-l-from-color":[{"mask-l-from":D()}],"mask-image-l-to-color":[{"mask-l-to":D()}],"mask-image-x-from-pos":[{"mask-x-from":ne()}],"mask-image-x-to-pos":[{"mask-x-to":ne()}],"mask-image-x-from-color":[{"mask-x-from":D()}],"mask-image-x-to-color":[{"mask-x-to":D()}],"mask-image-y-from-pos":[{"mask-y-from":ne()}],"mask-image-y-to-pos":[{"mask-y-to":ne()}],"mask-image-y-from-color":[{"mask-y-from":D()}],"mask-image-y-to-color":[{"mask-y-to":D()}],"mask-image-radial":[{"mask-radial":[X,J]}],"mask-image-radial-from-pos":[{"mask-radial-from":ne()}],"mask-image-radial-to-pos":[{"mask-radial-to":ne()}],"mask-image-radial-from-color":[{"mask-radial-from":D()}],"mask-image-radial-to-color":[{"mask-radial-to":D()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":g()}],"mask-image-conic-pos":[{"mask-conic":[he]}],"mask-image-conic-from-pos":[{"mask-conic-from":ne()}],"mask-image-conic-to-pos":[{"mask-conic-to":ne()}],"mask-image-conic-from-color":[{"mask-conic-from":D()}],"mask-image-conic-to-color":[{"mask-conic-to":D()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:$()}],"mask-repeat":[{mask:F()}],"mask-size":[{mask:K()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",X,J]}],filter:[{filter:["","none",X,J]}],blur:[{blur:pe()}],brightness:[{brightness:[he,X,J]}],contrast:[{contrast:[he,X,J]}],"drop-shadow":[{"drop-shadow":["","none",p,_o,So]}],"drop-shadow-color":[{"drop-shadow":D()}],grayscale:[{grayscale:["",he,X,J]}],"hue-rotate":[{"hue-rotate":[he,X,J]}],invert:[{invert:["",he,X,J]}],saturate:[{saturate:[he,X,J]}],sepia:[{sepia:["",he,X,J]}],"backdrop-filter":[{"backdrop-filter":["","none",X,J]}],"backdrop-blur":[{"backdrop-blur":pe()}],"backdrop-brightness":[{"backdrop-brightness":[he,X,J]}],"backdrop-contrast":[{"backdrop-contrast":[he,X,J]}],"backdrop-grayscale":[{"backdrop-grayscale":["",he,X,J]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[he,X,J]}],"backdrop-invert":[{"backdrop-invert":["",he,X,J]}],"backdrop-opacity":[{"backdrop-opacity":[he,X,J]}],"backdrop-saturate":[{"backdrop-saturate":[he,X,J]}],"backdrop-sepia":[{"backdrop-sepia":["",he,X,J]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":b()}],"border-spacing-x":[{"border-spacing-x":b()}],"border-spacing-y":[{"border-spacing-y":b()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",X,J]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[he,"initial",X,J]}],ease:[{ease:["linear","initial",S,X,J]}],delay:[{delay:[he,X,J]}],animate:[{animate:["none",E,X,J]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,X,J]}],"perspective-origin":[{"perspective-origin":w()}],rotate:[{rotate:se()}],"rotate-x":[{"rotate-x":se()}],"rotate-y":[{"rotate-y":se()}],"rotate-z":[{"rotate-z":se()}],scale:[{scale:me()}],"scale-x":[{"scale-x":me()}],"scale-y":[{"scale-y":me()}],"scale-z":[{"scale-z":me()}],"scale-3d":["scale-3d"],skew:[{skew:ve()}],"skew-x":[{"skew-x":ve()}],"skew-y":[{"skew-y":ve()}],transform:[{transform:[X,J,"","none","gpu","cpu"]}],"transform-origin":[{origin:w()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Se()}],"translate-x":[{"translate-x":Se()}],"translate-y":[{"translate-y":Se()}],"translate-z":[{"translate-z":Se()}],"translate-none":["translate-none"],accent:[{accent:D()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:D()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",X,J]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":b()}],"scroll-mx":[{"scroll-mx":b()}],"scroll-my":[{"scroll-my":b()}],"scroll-ms":[{"scroll-ms":b()}],"scroll-me":[{"scroll-me":b()}],"scroll-mt":[{"scroll-mt":b()}],"scroll-mr":[{"scroll-mr":b()}],"scroll-mb":[{"scroll-mb":b()}],"scroll-ml":[{"scroll-ml":b()}],"scroll-p":[{"scroll-p":b()}],"scroll-px":[{"scroll-px":b()}],"scroll-py":[{"scroll-py":b()}],"scroll-ps":[{"scroll-ps":b()}],"scroll-pe":[{"scroll-pe":b()}],"scroll-pt":[{"scroll-pt":b()}],"scroll-pr":[{"scroll-pr":b()}],"scroll-pb":[{"scroll-pb":b()}],"scroll-pl":[{"scroll-pl":b()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",X,J]}],fill:[{fill:["none",...D()]}],"stroke-w":[{stroke:[he,Ws,or,dc]}],stroke:[{stroke:["none",...D()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},s2=$N(r2);function dt(...t){return s2(O0(t))}function Ot({src:t,alt:e,className:n,aspectRatio:r="auto",...s}){const[i,o]=x.useState(!1),[a,l]=x.useState(!1),[c,u]=x.useState(!1),h=x.useRef(null);x.useEffect(()=>{const v=new IntersectionObserver(S=>{S.forEach(E=>{E.isIntersecting&&(l(!0),v.disconnect())})},{rootMargin:"50px",threshold:.1});return h.current&&v.observe(h.current),()=>{v.disconnect()}},[]);const f=()=>{o(!0)},p=()=>{u(!0)},m=c||!t?"https://via.placeholder.com/400x300?text=Image+Error":a?t:"",y={square:"aspect-square",video:"aspect-video",portrait:"aspect-[3/4]",auto:""}[r];return d.jsxs("div",{ref:h,className:dt("relative overflow-hidden bg-gray-100 dark:bg-gray-800",y,n),children:[!i&&d.jsx("div",{className:"absolute inset-0 bg-gray-200 dark:bg-gray-700 animate-pulse flex items-center justify-center",children:d.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 opacity-50 blur-xl scale-110"})}),a&&d.jsx("img",{src:m,alt:e,onLoad:f,onError:p,className:dt("w-full h-full object-cover transition-all duration-700 ease-in-out",i?"opacity-100 scale-100":"opacity-0 scale-105",n),...s})]})}var i2=Object.defineProperty,Ra=Object.getOwnPropertySymbols,Lb=Object.prototype.hasOwnProperty,$b=Object.prototype.propertyIsEnumerable,Jp=(t,e,n)=>e in t?i2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Eu=(t,e)=>{for(var n in e||(e={}))Lb.call(e,n)&&Jp(t,n,e[n]);if(Ra)for(var n of Ra(e))$b.call(e,n)&&Jp(t,n,e[n]);return t},Pu=(t,e)=>{var n={};for(var r in t)Lb.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Ra)for(var r of Ra(t))e.indexOf(r)<0&&$b.call(t,r)&&(n[r]=t[r]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Cr;(t=>{const e=class ge{constructor(l,c,u,h){if(this.version=l,this.errorCorrectionLevel=c,this.modules=[],this.isFunction=[],l<ge.MIN_VERSION||l>ge.MAX_VERSION)throw new RangeError("Version value out of range");if(h<-1||h>7)throw new RangeError("Mask value out of range");this.size=l*4+17;let f=[];for(let m=0;m<this.size;m++)f.push(!1);for(let m=0;m<this.size;m++)this.modules.push(f.slice()),this.isFunction.push(f.slice());this.drawFunctionPatterns();const p=this.addEccAndInterleave(u);if(this.drawCodewords(p),h==-1){let m=1e9;for(let y=0;y<8;y++){this.applyMask(y),this.drawFormatBits(y);const v=this.getPenaltyScore();v<m&&(h=y,m=v),this.applyMask(y)}}s(0<=h&&h<=7),this.mask=h,this.applyMask(h),this.drawFormatBits(h),this.isFunction=[]}static encodeText(l,c){const u=t.QrSegment.makeSegments(l);return ge.encodeSegments(u,c)}static encodeBinary(l,c){const u=t.QrSegment.makeBytes(l);return ge.encodeSegments([u],c)}static encodeSegments(l,c,u=1,h=40,f=-1,p=!0){if(!(ge.MIN_VERSION<=u&&u<=h&&h<=ge.MAX_VERSION)||f<-1||f>7)throw new RangeError("Invalid value");let m,y;for(m=u;;m++){const k=ge.getNumDataCodewords(m,c)*8,g=o.getTotalBits(l,m);if(g<=k){y=g;break}if(m>=h)throw new RangeError("Data too long")}for(const k of[ge.Ecc.MEDIUM,ge.Ecc.QUARTILE,ge.Ecc.HIGH])p&&y<=ge.getNumDataCodewords(m,k)*8&&(c=k);let v=[];for(const k of l){n(k.mode.modeBits,4,v),n(k.numChars,k.mode.numCharCountBits(m),v);for(const g of k.getData())v.push(g)}s(v.length==y);const S=ge.getNumDataCodewords(m,c)*8;s(v.length<=S),n(0,Math.min(4,S-v.length),v),n(0,(8-v.length%8)%8,v),s(v.length%8==0);for(let k=236;v.length<S;k^=253)n(k,8,v);let E=[];for(;E.length*8<v.length;)E.push(0);return v.forEach((k,g)=>E[g>>>3]|=k<<7-(g&7)),new ge(m,c,E,f)}getModule(l,c){return 0<=l&&l<this.size&&0<=c&&c<this.size&&this.modules[c][l]}getModules(){return this.modules}drawFunctionPatterns(){for(let u=0;u<this.size;u++)this.setFunctionModule(6,u,u%2==0),this.setFunctionModule(u,6,u%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const l=this.getAlignmentPatternPositions(),c=l.length;for(let u=0;u<c;u++)for(let h=0;h<c;h++)u==0&&h==0||u==0&&h==c-1||u==c-1&&h==0||this.drawAlignmentPattern(l[u],l[h]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(l){const c=this.errorCorrectionLevel.formatBits<<3|l;let u=c;for(let f=0;f<10;f++)u=u<<1^(u>>>9)*1335;const h=(c<<10|u)^21522;s(h>>>15==0);for(let f=0;f<=5;f++)this.setFunctionModule(8,f,r(h,f));this.setFunctionModule(8,7,r(h,6)),this.setFunctionModule(8,8,r(h,7)),this.setFunctionModule(7,8,r(h,8));for(let f=9;f<15;f++)this.setFunctionModule(14-f,8,r(h,f));for(let f=0;f<8;f++)this.setFunctionModule(this.size-1-f,8,r(h,f));for(let f=8;f<15;f++)this.setFunctionModule(8,this.size-15+f,r(h,f));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let l=this.version;for(let u=0;u<12;u++)l=l<<1^(l>>>11)*7973;const c=this.version<<12|l;s(c>>>18==0);for(let u=0;u<18;u++){const h=r(c,u),f=this.size-11+u%3,p=Math.floor(u/3);this.setFunctionModule(f,p,h),this.setFunctionModule(p,f,h)}}drawFinderPattern(l,c){for(let u=-4;u<=4;u++)for(let h=-4;h<=4;h++){const f=Math.max(Math.abs(h),Math.abs(u)),p=l+h,m=c+u;0<=p&&p<this.size&&0<=m&&m<this.size&&this.setFunctionModule(p,m,f!=2&&f!=4)}}drawAlignmentPattern(l,c){for(let u=-2;u<=2;u++)for(let h=-2;h<=2;h++)this.setFunctionModule(l+h,c+u,Math.max(Math.abs(h),Math.abs(u))!=1)}setFunctionModule(l,c,u){this.modules[c][l]=u,this.isFunction[c][l]=!0}addEccAndInterleave(l){const c=this.version,u=this.errorCorrectionLevel;if(l.length!=ge.getNumDataCodewords(c,u))throw new RangeError("Invalid argument");const h=ge.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][c],f=ge.ECC_CODEWORDS_PER_BLOCK[u.ordinal][c],p=Math.floor(ge.getNumRawDataModules(c)/8),m=h-p%h,y=Math.floor(p/h);let v=[];const S=ge.reedSolomonComputeDivisor(f);for(let k=0,g=0;k<h;k++){let w=l.slice(g,g+y-f+(k<m?0:1));g+=w.length;const _=ge.reedSolomonComputeRemainder(w,S);k<m&&w.push(0),v.push(w.concat(_))}let E=[];for(let k=0;k<v[0].length;k++)v.forEach((g,w)=>{(k!=y-f||w>=m)&&E.push(g[k])});return s(E.length==p),E}drawCodewords(l){if(l.length!=Math.floor(ge.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let c=0;for(let u=this.size-1;u>=1;u-=2){u==6&&(u=5);for(let h=0;h<this.size;h++)for(let f=0;f<2;f++){const p=u-f,y=(u+1&2)==0?this.size-1-h:h;!this.isFunction[y][p]&&c<l.length*8&&(this.modules[y][p]=r(l[c>>>3],7-(c&7)),c++)}}s(c==l.length*8)}applyMask(l){if(l<0||l>7)throw new RangeError("Mask value out of range");for(let c=0;c<this.size;c++)for(let u=0;u<this.size;u++){let h;switch(l){case 0:h=(u+c)%2==0;break;case 1:h=c%2==0;break;case 2:h=u%3==0;break;case 3:h=(u+c)%3==0;break;case 4:h=(Math.floor(u/3)+Math.floor(c/2))%2==0;break;case 5:h=u*c%2+u*c%3==0;break;case 6:h=(u*c%2+u*c%3)%2==0;break;case 7:h=((u+c)%2+u*c%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[c][u]&&h&&(this.modules[c][u]=!this.modules[c][u])}}getPenaltyScore(){let l=0;for(let f=0;f<this.size;f++){let p=!1,m=0,y=[0,0,0,0,0,0,0];for(let v=0;v<this.size;v++)this.modules[f][v]==p?(m++,m==5?l+=ge.PENALTY_N1:m>5&&l++):(this.finderPenaltyAddHistory(m,y),p||(l+=this.finderPenaltyCountPatterns(y)*ge.PENALTY_N3),p=this.modules[f][v],m=1);l+=this.finderPenaltyTerminateAndCount(p,m,y)*ge.PENALTY_N3}for(let f=0;f<this.size;f++){let p=!1,m=0,y=[0,0,0,0,0,0,0];for(let v=0;v<this.size;v++)this.modules[v][f]==p?(m++,m==5?l+=ge.PENALTY_N1:m>5&&l++):(this.finderPenaltyAddHistory(m,y),p||(l+=this.finderPenaltyCountPatterns(y)*ge.PENALTY_N3),p=this.modules[v][f],m=1);l+=this.finderPenaltyTerminateAndCount(p,m,y)*ge.PENALTY_N3}for(let f=0;f<this.size-1;f++)for(let p=0;p<this.size-1;p++){const m=this.modules[f][p];m==this.modules[f][p+1]&&m==this.modules[f+1][p]&&m==this.modules[f+1][p+1]&&(l+=ge.PENALTY_N2)}let c=0;for(const f of this.modules)c=f.reduce((p,m)=>p+(m?1:0),c);const u=this.size*this.size,h=Math.ceil(Math.abs(c*20-u*10)/u)-1;return s(0<=h&&h<=9),l+=h*ge.PENALTY_N4,s(0<=l&&l<=2568888),l}getAlignmentPatternPositions(){if(this.version==1)return[];{const l=Math.floor(this.version/7)+2,c=this.version==32?26:Math.ceil((this.version*4+4)/(l*2-2))*2;let u=[6];for(let h=this.size-7;u.length<l;h-=c)u.splice(1,0,h);return u}}static getNumRawDataModules(l){if(l<ge.MIN_VERSION||l>ge.MAX_VERSION)throw new RangeError("Version number out of range");let c=(16*l+128)*l+64;if(l>=2){const u=Math.floor(l/7)+2;c-=(25*u-10)*u-55,l>=7&&(c-=36)}return s(208<=c&&c<=29648),c}static getNumDataCodewords(l,c){return Math.floor(ge.getNumRawDataModules(l)/8)-ge.ECC_CODEWORDS_PER_BLOCK[c.ordinal][l]*ge.NUM_ERROR_CORRECTION_BLOCKS[c.ordinal][l]}static reedSolomonComputeDivisor(l){if(l<1||l>255)throw new RangeError("Degree out of range");let c=[];for(let h=0;h<l-1;h++)c.push(0);c.push(1);let u=1;for(let h=0;h<l;h++){for(let f=0;f<c.length;f++)c[f]=ge.reedSolomonMultiply(c[f],u),f+1<c.length&&(c[f]^=c[f+1]);u=ge.reedSolomonMultiply(u,2)}return c}static reedSolomonComputeRemainder(l,c){let u=c.map(h=>0);for(const h of l){const f=h^u.shift();u.push(0),c.forEach((p,m)=>u[m]^=ge.reedSolomonMultiply(p,f))}return u}static reedSolomonMultiply(l,c){if(l>>>8||c>>>8)throw new RangeError("Byte out of range");let u=0;for(let h=7;h>=0;h--)u=u<<1^(u>>>7)*285,u^=(c>>>h&1)*l;return s(u>>>8==0),u}finderPenaltyCountPatterns(l){const c=l[1];s(c<=this.size*3);const u=c>0&&l[2]==c&&l[3]==c*3&&l[4]==c&&l[5]==c;return(u&&l[0]>=c*4&&l[6]>=c?1:0)+(u&&l[6]>=c*4&&l[0]>=c?1:0)}finderPenaltyTerminateAndCount(l,c,u){return l&&(this.finderPenaltyAddHistory(c,u),c=0),c+=this.size,this.finderPenaltyAddHistory(c,u),this.finderPenaltyCountPatterns(u)}finderPenaltyAddHistory(l,c){c[0]==0&&(l+=this.size),c.pop(),c.unshift(l)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function n(a,l,c){if(l<0||l>31||a>>>l)throw new RangeError("Value out of range");for(let u=l-1;u>=0;u--)c.push(a>>>u&1)}function r(a,l){return(a>>>l&1)!=0}function s(a){if(!a)throw new Error("Assertion error")}const i=class Te{constructor(l,c,u){if(this.mode=l,this.numChars=c,this.bitData=u,c<0)throw new RangeError("Invalid argument");this.bitData=u.slice()}static makeBytes(l){let c=[];for(const u of l)n(u,8,c);return new Te(Te.Mode.BYTE,l.length,c)}static makeNumeric(l){if(!Te.isNumeric(l))throw new RangeError("String contains non-numeric characters");let c=[];for(let u=0;u<l.length;){const h=Math.min(l.length-u,3);n(parseInt(l.substring(u,u+h),10),h*3+1,c),u+=h}return new Te(Te.Mode.NUMERIC,l.length,c)}static makeAlphanumeric(l){if(!Te.isAlphanumeric(l))throw new RangeError("String contains unencodable characters in alphanumeric mode");let c=[],u;for(u=0;u+2<=l.length;u+=2){let h=Te.ALPHANUMERIC_CHARSET.indexOf(l.charAt(u))*45;h+=Te.ALPHANUMERIC_CHARSET.indexOf(l.charAt(u+1)),n(h,11,c)}return u<l.length&&n(Te.ALPHANUMERIC_CHARSET.indexOf(l.charAt(u)),6,c),new Te(Te.Mode.ALPHANUMERIC,l.length,c)}static makeSegments(l){return l==""?[]:Te.isNumeric(l)?[Te.makeNumeric(l)]:Te.isAlphanumeric(l)?[Te.makeAlphanumeric(l)]:[Te.makeBytes(Te.toUtf8ByteArray(l))]}static makeEci(l){let c=[];if(l<0)throw new RangeError("ECI assignment value out of range");if(l<128)n(l,8,c);else if(l<16384)n(2,2,c),n(l,14,c);else if(l<1e6)n(6,3,c),n(l,21,c);else throw new RangeError("ECI assignment value out of range");return new Te(Te.Mode.ECI,0,c)}static isNumeric(l){return Te.NUMERIC_REGEX.test(l)}static isAlphanumeric(l){return Te.ALPHANUMERIC_REGEX.test(l)}getData(){return this.bitData.slice()}static getTotalBits(l,c){let u=0;for(const h of l){const f=h.mode.numCharCountBits(c);if(h.numChars>=1<<f)return 1/0;u+=4+f+h.bitData.length}return u}static toUtf8ByteArray(l){l=encodeURI(l);let c=[];for(let u=0;u<l.length;u++)l.charAt(u)!="%"?c.push(l.charCodeAt(u)):(c.push(parseInt(l.substring(u+1,u+3),16)),u+=2);return c}};i.NUMERIC_REGEX=/^[0-9]*$/,i.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,i.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=i;t.QrSegment=i})(Cr||(Cr={}));(t=>{(e=>{const n=class{constructor(s,i){this.ordinal=s,this.formatBits=i}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),e.Ecc=n})(t.QrCode||(t.QrCode={}))})(Cr||(Cr={}));(t=>{(e=>{const n=class{constructor(s,i){this.modeBits=s,this.numBitsCharCount=i}numCharCountBits(s){return this.numBitsCharCount[Math.floor((s+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),e.Mode=n})(t.QrSegment||(t.QrSegment={}))})(Cr||(Cr={}));var is=Cr;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var o2={L:is.QrCode.Ecc.LOW,M:is.QrCode.Ecc.MEDIUM,Q:is.QrCode.Ecc.QUARTILE,H:is.QrCode.Ecc.HIGH},Fb=128,Ub="L",Bb="#FFFFFF",Vb="#000000",Wb=!1,zb=1,a2=4,l2=0,c2=.1;function Hb(t,e=0){const n=[];return t.forEach(function(r,s){let i=null;r.forEach(function(o,a){if(!o&&i!==null){n.push(`M${i+e} ${s+e}h${a-i}v1H${i+e}z`),i=null;return}if(a===r.length-1){if(!o)return;i===null?n.push(`M${a+e},${s+e} h1v1H${a+e}z`):n.push(`M${i+e},${s+e} h${a+1-i}v1H${i+e}z`);return}o&&i===null&&(i=a)})}),n.join("")}function Kb(t,e){return t.slice().map((n,r)=>r<e.y||r>=e.y+e.h?n:n.map((s,i)=>i<e.x||i>=e.x+e.w?s:!1))}function u2(t,e,n,r){if(r==null)return null;const s=t.length+n*2,i=Math.floor(e*c2),o=s/e,a=(r.width||i)*o,l=(r.height||i)*o,c=r.x==null?t.length/2-a/2:r.x*o,u=r.y==null?t.length/2-l/2:r.y*o,h=r.opacity==null?1:r.opacity;let f=null;if(r.excavate){let m=Math.floor(c),y=Math.floor(u),v=Math.ceil(a+c-m),S=Math.ceil(l+u-y);f={x:m,y,w:v,h:S}}const p=r.crossOrigin;return{x:c,y:u,h:l,w:a,excavation:f,opacity:h,crossOrigin:p}}function d2(t,e){return e!=null?Math.max(Math.floor(e),0):t?a2:l2}function Gb({value:t,level:e,minVersion:n,includeMargin:r,marginSize:s,imageSettings:i,size:o,boostLevel:a}){let l=fe.useMemo(()=>{const m=(Array.isArray(t)?t:[t]).reduce((y,v)=>(y.push(...is.QrSegment.makeSegments(v)),y),[]);return is.QrCode.encodeSegments(m,o2[e],n,void 0,void 0,a)},[t,e,n,a]);const{cells:c,margin:u,numCells:h,calculatedImageSettings:f}=fe.useMemo(()=>{let p=l.getModules();const m=d2(r,s),y=p.length+m*2,v=u2(p,o,m,i);return{cells:p,margin:m,numCells:y,calculatedImageSettings:v}},[l,o,i,r,s]);return{qrcode:l,margin:u,cells:c,numCells:h,calculatedImageSettings:f}}var h2=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),f2=fe.forwardRef(function(e,n){const r=e,{value:s,size:i=Fb,level:o=Ub,bgColor:a=Bb,fgColor:l=Vb,includeMargin:c=Wb,minVersion:u=zb,boostLevel:h,marginSize:f,imageSettings:p}=r,y=Pu(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:v}=y,S=Pu(y,["style"]),E=p==null?void 0:p.src,k=fe.useRef(null),g=fe.useRef(null),w=fe.useCallback(T=>{k.current=T,typeof n=="function"?n(T):n&&(n.current=T)},[n]),[_,P]=fe.useState(!1),{margin:b,cells:C,numCells:A,calculatedImageSettings:N}=Gb({value:s,level:o,minVersion:u,boostLevel:h,includeMargin:c,marginSize:f,imageSettings:p,size:i});fe.useEffect(()=>{if(k.current!=null){const T=k.current,M=T.getContext("2d");if(!M)return;let R=C;const j=g.current,D=N!=null&&j!==null&&j.complete&&j.naturalHeight!==0&&j.naturalWidth!==0;D&&N.excavation!=null&&(R=Kb(C,N.excavation));const $=window.devicePixelRatio||1;T.height=T.width=i*$;const F=i/A*$;M.scale(F,F),M.fillStyle=a,M.fillRect(0,0,A,A),M.fillStyle=l,h2?M.fill(new Path2D(Hb(R,b))):C.forEach(function(K,z){K.forEach(function(U,V){U&&M.fillRect(V+b,z+b,1,1)})}),N&&(M.globalAlpha=N.opacity),D&&M.drawImage(j,N.x+b,N.y+b,N.w,N.h)}}),fe.useEffect(()=>{P(!1)},[E]);const O=Eu({height:i,width:i},v);let I=null;return E!=null&&(I=fe.createElement("img",{src:E,key:E,style:{display:"none"},onLoad:()=>{P(!0)},ref:g,crossOrigin:N==null?void 0:N.crossOrigin})),fe.createElement(fe.Fragment,null,fe.createElement("canvas",Eu({style:O,height:i,width:i,ref:w,role:"img"},S)),I)});f2.displayName="QRCodeCanvas";var qb=fe.forwardRef(function(e,n){const r=e,{value:s,size:i=Fb,level:o=Ub,bgColor:a=Bb,fgColor:l=Vb,includeMargin:c=Wb,minVersion:u=zb,boostLevel:h,title:f,marginSize:p,imageSettings:m}=r,y=Pu(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:v,cells:S,numCells:E,calculatedImageSettings:k}=Gb({value:s,level:o,minVersion:u,boostLevel:h,includeMargin:c,marginSize:p,imageSettings:m,size:i});let g=S,w=null;m!=null&&k!=null&&(k.excavation!=null&&(g=Kb(S,k.excavation)),w=fe.createElement("image",{href:m.src,height:k.h,width:k.w,x:k.x+v,y:k.y+v,preserveAspectRatio:"none",opacity:k.opacity,crossOrigin:k.crossOrigin}));const _=Hb(g,v);return fe.createElement("svg",Eu({height:i,width:i,viewBox:`0 0 ${E} ${E}`,ref:n,role:"img"},y),!!f&&fe.createElement("title",null,f),fe.createElement("path",{fill:a,d:`M0,0 h${E}v${E}H0z`,shapeRendering:"crispEdges"}),fe.createElement("path",{fill:l,d:_,shapeRendering:"crispEdges"}),w)});qb.displayName="QRCodeSVG";function p2({entry:t,onClose:e}){const n=x.useRef(null),[r,s]=x.useState(!1),i=async()=>{if(n.current){s(!0);try{const o=await kk(n.current,{cacheBust:!0,pixelRatio:2}),a=document.createElement("a");a.download=`photo-diary-share-${t.id}.png`,a.href=o,a.click()}catch(o){console.error("Failed to generate image",o),alert("Failed to generate image. Please try again.")}finally{s(!1)}}};return d.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity animate-in fade-in",onClick:e}),d.jsxs("div",{className:"relative bg-white dark:bg-gray-900 rounded-3xl shadow-2xl max-w-sm w-full overflow-hidden animate-in zoom-in-95 duration-200",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-800",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[d.jsx(Ya,{className:"w-5 h-5 text-blue-500"}),"Share Memory"]}),d.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:d.jsx(Ct,{className:"w-5 h-5"})})]}),d.jsx("div",{className:"p-6 bg-gray-50 dark:bg-gray-800/50 flex justify-center",children:d.jsxs("div",{ref:n,className:"bg-white p-4 pb-6 rounded-none shadow-xl w-full max-w-[320px] transform rotate-1 transition-transform hover:rotate-0",style:{fontFamily:"sans-serif"},children:[d.jsxs("div",{className:"aspect-[4/5] bg-gray-100 mb-4 overflow-hidden relative group",children:[d.jsx("img",{src:t.photo,alt:"Memory",className:"w-full h-full object-cover",crossOrigin:"anonymous"}),d.jsx("div",{className:"absolute inset-0 shadow-[inset_0_0_40px_rgba(0,0,0,0.1)] pointer-events-none"})]}),d.jsxs("div",{className:"px-2 space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-end border-b-2 border-gray-100 pb-3",children:[d.jsx("div",{className:"font-handwriting text-2xl text-gray-800 leading-none",children:xe(new Date(t.date),"MMM d, yyyy")}),d.jsx("div",{className:"text-xs text-gray-400 font-medium uppercase tracking-wider",children:t.mood})]}),d.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed italic",children:['"',t.caption,'"']}),d.jsxs("div",{className:"flex items-center justify-between pt-2",children:[d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Recorded On"}),d.jsx("span",{className:"text-xs font-bold text-gray-900",children:"Photo Diary"})]}),d.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border border-gray-100",children:d.jsx(qb,{value:window.location.origin,size:48,level:"L",fgColor:"#374151"})})]})]})]})}),d.jsxs("div",{className:"p-4 border-t border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900",children:[d.jsx("button",{onClick:i,disabled:r,className:"w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl font-medium shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:r?d.jsxs(d.Fragment,{children:[d.jsx(on,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Ja,{className:"w-5 h-5"}),"Download Share Card"]})}),d.jsx("p",{className:"text-center text-xs text-gray-400 dark:text-gray-500 mt-3",children:"Save the image and share it to your favorite social app!"})]})]})]})}function m2(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,g2(s,...e)]}function g2(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Xp(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function y2(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Xp(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Xp(t[s],null)}}}}function Yb(...t){return x.useCallback(y2(...t),t)}function Bn(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function Qp(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function x2(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Qp(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Qp(t[s],null)}}}}function Rs(...t){return x.useCallback(x2(...t),t)}function b2(t,e){const n=x.createContext(e),r=i=>{const{children:o,...a}=i,l=x.useMemo(()=>a,Object.values(a));return d.jsx(n.Provider,{value:l,children:o})};r.displayName=t+"Provider";function s(i){const o=x.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function w2(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,v2(s,...e)]}function v2(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var S2=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},_2=gk.useId||(()=>{}),k2=0;function vr(t){const[e,n]=x.useState(_2());return S2(()=>{n(r=>r??String(k2++))},[t]),t||(e?`radix-${e}`:"")}function Wi(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function C2({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=E2({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,a=Wi(n),l=x.useCallback(c=>{if(i){const h=typeof c=="function"?c(t):c;h!==t&&a(h)}else s(c)},[i,t,s,a]);return[o,l]}function E2({defaultProp:t,onChange:e}){const n=x.useState(t),[r]=n,s=x.useRef(r),i=Wi(e);return x.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function Zp(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function P2(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Zp(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Zp(t[s],null)}}}}var tt=x.forwardRef((t,e)=>{const{children:n,...r}=t,s=x.Children.toArray(n),i=s.find(A2);if(i){const o=i.props.children,a=s.map(l=>l===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:l);return d.jsx(Au,{...r,ref:e,children:x.isValidElement(o)?x.cloneElement(o,void 0,a):null})}return d.jsx(Au,{...r,ref:e,children:n})});tt.displayName="Slot";var Au=x.forwardRef((t,e)=>{const{children:n,...r}=t;if(x.isValidElement(n)){const s=N2(n),i=j2(r,n.props);return n.type!==x.Fragment&&(i.ref=e?P2(e,s):s),x.cloneElement(n,i)}return x.Children.count(n)>1?x.Children.only(null):null});Au.displayName="SlotClone";var Jb=({children:t})=>d.jsx(d.Fragment,{children:t});function A2(t){return x.isValidElement(t)&&t.type===Jb}function j2(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{i(...a),s(...a)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function N2(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var T2=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Jn=T2.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function R2(t,e){t&&Xa.flushSync(()=>t.dispatchEvent(e))}function O2(t,e=globalThis==null?void 0:globalThis.document){const n=Wi(t);x.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var I2="DismissableLayer",ju="dismissableLayer.update",M2="dismissableLayer.pointerDownOutside",D2="dismissableLayer.focusOutside",em,Xb=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Qb=x.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=x.useContext(Xb),[u,h]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=x.useState({}),m=Rs(e,P=>h(P)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),S=y.indexOf(v),E=u?y.indexOf(u):-1,k=c.layersWithOutsidePointerEventsDisabled.size>0,g=E>=S,w=F2(P=>{const b=P.target,C=[...c.branches].some(A=>A.contains(b));!g||C||(s==null||s(P),o==null||o(P),P.defaultPrevented||a==null||a())},f),_=U2(P=>{const b=P.target;[...c.branches].some(A=>A.contains(b))||(i==null||i(P),o==null||o(P),P.defaultPrevented||a==null||a())},f);return O2(P=>{E===c.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&a&&(P.preventDefault(),a()))},f),x.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(em=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),tm(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=em)}},[u,f,n,c]),x.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),tm())},[u,c]),x.useEffect(()=>{const P=()=>p({});return document.addEventListener(ju,P),()=>document.removeEventListener(ju,P)},[]),d.jsx(Jn.div,{...l,ref:m,style:{pointerEvents:k?g?"auto":"none":void 0,...t.style},onFocusCapture:Bn(t.onFocusCapture,_.onFocusCapture),onBlurCapture:Bn(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Bn(t.onPointerDownCapture,w.onPointerDownCapture)})});Qb.displayName=I2;var L2="DismissableLayerBranch",$2=x.forwardRef((t,e)=>{const n=x.useContext(Xb),r=x.useRef(null),s=Rs(e,r);return x.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),d.jsx(Jn.div,{...t,ref:s})});$2.displayName=L2;function F2(t,e=globalThis==null?void 0:globalThis.document){const n=Wi(t),r=x.useRef(!1),s=x.useRef(()=>{});return x.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){Zb(M2,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function U2(t,e=globalThis==null?void 0:globalThis.document){const n=Wi(t),r=x.useRef(!1);return x.useEffect(()=>{const s=i=>{i.target&&!r.current&&Zb(D2,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function tm(){const t=new CustomEvent(ju);document.dispatchEvent(t)}function Zb(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?R2(s,i):s.dispatchEvent(i)}function nm(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function B2(...t){return e=>{let n=!1;const r=t.map(s=>{const i=nm(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():nm(t[s],null)}}}}function V2(...t){return x.useCallback(B2(...t),t)}var W2=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],z2=W2.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function rm(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}var hc="focusScope.autoFocusOnMount",fc="focusScope.autoFocusOnUnmount",sm={bubbles:!1,cancelable:!0},H2="FocusScope",yl=x.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=x.useState(null),c=rm(s),u=rm(i),h=x.useRef(null),f=V2(e,y=>l(y)),p=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(r){let y=function(k){if(p.paused||!a)return;const g=k.target;a.contains(g)?h.current=g:On(h.current,{select:!0})},v=function(k){if(p.paused||!a)return;const g=k.relatedTarget;g!==null&&(a.contains(g)||On(h.current,{select:!0}))},S=function(k){if(document.activeElement===document.body)for(const w of k)w.removedNodes.length>0&&On(a)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const E=new MutationObserver(S);return a&&E.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),E.disconnect()}}},[r,a,p.paused]),x.useEffect(()=>{if(a){om.add(p);const y=document.activeElement;if(!a.contains(y)){const S=new CustomEvent(hc,sm);a.addEventListener(hc,c),a.dispatchEvent(S),S.defaultPrevented||(K2(X2(ew(a)),{select:!0}),document.activeElement===y&&On(a))}return()=>{a.removeEventListener(hc,c),setTimeout(()=>{const S=new CustomEvent(fc,sm);a.addEventListener(fc,u),a.dispatchEvent(S),S.defaultPrevented||On(y??document.body,{select:!0}),a.removeEventListener(fc,u),om.remove(p)},0)}}},[a,c,u,p]);const m=x.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,S=document.activeElement;if(v&&S){const E=y.currentTarget,[k,g]=G2(E);k&&g?!y.shiftKey&&S===g?(y.preventDefault(),n&&On(k,{select:!0})):y.shiftKey&&S===k&&(y.preventDefault(),n&&On(g,{select:!0})):S===E&&y.preventDefault()}},[n,r,p.paused]);return d.jsx(z2.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});yl.displayName=H2;function K2(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(On(r,{select:e}),document.activeElement!==n)return}function G2(t){const e=ew(t),n=im(e,t),r=im(e.reverse(),t);return[n,r]}function ew(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function im(t,e){for(const n of t)if(!q2(n,{upTo:e}))return n}function q2(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Y2(t){return t instanceof HTMLInputElement&&"select"in t}function On(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Y2(t)&&e&&t.select()}}var om=J2();function J2(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=am(t,e),t.unshift(e)},remove(e){var n;t=am(t,e),(n=t[0])==null||n.resume()}}}function am(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function X2(t){return t.filter(e=>e.tagName!=="A")}var Nu=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},Q2="Portal",tw=x.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=x.useState(!1);Nu(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?kd.createPortal(d.jsx(Jn.div,{...r,ref:e}),o):null});tw.displayName=Q2;function Z2(t,e){return x.useReducer((n,r)=>e[n][r]??n,t)}var xl=t=>{const{present:e,children:n}=t,r=eT(e),s=typeof n=="function"?n({present:r.isPresent}):x.Children.only(n),i=Rs(r.ref,tT(s));return typeof n=="function"||r.isPresent?x.cloneElement(s,{ref:i}):null};xl.displayName="Presence";function eT(t){const[e,n]=x.useState(),r=x.useRef({}),s=x.useRef(t),i=x.useRef("none"),o=t?"mounted":"unmounted",[a,l]=Z2(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const c=ko(r.current);i.current=a==="mounted"?c:"none"},[a]),Nu(()=>{const c=r.current,u=s.current;if(u!==t){const f=i.current,p=ko(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),Nu(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const y=ko(r.current).includes(p.animationName);if(p.target===e&&y&&(l("ANIMATION_END"),!s.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(i.current=ko(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:x.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function ko(t){return(t==null?void 0:t.animationName)||"none"}function tT(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var pc=0;function ih(){x.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??lm()),document.body.insertAdjacentElement("beforeend",t[1]??lm()),pc++,()=>{pc===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),pc--}},[])}function lm(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Qo="right-scroll-bar-position",Zo="width-before-scroll-bar",nT="with-scroll-bars-hidden",rT="--removed-body-scroll-bar-size";function mc(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function sT(t,e){var n=x.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var iT=typeof window<"u"?x.useLayoutEffect:x.useEffect,cm=new WeakMap;function oT(t,e){var n=sT(null,function(r){return t.forEach(function(s){return mc(s,r)})});return iT(function(){var r=cm.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(a){i.has(a)||mc(a,null)}),i.forEach(function(a){s.has(a)||mc(a,o)})}cm.set(n,t)},[t]),n}function aT(t){return t}function lT(t,e){e===void 0&&(e=aT);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return s}function cT(t){t===void 0&&(t={});var e=lT(null);return e.options=Qt({async:!0,ssr:!1},t),e}var nw=function(t){var e=t.sideCar,n=Cs(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return x.createElement(r,Qt({},n))};nw.isSideCarExport=!0;function uT(t,e){return t.useMedium(e),nw}var rw=cT(),gc=function(){},bl=x.forwardRef(function(t,e){var n=x.useRef(null),r=x.useState({onScrollCapture:gc,onWheelCapture:gc,onTouchMoveCapture:gc}),s=r[0],i=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,h=t.shards,f=t.sideCar,p=t.noRelative,m=t.noIsolation,y=t.inert,v=t.allowPinchZoom,S=t.as,E=S===void 0?"div":S,k=t.gapMode,g=Cs(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=f,_=oT([n,e]),P=Qt(Qt({},g),s);return x.createElement(x.Fragment,null,u&&x.createElement(w,{sideCar:rw,removeScrollBar:c,shards:h,noRelative:p,noIsolation:m,inert:y,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:k}),o?x.cloneElement(x.Children.only(a),Qt(Qt({},P),{ref:_})):x.createElement(E,Qt({},P,{className:l,ref:_}),a))});bl.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};bl.classNames={fullWidth:Zo,zeroRight:Qo};var dT=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function hT(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=dT();return e&&t.setAttribute("nonce",e),t}function fT(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function pT(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var mT=function(){var t=0,e=null;return{add:function(n){t==0&&(e=hT())&&(fT(e,n),pT(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},gT=function(){var t=mT();return function(e,n){x.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},sw=function(){var t=gT(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},yT={left:0,top:0,right:0,gap:0},yc=function(t){return parseInt(t||"",10)||0},xT=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[yc(n),yc(r),yc(s)]},bT=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return yT;var e=xT(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},wT=sw(),fs="data-scroll-locked",vT=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(nT,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(fs,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Qo,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Zo,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Qo," .").concat(Qo,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Zo," .").concat(Zo,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(fs,`] {
    `).concat(rT,": ").concat(a,`px;
  }
`)},um=function(){var t=parseInt(document.body.getAttribute(fs)||"0",10);return isFinite(t)?t:0},ST=function(){x.useEffect(function(){return document.body.setAttribute(fs,(um()+1).toString()),function(){var t=um()-1;t<=0?document.body.removeAttribute(fs):document.body.setAttribute(fs,t.toString())}},[])},_T=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;ST();var i=x.useMemo(function(){return bT(s)},[s]);return x.createElement(wT,{styles:vT(i,!e,s,n?"":"!important")})},Tu=!1;if(typeof window<"u")try{var Co=Object.defineProperty({},"passive",{get:function(){return Tu=!0,!0}});window.addEventListener("test",Co,Co),window.removeEventListener("test",Co,Co)}catch{Tu=!1}var zr=Tu?{passive:!1}:!1,kT=function(t){return t.tagName==="TEXTAREA"},iw=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!kT(t)&&n[e]==="visible")},CT=function(t){return iw(t,"overflowY")},ET=function(t){return iw(t,"overflowX")},dm=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=ow(t,r);if(s){var i=aw(t,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},PT=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},AT=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},ow=function(t,e){return t==="v"?CT(e):ET(e)},aw=function(t,e){return t==="v"?PT(e):AT(e)},jT=function(t,e){return t==="h"&&e==="rtl"?-1:1},NT=function(t,e,n,r,s){var i=jT(t,window.getComputedStyle(e).direction),o=i*r,a=n.target,l=e.contains(a),c=!1,u=o>0,h=0,f=0;do{if(!a)break;var p=aw(t,a),m=p[0],y=p[1],v=p[2],S=y-v-i*m;(m||S)&&ow(t,a)&&(h+=S,f+=m);var E=a.parentNode;a=E&&E.nodeType===Node.DOCUMENT_FRAGMENT_NODE?E.host:E}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(h)<1||!u&&Math.abs(f)<1)&&(c=!0),c},Eo=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},hm=function(t){return[t.deltaX,t.deltaY]},fm=function(t){return t&&"current"in t?t.current:t},TT=function(t,e){return t[0]===e[0]&&t[1]===e[1]},RT=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},OT=0,Hr=[];function IT(t){var e=x.useRef([]),n=x.useRef([0,0]),r=x.useRef(),s=x.useState(OT++)[0],i=x.useState(sw)[0],o=x.useRef(t);x.useEffect(function(){o.current=t},[t]),x.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var y=DC([t.lockRef.current],(t.shards||[]).map(fm),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=x.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!o.current.allowPinchZoom;var S=Eo(y),E=n.current,k="deltaX"in y?y.deltaX:E[0]-S[0],g="deltaY"in y?y.deltaY:E[1]-S[1],w,_=y.target,P=Math.abs(k)>Math.abs(g)?"h":"v";if("touches"in y&&P==="h"&&_.type==="range")return!1;var b=window.getSelection(),C=b&&b.anchorNode,A=C?C===_||C.contains(_):!1;if(A)return!1;var N=dm(P,_);if(!N)return!0;if(N?w=P:(w=P==="v"?"h":"v",N=dm(P,_)),!N)return!1;if(!r.current&&"changedTouches"in y&&(k||g)&&(r.current=w),!w)return!0;var O=r.current||w;return NT(O,v,y,O==="h"?k:g)},[]),l=x.useCallback(function(y){var v=y;if(!(!Hr.length||Hr[Hr.length-1]!==i)){var S="deltaY"in v?hm(v):Eo(v),E=e.current.filter(function(w){return w.name===v.type&&(w.target===v.target||v.target===w.shadowParent)&&TT(w.delta,S)})[0];if(E&&E.should){v.cancelable&&v.preventDefault();return}if(!E){var k=(o.current.shards||[]).map(fm).filter(Boolean).filter(function(w){return w.contains(v.target)}),g=k.length>0?a(v,k[0]):!o.current.noIsolation;g&&v.cancelable&&v.preventDefault()}}},[]),c=x.useCallback(function(y,v,S,E){var k={name:y,delta:v,target:S,should:E,shadowParent:MT(S)};e.current.push(k),setTimeout(function(){e.current=e.current.filter(function(g){return g!==k})},1)},[]),u=x.useCallback(function(y){n.current=Eo(y),r.current=void 0},[]),h=x.useCallback(function(y){c(y.type,hm(y),y.target,a(y,t.lockRef.current))},[]),f=x.useCallback(function(y){c(y.type,Eo(y),y.target,a(y,t.lockRef.current))},[]);x.useEffect(function(){return Hr.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,zr),document.addEventListener("touchmove",l,zr),document.addEventListener("touchstart",u,zr),function(){Hr=Hr.filter(function(y){return y!==i}),document.removeEventListener("wheel",l,zr),document.removeEventListener("touchmove",l,zr),document.removeEventListener("touchstart",u,zr)}},[]);var p=t.removeScrollBar,m=t.inert;return x.createElement(x.Fragment,null,m?x.createElement(i,{styles:RT(s)}):null,p?x.createElement(_T,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function MT(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const DT=uT(rw,IT);var wl=x.forwardRef(function(t,e){return x.createElement(bl,Qt({},t,{ref:e,sideCar:DT}))});wl.classNames=bl.classNames;var LT=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Kr=new WeakMap,Po=new WeakMap,Ao={},xc=0,lw=function(t){return t&&(t.host||lw(t.parentNode))},$T=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=lw(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},FT=function(t,e,n,r){var s=$T(e,Array.isArray(t)?t:[t]);Ao[n]||(Ao[n]=new WeakMap);var i=Ao[n],o=[],a=new Set,l=new Set(s),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};s.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(r),m=p!==null&&p!=="false",y=(Kr.get(f)||0)+1,v=(i.get(f)||0)+1;Kr.set(f,y),i.set(f,v),o.push(f),y===1&&m&&Po.set(f,!0),v===1&&f.setAttribute(n,"true"),m||f.setAttribute(r,"true")}catch(S){console.error("aria-hidden: cannot operate on ",f,S)}})};return u(e),a.clear(),xc++,function(){o.forEach(function(h){var f=Kr.get(h)-1,p=i.get(h)-1;Kr.set(h,f),i.set(h,p),f||(Po.has(h)||h.removeAttribute(r),Po.delete(h)),p||h.removeAttribute(n)}),xc--,xc||(Kr=new WeakMap,Kr=new WeakMap,Po=new WeakMap,Ao={})}},oh=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=LT(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),FT(r,s,n,"aria-hidden")):function(){return null}},ah="Dialog",[cw,uw]=w2(ah),[UT,Ht]=cw(ah),dw=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=x.useRef(null),l=x.useRef(null),[c=!1,u]=C2({prop:r,defaultProp:s,onChange:i});return d.jsx(UT,{scope:e,triggerRef:a,contentRef:l,contentId:vr(),titleId:vr(),descriptionId:vr(),open:c,onOpenChange:u,onOpenToggle:x.useCallback(()=>u(h=>!h),[u]),modal:o,children:n})};dw.displayName=ah;var hw="DialogTrigger",fw=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Ht(hw,n),i=Rs(e,s.triggerRef);return d.jsx(Jn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":uh(s.open),...r,ref:i,onClick:Bn(t.onClick,s.onOpenToggle)})});fw.displayName=hw;var lh="DialogPortal",[BT,pw]=cw(lh,{forceMount:void 0}),mw=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Ht(lh,e);return d.jsx(BT,{scope:e,forceMount:n,children:x.Children.map(r,o=>d.jsx(xl,{present:n||i.open,children:d.jsx(tw,{asChild:!0,container:s,children:o})}))})};mw.displayName=lh;var Oa="DialogOverlay",gw=x.forwardRef((t,e)=>{const n=pw(Oa,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Ht(Oa,t.__scopeDialog);return i.modal?d.jsx(xl,{present:r||i.open,children:d.jsx(VT,{...s,ref:e})}):null});gw.displayName=Oa;var VT=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Ht(Oa,n);return d.jsx(wl,{as:tt,allowPinchZoom:!0,shards:[s.contentRef],children:d.jsx(Jn.div,{"data-state":uh(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Er="DialogContent",yw=x.forwardRef((t,e)=>{const n=pw(Er,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Ht(Er,t.__scopeDialog);return d.jsx(xl,{present:r||i.open,children:i.modal?d.jsx(WT,{...s,ref:e}):d.jsx(zT,{...s,ref:e})})});yw.displayName=Er;var WT=x.forwardRef((t,e)=>{const n=Ht(Er,t.__scopeDialog),r=x.useRef(null),s=Rs(e,n.contentRef,r);return x.useEffect(()=>{const i=r.current;if(i)return oh(i)},[]),d.jsx(xw,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Bn(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Bn(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:Bn(t.onFocusOutside,i=>i.preventDefault())})}),zT=x.forwardRef((t,e)=>{const n=Ht(Er,t.__scopeDialog),r=x.useRef(!1),s=x.useRef(!1);return d.jsx(xw,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),xw=x.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=Ht(Er,n),l=x.useRef(null),c=Rs(e,l);return ih(),d.jsxs(d.Fragment,{children:[d.jsx(yl,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(Qb,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":uh(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),d.jsxs(d.Fragment,{children:[d.jsx(KT,{titleId:a.titleId}),d.jsx(qT,{contentRef:l,descriptionId:a.descriptionId})]})]})}),ch="DialogTitle",bw=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Ht(ch,n);return d.jsx(Jn.h2,{id:s.titleId,...r,ref:e})});bw.displayName=ch;var ww="DialogDescription",vw=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Ht(ww,n);return d.jsx(Jn.p,{id:s.descriptionId,...r,ref:e})});vw.displayName=ww;var Sw="DialogClose",_w=x.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Ht(Sw,n);return d.jsx(Jn.button,{type:"button",...r,ref:e,onClick:Bn(t.onClick,()=>s.onOpenChange(!1))})});_w.displayName=Sw;function uh(t){return t?"open":"closed"}var kw="DialogTitleWarning",[HT,Cw]=b2(kw,{contentName:Er,titleName:ch,docsSlug:"dialog"}),KT=({titleId:t})=>{const e=Cw(kw),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return x.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},GT="DialogDescriptionWarning",qT=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Cw(GT).contentName}}.`;return x.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},YT=dw,JT=fw,XT=mw,QT=gw,ZT=yw,eR=bw,tR=vw,Ew=_w;function nR(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}var Pw="AlertDialog",[rR]=m2(Pw,[uw]),Cn=uw(),Aw=t=>{const{__scopeAlertDialog:e,...n}=t,r=Cn(e);return d.jsx(YT,{...r,...n,modal:!0})};Aw.displayName=Pw;var sR="AlertDialogTrigger",jw=x.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Cn(n);return d.jsx(JT,{...s,...r,ref:e})});jw.displayName=sR;var iR="AlertDialogPortal",Nw=t=>{const{__scopeAlertDialog:e,...n}=t,r=Cn(e);return d.jsx(XT,{...r,...n})};Nw.displayName=iR;var oR="AlertDialogOverlay",Tw=x.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Cn(n);return d.jsx(QT,{...s,...r,ref:e})});Tw.displayName=oR;var ps="AlertDialogContent",[aR,lR]=rR(ps),Rw=x.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...s}=t,i=Cn(n),o=x.useRef(null),a=Yb(e,o),l=x.useRef(null);return d.jsx(HT,{contentName:ps,titleName:Ow,docsSlug:"alert-dialog",children:d.jsx(aR,{scope:n,cancelRef:l,children:d.jsxs(ZT,{role:"alertdialog",...i,...s,ref:a,onOpenAutoFocus:nR(s.onOpenAutoFocus,c=>{var u;c.preventDefault(),(u=l.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[d.jsx(Jb,{children:r}),d.jsx(uR,{contentRef:o})]})})})});Rw.displayName=ps;var Ow="AlertDialogTitle",Iw=x.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Cn(n);return d.jsx(eR,{...s,...r,ref:e})});Iw.displayName=Ow;var Mw="AlertDialogDescription",Dw=x.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Cn(n);return d.jsx(tR,{...s,...r,ref:e})});Dw.displayName=Mw;var cR="AlertDialogAction",Lw=x.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Cn(n);return d.jsx(Ew,{...s,...r,ref:e})});Lw.displayName=cR;var $w="AlertDialogCancel",Fw=x.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:s}=lR($w,n),i=Cn(n),o=Yb(e,s);return d.jsx(Ew,{...i,...r,ref:o})});Fw.displayName=$w;var uR=({contentRef:t})=>{const e=`\`${ps}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ps}\` by passing a \`${Mw}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ps}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return x.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},dR=Aw,hR=jw,fR=Nw,pR=Tw,mR=Rw,gR=Lw,yR=Fw,xR=Iw,bR=Dw;const pm=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,mm=O0,wR=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return mm(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],h=i==null?void 0:i[c];if(u===null)return null;const f=pm(u)||pm(h);return s[c][f]}),a=n&&Object.entries(n).reduce((c,u)=>{let[h,f]=u;return f===void 0||(c[h]=f),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:f,...p}=u;return Object.entries(p).every(m=>{let[y,v]=m;return Array.isArray(v)?v.includes({...i,...a}[y]):{...i,...a}[y]===v})?[...c,h,f]:c},[]);return mm(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},Uw=wR("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function dh({...t}){return d.jsx(dR,{"data-slot":"alert-dialog",...t})}function vR({...t}){return d.jsx(hR,{"data-slot":"alert-dialog-trigger",...t})}function SR({...t}){return d.jsx(fR,{"data-slot":"alert-dialog-portal",...t})}function _R({className:t,...e}){return d.jsx(pR,{"data-slot":"alert-dialog-overlay",className:dt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...e})}function hh({className:t,...e}){return d.jsxs(SR,{children:[d.jsx(_R,{}),d.jsx(mR,{"data-slot":"alert-dialog-content",className:dt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...e})]})}function fh({className:t,...e}){return d.jsx("div",{"data-slot":"alert-dialog-header",className:dt("flex flex-col gap-2 text-center sm:text-left",t),...e})}function ph({className:t,...e}){return d.jsx("div",{"data-slot":"alert-dialog-footer",className:dt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...e})}function mh({className:t,...e}){return d.jsx(xR,{"data-slot":"alert-dialog-title",className:dt("text-lg font-semibold",t),...e})}function gh({className:t,...e}){return d.jsx(bR,{"data-slot":"alert-dialog-description",className:dt("text-muted-foreground text-sm",t),...e})}function Bw({className:t,...e}){return d.jsx(gR,{className:dt(Uw(),t),...e})}function Vw({className:t,...e}){return d.jsx(yR,{className:dt(Uw({variant:"outline"}),t),...e})}const kR={Happy:xd,Sad:k0,Grateful:xn,Excited:bd,Calm:C0,Inspired:on,Stressed:E0,Energetic:wd},CR={Happy:"bg-yellow-100 text-yellow-700",Sad:"bg-blue-100 text-blue-700",Grateful:"bg-pink-100 text-pink-700",Excited:"bg-purple-100 text-purple-700",Calm:"bg-green-100 text-green-700",Inspired:"bg-indigo-100 text-indigo-700",Stressed:"bg-gray-100 text-gray-700",Energetic:"bg-orange-100 text-orange-700"};function Ww({entry:t,onDelete:e}){var a,l;const n=kR[t.mood]||xd,r=new Date(t.date),s=ks(),[i,o]=x.useState(!1);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm overflow-hidden group hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden bg-gray-100",children:[d.jsx(Ot,{src:t.photo,alt:t.caption,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}),d.jsxs("div",{className:"absolute top-3 right-3 flex gap-2 opacity-0 group-hover:opacity-100 transition-all",children:[d.jsx("button",{onClick:()=>o(!0),className:"bg-white/90 dark:bg-gray-800/90 hover:bg-purple-500 hover:text-white text-gray-700 dark:text-gray-300 rounded-full p-2 shadow-lg transition-colors","aria-label":"Share entry",children:d.jsx(Ya,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>s(`/edit/${t.id}`),className:"bg-white/90 dark:bg-gray-800/90 hover:bg-blue-500 hover:text-white text-gray-700 dark:text-gray-300 rounded-full p-2 shadow-lg transition-colors","aria-label":"Edit entry",children:d.jsx(D1,{className:"w-4 h-4"})}),d.jsxs(dh,{children:[d.jsx(vR,{asChild:!0,children:d.jsx("button",{className:"bg-white/90 dark:bg-gray-800/90 hover:bg-red-500 hover:text-white text-gray-700 dark:text-gray-300 rounded-full p-2 shadow-lg transition-colors","aria-label":"Delete entry",children:d.jsx(Sd,{className:"w-4 h-4"})})}),d.jsxs(hh,{className:"bg-white dark:bg-gray-800 dark:text-white border-gray-200 dark:border-gray-700",children:[d.jsxs(fh,{children:[d.jsx(mh,{className:"text-gray-900 dark:text-white",children:"Are you absolutely sure?"}),d.jsx(gh,{className:"text-gray-500 dark:text-gray-400",children:"This action cannot be undone. This will permanently delete this memory from our servers."})]}),d.jsxs(ph,{children:[d.jsx(Vw,{className:"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600 border-none",children:"Cancel"}),d.jsx(Bw,{onClick:()=>e(t.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})]}),d.jsxs("div",{className:"p-4 space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:xe(r,"EEEE, MMMM d, yyyy")}),d.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:xe(r,"h:mm a")})]}),d.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full ${CR[t.mood]}`,children:[d.jsx(n,{className:"w-4 h-4"}),d.jsx("span",{className:"text-sm",children:t.mood})]})]}),d.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:t.caption}),(t.tags&&t.tags.length>0||t.aiTags&&t.aiTags.length>0)&&d.jsxs("div",{className:"flex flex-wrap gap-1.5 pt-2",children:[(a=t.tags)==null?void 0:a.map(c=>d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300",children:["#",c]},c)),(l=t.aiTags)==null?void 0:l.map(c=>d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-purple-50 dark:bg-purple-900/30 text-purple-600 dark:text-purple-300",children:[d.jsx(on,{className:"w-2 h-2 mr-1"}),c]},`ai-${c}`))]})]})]}),i&&d.jsx(p2,{entry:t,onClose:()=>o(!1)})]})}function ER({value:t,onChange:e,placeholder:n="Search memories..."}){const r=()=>{e("")};return d.jsxs("div",{className:"relative",children:[d.jsx(L1,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),d.jsx("input",{type:"text",value:t,onChange:s=>e(s.target.value),placeholder:n,className:"w-full pl-12 pr-12 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t&&d.jsx("button",{onClick:r,className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded-full transition-colors",children:d.jsx(Ct,{className:"w-4 h-4 text-gray-400"})})]})}function qt({className:t,...e}){return d.jsx("div",{"data-slot":"skeleton",className:dt("bg-accent animate-pulse rounded-md",t),...e})}function PR({entries:t,onDeleteEntry:e,loading:n=!1}){const{t:r}=Pe(),[s,i]=x.useState("All"),[o,a]=x.useState(""),l=["All",...Td.map(u=>u.name)],c=x.useMemo(()=>{let u=t;if(s!=="All"&&(u=u.filter(h=>h.mood===s)),o.trim()){const h=o.toLowerCase();u=u.filter(f=>f.caption.toLowerCase().includes(h)||f.mood.toLowerCase().includes(h))}return u},[t,s,o]);return n?d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[d.jsx(qt,{className:"h-8 w-48 bg-gray-200 dark:bg-gray-700"}),d.jsx(qt,{className:"h-6 w-24 bg-gray-200 dark:bg-gray-700"})]}),d.jsx(qt,{className:"h-16 w-full rounded-2xl bg-gray-200 dark:bg-gray-700"}),d.jsx(qt,{className:"h-12 w-full rounded-xl bg-gray-200 dark:bg-gray-700"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(u=>d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm overflow-hidden h-full",children:[d.jsx(qt,{className:"aspect-[4/3] w-full bg-gray-200 dark:bg-gray-700"}),d.jsxs("div",{className:"p-4 space-y-3",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(qt,{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700"}),d.jsx(qt,{className:"h-3 w-20 bg-gray-200 dark:bg-gray-700"})]}),d.jsx(qt,{className:"h-8 w-20 rounded-full bg-gray-200 dark:bg-gray-700"})]}),d.jsx(qt,{className:"h-4 w-full bg-gray-200 dark:bg-gray-700"}),d.jsx(qt,{className:"h-4 w-2/3 bg-gray-200 dark:bg-gray-700"})]})]},u))})]}):t.length===0?d.jsxs("div",{className:"text-center py-20 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm rounded-3xl border border-white/20 dark:border-gray-700/30",children:[d.jsx("div",{className:"w-24 h-24 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse",children:d.jsx("span",{className:"text-4xl",children:""})}),d.jsx("h3",{className:"text-2xl font-medium text-gray-900 dark:text-gray-100 mb-2",children:r("timeline.empty")}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400 max-w-sm mx-auto",children:r("timeline.start")})]}):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(bs,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),d.jsx("h2",{className:"text-2xl text-gray-900 dark:text-gray-100",children:r("timeline.title")})]}),d.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[c.length," ",c.length===1?"memory":"memories"]})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-4 border border-gray-100 dark:border-gray-700 transition-colors",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[d.jsx(I0,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"}),d.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-200",children:r("timeline.filter")})]}),d.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(u=>d.jsx("button",{onClick:()=>i(u),className:`px-4 py-2 rounded-full text-sm transition-all ${s===u?"bg-blue-600 dark:bg-blue-500 text-white shadow-sm":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:u==="All"?r("timeline.all"):r(`moods.${u.toLowerCase()}`,u)},u))})]}),d.jsx("div",{className:"mt-4",children:d.jsx(ER,{value:o,onChange:a,placeholder:r("timeline.search")})}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(u=>d.jsx(Ww,{entry:u,onDelete:e},u.id))}),c.length===0&&d.jsxs("div",{className:"text-center py-16",children:[d.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx(bs,{className:"w-10 h-10 text-gray-400 dark:text-gray-500"})}),d.jsx("h3",{className:"text-xl mb-2 text-gray-700 dark:text-gray-200",children:"No matches found"}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:s!=="All"?`No entries with "${r(`moods.${s.toLowerCase()}`,s)}" mood found`:"Try adjusting your search"})]})]})}function AR({entries:t,onDeleteEntry:e}){const[n,r]=x.useState(new Date),[s,i]=x.useState(null),o=x.useMemo(()=>{const h=Ck(n),f=Ek(n),p=Pk(h),m=Ak(f);return jk({start:p,end:m})},[n]),a=x.useMemo(()=>{const h=new Map;return t.forEach(f=>{const p=xe(new Date(f.date),"yyyy-MM-dd");h.has(p)||h.set(p,[]),h.get(p).push(f)}),h},[t]),l=x.useMemo(()=>{if(!s)return[];const h=xe(s,"yyyy-MM-dd");return a.get(h)||[]},[s,a]),c=()=>{r(h=>new Date(h.getFullYear(),h.getMonth()-1,1))},u=()=>{r(h=>new Date(h.getFullYear(),h.getMonth()+1,1))};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-2xl",children:xe(n,"MMMM yyyy")}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx($1,{className:"w-5 h-5"})}),d.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx(F1,{className:"w-5 h-5"})})]})]}),d.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(h=>d.jsx("div",{className:"text-center text-sm text-gray-500 p-2",children:h},h))}),d.jsx("div",{className:"grid grid-cols-7 gap-2",children:o.map(h=>{const f=xe(h,"yyyy-MM-dd"),p=a.get(f)||[],m=p.length>0,y=Nk(h,n),v=s&&z0(h,s);return d.jsx("button",{onClick:()=>i(h),className:`aspect-square p-2 rounded-lg border transition-all ${v?"border-blue-600 bg-blue-50":m?"border-purple-200 bg-purple-50 hover:bg-purple-100":y?"border-gray-200 hover:bg-gray-50":"border-transparent text-gray-300"} ${y?"":"opacity-50"}`,children:d.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[d.jsx("span",{className:"text-sm",children:xe(h,"d")}),m&&d.jsx("div",{className:"flex gap-1 mt-1",children:p.slice(0,3).map((S,E)=>d.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-600"},E))})]})},h.toISOString())})})]}),s&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-xl",children:xe(s,"EEEE, MMMM d, yyyy")}),d.jsx("button",{onClick:()=>i(null),className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear selection"})]}),l.length>0?d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(h=>d.jsx(Ww,{entry:h,onDelete:e},h.id))}):d.jsx("div",{className:"text-center py-8 text-gray-500 bg-white rounded-2xl",children:"No memories for this day"})]})]})}(function(){function t(e){return this instanceof t?(this._canvas=e=typeof e=="string"?document.getElementById(e):e,this._ctx=e.getContext("2d"),this._width=e.width,this._height=e.height,this._max=1,void this.clear()):new t(e)}t.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(e,n){return this._data=e,this},max:function(e){return this._max=e,this},add:function(e){return this._data.push(e),this},clear:function(){return this._data=[],this},radius:function(e,n){n=n||15;var r=this._circle=document.createElement("canvas"),s=r.getContext("2d"),i=this._r=e+n;return r.width=r.height=2*i,s.shadowOffsetX=s.shadowOffsetY=200,s.shadowBlur=n,s.shadowColor="black",s.beginPath(),s.arc(i-200,i-200,e,0,2*Math.PI,!0),s.closePath(),s.fill(),this},gradient:function(e){var n=document.createElement("canvas"),r=n.getContext("2d"),s=r.createLinearGradient(0,0,0,256);n.width=1,n.height=256;for(var i in e)s.addColorStop(i,e[i]);return r.fillStyle=s,r.fillRect(0,0,1,256),this._grad=r.getImageData(0,0,1,256).data,this},draw:function(e){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var n=this._ctx;n.clearRect(0,0,this._width,this._height);for(var r,s=0,i=this._data.length;i>s;s++)r=this._data[s],n.globalAlpha=Math.max(r[2]/this._max,e||.05),n.drawImage(this._circle,r[0]-this._r,r[1]-this._r);var o=n.getImageData(0,0,this._width,this._height);return this._colorize(o.data,this._grad),n.putImageData(o,0,0),this},_colorize:function(e,n){for(var r,s=3,i=e.length;i>s;s+=4)r=4*e[s],r&&(e[s-3]=n[r],e[s-2]=n[r+1],e[s-1]=n[r+2])}},window.simpleheat=t})(),L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(t,e){this._latlngs=t,L.setOptions(this,e)},setLatLngs:function(t){return this._latlngs=t,this.redraw()},addLatLng:function(t){return this._latlngs.push(t),this.redraw()},setOptions:function(t){return L.setOptions(this,t),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this._canvas||this._initCanvas(),t._panes.overlayPane.appendChild(this._canvas),t.on("moveend",this._reset,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._canvas),t.off("moveend",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},_initCanvas:function(){var t=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),e=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);t.style[e]="50% 50%";var n=this._map.getSize();t.width=n.x,t.height=n.y;var r=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(t,"leaflet-zoom-"+(r?"animated":"hide")),this._heat=simpleheat(t),this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur),this.options.gradient&&this._heat.gradient(this.options.gradient),this.options.max&&this._heat.max(this.options.max)},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t);var e=this._map.getSize();this._heat._width!==e.x&&(this._canvas.width=this._heat._width=e.x),this._heat._height!==e.y&&(this._canvas.height=this._heat._height=e.y),this._redraw()},_redraw:function(){var t,e,n,r,s,i,o,a,l,c=[],u=this._heat._r,h=this._map.getSize(),f=new L.Bounds(L.point([-u,-u]),h.add([u,u])),p=this.options.max===void 0?1:this.options.max,m=this.options.maxZoom===void 0?this._map.getMaxZoom():this.options.maxZoom,y=1/Math.pow(2,Math.max(0,Math.min(m-this._map.getZoom(),12))),v=u/2,S=[],E=this._map._getMapPanePos(),k=E.x%v,g=E.y%v;for(t=0,e=this._latlngs.length;e>t;t++)if(n=this._map.latLngToContainerPoint(this._latlngs[t]),f.contains(n)){s=Math.floor((n.x-k)/v)+2,i=Math.floor((n.y-g)/v)+2;var w=this._latlngs[t].alt!==void 0?this._latlngs[t].alt:this._latlngs[t][2]!==void 0?+this._latlngs[t][2]:1;l=w*y,S[i]=S[i]||[],r=S[i][s],r?(r[0]=(r[0]*r[2]+n.x*l)/(r[2]+l),r[1]=(r[1]*r[2]+n.y*l)/(r[2]+l),r[2]+=l):S[i][s]=[n.x,n.y,l]}for(t=0,e=S.length;e>t;t++)if(S[t])for(o=0,a=S[t].length;a>o;o++)r=S[t][o],r&&c.push([Math.round(r[0]),Math.round(r[1]),Math.min(r[2],p)]);this._heat.data(c).draw(this.options.minOpacity),this._frame=null},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,n,e):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(n)+" scale("+e+")"}}),L.heatLayer=function(t,e){return new L.HeatLayer(t,e)};function Ia(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function gm(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function jR(...t){return e=>{let n=!1;const r=t.map(s=>{const i=gm(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():gm(t[s],null)}}}}function NR(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,TR(s,...e)]}function TR(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function zw(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function RR({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=OR({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,a=zw(n),l=x.useCallback(c=>{if(i){const h=typeof c=="function"?c(t):c;h!==t&&a(h)}else s(c)},[i,t,s,a]);return[o,l]}function OR({defaultProp:t,onChange:e}){const n=x.useState(t),[r]=n,s=x.useRef(r),i=zw(e);return x.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}var IR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],MR=IR.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function je(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function Hw(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,DR(s,...e)]}function DR(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function ym(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Kw(...t){return e=>{let n=!1;const r=t.map(s=>{const i=ym(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():ym(t[s],null)}}}}function an(...t){return x.useCallback(Kw(...t),t)}function LR(t){const e=t+"CollectionProvider",[n,r]=Hw(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:m,children:y}=p,v=fe.useRef(null),S=fe.useRef(new Map).current;return d.jsx(s,{scope:m,itemMap:S,collectionRef:v,children:y})};o.displayName=e;const a=t+"CollectionSlot",l=fe.forwardRef((p,m)=>{const{scope:y,children:v}=p,S=i(a,y),E=an(m,S.collectionRef);return d.jsx(tt,{ref:E,children:v})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",h=fe.forwardRef((p,m)=>{const{scope:y,children:v,...S}=p,E=fe.useRef(null),k=an(m,E),g=i(c,y);return fe.useEffect(()=>(g.itemMap.set(E,{ref:E,...S}),()=>void g.itemMap.delete(E))),d.jsx(tt,{[u]:"",ref:k,children:v})});h.displayName=c;function f(p){const m=i(t+"CollectionConsumer",p);return fe.useCallback(()=>{const v=m.collectionRef.current;if(!v)return[];const S=Array.from(v.querySelectorAll(`[${u}]`));return Array.from(m.itemMap.values()).sort((g,w)=>S.indexOf(g.ref.current)-S.indexOf(w.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:o,Slot:l,ItemSlot:h},f,r]}var $R=x.createContext(void 0);function Gw(t){const e=x.useContext($R);return t||e||"ltr"}var FR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Xn=FR.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function qw(t,e){t&&Xa.flushSync(()=>t.dispatchEvent(e))}function zi(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function UR(t,e=globalThis==null?void 0:globalThis.document){const n=zi(t);x.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var BR="DismissableLayer",Ru="dismissableLayer.update",VR="dismissableLayer.pointerDownOutside",WR="dismissableLayer.focusOutside",xm,Yw=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Jw=x.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=x.useContext(Yw),[u,h]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=x.useState({}),m=an(e,P=>h(P)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),S=y.indexOf(v),E=u?y.indexOf(u):-1,k=c.layersWithOutsidePointerEventsDisabled.size>0,g=E>=S,w=KR(P=>{const b=P.target,C=[...c.branches].some(A=>A.contains(b));!g||C||(s==null||s(P),o==null||o(P),P.defaultPrevented||a==null||a())},f),_=GR(P=>{const b=P.target;[...c.branches].some(A=>A.contains(b))||(i==null||i(P),o==null||o(P),P.defaultPrevented||a==null||a())},f);return UR(P=>{E===c.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&a&&(P.preventDefault(),a()))},f),x.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(xm=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),bm(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=xm)}},[u,f,n,c]),x.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),bm())},[u,c]),x.useEffect(()=>{const P=()=>p({});return document.addEventListener(Ru,P),()=>document.removeEventListener(Ru,P)},[]),d.jsx(Xn.div,{...l,ref:m,style:{pointerEvents:k?g?"auto":"none":void 0,...t.style},onFocusCapture:je(t.onFocusCapture,_.onFocusCapture),onBlurCapture:je(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:je(t.onPointerDownCapture,w.onPointerDownCapture)})});Jw.displayName=BR;var zR="DismissableLayerBranch",HR=x.forwardRef((t,e)=>{const n=x.useContext(Yw),r=x.useRef(null),s=an(e,r);return x.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),d.jsx(Xn.div,{...t,ref:s})});HR.displayName=zR;function KR(t,e=globalThis==null?void 0:globalThis.document){const n=zi(t),r=x.useRef(!1),s=x.useRef(()=>{});return x.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){Xw(VR,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function GR(t,e=globalThis==null?void 0:globalThis.document){const n=zi(t),r=x.useRef(!1);return x.useEffect(()=>{const s=i=>{i.target&&!r.current&&Xw(WR,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function bm(){const t=new CustomEvent(Ru);document.dispatchEvent(t)}function Xw(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?qw(s,i):s.dispatchEvent(i)}const qR=["top","right","bottom","left"],Hn=Math.min,St=Math.max,Ma=Math.round,jo=Math.floor,rn=t=>({x:t,y:t}),YR={left:"right",right:"left",bottom:"top",top:"bottom"},JR={start:"end",end:"start"};function Ou(t,e,n){return St(t,Hn(e,n))}function wn(t,e){return typeof t=="function"?t(e):t}function vn(t){return t.split("-")[0]}function Os(t){return t.split("-")[1]}function yh(t){return t==="x"?"y":"x"}function xh(t){return t==="y"?"height":"width"}const XR=new Set(["top","bottom"]);function nn(t){return XR.has(vn(t))?"y":"x"}function bh(t){return yh(nn(t))}function QR(t,e,n){n===void 0&&(n=!1);const r=Os(t),s=bh(t),i=xh(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Da(o)),[o,Da(o)]}function ZR(t){const e=Da(t);return[Iu(t),e,Iu(e)]}function Iu(t){return t.replace(/start|end/g,e=>JR[e])}const wm=["left","right"],vm=["right","left"],eO=["top","bottom"],tO=["bottom","top"];function nO(t,e,n){switch(t){case"top":case"bottom":return n?e?vm:wm:e?wm:vm;case"left":case"right":return e?eO:tO;default:return[]}}function rO(t,e,n,r){const s=Os(t);let i=nO(vn(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(Iu)))),i}function Da(t){return t.replace(/left|right|bottom|top/g,e=>YR[e])}function sO(t){return{top:0,right:0,bottom:0,left:0,...t}}function Qw(t){return typeof t!="number"?sO(t):{top:t,right:t,bottom:t,left:t}}function La(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function Sm(t,e,n){let{reference:r,floating:s}=t;const i=nn(e),o=bh(e),a=xh(o),l=vn(e),c=i==="y",u=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[a]/2-s[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-s.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-s.width,y:h};break;default:p={x:r.x,y:r.y}}switch(Os(e)){case"start":p[o]-=f*(n&&c?-1:1);break;case"end":p[o]+=f*(n&&c?-1:1);break}return p}async function iO(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=wn(e,t),m=Qw(p),v=a[f?h==="floating"?"reference":"floating":h],S=La(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),E=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),g=await(i.isElement==null?void 0:i.isElement(k))?await(i.getScale==null?void 0:i.getScale(k))||{x:1,y:1}:{x:1,y:1},w=La(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:E,offsetParent:k,strategy:l}):E);return{top:(S.top-w.top+m.top)/g.y,bottom:(w.bottom-S.bottom+m.bottom)/g.y,left:(S.left-w.left+m.left)/g.x,right:(w.right-S.right+m.right)/g.x}}const oO=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:h}=Sm(c,r,l),f=r,p={},m=0;for(let v=0;v<a.length;v++){var y;const{name:S,fn:E}=a[v],{x:k,y:g,data:w,reset:_}=await E({x:u,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:p,rects:c,platform:{...o,detectOverflow:(y=o.detectOverflow)!=null?y:iO},elements:{reference:t,floating:e}});u=k??u,h=g??h,p={...p,[S]:{...p[S],...w}},_&&m<=50&&(m++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(c=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):_.rects),{x:u,y:h}=Sm(c,f,l)),v=-1)}return{x:u,y:h,placement:f,strategy:s,middlewareData:p}},aO=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=wn(t,e)||{};if(c==null)return{};const h=Qw(u),f={x:n,y:r},p=bh(s),m=xh(p),y=await o.getDimensions(c),v=p==="y",S=v?"top":"left",E=v?"bottom":"right",k=v?"clientHeight":"clientWidth",g=i.reference[m]+i.reference[p]-f[p]-i.floating[m],w=f[p]-i.reference[p],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let P=_?_[k]:0;(!P||!await(o.isElement==null?void 0:o.isElement(_)))&&(P=a.floating[k]||i.floating[m]);const b=g/2-w/2,C=P/2-y[m]/2-1,A=Hn(h[S],C),N=Hn(h[E],C),O=A,I=P-y[m]-N,T=P/2-y[m]/2+b,M=Ou(O,T,I),R=!l.arrow&&Os(s)!=null&&T!==M&&i.reference[m]/2-(T<O?A:N)-y[m]/2<0,j=R?T<O?T-O:T-I:0;return{[p]:f[p]+j,data:{[p]:M,centerOffset:T-M-j,...R&&{alignmentOffset:j}},reset:R}}}),lO=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...v}=wn(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const S=vn(s),E=nn(a),k=vn(a)===a,g=await(l.isRTL==null?void 0:l.isRTL(c.floating)),w=f||(k||!y?[Da(a)]:ZR(a)),_=m!=="none";!f&&_&&w.push(...rO(a,y,m,g));const P=[a,...w],b=await l.detectOverflow(e,v),C=[];let A=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&C.push(b[S]),h){const T=QR(s,o,g);C.push(b[T[0]],b[T[1]])}if(A=[...A,{placement:s,overflows:C}],!C.every(T=>T<=0)){var N,O;const T=(((N=i.flip)==null?void 0:N.index)||0)+1,M=P[T];if(M&&(!(h==="alignment"?E!==nn(M):!1)||A.every(D=>nn(D.placement)===E?D.overflows[0]>0:!0)))return{data:{index:T,overflows:A},reset:{placement:M}};let R=(O=A.filter(j=>j.overflows[0]<=0).sort((j,D)=>j.overflows[1]-D.overflows[1])[0])==null?void 0:O.placement;if(!R)switch(p){case"bestFit":{var I;const j=(I=A.filter(D=>{if(_){const $=nn(D.placement);return $===E||$==="y"}return!0}).map(D=>[D.placement,D.overflows.filter($=>$>0).reduce(($,F)=>$+F,0)]).sort((D,$)=>D[1]-$[1])[0])==null?void 0:I[0];j&&(R=j);break}case"initialPlacement":R=a;break}if(s!==R)return{reset:{placement:R}}}return{}}}};function _m(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function km(t){return qR.some(e=>t[e]>=0)}const cO=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n,platform:r}=e,{strategy:s="referenceHidden",...i}=wn(t,e);switch(s){case"referenceHidden":{const o=await r.detectOverflow(e,{...i,elementContext:"reference"}),a=_m(o,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:km(a)}}}case"escaped":{const o=await r.detectOverflow(e,{...i,altBoundary:!0}),a=_m(o,n.floating);return{data:{escapedOffsets:a,escaped:km(a)}}}default:return{}}}}},Zw=new Set(["left","top"]);async function uO(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=vn(n),a=Os(n),l=nn(n)==="y",c=Zw.has(o)?-1:1,u=i&&l?-1:1,h=wn(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const dO=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await uO(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},hO=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s,platform:i}=e,{mainAxis:o=!0,crossAxis:a=!1,limiter:l={fn:S=>{let{x:E,y:k}=S;return{x:E,y:k}}},...c}=wn(t,e),u={x:n,y:r},h=await i.detectOverflow(e,c),f=nn(vn(s)),p=yh(f);let m=u[p],y=u[f];if(o){const S=p==="y"?"top":"left",E=p==="y"?"bottom":"right",k=m+h[S],g=m-h[E];m=Ou(k,m,g)}if(a){const S=f==="y"?"top":"left",E=f==="y"?"bottom":"right",k=y+h[S],g=y-h[E];y=Ou(k,y,g)}const v=l.fn({...e,[p]:m,[f]:y});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[p]:o,[f]:a}}}}}},fO=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=wn(t,e),u={x:n,y:r},h=nn(s),f=yh(h);let p=u[f],m=u[h];const y=wn(a,e),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(l){const k=f==="y"?"height":"width",g=i.reference[f]-i.floating[k]+v.mainAxis,w=i.reference[f]+i.reference[k]-v.mainAxis;p<g?p=g:p>w&&(p=w)}if(c){var S,E;const k=f==="y"?"width":"height",g=Zw.has(vn(s)),w=i.reference[h]-i.floating[k]+(g&&((S=o.offset)==null?void 0:S[h])||0)+(g?0:v.crossAxis),_=i.reference[h]+i.reference[k]+(g?0:((E=o.offset)==null?void 0:E[h])||0)-(g?v.crossAxis:0);m<w?m=w:m>_&&(m=_)}return{[f]:p,[h]:m}}}},pO=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=wn(t,e),u=await o.detectOverflow(e,c),h=vn(s),f=Os(s),p=nn(s)==="y",{width:m,height:y}=i.floating;let v,S;h==="top"||h==="bottom"?(v=h,S=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(S=h,v=f==="end"?"top":"bottom");const E=y-u.top-u.bottom,k=m-u.left-u.right,g=Hn(y-u[v],E),w=Hn(m-u[S],k),_=!e.middlewareData.shift;let P=g,b=w;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(b=k),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(P=E),_&&!f){const A=St(u.left,0),N=St(u.right,0),O=St(u.top,0),I=St(u.bottom,0);p?b=m-2*(A!==0||N!==0?A+N:St(u.left,u.right)):P=y-2*(O!==0||I!==0?O+I:St(u.top,u.bottom))}await l({...e,availableWidth:b,availableHeight:P});const C=await o.getDimensions(a.floating);return m!==C.width||y!==C.height?{reset:{rects:!0}}:{}}}};function vl(){return typeof window<"u"}function Is(t){return ev(t)?(t.nodeName||"").toLowerCase():"#document"}function Pt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function un(t){var e;return(e=(ev(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function ev(t){return vl()?t instanceof Node||t instanceof Pt(t).Node:!1}function Wt(t){return vl()?t instanceof Element||t instanceof Pt(t).Element:!1}function ln(t){return vl()?t instanceof HTMLElement||t instanceof Pt(t).HTMLElement:!1}function Cm(t){return!vl()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Pt(t).ShadowRoot}const mO=new Set(["inline","contents"]);function Hi(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=zt(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!mO.has(s)}const gO=new Set(["table","td","th"]);function yO(t){return gO.has(Is(t))}const xO=[":popover-open",":modal"];function Sl(t){return xO.some(e=>{try{return t.matches(e)}catch{return!1}})}const bO=["transform","translate","scale","rotate","perspective"],wO=["transform","translate","scale","rotate","perspective","filter"],vO=["paint","layout","strict","content"];function wh(t){const e=vh(),n=Wt(t)?zt(t):t;return bO.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||wO.some(r=>(n.willChange||"").includes(r))||vO.some(r=>(n.contain||"").includes(r))}function SO(t){let e=Kn(t);for(;ln(e)&&!Ss(e);){if(wh(e))return e;if(Sl(e))return null;e=Kn(e)}return null}function vh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const _O=new Set(["html","body","#document"]);function Ss(t){return _O.has(Is(t))}function zt(t){return Pt(t).getComputedStyle(t)}function _l(t){return Wt(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Kn(t){if(Is(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Cm(t)&&t.host||un(t);return Cm(e)?e.host:e}function tv(t){const e=Kn(t);return Ss(e)?t.ownerDocument?t.ownerDocument.body:t.body:ln(e)&&Hi(e)?e:tv(e)}function ji(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=tv(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Pt(s);if(i){const a=Mu(o);return e.concat(o,o.visualViewport||[],Hi(s)?s:[],a&&n?ji(a):[])}return e.concat(s,ji(s,[],n))}function Mu(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function nv(t){const e=zt(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=ln(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,a=Ma(n)!==i||Ma(r)!==o;return a&&(n=i,r=o),{width:n,height:r,$:a}}function Sh(t){return Wt(t)?t:t.contextElement}function ms(t){const e=Sh(t);if(!ln(e))return rn(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=nv(e);let o=(i?Ma(n.width):n.width)/r,a=(i?Ma(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const kO=rn(0);function rv(t){const e=Pt(t);return!vh()||!e.visualViewport?kO:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function CO(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Pt(t)?!1:e}function Pr(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=Sh(t);let o=rn(1);e&&(r?Wt(r)&&(o=ms(r)):o=ms(t));const a=CO(i,n,r)?rv(i):rn(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const f=Pt(i),p=r&&Wt(r)?Pt(r):r;let m=f,y=Mu(m);for(;y&&r&&p!==m;){const v=ms(y),S=y.getBoundingClientRect(),E=zt(y),k=S.left+(y.clientLeft+parseFloat(E.paddingLeft))*v.x,g=S.top+(y.clientTop+parseFloat(E.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,h*=v.y,l+=k,c+=g,m=Pt(y),y=Mu(m)}}return La({width:u,height:h,x:l,y:c})}function kl(t,e){const n=_l(t).scrollLeft;return e?e.left+n:Pr(un(t)).left+n}function sv(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-kl(t,n),s=n.top+e.scrollTop;return{x:r,y:s}}function EO(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=un(r),a=e?Sl(e.floating):!1;if(r===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=rn(1);const u=rn(0),h=ln(r);if((h||!h&&!i)&&((Is(r)!=="body"||Hi(o))&&(l=_l(r)),ln(r))){const p=Pr(r);c=ms(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const f=o&&!h&&!i?sv(o,l):rn(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function PO(t){return Array.from(t.getClientRects())}function AO(t){const e=un(t),n=_l(t),r=t.ownerDocument.body,s=St(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=St(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+kl(t);const a=-n.scrollTop;return zt(r).direction==="rtl"&&(o+=St(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}const Em=25;function jO(t,e){const n=Pt(t),r=un(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const u=vh();(!u||u&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}const c=kl(r);if(c<=0){const u=r.ownerDocument,h=u.body,f=getComputedStyle(h),p=u.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,m=Math.abs(r.clientWidth-h.clientWidth-p);m<=Em&&(i-=m)}else c<=Em&&(i+=c);return{width:i,height:o,x:a,y:l}}const NO=new Set(["absolute","fixed"]);function TO(t,e){const n=Pr(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=ln(t)?ms(t):rn(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function Pm(t,e,n){let r;if(e==="viewport")r=jO(t,n);else if(e==="document")r=AO(un(t));else if(Wt(e))r=TO(e,n);else{const s=rv(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return La(r)}function iv(t,e){const n=Kn(t);return n===e||!Wt(n)||Ss(n)?!1:zt(n).position==="fixed"||iv(n,e)}function RO(t,e){const n=e.get(t);if(n)return n;let r=ji(t,[],!1).filter(a=>Wt(a)&&Is(a)!=="body"),s=null;const i=zt(t).position==="fixed";let o=i?Kn(t):t;for(;Wt(o)&&!Ss(o);){const a=zt(o),l=wh(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&NO.has(s.position)||Hi(o)&&!l&&iv(t,o))?r=r.filter(u=>u!==o):s=a,o=Kn(o)}return e.set(t,r),r}function OO(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?Sl(e)?[]:RO(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,u)=>{const h=Pm(e,u,s);return c.top=St(h.top,c.top),c.right=Hn(h.right,c.right),c.bottom=Hn(h.bottom,c.bottom),c.left=St(h.left,c.left),c},Pm(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function IO(t){const{width:e,height:n}=nv(t);return{width:e,height:n}}function MO(t,e,n){const r=ln(e),s=un(e),i=n==="fixed",o=Pr(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=rn(0);function c(){l.x=kl(s)}if(r||!r&&!i)if((Is(e)!=="body"||Hi(s))&&(a=_l(e)),r){const p=Pr(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?sv(s,a):rn(0),h=o.left+a.scrollLeft-l.x-u.x,f=o.top+a.scrollTop-l.y-u.y;return{x:h,y:f,width:o.width,height:o.height}}function bc(t){return zt(t).position==="static"}function Am(t,e){if(!ln(t)||zt(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return un(t)===n&&(n=n.ownerDocument.body),n}function ov(t,e){const n=Pt(t);if(Sl(t))return n;if(!ln(t)){let s=Kn(t);for(;s&&!Ss(s);){if(Wt(s)&&!bc(s))return s;s=Kn(s)}return n}let r=Am(t,e);for(;r&&yO(r)&&bc(r);)r=Am(r,e);return r&&Ss(r)&&bc(r)&&!wh(r)?n:r||SO(t)||n}const DO=async function(t){const e=this.getOffsetParent||ov,n=this.getDimensions,r=await n(t.floating);return{reference:MO(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function LO(t){return zt(t).direction==="rtl"}const $O={convertOffsetParentRelativeRectToViewportRelativeRect:EO,getDocumentElement:un,getClippingRect:OO,getOffsetParent:ov,getElementRects:DO,getClientRects:PO,getDimensions:IO,getScale:ms,isElement:Wt,isRTL:LO};function av(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function FO(t,e){let n=null,r;const s=un(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:f,height:p}=c;if(a||e(),!f||!p)return;const m=jo(h),y=jo(s.clientWidth-(u+f)),v=jo(s.clientHeight-(h+p)),S=jo(u),k={rootMargin:-m+"px "+-y+"px "+-v+"px "+-S+"px",threshold:St(0,Hn(1,l))||1};let g=!0;function w(_){const P=_[0].intersectionRatio;if(P!==l){if(!g)return o();P?o(!1,P):r=setTimeout(()=>{o(!1,1e-7)},1e3)}P===1&&!av(c,t.getBoundingClientRect())&&o(),g=!1}try{n=new IntersectionObserver(w,{...k,root:s.ownerDocument})}catch{n=new IntersectionObserver(w,k)}n.observe(t)}return o(!0),i}function UO(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Sh(t),u=s||i?[...c?ji(c):[],...ji(e)]:[];u.forEach(S=>{s&&S.addEventListener("scroll",n,{passive:!0}),i&&S.addEventListener("resize",n)});const h=c&&a?FO(c,n):null;let f=-1,p=null;o&&(p=new ResizeObserver(S=>{let[E]=S;E&&E.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var k;(k=p)==null||k.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let m,y=l?Pr(t):null;l&&v();function v(){const S=Pr(t);y&&!av(y,S)&&n(),y=S,m=requestAnimationFrame(v)}return n(),()=>{var S;u.forEach(E=>{s&&E.removeEventListener("scroll",n),i&&E.removeEventListener("resize",n)}),h==null||h(),(S=p)==null||S.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const BO=dO,VO=hO,WO=lO,zO=pO,HO=cO,jm=aO,KO=fO,GO=(t,e,n)=>{const r=new Map,s={platform:$O,...n},i={...s.platform,_c:r};return oO(t,e,{...s,platform:i})};var qO=typeof document<"u",YO=function(){},ea=qO?x.useLayoutEffect:YO;function $a(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!$a(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!$a(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function lv(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Nm(t,e){const n=lv(t);return Math.round(e*n)/n}function wc(t){const e=x.useRef(t);return ea(()=>{e.current=t}),e}function JO(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=x.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=x.useState(r);$a(f,r)||p(r);const[m,y]=x.useState(null),[v,S]=x.useState(null),E=x.useCallback(D=>{D!==_.current&&(_.current=D,y(D))},[]),k=x.useCallback(D=>{D!==P.current&&(P.current=D,S(D))},[]),g=i||m,w=o||v,_=x.useRef(null),P=x.useRef(null),b=x.useRef(u),C=l!=null,A=wc(l),N=wc(s),O=wc(c),I=x.useCallback(()=>{if(!_.current||!P.current)return;const D={placement:e,strategy:n,middleware:f};N.current&&(D.platform=N.current),GO(_.current,P.current,D).then($=>{const F={...$,isPositioned:O.current!==!1};T.current&&!$a(b.current,F)&&(b.current=F,Xa.flushSync(()=>{h(F)}))})},[f,e,n,N,O]);ea(()=>{c===!1&&b.current.isPositioned&&(b.current.isPositioned=!1,h(D=>({...D,isPositioned:!1})))},[c]);const T=x.useRef(!1);ea(()=>(T.current=!0,()=>{T.current=!1}),[]),ea(()=>{if(g&&(_.current=g),w&&(P.current=w),g&&w){if(A.current)return A.current(g,w,I);I()}},[g,w,I,A,C]);const M=x.useMemo(()=>({reference:_,floating:P,setReference:E,setFloating:k}),[E,k]),R=x.useMemo(()=>({reference:g,floating:w}),[g,w]),j=x.useMemo(()=>{const D={position:n,left:0,top:0};if(!R.floating)return D;const $=Nm(R.floating,u.x),F=Nm(R.floating,u.y);return a?{...D,transform:"translate("+$+"px, "+F+"px)",...lv(R.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:$,top:F}},[n,a,R.floating,u.x,u.y]);return x.useMemo(()=>({...u,update:I,refs:M,elements:R,floatingStyles:j}),[u,I,M,R,j])}const XO=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?jm({element:r.current,padding:s}).fn(n):{}:r?jm({element:r,padding:s}).fn(n):{}}}},QO=(t,e)=>({...BO(t),options:[t,e]}),ZO=(t,e)=>({...VO(t),options:[t,e]}),eI=(t,e)=>({...KO(t),options:[t,e]}),tI=(t,e)=>({...WO(t),options:[t,e]}),nI=(t,e)=>({...zO(t),options:[t,e]}),rI=(t,e)=>({...HO(t),options:[t,e]}),sI=(t,e)=>({...XO(t),options:[t,e]});var iI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],oI=iI.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{}),aI="Arrow",cv=x.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return d.jsx(oI.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:d.jsx("polygon",{points:"0,0 30,0 15,10"})})});cv.displayName=aI;var lI=cv;function Tm(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function cI(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Tm(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Tm(t[s],null)}}}}function uv(...t){return x.useCallback(cI(...t),t)}function uI(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,dI(s,...e)]}function dI(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var hI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],dv=hI.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function fI(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}var Rm=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},pI=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{};function hv(t){const[e,n]=x.useState(void 0);return pI(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var _h="Popper",[fv,Cl]=uI(_h),[mI,pv]=fv(_h),mv=t=>{const{__scopePopper:e,children:n}=t,[r,s]=x.useState(null);return d.jsx(mI,{scope:e,anchor:r,onAnchorChange:s,children:n})};mv.displayName=_h;var gv="PopperAnchor",yv=x.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=pv(gv,n),o=x.useRef(null),a=uv(e,o);return x.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:d.jsx(dv.div,{...s,ref:a})});yv.displayName=gv;var kh="PopperContent",[gI,yI]=fv(kh),xv=x.forwardRef((t,e)=>{var ne,pe,se,me,ve,Se;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:m,...y}=t,v=pv(kh,n),[S,E]=x.useState(null),k=uv(e,it=>E(it)),[g,w]=x.useState(null),_=hv(g),P=(_==null?void 0:_.width)??0,b=(_==null?void 0:_.height)??0,C=r+(i!=="center"?"-"+i:""),A=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},N=Array.isArray(c)?c:[c],O=N.length>0,I={padding:A,boundary:N.filter(bI),altBoundary:O},{refs:T,floatingStyles:M,placement:R,isPositioned:j,middlewareData:D}=JO({strategy:"fixed",placement:C,whileElementsMounted:(...it)=>UO(...it,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[QO({mainAxis:s+b,alignmentAxis:o}),l&&ZO({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?eI():void 0,...I}),l&&tI({...I}),nI({...I,apply:({elements:it,rects:ot,availableWidth:Ce,availableHeight:Me})=>{const{width:G,height:q}=ot.reference,ue=it.floating.style;ue.setProperty("--radix-popper-available-width",`${Ce}px`),ue.setProperty("--radix-popper-available-height",`${Me}px`),ue.setProperty("--radix-popper-anchor-width",`${G}px`),ue.setProperty("--radix-popper-anchor-height",`${q}px`)}}),g&&sI({element:g,padding:a}),wI({arrowWidth:P,arrowHeight:b}),f&&rI({strategy:"referenceHidden",...I})]}),[$,F]=vv(R),K=fI(m);Rm(()=>{j&&(K==null||K())},[j,K]);const z=(ne=D.arrow)==null?void 0:ne.x,U=(pe=D.arrow)==null?void 0:pe.y,V=((se=D.arrow)==null?void 0:se.centerOffset)!==0,[W,ee]=x.useState();return Rm(()=>{S&&ee(window.getComputedStyle(S).zIndex)},[S]),d.jsx("div",{ref:T.setFloating,"data-radix-popper-content-wrapper":"",style:{...M,transform:j?M.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:W,"--radix-popper-transform-origin":[(me=D.transformOrigin)==null?void 0:me.x,(ve=D.transformOrigin)==null?void 0:ve.y].join(" "),...((Se=D.hide)==null?void 0:Se.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:d.jsx(gI,{scope:n,placedSide:$,onArrowChange:w,arrowX:z,arrowY:U,shouldHideArrow:V,children:d.jsx(dv.div,{"data-side":$,"data-align":F,...y,ref:k,style:{...y.style,animation:j?void 0:"none"}})})})});xv.displayName=kh;var bv="PopperArrow",xI={top:"bottom",right:"left",bottom:"top",left:"right"},wv=x.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=yI(bv,r),o=xI[i.placedSide];return d.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:d.jsx(lI,{...s,ref:n,style:{...s.style,display:"block"}})})});wv.displayName=bv;function bI(t){return t!==null}var wI=t=>({name:"transformOrigin",options:t,fn(e){var v,S,E;const{placement:n,rects:r,middlewareData:s}=e,o=((v=s.arrow)==null?void 0:v.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=vv(n),h={start:"0%",center:"50%",end:"100%"}[u],f=(((S=s.arrow)==null?void 0:S.x)??0)+a/2,p=(((E=s.arrow)==null?void 0:E.y)??0)+l/2;let m="",y="";return c==="bottom"?(m=o?h:`${f}px`,y=`${-l}px`):c==="top"?(m=o?h:`${f}px`,y=`${r.floating.height+l}px`):c==="right"?(m=`${-l}px`,y=o?h:`${p}px`):c==="left"&&(m=`${r.floating.width+l}px`,y=o?h:`${p}px`),{data:{x:m,y}}}});function vv(t){const[e,n="center"]=t.split("-");return[e,n]}var Sv=mv,Ch=yv,_v=xv,kv=wv,Du=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},vI="Portal",Cv=x.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=x.useState(!1);Du(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?kd.createPortal(d.jsx(Xn.div,{...r,ref:e}),o):null});Cv.displayName=vI;function SI(t,e){return x.useReducer((n,r)=>e[n][r]??n,t)}var Ki=t=>{const{present:e,children:n}=t,r=_I(e),s=typeof n=="function"?n({present:r.isPresent}):x.Children.only(n),i=an(r.ref,kI(s));return typeof n=="function"||r.isPresent?x.cloneElement(s,{ref:i}):null};Ki.displayName="Presence";function _I(t){const[e,n]=x.useState(),r=x.useRef({}),s=x.useRef(t),i=x.useRef("none"),o=t?"mounted":"unmounted",[a,l]=SI(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const c=No(r.current);i.current=a==="mounted"?c:"none"},[a]),Du(()=>{const c=r.current,u=s.current;if(u!==t){const f=i.current,p=No(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),Du(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const y=No(r.current).includes(p.animationName);if(p.target===e&&y&&(l("ANIMATION_END"),!s.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(i.current=No(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:x.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function No(t){return(t==null?void 0:t.animationName)||"none"}function kI(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function gs(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function Ev(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,CI(s,...e)]}function CI(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Om(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function EI(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Om(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Om(t[s],null)}}}}function Lu(...t){return x.useCallback(EI(...t),t)}function PI(t){const e=t+"CollectionProvider",[n,r]=Ev(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:m,children:y}=p,v=fe.useRef(null),S=fe.useRef(new Map).current;return d.jsx(s,{scope:m,itemMap:S,collectionRef:v,children:y})};o.displayName=e;const a=t+"CollectionSlot",l=fe.forwardRef((p,m)=>{const{scope:y,children:v}=p,S=i(a,y),E=Lu(m,S.collectionRef);return d.jsx(tt,{ref:E,children:v})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",h=fe.forwardRef((p,m)=>{const{scope:y,children:v,...S}=p,E=fe.useRef(null),k=Lu(m,E),g=i(c,y);return fe.useEffect(()=>(g.itemMap.set(E,{ref:E,...S}),()=>void g.itemMap.delete(E))),d.jsx(tt,{[u]:"",ref:k,children:v})});h.displayName=c;function f(p){const m=i(t+"CollectionConsumer",p);return fe.useCallback(()=>{const v=m.collectionRef.current;if(!v)return[];const S=Array.from(v.querySelectorAll(`[${u}]`));return Array.from(m.itemMap.values()).sort((g,w)=>S.indexOf(g.ref.current)-S.indexOf(w.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:o,Slot:l,ItemSlot:h},f,r]}var AI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Pv=AI.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Eh(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function jI({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=NI({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,a=Eh(n),l=x.useCallback(c=>{if(i){const h=typeof c=="function"?c(t):c;h!==t&&a(h)}else s(c)},[i,t,s,a]);return[o,l]}function NI({defaultProp:t,onChange:e}){const n=x.useState(t),[r]=n,s=x.useRef(r),i=Eh(e);return x.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}var vc="rovingFocusGroup.onEntryFocus",TI={bubbles:!1,cancelable:!0},El="RovingFocusGroup",[$u,Av,RI]=PI(El),[OI,jv]=Ev(El,[RI]),[II,MI]=OI(El),Nv=x.forwardRef((t,e)=>d.jsx($u.Provider,{scope:t.__scopeRovingFocusGroup,children:d.jsx($u.Slot,{scope:t.__scopeRovingFocusGroup,children:d.jsx(DI,{...t,ref:e})})}));Nv.displayName=El;var DI=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=t,f=x.useRef(null),p=Lu(e,f),m=Gw(i),[y=null,v]=jI({prop:o,defaultProp:a,onChange:l}),[S,E]=x.useState(!1),k=Eh(c),g=Av(n),w=x.useRef(!1),[_,P]=x.useState(0);return x.useEffect(()=>{const b=f.current;if(b)return b.addEventListener(vc,k),()=>b.removeEventListener(vc,k)},[k]),d.jsx(II,{scope:n,orientation:r,dir:m,loop:s,currentTabStopId:y,onItemFocus:x.useCallback(b=>v(b),[v]),onItemShiftTab:x.useCallback(()=>E(!0),[]),onFocusableItemAdd:x.useCallback(()=>P(b=>b+1),[]),onFocusableItemRemove:x.useCallback(()=>P(b=>b-1),[]),children:d.jsx(Pv.div,{tabIndex:S||_===0?-1:0,"data-orientation":r,...h,ref:p,style:{outline:"none",...t.style},onMouseDown:gs(t.onMouseDown,()=>{w.current=!0}),onFocus:gs(t.onFocus,b=>{const C=!w.current;if(b.target===b.currentTarget&&C&&!S){const A=new CustomEvent(vc,TI);if(b.currentTarget.dispatchEvent(A),!A.defaultPrevented){const N=g().filter(R=>R.focusable),O=N.find(R=>R.active),I=N.find(R=>R.id===y),M=[O,I,...N].filter(Boolean).map(R=>R.ref.current);Ov(M,u)}}w.current=!1}),onBlur:gs(t.onBlur,()=>E(!1))})})}),Tv="RovingFocusGroupItem",Rv=x.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,...o}=t,a=vr(),l=i||a,c=MI(Tv,n),u=c.currentTabStopId===l,h=Av(n),{onFocusableItemAdd:f,onFocusableItemRemove:p}=c;return x.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),d.jsx($u.ItemSlot,{scope:n,id:l,focusable:r,active:s,children:d.jsx(Pv.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:gs(t.onMouseDown,m=>{r?c.onItemFocus(l):m.preventDefault()}),onFocus:gs(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:gs(t.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const y=FI(m,c.orientation,c.dir);if(y!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let S=h().filter(E=>E.focusable).map(E=>E.ref.current);if(y==="last")S.reverse();else if(y==="prev"||y==="next"){y==="prev"&&S.reverse();const E=S.indexOf(m.currentTarget);S=c.loop?UI(S,E+1):S.slice(E+1)}setTimeout(()=>Ov(S))}})})})});Rv.displayName=Tv;var LI={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $I(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function FI(t,e,n){const r=$I(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return LI[r]}function Ov(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function UI(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var BI=Nv,VI=Rv,Fu=["Enter"," "],WI=["ArrowDown","PageUp","Home"],Iv=["ArrowUp","PageDown","End"],zI=[...WI,...Iv],HI={ltr:[...Fu,"ArrowRight"],rtl:[...Fu,"ArrowLeft"]},KI={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Gi="Menu",[Ni,GI,qI]=LR(Gi),[jr,Mv]=Hw(Gi,[qI,Cl,jv]),Pl=Cl(),Dv=jv(),[YI,Nr]=jr(Gi),[JI,qi]=jr(Gi),Lv=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,a=Pl(e),[l,c]=x.useState(null),u=x.useRef(!1),h=zi(i),f=Gw(s);return x.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),d.jsx(Sv,{...a,children:d.jsx(YI,{scope:e,open:n,onOpenChange:h,content:l,onContentChange:c,children:d.jsx(JI,{scope:e,onClose:x.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:f,modal:o,children:r})})})};Lv.displayName=Gi;var XI="MenuAnchor",Ph=x.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=Pl(n);return d.jsx(Ch,{...s,...r,ref:e})});Ph.displayName=XI;var Ah="MenuPortal",[QI,$v]=jr(Ah,{forceMount:void 0}),Fv=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=Nr(Ah,e);return d.jsx(QI,{scope:e,forceMount:n,children:d.jsx(Ki,{present:n||i.open,children:d.jsx(Cv,{asChild:!0,container:s,children:r})})})};Fv.displayName=Ah;var Tt="MenuContent",[ZI,jh]=jr(Tt),Uv=x.forwardRef((t,e)=>{const n=$v(Tt,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Nr(Tt,t.__scopeMenu),o=qi(Tt,t.__scopeMenu);return d.jsx(Ni.Provider,{scope:t.__scopeMenu,children:d.jsx(Ki,{present:r||i.open,children:d.jsx(Ni.Slot,{scope:t.__scopeMenu,children:o.modal?d.jsx(eM,{...s,ref:e}):d.jsx(tM,{...s,ref:e})})})})}),eM=x.forwardRef((t,e)=>{const n=Nr(Tt,t.__scopeMenu),r=x.useRef(null),s=an(e,r);return x.useEffect(()=>{const i=r.current;if(i)return oh(i)},[]),d.jsx(Nh,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:je(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),tM=x.forwardRef((t,e)=>{const n=Nr(Tt,t.__scopeMenu);return d.jsx(Nh,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Nh=x.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:m,...y}=t,v=Nr(Tt,n),S=qi(Tt,n),E=Pl(n),k=Dv(n),g=GI(n),[w,_]=x.useState(null),P=x.useRef(null),b=an(e,P,v.onContentChange),C=x.useRef(0),A=x.useRef(""),N=x.useRef(0),O=x.useRef(null),I=x.useRef("right"),T=x.useRef(0),M=m?wl:x.Fragment,R=m?{as:tt,allowPinchZoom:!0}:void 0,j=$=>{var ne,pe;const F=A.current+$,K=g().filter(se=>!se.disabled),z=document.activeElement,U=(ne=K.find(se=>se.ref.current===z))==null?void 0:ne.textValue,V=K.map(se=>se.textValue),W=fM(V,F,U),ee=(pe=K.find(se=>se.textValue===W))==null?void 0:pe.ref.current;(function se(me){A.current=me,window.clearTimeout(C.current),me!==""&&(C.current=window.setTimeout(()=>se(""),1e3))})(F),ee&&setTimeout(()=>ee.focus())};x.useEffect(()=>()=>window.clearTimeout(C.current),[]),ih();const D=x.useCallback($=>{var K,z;return I.current===((K=O.current)==null?void 0:K.side)&&mM($,(z=O.current)==null?void 0:z.area)},[]);return d.jsx(ZI,{scope:n,searchRef:A,onItemEnter:x.useCallback($=>{D($)&&$.preventDefault()},[D]),onItemLeave:x.useCallback($=>{var F;D($)||((F=P.current)==null||F.focus(),_(null))},[D]),onTriggerLeave:x.useCallback($=>{D($)&&$.preventDefault()},[D]),pointerGraceTimerRef:N,onPointerGraceIntentChange:x.useCallback($=>{O.current=$},[]),children:d.jsx(M,{...R,children:d.jsx(yl,{asChild:!0,trapped:s,onMountAutoFocus:je(i,$=>{var F;$.preventDefault(),(F=P.current)==null||F.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:d.jsx(Jw,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:d.jsx(BI,{asChild:!0,...k,dir:S.dir,orientation:"vertical",loop:r,currentTabStopId:w,onCurrentTabStopIdChange:_,onEntryFocus:je(l,$=>{S.isUsingKeyboardRef.current||$.preventDefault()}),preventScrollOnEntryFocus:!0,children:d.jsx(_v,{role:"menu","aria-orientation":"vertical","data-state":nS(v.open),"data-radix-menu-content":"",dir:S.dir,...E,...y,ref:b,style:{outline:"none",...y.style},onKeyDown:je(y.onKeyDown,$=>{const K=$.target.closest("[data-radix-menu-content]")===$.currentTarget,z=$.ctrlKey||$.altKey||$.metaKey,U=$.key.length===1;K&&($.key==="Tab"&&$.preventDefault(),!z&&U&&j($.key));const V=P.current;if($.target!==V||!zI.includes($.key))return;$.preventDefault();const ee=g().filter(ne=>!ne.disabled).map(ne=>ne.ref.current);Iv.includes($.key)&&ee.reverse(),dM(ee)}),onBlur:je(t.onBlur,$=>{$.currentTarget.contains($.target)||(window.clearTimeout(C.current),A.current="")}),onPointerMove:je(t.onPointerMove,Ti($=>{const F=$.target,K=T.current!==$.clientX;if($.currentTarget.contains(F)&&K){const z=$.clientX>T.current?"right":"left";I.current=z,T.current=$.clientX}}))})})})})})})});Uv.displayName=Tt;var nM="MenuGroup",Th=x.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return d.jsx(Xn.div,{role:"group",...r,ref:e})});Th.displayName=nM;var rM="MenuLabel",Bv=x.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return d.jsx(Xn.div,{...r,ref:e})});Bv.displayName=rM;var Fa="MenuItem",Im="menu.itemSelect",Al=x.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=x.useRef(null),o=qi(Fa,t.__scopeMenu),a=jh(Fa,t.__scopeMenu),l=an(e,i),c=x.useRef(!1),u=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(Im,{bubbles:!0,cancelable:!0});h.addEventListener(Im,p=>r==null?void 0:r(p),{once:!0}),qw(h,f),f.defaultPrevented?c.current=!1:o.onClose()}};return d.jsx(Vv,{...s,ref:l,disabled:n,onClick:je(t.onClick,u),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),c.current=!0},onPointerUp:je(t.onPointerUp,h=>{var f;c.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:je(t.onKeyDown,h=>{const f=a.searchRef.current!=="";n||f&&h.key===" "||Fu.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Al.displayName=Fa;var Vv=x.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=jh(Fa,n),a=Dv(n),l=x.useRef(null),c=an(e,l),[u,h]=x.useState(!1),[f,p]=x.useState("");return x.useEffect(()=>{const m=l.current;m&&p((m.textContent??"").trim())},[i.children]),d.jsx(Ni.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:d.jsx(VI,{asChild:!0,...a,focusable:!r,children:d.jsx(Xn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:je(t.onPointerMove,Ti(m=>{r?o.onItemLeave(m):(o.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:je(t.onPointerLeave,Ti(m=>o.onItemLeave(m))),onFocus:je(t.onFocus,()=>h(!0)),onBlur:je(t.onBlur,()=>h(!1))})})})}),sM="MenuCheckboxItem",Wv=x.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return d.jsx(qv,{scope:t.__scopeMenu,checked:n,children:d.jsx(Al,{role:"menuitemcheckbox","aria-checked":Ua(n)?"mixed":n,...s,ref:e,"data-state":Oh(n),onSelect:je(s.onSelect,()=>r==null?void 0:r(Ua(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Wv.displayName=sM;var zv="MenuRadioGroup",[iM,oM]=jr(zv,{value:void 0,onValueChange:()=>{}}),Hv=x.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=zi(r);return d.jsx(iM,{scope:t.__scopeMenu,value:n,onValueChange:i,children:d.jsx(Th,{...s,ref:e})})});Hv.displayName=zv;var Kv="MenuRadioItem",Gv=x.forwardRef((t,e)=>{const{value:n,...r}=t,s=oM(Kv,t.__scopeMenu),i=n===s.value;return d.jsx(qv,{scope:t.__scopeMenu,checked:i,children:d.jsx(Al,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":Oh(i),onSelect:je(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});Gv.displayName=Kv;var Rh="MenuItemIndicator",[qv,aM]=jr(Rh,{checked:!1}),Yv=x.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=aM(Rh,n);return d.jsx(Ki,{present:r||Ua(i.checked)||i.checked===!0,children:d.jsx(Xn.span,{...s,ref:e,"data-state":Oh(i.checked)})})});Yv.displayName=Rh;var lM="MenuSeparator",Jv=x.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return d.jsx(Xn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});Jv.displayName=lM;var cM="MenuArrow",Xv=x.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=Pl(n);return d.jsx(kv,{...s,...r,ref:e})});Xv.displayName=cM;var uM="MenuSub",[hB,Qv]=jr(uM),ti="MenuSubTrigger",Zv=x.forwardRef((t,e)=>{const n=Nr(ti,t.__scopeMenu),r=qi(ti,t.__scopeMenu),s=Qv(ti,t.__scopeMenu),i=jh(ti,t.__scopeMenu),o=x.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,c={__scopeMenu:t.__scopeMenu},u=x.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return x.useEffect(()=>u,[u]),x.useEffect(()=>{const h=a.current;return()=>{window.clearTimeout(h),l(null)}},[a,l]),d.jsx(Ph,{asChild:!0,...c,children:d.jsx(Vv,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":nS(n.open),...t,ref:Kw(e,s.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:je(t.onPointerMove,Ti(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:je(t.onPointerLeave,Ti(h=>{var p,m;u();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const y=(m=n.content)==null?void 0:m.dataset.side,v=y==="right",S=v?-5:5,E=f[v?"left":"right"],k=f[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+S,y:h.clientY},{x:E,y:f.top},{x:k,y:f.top},{x:k,y:f.bottom},{x:E,y:f.bottom}],side:y}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:je(t.onKeyDown,h=>{var p;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||HI[r.dir].includes(h.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),h.preventDefault())})})})});Zv.displayName=ti;var eS="MenuSubContent",tS=x.forwardRef((t,e)=>{const n=$v(Tt,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Nr(Tt,t.__scopeMenu),o=qi(Tt,t.__scopeMenu),a=Qv(eS,t.__scopeMenu),l=x.useRef(null),c=an(e,l);return d.jsx(Ni.Provider,{scope:t.__scopeMenu,children:d.jsx(Ki,{present:r||i.open,children:d.jsx(Ni.Slot,{scope:t.__scopeMenu,children:d.jsx(Nh,{id:a.contentId,"aria-labelledby":a.triggerId,...s,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:je(t.onFocusOutside,u=>{u.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:je(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:je(t.onKeyDown,u=>{var p;const h=u.currentTarget.contains(u.target),f=KI[o.dir].includes(u.key);h&&f&&(i.onOpenChange(!1),(p=a.trigger)==null||p.focus(),u.preventDefault())})})})})})});tS.displayName=eS;function nS(t){return t?"open":"closed"}function Ua(t){return t==="indeterminate"}function Oh(t){return Ua(t)?"indeterminate":t?"checked":"unchecked"}function dM(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function hM(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function fM(t,e,n){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=hM(t,Math.max(i,0));s.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function pM(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,u=e[o].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(s=!s)}return s}function mM(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return pM(n,e)}function Ti(t){return e=>e.pointerType==="mouse"?t(e):void 0}var gM=Lv,yM=Ph,xM=Fv,bM=Uv,wM=Th,vM=Bv,SM=Al,_M=Wv,kM=Hv,CM=Gv,EM=Yv,PM=Jv,AM=Xv,jM=Zv,NM=tS,Ih="DropdownMenu",[TM]=NR(Ih,[Mv]),ht=Mv(),[RM,rS]=TM(Ih),sS=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=ht(e),c=x.useRef(null),[u=!1,h]=RR({prop:s,defaultProp:i,onChange:o});return d.jsx(RM,{scope:e,triggerId:vr(),triggerRef:c,contentId:vr(),open:u,onOpenChange:h,onOpenToggle:x.useCallback(()=>h(f=>!f),[h]),modal:a,children:d.jsx(gM,{...l,open:u,onOpenChange:h,dir:r,modal:a,children:n})})};sS.displayName=Ih;var iS="DropdownMenuTrigger",oS=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=rS(iS,n),o=ht(n);return d.jsx(yM,{asChild:!0,...o,children:d.jsx(MR.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:jR(e,i.triggerRef),onPointerDown:Ia(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:Ia(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});oS.displayName=iS;var OM="DropdownMenuPortal",aS=t=>{const{__scopeDropdownMenu:e,...n}=t,r=ht(e);return d.jsx(xM,{...r,...n})};aS.displayName=OM;var lS="DropdownMenuContent",cS=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=rS(lS,n),i=ht(n),o=x.useRef(!1);return d.jsx(bM,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:Ia(t.onCloseAutoFocus,a=>{var l;o.current||(l=s.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:Ia(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});cS.displayName=lS;var IM="DropdownMenuGroup",MM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(wM,{...s,...r,ref:e})});MM.displayName=IM;var DM="DropdownMenuLabel",LM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(vM,{...s,...r,ref:e})});LM.displayName=DM;var $M="DropdownMenuItem",uS=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(SM,{...s,...r,ref:e})});uS.displayName=$M;var FM="DropdownMenuCheckboxItem",UM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(_M,{...s,...r,ref:e})});UM.displayName=FM;var BM="DropdownMenuRadioGroup",VM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(kM,{...s,...r,ref:e})});VM.displayName=BM;var WM="DropdownMenuRadioItem",zM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(CM,{...s,...r,ref:e})});zM.displayName=WM;var HM="DropdownMenuItemIndicator",KM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(EM,{...s,...r,ref:e})});KM.displayName=HM;var GM="DropdownMenuSeparator",qM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(PM,{...s,...r,ref:e})});qM.displayName=GM;var YM="DropdownMenuArrow",JM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(AM,{...s,...r,ref:e})});JM.displayName=YM;var XM="DropdownMenuSubTrigger",QM=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(jM,{...s,...r,ref:e})});QM.displayName=XM;var ZM="DropdownMenuSubContent",eD=x.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ht(n);return d.jsx(NM,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});eD.displayName=ZM;var tD=sS,nD=oS,rD=aS,sD=cS,iD=uS;function oD({...t}){return d.jsx(tD,{"data-slot":"dropdown-menu",...t})}function aD({...t}){return d.jsx(nD,{"data-slot":"dropdown-menu-trigger",...t})}function lD({className:t,sideOffset:e=4,...n}){return d.jsx(rD,{children:d.jsx(sD,{"data-slot":"dropdown-menu-content",sideOffset:e,className:dt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...n})})}function cD({className:t,inset:e,variant:n="default",...r}){return d.jsx(iD,{"data-slot":"dropdown-menu-item","data-inset":e,"data-variant":n,className:dt("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r})}function uD(){const{t}=Pe(),{groups:e,createGroup:n,joinGroup:r,deleteGroup:s,leaveGroup:i}=Fi(),[o,a]=x.useState(!1),[l,c]=x.useState(!1),[u,h]=x.useState(""),[f,p]=x.useState(""),[m,y]=x.useState(null),[v,S]=x.useState(null),[E,k]=x.useState(null),g=b=>{b.preventDefault(),u.trim()&&(n(u),h(""),a(!1))},w=b=>{b.preventDefault(),f.trim()&&(r(f),p(""),c(!1))},_=b=>{navigator.clipboard.writeText(b),S(b),setTimeout(()=>S(null),2e3)},P=()=>{E&&(E.type==="delete"?s(E.id):i(E.id),k(null))};return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2 text-gray-900 dark:text-white",children:[d.jsx(A0,{className:"w-5 h-5 text-purple-500"}),t("groups.title")]}),d.jsxs("div",{className:"flex gap-2 text-xs",children:[d.jsx("button",{onClick:()=>{c(!0),a(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline",children:t("groups.join")}),d.jsx("span",{className:"text-gray-300",children:"|"}),d.jsx("button",{onClick:()=>{a(!0),c(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline",children:t("groups.create")})]})]}),d.jsxs("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-1",children:[d.jsxs("button",{onClick:()=>y(null),className:`w-full flex items-center justify-between p-3 rounded-xl text-left transition-all border ${m===null?"bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 border-purple-200 dark:border-purple-800 shadow-sm":"border-transparent hover:bg-gray-50 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-300"}`,children:[d.jsxs("span",{className:"font-medium",children:[" ",t("groups.private")]}),m===null&&d.jsx(Et,{className:"w-4 h-4"})]}),e.map(b=>{var A;const C=((A=b.members.find(N=>N.id==="user-1"))==null?void 0:A.role)==="owner";return d.jsxs("div",{className:`relative group/item w-full flex flex-col p-3 rounded-xl text-left transition-all border ${m===b.id?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800":"border-transparent hover:bg-gray-50 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-300"}`,onClick:()=>y(b.id),children:[d.jsxs("div",{className:"flex items-center justify-between w-full mb-1",children:[d.jsxs("span",{className:"font-medium flex items-center gap-2",children:[d.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:b.color}}),b.name]}),d.jsxs("div",{className:"flex items-center gap-2",children:[m===b.id&&d.jsx(Et,{className:"w-4 h-4"}),d.jsxs(oD,{children:[d.jsx(aD,{asChild:!0,children:d.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-400 opacity-0 group-hover/item:opacity-100 transition-opacity",onClick:N=>N.stopPropagation(),children:d.jsx(U1,{className:"w-3 h-3"})})}),d.jsx(lD,{align:"end",className:"w-32",children:d.jsx(cD,{className:"text-xs text-red-600 focus:text-red-600 cursor-pointer",onClick:N=>{N.stopPropagation(),k({id:b.id,name:b.name,type:C?"delete":"leave"})},children:C?d.jsxs(d.Fragment,{children:[d.jsx(Sd,{className:"w-3 h-3 mr-2"}),t("groups.delete")]}):d.jsxs(d.Fragment,{children:[d.jsx(M0,{className:"w-3 h-3 mr-2"}),t("groups.leave")]})})})]})]})]}),d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsxs("div",{className:"flex -space-x-2",children:[b.members.slice(0,3).map(N=>d.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white dark:border-gray-800 bg-gray-200 overflow-hidden",title:N.name,children:N.avatar?d.jsx("img",{src:N.avatar,alt:N.name,className:"w-full h-full object-cover"}):d.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-gray-500 font-bold",children:N.name[0]})},N.id)),b.members.length>3&&d.jsxs("div",{className:"w-6 h-6 rounded-full border-2 border-white dark:border-gray-800 bg-gray-100 flex items-center justify-center text-[10px] text-gray-500",children:["+",b.members.length-3]})]}),d.jsxs("button",{onClick:N=>{N.stopPropagation(),_(b.inviteCode)},className:"flex items-center gap-1 text-[10px] text-gray-400 hover:text-gray-600 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-md transition-colors",children:[v===b.inviteCode?d.jsx(Et,{className:"w-3 h-3 text-green-500"}):d.jsx(B1,{className:"w-3 h-3"}),b.inviteCode]})]})]},b.id)})]}),(o||l)&&d.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 animate-in slide-in-from-top-2",children:o?d.jsxs("form",{onSubmit:g,className:"space-y-3",children:[d.jsx("input",{type:"text",value:u,onChange:b=>h(b.target.value),placeholder:t("groups.create")+" (e.g. Hiking Club)",className:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{type:"button",onClick:()=>a(!1),className:"flex-1 px-3 py-2 text-xs font-medium text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:t("common.cancel")}),d.jsx("button",{type:"submit",disabled:!u.trim(),className:"flex-1 px-3 py-2 text-xs font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:t("groups.create")})]})]}):d.jsxs("form",{onSubmit:w,className:"space-y-3",children:[d.jsx("input",{type:"text",value:f,onChange:b=>p(b.target.value),placeholder:t("groups.inviteCode"),className:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-3 py-2 text-xs font-medium text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:t("common.cancel")}),d.jsx("button",{type:"submit",disabled:!f.trim(),className:"flex-1 px-3 py-2 text-xs font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:t("groups.join")})]})]})}),d.jsx(dh,{open:!!E,onOpenChange:()=>k(null),children:d.jsxs(hh,{children:[d.jsxs(fh,{children:[d.jsx(mh,{children:(E==null?void 0:E.type)==="delete"?t("groups.delete"):t("groups.leave")}),d.jsx(gh,{children:(E==null?void 0:E.type)==="delete"?t("groups.confirmDelete"):t("groups.confirmLeave")})]}),d.jsxs(ph,{children:[d.jsx(Vw,{children:t("common.cancel")}),d.jsx(Bw,{onClick:P,className:"bg-red-600 hover:bg-red-700 text-white",children:(E==null?void 0:E.type)==="delete"?t("common.delete"):t("groups.leave")})]})]})})]})}let dD=zn.icon({iconUrl:zy,shadowUrl:Hy,iconSize:[25,41],iconAnchor:[12,41]});zn.Marker.prototype.options.icon=dD;function hD({points:t}){const e=H0(),n=x.useRef(null);return x.useEffect(()=>{if(e&&zn.heatLayer)return n.current&&e.removeLayer(n.current),t.length>0&&(n.current=zn.heatLayer(t,{radius:25,blur:15,maxZoom:17,max:1,gradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"}}).addTo(e)),()=>{n.current&&e.removeLayer(n.current)}},[e,t]),null}function fD({entries:t,isPlaying:e,onStop:n}){const{t:r}=Pe(),s=H0(),[i,o]=x.useState(0),a=x.useRef(null),l=x.useRef(null),c=x.useMemo(()=>[...t].filter(h=>h.location).sort((h,f)=>new Date(h.date).getTime()-new Date(f.date).getTime()),[t]),u=x.useMemo(()=>c.map(h=>{const[f,p]=hs(h.location.lat,h.location.lng);return[f,p]}),[c]);return x.useEffect(()=>{if(!e){l.current&&cancelAnimationFrame(l.current);return}if(c.length<2){n();return}let h=null;const f=1e3,p=m=>{h||(h=m);const y=m-h,S=(c.length-1)*f;if(y>=S){o(c.length-1),n();return}const E=Math.floor(y/f),k=y%f/f;o(E);const g=u[E],w=u[E+1];if(g&&w){const _=g[0]+(w[0]-g[0])*k,P=g[1]+(w[1]-g[1])*k;a.current&&(a.current.setLatLng([_,P]),s.panTo([_,P]))}l.current=requestAnimationFrame(p)};return l.current=requestAnimationFrame(p),()=>{l.current&&cancelAnimationFrame(l.current)}},[e,c,u,s,n]),e?d.jsxs(d.Fragment,{children:[d.jsx(Mk,{positions:u,color:"#3b82f6",weight:4,opacity:.6,dashArray:"10, 10"}),d.jsx(Cd,{ref:a,position:u[0],icon:zn.divIcon({className:"playback-marker",html:'<div style="background-color: #3b82f6; width: 16px; height: 16px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);"></div>',iconSize:[16,16]}),zIndexOffset:1e3}),d.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-[1000] bg-white/90 dark:bg-gray-800/90 backdrop-blur px-4 py-2 rounded-full shadow-lg border border-gray-200 dark:border-gray-700 flex flex-col items-center",children:[d.jsx("span",{className:"text-xs text-gray-500 font-medium",children:r("map.traveling")}),d.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:c[i]?xe(new Date(c[i].date),"yyyy-MM-dd HH:mm"):""})]})]}):null}const pD=(t,e)=>zn.divIcon({className:"custom-marker",html:`
      <div style="
        background-color: ${t};
        width: 30px;
        height: 30px;
        border-radius: 50%;
        border: 2px solid white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      ">
        ${e?`<img src="${e}" style="width: 100%; height: 100%; object-fit: cover;" />`:""}
      </div>
      <div style="
        width: 0; 
        height: 0; 
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-top: 8px solid ${t};
        margin: -2px auto 0;
      "></div>
    `,iconSize:[30,40],iconAnchor:[15,40],popupAnchor:[0,-40]});function mD({entries:t}){const{t:e}=Pe(),n=ks(),{groups:r,currentGroupId:s,getGroupEntries:i}=Fi(),[o,a]=x.useState("All"),[l,c]=x.useState(""),[u,h]=x.useState(""),[f,p]=x.useState(!1),[m,y]=x.useState(!1),[v,S]=x.useState("all"),[E,k]=x.useState(xe(new Date,"yyyy-MM-dd")),[g,w]=x.useState(xe(new Date,"yyyy-MM-dd")),[_,P]=x.useState(!1),[b,C]=x.useState(!1),A=x.useMemo(()=>s?i(s):t,[t,s,i]),N=x.useMemo(()=>{const T=new Set;return A.forEach(M=>{var R;(R=M.tags)==null||R.forEach(j=>T.add(j))}),Array.from(T).sort()},[A]),O=x.useMemo(()=>A.filter(T=>{if(!T.location)return!1;const M=o==="All"||T.mood===o,R=l===""||T.tags&&T.tags.some($=>$.toLowerCase()===l.toLowerCase());let j=!0;const D=new Date(T.date);return v==="today"?j=z0(D,new Date):v==="range"&&(j=Tk(D,{start:Ok(new Date(E)),end:Rk(new Date(g))})),M&&R&&j}),[A,o,l,v,E,g]),I=O.length>0?(()=>{const T=hs(O[0].location.lat,O[0].location.lng);return[T[0],T[1]]})():[20,0];return d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 h-[calc(100vh-140px)]",children:[d.jsxs("div",{className:"lg:col-span-1 space-y-4 h-full overflow-y-auto pr-2",children:[d.jsx(uD,{}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm flex flex-col gap-4 border border-gray-100 dark:border-gray-700",children:[d.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[d.jsx(I0,{className:"w-4 h-4 text-blue-500"}),e("filters.title")]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs text-gray-500 font-medium",children:e("filters.dateRange")}),d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsx("button",{onClick:()=>S("all"),className:`px-3 py-2 text-xs rounded-lg transition-all text-left ${v==="all"?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:e("filters.allTime")}),d.jsx("button",{onClick:()=>S("today"),className:`px-3 py-2 text-xs rounded-lg transition-all text-left ${v==="today"?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:e("filters.today")}),d.jsx("button",{onClick:()=>S("range"),className:`px-3 py-2 text-xs rounded-lg transition-all text-left ${v==="range"?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100"}`,children:e("filters.custom")})]}),v==="range"&&d.jsxs("div",{className:"flex flex-col gap-2 animate-in fade-in slide-in-from-top-2 pt-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-xs text-gray-400 w-8",children:"From"}),d.jsx("input",{type:"date",value:E,onChange:T=>k(T.target.value),className:"flex-1 px-2 py-1 text-xs border border-gray-200 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-xs text-gray-400 w-8",children:"To"}),d.jsx("input",{type:"date",value:g,onChange:T=>w(T.target.value),className:"flex-1 px-2 py-1 text-xs border border-gray-200 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs text-gray-500 font-medium",children:e("filters.mood")}),d.jsxs("select",{value:o,onChange:T=>a(T.target.value),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white",children:[d.jsx("option",{value:"All",children:e("timeline.all")}),Td.map(T=>d.jsx("option",{value:T.name,children:e(`moods.${T.name.toLowerCase()}`,T.name)},T.name))]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-xs text-gray-500 font-medium",children:e("filters.tag")}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:u,onChange:T=>{h(T.target.value),c(T.target.value),p(!0)},onFocus:()=>p(!0),onBlur:()=>setTimeout(()=>p(!1),200),placeholder:e("filters.searchTags"),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-xs focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"}),l&&d.jsx("button",{onClick:()=>{c(""),h("")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:""}),f&&N.length>0&&d.jsx("div",{className:"absolute top-full left-0 mt-1 w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg max-h-48 overflow-y-auto z-20",children:N.filter(T=>T.toLowerCase().includes(u.toLowerCase())).map(T=>d.jsxs("div",{className:"px-3 py-2 text-xs text-gray-700 dark:text-gray-300 hover:bg-blue-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>{c(T),h(T),p(!1)},children:["#",T]},T))})]})]}),d.jsx("div",{className:"pt-2 border-t border-gray-100 dark:border-gray-700 text-xs text-center text-gray-500 dark:text-gray-400",children:e("filters.found",{count:O.length})}),d.jsxs("div",{className:"pt-2 border-t border-gray-100 dark:border-gray-700 flex flex-col gap-2",children:[d.jsx("h4",{className:"text-xs font-medium text-gray-500",children:e("map.features")}),d.jsxs("button",{onClick:()=>P(!_),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-colors ${_?"bg-orange-100 text-orange-700 border border-orange-200":"bg-gray-50 text-gray-700 hover:bg-gray-100 border border-gray-200"}`,children:[d.jsx(D0,{className:`w-4 h-4 ${_?"fill-orange-500":""}`}),e(_?"map.hideHeatmap":"map.showHeatmap")]}),d.jsxs("button",{onClick:()=>C(!b),disabled:O.length<2,className:`flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-colors ${b?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-50 text-gray-700 hover:bg-gray-100 border border-gray-200"} ${O.length<2?"opacity-50 cursor-not-allowed":""}`,children:[b?d.jsx(V1,{className:"w-4 h-4 fill-current"}):d.jsx(L0,{className:"w-4 h-4 fill-current"}),e(b?"map.stopPlayback":"map.playRoute")]})]})]})]}),d.jsx("div",{className:"lg:col-span-3 h-full rounded-2xl overflow-hidden shadow-sm border border-gray-200 dark:border-gray-700 relative z-0",children:d.jsxs(V0,{center:I,zoom:O.length>0?5:4,style:{height:"100%",width:"100%"},children:[d.jsx(W0,{attribution:'Map data  <a href="https://www.amap.com/">Gaode</a> contributors',url:"https://webrd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}"}),_&&d.jsx(hD,{points:O.filter(T=>T.location).map(T=>{const[M,R]=hs(T.location.lat,T.location.lng);return[M,R,1]})}),d.jsx(fD,{entries:O,isPlaying:b,onStop:()=>C(!1)}),!_&&!b&&O.map(T=>{var D,$;let M="#3b82f6";T.userId==="user-2"&&(M="#ec4899"),T.userId==="user-3"&&(M="#f97316"),T.userId==="user-4"&&(M="#10b981");const[R,j]=hs(T.location.lat,T.location.lng);return d.jsx(Cd,{position:[R,j],icon:pD(M,T.userAvatar),children:d.jsx(Ik,{children:d.jsxs("div",{className:"w-56 cursor-pointer",onClick:()=>n(`/edit/${T.id}`),children:[T.userName&&d.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-gray-100",children:[T.userAvatar?d.jsx("div",{className:"w-5 h-5 rounded-full overflow-hidden",children:d.jsx(Ot,{src:T.userAvatar,alt:T.userName,className:"w-full h-full object-cover"})}):d.jsx(aa,{className:"w-4 h-4 text-gray-400"}),d.jsx("span",{className:"text-xs font-bold text-gray-700",children:T.userName})]}),d.jsx("div",{className:"w-full h-32 mb-2 rounded-lg overflow-hidden",children:d.jsx(Ot,{src:T.photo,alt:T.caption,className:"w-full h-full object-cover"})}),d.jsx("p",{className:"font-medium text-sm text-gray-900 line-clamp-2",children:T.caption}),d.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:(D=T.tags)==null?void 0:D.map(F=>d.jsxs("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-600 rounded text-[10px]",children:["#",F]},F))}),d.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs text-gray-500",children:[d.jsx("span",{children:xe(new Date(T.date),"MMM d, yyyy")}),(($=T.location)==null?void 0:$.name)&&d.jsx("span",{className:"text-blue-600 truncate max-w-[80px]",children:T.location.name})]})]})})},T.id)})]},`${I[0]}-${I[1]}`)})]})}const Mh=x.createContext({});function Tr(t){const e=x.useRef(null);return e.current===null&&(e.current=t()),e.current}const dS=typeof window<"u",Dh=dS?x.useLayoutEffect:x.useEffect,jl=x.createContext(null);function Lh(t,e){t.indexOf(e)===-1&&t.push(e)}function Ba(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function gD([...t],e,n){const r=e<0?t.length+e:e;if(r>=0&&r<t.length){const s=n<0?t.length+n:n,[i]=t.splice(e,1);t.splice(s,0,i)}return t}const cn=(t,e,n)=>n>e?e:n<t?t:n;let $h=()=>{};const Sn={},hS=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function fS(t){return typeof t=="object"&&t!==null}const pS=t=>/^0[^.\s]+$/u.test(t);function Fh(t){let e;return()=>(e===void 0&&(e=t()),e)}const Rt=t=>t,yD=(t,e)=>n=>e(t(n)),Yi=(...t)=>t.reduce(yD),Ri=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class Uh{constructor(){this.subscriptions=[]}add(e){return Lh(this.subscriptions,e),()=>Ba(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Vt=t=>t*1e3,Nt=t=>t/1e3;function mS(t,e){return e?t*(1e3/e):0}const gS=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,xD=1e-7,bD=12;function wD(t,e,n,r,s){let i,o,a=0;do o=e+(n-e)/2,i=gS(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>xD&&++a<bD);return o}function Ji(t,e,n,r){if(t===e&&n===r)return Rt;const s=i=>wD(i,0,1,t,n);return i=>i===0||i===1?i:gS(s(i),e,r)}const yS=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,xS=t=>e=>1-t(1-e),bS=Ji(.33,1.53,.69,.99),Bh=xS(bS),wS=yS(Bh),vS=t=>(t*=2)<1?.5*Bh(t):.5*(2-Math.pow(2,-10*(t-1))),Vh=t=>1-Math.sin(Math.acos(t)),SS=xS(Vh),_S=yS(Vh),vD=Ji(.42,0,1,1),SD=Ji(0,0,.58,1),kS=Ji(.42,0,.58,1),_D=t=>Array.isArray(t)&&typeof t[0]!="number",CS=t=>Array.isArray(t)&&typeof t[0]=="number",kD={linear:Rt,easeIn:vD,easeInOut:kS,easeOut:SD,circIn:Vh,circInOut:_S,circOut:SS,backIn:Bh,backInOut:wS,backOut:bS,anticipate:vS},CD=t=>typeof t=="string",Mm=t=>{if(CS(t)){$h(t.length===4);const[e,n,r,s]=t;return Ji(e,n,r,s)}else if(CD(t))return kD[t];return t},To=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function ED(t,e){let n=new Set,r=new Set,s=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(u){o.has(u)&&(c.schedule(u),t()),u(a)}const c={schedule:(u,h=!1,f=!1)=>{const m=f&&s?n:r;return h&&o.add(u),m.has(u)||m.add(u),u},cancel:u=>{r.delete(u),o.delete(u)},process:u=>{if(a=u,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(l),n.clear(),s=!1,i&&(i=!1,c.process(u))}};return c}const PD=40;function ES(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=To.reduce((k,g)=>(k[g]=ED(i),k),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:h,preRender:f,render:p,postRender:m}=o,y=()=>{const k=Sn.useManualTiming?s.timestamp:performance.now();n=!1,Sn.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(k-s.timestamp,PD),1)),s.timestamp=k,s.isProcessing=!0,a.process(s),l.process(s),c.process(s),u.process(s),h.process(s),f.process(s),p.process(s),m.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(y))},v=()=>{n=!0,r=!0,s.isProcessing||t(y)};return{schedule:To.reduce((k,g)=>{const w=o[g];return k[g]=(_,P=!1,b=!1)=>(n||v(),w.schedule(_,P,b)),k},{}),cancel:k=>{for(let g=0;g<To.length;g++)o[To[g]].cancel(k)},state:s,steps:o}}const{schedule:ke,cancel:_n,state:Xe,steps:Sc}=ES(typeof requestAnimationFrame<"u"?requestAnimationFrame:Rt,!0);let ta;function AD(){ta=void 0}const ct={now:()=>(ta===void 0&&ct.set(Xe.isProcessing||Sn.useManualTiming?Xe.timestamp:performance.now()),ta),set:t=>{ta=t,queueMicrotask(AD)}},PS=t=>e=>typeof e=="string"&&e.startsWith(t),AS=PS("--"),jD=PS("var(--"),Wh=t=>jD(t)?ND.test(t.split("/*")[0].trim()):!1,ND=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Dm(t){return typeof t!="string"?!1:t.split("/*")[0].includes("var(--")}const Ms={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Oi={...Ms,transform:t=>cn(0,1,t)},Ro={...Ms,default:1},hi=t=>Math.round(t*1e5)/1e5,zh=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function TD(t){return t==null}const RD=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Hh=(t,e)=>n=>!!(typeof n=="string"&&RD.test(n)&&n.startsWith(t)||e&&!TD(n)&&Object.prototype.hasOwnProperty.call(n,e)),jS=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,i,o,a]=r.match(zh);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},OD=t=>cn(0,255,t),_c={...Ms,transform:t=>Math.round(OD(t))},br={test:Hh("rgb","red"),parse:jS("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+_c.transform(t)+", "+_c.transform(e)+", "+_c.transform(n)+", "+hi(Oi.transform(r))+")"};function ID(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Uu={test:Hh("#"),parse:ID,transform:br.transform},Xi=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),In=Xi("deg"),sn=Xi("%"),Q=Xi("px"),MD=Xi("vh"),DD=Xi("vw"),Lm={...sn,parse:t=>sn.parse(t)/100,transform:t=>sn.transform(t*100)},os={test:Hh("hsl","hue"),parse:jS("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+sn.transform(hi(e))+", "+sn.transform(hi(n))+", "+hi(Oi.transform(r))+")"},Le={test:t=>br.test(t)||Uu.test(t)||os.test(t),parse:t=>br.test(t)?br.parse(t):os.test(t)?os.parse(t):Uu.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?br.transform(t):os.transform(t),getAnimatableNone:t=>{const e=Le.parse(t);return e.alpha=0,Le.transform(e)}},LD=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function $D(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(zh))==null?void 0:e.length)||0)+(((n=t.match(LD))==null?void 0:n.length)||0)>0}const NS="number",TS="color",FD="var",UD="var(",$m="${}",BD=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ii(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const a=e.replace(BD,l=>(Le.test(l)?(r.color.push(i),s.push(TS),n.push(Le.parse(l))):l.startsWith(UD)?(r.var.push(i),s.push(FD),n.push(l)):(r.number.push(i),s.push(NS),n.push(parseFloat(l))),++i,$m)).split($m);return{values:n,split:a,indexes:r,types:s}}function RS(t){return Ii(t).values}function OS(t){const{split:e,types:n}=Ii(t),r=e.length;return s=>{let i="";for(let o=0;o<r;o++)if(i+=e[o],s[o]!==void 0){const a=n[o];a===NS?i+=hi(s[o]):a===TS?i+=Le.transform(s[o]):i+=s[o]}return i}}const VD=t=>typeof t=="number"?0:Le.test(t)?Le.getAnimatableNone(t):t;function WD(t){const e=RS(t);return OS(t)(e.map(VD))}const Gn={test:$D,parse:RS,createTransformer:OS,getAnimatableNone:WD};function kc(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function zD({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=kc(l,a,t+1/3),i=kc(l,a,t),o=kc(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}function Va(t,e){return n=>n>0?e:t}const Ne=(t,e,n)=>t+(e-t)*n,Cc=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},HD=[Uu,br,os],KD=t=>HD.find(e=>e.test(t));function Fm(t){const e=KD(t);if(!e)return!1;let n=e.parse(t);return e===os&&(n=zD(n)),n}const Um=(t,e)=>{const n=Fm(t),r=Fm(e);if(!n||!r)return Va(t,e);const s={...n};return i=>(s.red=Cc(n.red,r.red,i),s.green=Cc(n.green,r.green,i),s.blue=Cc(n.blue,r.blue,i),s.alpha=Ne(n.alpha,r.alpha,i),br.transform(s))},Bu=new Set(["none","hidden"]);function GD(t,e){return Bu.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function qD(t,e){return n=>Ne(t,e,n)}function Kh(t){return typeof t=="number"?qD:typeof t=="string"?Wh(t)?Va:Le.test(t)?Um:XD:Array.isArray(t)?IS:typeof t=="object"?Le.test(t)?Um:YD:Va}function IS(t,e){const n=[...t],r=n.length,s=t.map((i,o)=>Kh(i)(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}}function YD(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=Kh(t[s])(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function JD(t,e){const n=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],o=t.indexes[i][r[i]],a=t.values[o]??0;n[s]=a,r[i]++}return n}const XD=(t,e)=>{const n=Gn.createTransformer(e),r=Ii(t),s=Ii(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Bu.has(t)&&!s.values.length||Bu.has(e)&&!r.values.length?GD(t,e):Yi(IS(JD(r,s),s.values),n):Va(t,e)};function MS(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Ne(t,e,n):Kh(t)(t,e)}const QD=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>ke.update(e,n),stop:()=>_n(e),now:()=>Xe.isProcessing?Xe.timestamp:ct.now()}},DS=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let i=0;i<s;i++)r+=Math.round(t(i/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Wa=2e4;function Gh(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<Wa;)e+=n,r=t.next(e);return e>=Wa?1/0:e}function ZD(t,e=100,n){const r=n({...t,keyframes:[0,e]}),s=Math.min(Gh(r),Wa);return{type:"keyframes",ease:i=>r.next(s*i).value/e,duration:Nt(s)}}const eL=5;function LS(t,e,n){const r=Math.max(e-eL,0);return mS(n-t(r),e-r)}const Oe={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ec=.001;function tL({duration:t=Oe.duration,bounce:e=Oe.bounce,velocity:n=Oe.velocity,mass:r=Oe.mass}){let s,i,o=1-e;o=cn(Oe.minDamping,Oe.maxDamping,o),t=cn(Oe.minDuration,Oe.maxDuration,Nt(t)),o<1?(s=c=>{const u=c*o,h=u*t,f=u-n,p=Vu(c,o),m=Math.exp(-h);return Ec-f/p*m},i=c=>{const h=c*o*t,f=h*n+n,p=Math.pow(o,2)*Math.pow(c,2)*t,m=Math.exp(-h),y=Vu(Math.pow(c,2),o);return(-s(c)+Ec>0?-1:1)*((f-p)*m)/y}):(s=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-Ec+u*h},i=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=rL(s,i,a);if(t=Vt(t),isNaN(l))return{stiffness:Oe.stiffness,damping:Oe.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:o*2*Math.sqrt(r*c),duration:t}}}const nL=12;function rL(t,e,n){let r=n;for(let s=1;s<nL;s++)r=r-t(r)/e(r);return r}function Vu(t,e){return t*Math.sqrt(1-e*e)}const sL=["duration","bounce"],iL=["stiffness","damping","mass"];function Bm(t,e){return e.some(n=>t[n]!==void 0)}function oL(t){let e={velocity:Oe.velocity,stiffness:Oe.stiffness,damping:Oe.damping,mass:Oe.mass,isResolvedFromDuration:!1,...t};if(!Bm(t,iL)&&Bm(t,sL))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*cn(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Oe.mass,stiffness:s,damping:i}}else{const n=tL(t);e={...e,...n,mass:Oe.mass},e.isResolvedFromDuration=!0}return e}function za(t=Oe.visualDuration,e=Oe.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:h,velocity:f,isResolvedFromDuration:p}=oL({...n,velocity:-Nt(n.velocity||0)}),m=f||0,y=c/(2*Math.sqrt(l*u)),v=o-i,S=Nt(Math.sqrt(l/u)),E=Math.abs(v)<5;r||(r=E?Oe.restSpeed.granular:Oe.restSpeed.default),s||(s=E?Oe.restDelta.granular:Oe.restDelta.default);let k;if(y<1){const w=Vu(S,y);k=_=>{const P=Math.exp(-y*S*_);return o-P*((m+y*S*v)/w*Math.sin(w*_)+v*Math.cos(w*_))}}else if(y===1)k=w=>o-Math.exp(-S*w)*(v+(m+S*v)*w);else{const w=S*Math.sqrt(y*y-1);k=_=>{const P=Math.exp(-y*S*_),b=Math.min(w*_,300);return o-P*((m+y*S*v)*Math.sinh(b)+w*v*Math.cosh(b))/w}}const g={calculatedDuration:p&&h||null,next:w=>{const _=k(w);if(p)a.done=w>=h;else{let P=w===0?m:0;y<1&&(P=w===0?Vt(m):LS(k,w,_));const b=Math.abs(P)<=r,C=Math.abs(o-_)<=s;a.done=b&&C}return a.value=a.done?o:_,a},toString:()=>{const w=Math.min(Gh(g),Wa),_=DS(P=>g.next(w*P).value,w,30);return w+"ms "+_},toTransition:()=>{}};return g}za.applyToOptions=t=>{const e=ZD(t,100,za);return t.ease=e.ease,t.duration=Vt(e.duration),t.type="keyframes",t};function Wu({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},p=b=>a!==void 0&&b<a||l!==void 0&&b>l,m=b=>a===void 0?l:l===void 0||Math.abs(a-b)<Math.abs(l-b)?a:l;let y=n*e;const v=h+y,S=o===void 0?v:o(v);S!==v&&(y=S-h);const E=b=>-y*Math.exp(-b/r),k=b=>S+E(b),g=b=>{const C=E(b),A=k(b);f.done=Math.abs(C)<=c,f.value=f.done?S:A};let w,_;const P=b=>{p(f.value)&&(w=b,_=za({keyframes:[f.value,m(f.value)],velocity:LS(k,b,f.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return P(0),{calculatedDuration:null,next:b=>{let C=!1;return!_&&w===void 0&&(C=!0,g(b),P(b)),w!==void 0&&b>=w?_.next(b-w):(!C&&g(b),f)}}}function aL(t,e,n){const r=[],s=n||Sn.mix||MS,i=t.length-1;for(let o=0;o<i;o++){let a=s(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Rt:e;a=Yi(l,a)}r.push(a)}return r}function $S(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if($h(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=aL(e,r,s),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=Ri(t[h],t[h+1],u);return a[h](f)};return n?u=>c(cn(t[0],t[i-1],u)):c}function lL(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=Ri(0,e,r);t.push(Ne(n,1,s))}}function cL(t){const e=[0];return lL(e,t.length-1),e}function uL(t,e){return t.map(n=>n*e)}function dL(t,e){return t.map(()=>e||kS).splice(0,t.length-1)}function fi({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=_D(r)?r.map(Mm):Mm(r),i={done:!1,value:e[0]},o=uL(n&&n.length===e.length?n:cL(e),t),a=$S(o,e,{ease:Array.isArray(s)?s:dL(e,s)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const hL=t=>t!==null;function qh(t,{repeat:e,repeatType:n="loop"},r,s=1){const i=t.filter(hL),a=s<0||e&&n!=="loop"&&e%2===1?0:i.length-1;return!a||r===void 0?i[a]:r}const fL={decay:Wu,inertia:Wu,tween:fi,keyframes:fi,spring:za};function FS(t){typeof t.type=="string"&&(t.type=fL[t.type])}class Yh{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const pL=t=>t/100;class Jh extends Yh{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,s;const{motionValue:n}=this.options;n&&n.updatedAt!==ct.now()&&this.tick(ct.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(r=this.options).onStop)==null||s.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;FS(e);const{type:n=fi,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=e;let{keyframes:a}=e;const l=n||fi;l!==fi&&typeof a[0]!="number"&&(this.mixKeyframes=Yi(pL,MS(a[0],a[1])),a=[0,100]);const c=l({...e,keyframes:a});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=Gh(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:h,repeatType:f,repeatDelay:p,type:m,onUpdate:y,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const S=this.currentTime-c*(this.playbackSpeed>=0?1:-1),E=this.playbackSpeed>=0?S<0:S>s;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let k=this.currentTime,g=r;if(h){const b=Math.min(this.currentTime,s)/a;let C=Math.floor(b),A=b%1;!A&&b>=1&&(A=1),A===1&&C--,C=Math.min(C,h+1),!!(C%2)&&(f==="reverse"?(A=1-A,p&&(A-=p/a)):f==="mirror"&&(g=o)),k=cn(0,1,A)*a}const w=E?{done:!1,value:u[0]}:g.next(k);i&&(w.value=i(w.value));let{done:_}=w;!E&&l!==null&&(_=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&_);return P&&m!==Wu&&(w.value=qh(u,this.options,v,this.speed)),y&&y(w.value),P&&this.finish(),w}then(e,n){return this.finished.then(e,n)}get duration(){return Nt(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Nt(e)}get time(){return Nt(this.currentTime)}set time(e){var n;e=Vt(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ct.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Nt(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:e=QD,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(s=this.options).onPlay)==null||i.call(s);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ct.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function mL(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const wr=t=>t*180/Math.PI,zu=t=>{const e=wr(Math.atan2(t[1],t[0]));return Hu(e)},gL={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:zu,rotateZ:zu,skewX:t=>wr(Math.atan(t[1])),skewY:t=>wr(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Hu=t=>(t=t%360,t<0&&(t+=360),t),Vm=zu,Wm=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),zm=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),yL={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Wm,scaleY:zm,scale:t=>(Wm(t)+zm(t))/2,rotateX:t=>Hu(wr(Math.atan2(t[6],t[5]))),rotateY:t=>Hu(wr(Math.atan2(-t[2],t[0]))),rotateZ:Vm,rotate:Vm,skewX:t=>wr(Math.atan(t[4])),skewY:t=>wr(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Ku(t){return t.includes("scale")?1:0}function Gu(t,e){if(!t||t==="none")return Ku(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=yL,s=n;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=gL,s=a}if(!s)return Ku(e);const i=r[e],o=s[1].split(",").map(bL);return typeof i=="function"?i(o):o[i]}const xL=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return Gu(n,e)};function bL(t){return parseFloat(t.trim())}const Ds=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ls=new Set(Ds),Hm=t=>t===Ms||t===Q,wL=new Set(["x","y","z"]),vL=Ds.filter(t=>!wL.has(t));function SL(t){const e=[];return vL.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Fn={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Gu(e,"x"),y:(t,{transform:e})=>Gu(e,"y")};Fn.translateX=Fn.x;Fn.translateY=Fn.y;const Sr=new Set;let qu=!1,Yu=!1,Ju=!1;function US(){if(Yu){const t=Array.from(Sr).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=SL(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,o])=>{var a;(a=r.getValue(i))==null||a.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Yu=!1,qu=!1,Sr.forEach(t=>t.complete(Ju)),Sr.clear()}function BS(){Sr.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Yu=!0)})}function _L(){Ju=!0,BS(),US(),Ju=!1}class Xh{constructor(e,n,r,s,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Sr.add(this),qu||(qu=!0,ke.read(BS),ke.resolveKeyframes(US))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;if(e[0]===null){const i=s==null?void 0:s.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&n){const a=r.readValue(n,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),s&&i===void 0&&s.set(e[0])}mL(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Sr.delete(this)}cancel(){this.state==="scheduled"&&(Sr.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const kL=t=>t.startsWith("--");function CL(t,e,n){kL(e)?t.style.setProperty(e,n):t.style[e]=n}const EL=Fh(()=>window.ScrollTimeline!==void 0),PL={};function AL(t,e){const n=Fh(t);return()=>PL[e]??n()}const VS=AL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ni=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,Km={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ni([0,.65,.55,1]),circOut:ni([.55,0,1,.45]),backIn:ni([.31,.01,.66,-.59]),backOut:ni([.33,1.53,.69,.99])};function WS(t,e){if(t)return typeof t=="function"?VS()?DS(t,e):"ease-out":CS(t)?ni(t):Array.isArray(t)?t.map(n=>WS(n,e)||Km.easeOut):Km[t]}function jL(t,e,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:a="easeOut",times:l}={},c=void 0){const u={[e]:n};l&&(u.offset=l);const h=WS(a,s);Array.isArray(h)&&(u.easing=h);const f={delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return c&&(f.pseudoElement=c),t.animate(u,f)}function zS(t){return typeof t=="function"&&"applyToOptions"in t}function NL({type:t,...e}){return zS(t)&&VS()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class HS extends Yh{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,$h(typeof e.type!="string");const c=NL(e);this.animation=jL(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=qh(s,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):CL(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var n,r,s;const e=(n=this.options)==null?void 0:n.element;!this.isPseudoElement&&(e!=null&&e.isConnected)&&((s=(r=this.animation).commitStyles)==null||s.call(r))}get duration(){var n,r;const e=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Nt(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Nt(e)}get time(){return Nt(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Vt(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&EL()?(this.animation.timeline=e,Rt):n(this)}}const KS={anticipate:vS,backInOut:wS,circInOut:_S};function TL(t){return t in KS}function RL(t){typeof t.ease=="string"&&TL(t.ease)&&(t.ease=KS[t.ease])}const Pc=10;class OL extends HS{constructor(e){RL(e),FS(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const a=new Jh({...o,autoplay:!1}),l=Math.max(Pc,ct.now()-this.startTime),c=cn(0,Pc,l-Pc);n.setWithVelocity(a.sample(Math.max(0,l-c)).value,a.sample(l).value,c),a.stop()}}const Gm=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Gn.test(t)||t==="0")&&!t.startsWith("url("));function IL(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function ML(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=Gm(s,e),a=Gm(i,e);return!o||!a?!1:IL(t)||(n==="spring"||zS(n))&&r}function Xu(t){t.duration=0,t.type="keyframes"}const DL=new Set(["opacity","clipPath","filter","transform"]),LL=Fh(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function $L(t){var u;const{motionValue:e,name:n,repeatDelay:r,repeatType:s,damping:i,type:o}=t;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return LL()&&n&&DL.has(n)&&(n!=="transform"||!c)&&!l&&!r&&s!=="mirror"&&i!==0&&o!=="inertia"}const FL=40;class UL extends Yh{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",keyframes:a,name:l,motionValue:c,element:u,...h}){var m;super(),this.stop=()=>{var y,v;this._animation&&(this._animation.stop(),(y=this.stopTimeline)==null||y.call(this)),(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=ct.now();const f={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:o,name:l,motionValue:c,element:u,...h},p=(u==null?void 0:u.KeyframeResolver)||Xh;this.keyframeResolver=new p(a,(y,v,S)=>this.onKeyframesResolved(y,v,f,!S),l,c,u),(m=this.keyframeResolver)==null||m.scheduleResolve()}onKeyframesResolved(e,n,r,s){var v,S;this.keyframeResolver=void 0;const{name:i,type:o,velocity:a,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=ct.now(),ML(e,i,o,a)||((Sn.instantAnimations||!l)&&(u==null||u(qh(e,r,n))),e[0]=e[e.length-1],Xu(r),r.repeat=0);const f={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>FL?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},p=!c&&$L(f),m=(S=(v=f.motionValue)==null?void 0:v.owner)==null?void 0:S.current,y=p?new OL({...f,element:m}):new Jh(f);y.finished.then(()=>{this.notifyFinished()}).catch(Rt),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),_L()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}function GS(t,e,n,r=0,s=1){const i=Array.from(t).sort((c,u)=>c.sortNodePosition(u)).indexOf(e),o=t.size,a=(o-1)*r;return typeof n=="function"?n(i,o):s===1?i*r:a-i*r}const BL=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function VL(t){const e=BL.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function qS(t,e,n=1){const[r,s]=VL(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return hS(o)?parseFloat(o):o}return Wh(s)?qS(s,e,n+1):s}const WL={type:"spring",stiffness:500,damping:25,restSpeed:10},zL=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),HL={type:"keyframes",duration:.8},KL={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},GL=(t,{keyframes:e})=>e.length>2?HL:Ls.has(t)?t.startsWith("scale")?zL(e[1]):WL:KL,qL=t=>t!==null;function YL(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(qL),i=e&&n!=="loop"&&e%2===1?0:s.length-1;return s[i]}function YS(t,e){if(t!=null&&t.inherit&&e){const{inherit:n,...r}=t;return{...e,...r}}return t}function Qh(t,e){const n=(t==null?void 0:t[e])??(t==null?void 0:t.default)??t;return n!==t?YS(n,t):n}function JL({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const Zh=(t,e,n,r={},s,i)=>o=>{const a=Qh(r,t)||{},l=a.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Vt(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:s};JL(a)||Object.assign(u,GL(t,u)),u.duration&&(u.duration=Vt(u.duration)),u.repeatDelay&&(u.repeatDelay=Vt(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(Xu(u),u.delay===0&&(h=!0)),(Sn.instantAnimations||Sn.skipAnimations||s!=null&&s.shouldSkipAnimations)&&(h=!0,Xu(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,h&&!i&&e.get()!==void 0){const f=YL(u.keyframes,a);if(f!==void 0){ke.update(()=>{u.onUpdate(f),u.onComplete()});return}}return a.isSync?new Jh(u):new UL(u)};function qm(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function ef(t,e,n,r){if(typeof e=="function"){const[s,i]=qm(r);e=e(n!==void 0?n:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=qm(r);e=e(n!==void 0?n:t.custom,s,i)}return e}function ys(t,e,n){const r=t.getProps();return ef(r,e,n!==void 0?n:r.custom,t)}const JS=new Set(["width","height","top","left","right","bottom",...Ds]),Ym=30,XL=t=>!isNaN(parseFloat(t)),pi={current:void 0};class QL{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var i;const s=ct.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=ct.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=XL(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new Uh);const r=this.events[e].add(n);return e==="change"?()=>{r(),ke.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return pi.current&&pi.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=ct.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Ym)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Ym);return mS(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ar(t,e){return new QL(t,e)}const Qu=t=>Array.isArray(t);function ZL(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Ar(n))}function e$(t){return Qu(t)?t[t.length-1]||0:t}function t$(t,e){const n=ys(t,e);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const o in i){const a=e$(i[o]);ZL(t,o,a)}}const Ze=t=>!!(t&&t.getVelocity);function n$(t){return!!(Ze(t)&&t.add)}function Zu(t,e){const n=t.getValue("willChange");if(n$(n))return n.add(e);if(!n&&Sn.WillChange){const r=new Sn.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function tf(t){return t.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}const r$="framerAppearId",XS="data-"+tf(r$);function QS(t){return t.props[XS]}function s$({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function ZS(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i,transitionEnd:o,...a}=e;const l=t.getDefaultTransition();i=i?YS(i,l):l;const c=i==null?void 0:i.reduceMotion;r&&(i=r);const u=[],h=s&&t.animationState&&t.animationState.getState()[s];for(const f in a){const p=t.getValue(f,t.latestValues[f]??null),m=a[f];if(m===void 0||h&&s$(h,f))continue;const y={delay:n,...Qh(i||{},f)},v=p.get();if(v!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===v&&!y.velocity)continue;let S=!1;if(window.MotionHandoffAnimation){const g=QS(t);if(g){const w=window.MotionHandoffAnimation(g,f,ke);w!==null&&(y.startTime=w,S=!0)}}Zu(t,f);const E=c??t.shouldReduceMotion;p.start(Zh(f,p,m,E&&JS.has(f)?{type:!1}:y,t,S));const k=p.animation;k&&u.push(k)}if(o){const f=()=>ke.update(()=>{o&&t$(t,o)});u.length?Promise.all(u).then(f):f()}return u}function ed(t,e,n={}){var l;const r=ys(t,e,n.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(ZS(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=s;return i$(t,e,c,u,h,f,n)}:()=>Promise.resolve(),{when:a}=s;if(a){const[c,u]=a==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function i$(t,e,n=0,r=0,s=0,i=1,o){const a=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),a.push(ed(l,e,{...o,delay:n+(typeof r=="function"?0:r)+GS(t.variantChildren,l,r,s,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function o$(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>ed(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=ed(t,e,n);else{const s=typeof e=="function"?ys(t,e,n.custom):e;r=Promise.all(ZS(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const a$={test:t=>t==="auto",parse:t=>t},e_=t=>e=>e.test(t),t_=[Ms,Q,sn,In,DD,MD,a$],Jm=t=>t_.find(e_(t));function l$(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||pS(t):!0}const c$=new Set(["brightness","contrast","saturate","opacity"]);function u$(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(zh)||[];if(!r)return t;const s=n.replace(r,"");let i=c$.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const d$=/\b([a-z-]*)\(.*?\)/gu,td={...Gn,getAnimatableNone:t=>{const e=t.match(d$);return e?e.map(u$).join(" "):t}},Xm={...Ms,transform:Math.round},h$={rotate:In,rotateX:In,rotateY:In,rotateZ:In,scale:Ro,scaleX:Ro,scaleY:Ro,scaleZ:Ro,skew:In,skewX:In,skewY:In,distance:Q,translateX:Q,translateY:Q,translateZ:Q,x:Q,y:Q,z:Q,perspective:Q,transformPerspective:Q,opacity:Oi,originX:Lm,originY:Lm,originZ:Q},nf={borderWidth:Q,borderTopWidth:Q,borderRightWidth:Q,borderBottomWidth:Q,borderLeftWidth:Q,borderRadius:Q,borderTopLeftRadius:Q,borderTopRightRadius:Q,borderBottomRightRadius:Q,borderBottomLeftRadius:Q,width:Q,maxWidth:Q,height:Q,maxHeight:Q,top:Q,right:Q,bottom:Q,left:Q,inset:Q,insetBlock:Q,insetBlockStart:Q,insetBlockEnd:Q,insetInline:Q,insetInlineStart:Q,insetInlineEnd:Q,padding:Q,paddingTop:Q,paddingRight:Q,paddingBottom:Q,paddingLeft:Q,paddingBlock:Q,paddingBlockStart:Q,paddingBlockEnd:Q,paddingInline:Q,paddingInlineStart:Q,paddingInlineEnd:Q,margin:Q,marginTop:Q,marginRight:Q,marginBottom:Q,marginLeft:Q,marginBlock:Q,marginBlockStart:Q,marginBlockEnd:Q,marginInline:Q,marginInlineStart:Q,marginInlineEnd:Q,fontSize:Q,backgroundPositionX:Q,backgroundPositionY:Q,...h$,zIndex:Xm,fillOpacity:Oi,strokeOpacity:Oi,numOctaves:Xm},f$={...nf,color:Le,backgroundColor:Le,outlineColor:Le,fill:Le,stroke:Le,borderColor:Le,borderTopColor:Le,borderRightColor:Le,borderBottomColor:Le,borderLeftColor:Le,filter:td,WebkitFilter:td},n_=t=>f$[t];function r_(t,e){let n=n_(t);return n!==td&&(n=Gn),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const p$=new Set(["auto","none","0"]);function m$(t,e,n){let r=0,s;for(;r<t.length&&!s;){const i=t[r];typeof i=="string"&&!p$.has(i)&&Ii(i).values.length&&(s=t[r]),r++}if(s&&n)for(const i of e)t[i]=r_(n,s)}class g$ extends Xh{constructor(e,n,r,s,i){super(e,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Wh(h))){const f=qS(h,n.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!JS.has(r)||e.length!==2)return;const[s,i]=e,o=Jm(s),a=Jm(i),l=Dm(s),c=Dm(i);if(l!==c&&Fn[r]){this.needsMeasurement=!0;return}if(o!==a)if(Hm(o)&&Hm(a))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else Fn[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)(e[s]===null||l$(e[s]))&&r.push(s);r.length&&m$(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Fn[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var a;const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,o=r[i];r[i]=Fn[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const y$=new Set(["opacity","clipPath","filter","transform"]);function s_(t,e,n){if(t==null)return[];if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const s=(n==null?void 0:n[t])??r.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t).filter(r=>r!=null)}const i_=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function nd(t){return fS(t)&&"offsetHeight"in t}const{schedule:rf}=ES(queueMicrotask,!1),$t={x:!1,y:!1};function o_(){return $t.x||$t.y}function x$(t){return t==="x"||t==="y"?$t[t]?null:($t[t]=!0,()=>{$t[t]=!1}):$t.x||$t.y?null:($t.x=$t.y=!0,()=>{$t.x=$t.y=!1})}function a_(t,e){const n=s_(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function b$(t){return!(t.pointerType==="touch"||o_())}function w$(t,e,n={}){const[r,s,i]=a_(t,n);return r.forEach(o=>{let a=!1,l=!1,c;const u=()=>{o.removeEventListener("pointerleave",m)},h=v=>{c&&(c(v),c=void 0),u()},f=v=>{a=!1,window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",f),l&&(l=!1,h(v))},p=()=>{a=!0,window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",f,s)},m=v=>{if(v.pointerType!=="touch"){if(a){l=!0;return}h(v)}},y=v=>{if(!b$(v))return;l=!1;const S=e(o,v);typeof S=="function"&&(c=S,o.addEventListener("pointerleave",m,s))};o.addEventListener("pointerenter",y,s),o.addEventListener("pointerdown",p,s)}),i}const l_=(t,e)=>e?t===e?!0:l_(t,e.parentElement):!1,sf=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,v$=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function S$(t){return v$.has(t.tagName)||t.isContentEditable===!0}const _$=new Set(["INPUT","SELECT","TEXTAREA"]);function k$(t){return _$.has(t.tagName)||t.isContentEditable===!0}const na=new WeakSet;function Qm(t){return e=>{e.key==="Enter"&&t(e)}}function Ac(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const C$=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=Qm(()=>{if(na.has(n))return;Ac(n,"down");const s=Qm(()=>{Ac(n,"up")}),i=()=>Ac(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function Zm(t){return sf(t)&&!o_()}const eg=new WeakSet;function E$(t,e,n={}){const[r,s,i]=a_(t,n),o=a=>{const l=a.currentTarget;if(!Zm(a)||eg.has(a))return;na.add(l),n.stopPropagation&&eg.add(a);const c=e(l,a),u=(p,m)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),na.has(l)&&na.delete(l),Zm(p)&&typeof c=="function"&&c(p,{success:m})},h=p=>{u(p,l===window||l===document||n.useGlobalTarget||l_(l,p.target))},f=p=>{u(p,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",f,s)};return r.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,s),nd(a)&&(a.addEventListener("focus",c=>C$(c,s)),!S$(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),i}function of(t){return fS(t)&&"ownerSVGElement"in t}const ra=new WeakMap;let Mn;const c_=(t,e,n)=>(r,s)=>s&&s[0]?s[0][t+"Size"]:of(r)&&"getBBox"in r?r.getBBox()[e]:r[n],P$=c_("inline","width","offsetWidth"),A$=c_("block","height","offsetHeight");function j$({target:t,borderBoxSize:e}){var n;(n=ra.get(t))==null||n.forEach(r=>{r(t,{get width(){return P$(t,e)},get height(){return A$(t,e)}})})}function N$(t){t.forEach(j$)}function T$(){typeof ResizeObserver>"u"||(Mn=new ResizeObserver(N$))}function R$(t,e){Mn||T$();const n=s_(t);return n.forEach(r=>{let s=ra.get(r);s||(s=new Set,ra.set(r,s)),s.add(e),Mn==null||Mn.observe(r)}),()=>{n.forEach(r=>{const s=ra.get(r);s==null||s.delete(e),s!=null&&s.size||Mn==null||Mn.unobserve(r)})}}const sa=new Set;let as;function O$(){as=()=>{const t={get width(){return window.innerWidth},get height(){return window.innerHeight}};sa.forEach(e=>e(t))},window.addEventListener("resize",as)}function I$(t){return sa.add(t),as||O$(),()=>{sa.delete(t),!sa.size&&typeof as=="function"&&(window.removeEventListener("resize",as),as=void 0)}}function tg(t,e){return typeof t=="function"?I$(t):R$(t,e)}function M$(t){return of(t)&&t.tagName==="svg"}function D$(...t){const e=!Array.isArray(t[0]),n=e?0:-1,r=t[0+n],s=t[1+n],i=t[2+n],o=t[3+n],a=$S(s,i,o);return e?a(r):a}const L$=[...t_,Le,Gn],$$=t=>L$.find(e_(t)),ng=()=>({translate:0,scale:1,origin:0,originPoint:0}),ls=()=>({x:ng(),y:ng()}),rg=()=>({min:0,max:0}),We=()=>({x:rg(),y:rg()}),F$=new WeakMap;function Nl(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Mi(t){return typeof t=="string"||Array.isArray(t)}const af=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],lf=["initial",...af];function Tl(t){return Nl(t.animate)||lf.some(e=>Mi(t[e]))}function u_(t){return!!(Tl(t)||t.variants)}function U$(t,e,n){for(const r in e){const s=e[r],i=n[r];if(Ze(s))t.addValue(r,s);else if(Ze(i))t.addValue(r,Ar(s,{owner:t}));else if(i!==s)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(r);t.addValue(r,Ar(o!==void 0?o:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const rd={current:null},d_={current:!1},B$=typeof window<"u";function V$(){if(d_.current=!0,!!B$)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>rd.current=t.matches;t.addEventListener("change",e),e()}else rd.current=!1}const sg=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Ha={};function h_(t){Ha=t}function W$(){return Ha}class z${scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,skipAnimations:i,blockInitialAnimation:o,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=Xh,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=ct.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,ke.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=a;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.skipAnimationsConfig=i,this.options=l,this.blockInitialAnimation=!!o,this.isControllingVariants=Tl(n),this.isVariantNode=u_(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const p in f){const m=f[p];c[p]!==void 0&&Ze(m)&&m.set(c[p])}}mount(e){var n,r;if(this.hasBeenMounted)for(const s in this.initialValues)(n=this.values.get(s))==null||n.jump(this.initialValues[s]),this.latestValues[s]=this.initialValues[s];this.current=e,F$.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,i)=>this.bindToMotionValue(i,s)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(d_.current||V$(),this.shouldReduceMotion=rd.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){var e;this.projection&&this.projection.unmount(),_n(this.notifyUpdate),_n(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const r=this.features[n];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){if(this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)(),n.accelerate&&y$.has(e)&&this.current instanceof HTMLElement){const{factory:o,keyframes:a,times:l,ease:c,duration:u}=n.accelerate,h=new HS({element:this.current,name:e,keyframes:a,times:l,ease:c,duration:Vt(u)}),f=o(h);this.valueSubscriptions.set(e,()=>{f(),h.cancel()});return}const r=Ls.has(e);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&ke.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;typeof window<"u"&&window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ha){const n=Ha[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):We()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<sg.length;r++){const s=sg[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=U$(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Ar(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(hS(r)||pS(r))?r=parseFloat(r):!$$(r)&&Gn.test(n)&&(r=r_(e,n)),this.setBaseTarget(e,Ze(r)?r.get():r)),Ze(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const o=ef(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);o&&(r=o[e])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ze(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new Uh),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){rf.render(this.render)}}class f_ extends z${constructor(){super(...arguments),this.KeyframeResolver=g$}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){const r=e.style;return r?r[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ze(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}class Qn{constructor(e){this.isMounted=!1,this.node=e}update(){}}function p_({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function H$({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function K$(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function jc(t){return t===void 0||t===1}function sd({scale:t,scaleX:e,scaleY:n}){return!jc(t)||!jc(e)||!jc(n)}function ur(t){return sd(t)||m_(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function m_(t){return ig(t.x)||ig(t.y)}function ig(t){return t&&t!=="0%"}function Ka(t,e,n){const r=t-n,s=e*r;return n+s}function og(t,e,n,r,s){return s!==void 0&&(t=Ka(t,s,r)),Ka(t,n,r)+e}function id(t,e=0,n=1,r,s){t.min=og(t.min,e,n,r,s),t.max=og(t.max,e,n,r,s)}function g_(t,{x:e,y:n}){id(t.x,e.translate,e.scale,e.originPoint),id(t.y,n.translate,n.scale,n.originPoint)}const ag=.999999999999,lg=1.0000000000001;function G$(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let a=0;a<s;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&us(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,g_(t,o)),r&&ur(i.latestValues)&&us(t,i.latestValues))}e.x<lg&&e.x>ag&&(e.x=1),e.y<lg&&e.y>ag&&(e.y=1)}function cs(t,e){t.min=t.min+e,t.max=t.max+e}function cg(t,e,n,r,s=.5){const i=Ne(t.min,t.max,s);id(t,e,n,i,r)}function us(t,e){cg(t.x,e.x,e.scaleX,e.scale,e.originX),cg(t.y,e.y,e.scaleY,e.scale,e.originY)}function y_(t,e){return p_(K$(t.getBoundingClientRect(),e))}function q$(t,e,n){const r=y_(t,n),{scroll:s}=e;return s&&(cs(r.x,s.offset.x),cs(r.y,s.offset.y)),r}const Y$={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},J$=Ds.length;function X$(t,e,n){let r="",s=!0;for(let i=0;i<J$;i++){const o=Ds[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number")l=a===(o.startsWith("scale")?1:0);else{const c=parseFloat(a);l=o.startsWith("scale")?c===1:c===0}if(!l||n){const c=i_(a,nf[o]);if(!l){s=!1;const u=Y$[o]||o;r+=`${u}(${c}) `}n&&(e[o]=c)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function cf(t,e,n){const{style:r,vars:s,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(Ls.has(l)){o=!0;continue}else if(AS(l)){s[l]=c;continue}else{const u=i_(c,nf[l]);l.startsWith("origin")?(a=!0,i[l]=u):r[l]=u}}if(e.transform||(o||n?r.transform=X$(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}function x_(t,{style:e,vars:n},r,s){const i=t.style;let o;for(o in e)i[o]=e[o];s==null||s.applyProjectionStyles(i,r);for(o in n)i.setProperty(o,n[o])}function ug(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const zs={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Q.test(t))t=parseFloat(t);else return t;const n=ug(t,e.target.x),r=ug(t,e.target.y);return`${n}% ${r}%`}},Q$={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=Gn.parse(t);if(s.length>5)return r;const i=Gn.createTransformer(t),o=typeof s[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;s[0+o]/=a,s[1+o]/=l;const c=Ne(a,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=c),typeof s[3+o]=="number"&&(s[3+o]/=c),i(s)}},od={borderRadius:{...zs,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:zs,borderTopRightRadius:zs,borderBottomLeftRadius:zs,borderBottomRightRadius:zs,boxShadow:Q$};function b_(t,{layout:e,layoutId:n}){return Ls.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!od[t]||t==="opacity")}function uf(t,e,n){var o;const r=t.style,s=e==null?void 0:e.style,i={};if(!r)return i;for(const a in r)(Ze(r[a])||s&&Ze(s[a])||b_(a,t)||((o=n==null?void 0:n.getValue(a))==null?void 0:o.liveStyle)!==void 0)&&(i[a]=r[a]);return i}function Z$(t){return window.getComputedStyle(t)}class e5 extends f_{constructor(){super(...arguments),this.type="html",this.renderInstance=x_}readValueFromInstance(e,n){var r;if(Ls.has(n))return(r=this.projection)!=null&&r.isProjecting?Ku(n):xL(e,n);{const s=Z$(e),i=(AS(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return y_(e,n)}build(e,n,r){cf(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return uf(e,n,r)}}const t5={offset:"stroke-dashoffset",array:"stroke-dasharray"},n5={offset:"strokeDashoffset",array:"strokeDasharray"};function r5(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?t5:n5;t[i.offset]=`${-r}`,t[i.array]=`${e} ${n}`}const s5=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function w_(t,{attrX:e,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:o=0,...a},l,c,u){if(cf(t,a,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:f}=t;h.transform&&(f.transform=h.transform,delete h.transform),(f.transform||h.transformOrigin)&&(f.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete h.transformBox);for(const p of s5)h[p]!==void 0&&(f[p]=h[p],delete h[p]);e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),s!==void 0&&r5(h,s,i,o,!1)}const v_=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),S_=t=>typeof t=="string"&&t.toLowerCase()==="svg";function i5(t,e,n,r){x_(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(v_.has(s)?s:tf(s),e.attrs[s])}function __(t,e,n){const r=uf(t,e,n);for(const s in t)if(Ze(t[s])||Ze(e[s])){const i=Ds.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=t[s]}return r}class o5 extends f_{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=We}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Ls.has(n)){const r=n_(n);return r&&r.default||0}return n=v_.has(n)?n:tf(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return __(e,n,r)}build(e,n,r){w_(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,s){i5(e,n,r,s)}mount(e){this.isSVGTag=S_(e.tagName),super.mount(e)}}const a5=lf.length;function k_(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?k_(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<a5;n++){const r=lf[n],s=t.props[r];(Mi(s)||s===!1)&&(e[r]=s)}return e}function C_(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const l5=[...af].reverse(),c5=af.length;function u5(t){return e=>Promise.all(e.map(({animation:n,options:r})=>o$(t,n,r)))}function d5(t){let e=u5(t),n=dg(),r=!0;const s=l=>(c,u)=>{var f;const h=ys(t,u,l==="exit"?(f=t.presenceContext)==null?void 0:f.custom:void 0);if(h){const{transition:p,transitionEnd:m,...y}=h;c={...c,...y,...m}}return c};function i(l){e=l(t)}function o(l){const{props:c}=t,u=k_(t.parent)||{},h=[],f=new Set;let p={},m=1/0;for(let v=0;v<c5;v++){const S=l5[v],E=n[S],k=c[S]!==void 0?c[S]:u[S],g=Mi(k),w=S===l?E.isActive:null;w===!1&&(m=v);let _=k===u[S]&&k!==c[S]&&g;if(_&&r&&t.manuallyAnimateOnMount&&(_=!1),E.protectedKeys={...p},!E.isActive&&w===null||!k&&!E.prevProp||Nl(k)||typeof k=="boolean")continue;if(S==="exit"&&E.isActive&&w!==!0){E.prevResolvedValues&&(p={...p,...E.prevResolvedValues});continue}const P=h5(E.prevProp,k);let b=P||S===l&&E.isActive&&!_&&g||v>m&&g,C=!1;const A=Array.isArray(k)?k:[k];let N=A.reduce(s(S),{});w===!1&&(N={});const{prevResolvedValues:O={}}=E,I={...O,...N},T=j=>{b=!0,f.has(j)&&(C=!0,f.delete(j)),E.needsAnimating[j]=!0;const D=t.getValue(j);D&&(D.liveStyle=!1)};for(const j in I){const D=N[j],$=O[j];if(p.hasOwnProperty(j))continue;let F=!1;Qu(D)&&Qu($)?F=!C_(D,$):F=D!==$,F?D!=null?T(j):f.add(j):D!==void 0&&f.has(j)?T(j):E.protectedKeys[j]=!0}E.prevProp=k,E.prevResolvedValues=N,E.isActive&&(p={...p,...N}),r&&t.blockInitialAnimation&&(b=!1);const M=_&&P;b&&(!M||C)&&h.push(...A.map(j=>{const D={type:S};if(typeof j=="string"&&r&&!M&&t.manuallyAnimateOnMount&&t.parent){const{parent:$}=t,F=ys($,j);if($.enteringChildren&&F){const{delayChildren:K}=F.transition||{};D.delay=GS($.enteringChildren,t,K)}}return{animation:j,options:D}}))}if(f.size){const v={};if(typeof c.initial!="boolean"){const S=ys(t,Array.isArray(c.initial)?c.initial[0]:c.initial);S&&S.transition&&(v.transition=S.transition)}f.forEach(S=>{const E=t.getBaseTarget(S),k=t.getValue(S);k&&(k.liveStyle=!0),v[S]=E??null}),h.push({animation:v})}let y=!!h.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(y=!1),r=!1,y?e(h):Promise.resolve()}function a(l,c){var h;if(n[l].isActive===c)return Promise.resolve();(h=t.variantChildren)==null||h.forEach(f=>{var p;return(p=f.animationState)==null?void 0:p.setActive(l,c)}),n[l].isActive=c;const u=o(l);for(const f in n)n[f].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=dg()}}}function h5(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!C_(e,t):!1}function ar(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function dg(){return{animate:ar(!0),whileInView:ar(),whileHover:ar(),whileTap:ar(),whileDrag:ar(),whileFocus:ar(),exit:ar()}}function hg(t,e){t.min=e.min,t.max=e.max}function Mt(t,e){hg(t.x,e.x),hg(t.y,e.y)}function fg(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}const E_=1e-4,f5=1-E_,p5=1+E_,P_=.01,m5=0-P_,g5=0+P_;function ut(t){return t.max-t.min}function y5(t,e,n){return Math.abs(t-e)<=n}function pg(t,e,n,r=.5){t.origin=r,t.originPoint=Ne(e.min,e.max,t.origin),t.scale=ut(n)/ut(e),t.translate=Ne(n.min,n.max,t.origin)-t.originPoint,(t.scale>=f5&&t.scale<=p5||isNaN(t.scale))&&(t.scale=1),(t.translate>=m5&&t.translate<=g5||isNaN(t.translate))&&(t.translate=0)}function mi(t,e,n,r){pg(t.x,e.x,n.x,r?r.originX:void 0),pg(t.y,e.y,n.y,r?r.originY:void 0)}function mg(t,e,n){t.min=n.min+e.min,t.max=t.min+ut(e)}function x5(t,e,n){mg(t.x,e.x,n.x),mg(t.y,e.y,n.y)}function gg(t,e,n){t.min=e.min-n.min,t.max=t.min+ut(e)}function Ga(t,e,n){gg(t.x,e.x,n.x),gg(t.y,e.y,n.y)}function yg(t,e,n,r,s){return t-=e,t=Ka(t,1/n,r),s!==void 0&&(t=Ka(t,1/s,r)),t}function b5(t,e=0,n=1,r=.5,s,i=t,o=t){if(sn.test(e)&&(e=parseFloat(e),e=Ne(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Ne(i.min,i.max,r);t===i&&(a-=e),t.min=yg(t.min,e,n,a,s),t.max=yg(t.max,e,n,a,s)}function xg(t,e,[n,r,s],i,o){b5(t,e[n],e[r],e[s],e.scale,i,o)}const w5=["x","scaleX","originX"],v5=["y","scaleY","originY"];function bg(t,e,n,r){xg(t.x,e,w5,n?n.x:void 0,r?r.x:void 0),xg(t.y,e,v5,n?n.y:void 0,r?r.y:void 0)}function wg(t){return t.translate===0&&t.scale===1}function A_(t){return wg(t.x)&&wg(t.y)}function vg(t,e){return t.min===e.min&&t.max===e.max}function S5(t,e){return vg(t.x,e.x)&&vg(t.y,e.y)}function Sg(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function j_(t,e){return Sg(t.x,e.x)&&Sg(t.y,e.y)}function _g(t){return ut(t.x)/ut(t.y)}function kg(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}function Yt(t){return[t("x"),t("y")]}function _5(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((s||i||o)&&(r=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:f,skewX:p,skewY:m}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),p&&(r+=`skewX(${p}deg) `),m&&(r+=`skewY(${m}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const N_=["TopLeft","TopRight","BottomLeft","BottomRight"],k5=N_.length,Cg=t=>typeof t=="string"?parseFloat(t):t,Eg=t=>typeof t=="number"||Q.test(t);function C5(t,e,n,r,s,i){s?(t.opacity=Ne(0,n.opacity??1,E5(r)),t.opacityExit=Ne(e.opacity??1,0,P5(r))):i&&(t.opacity=Ne(e.opacity??1,n.opacity??1,r));for(let o=0;o<k5;o++){const a=`border${N_[o]}Radius`;let l=Pg(e,a),c=Pg(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Eg(l)===Eg(c)?(t[a]=Math.max(Ne(Cg(l),Cg(c),r),0),(sn.test(c)||sn.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Ne(e.rotate||0,n.rotate||0,r))}function Pg(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const E5=T_(0,.5,SS),P5=T_(.5,.95,Rt);function T_(t,e,n){return r=>r<t?0:r>e?1:n(Ri(t,e,r))}function A5(t,e,n){const r=Ze(t)?t:Ar(t);return r.start(Zh("",r,e,n)),r.animation}function Di(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const j5=(t,e)=>t.depth-e.depth;class N5{constructor(){this.children=[],this.isDirty=!1}add(e){Lh(this.children,e),this.isDirty=!0}remove(e){Ba(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(j5),this.isDirty=!1,this.children.forEach(e)}}function T5(t,e){const n=ct.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(_n(r),t(i-e))};return ke.setup(r,!0),()=>_n(r)}function ia(t){return Ze(t)?t.get():t}class R5{constructor(){this.members=[]}add(e){Lh(this.members,e);for(let n=this.members.length-1;n>=0;n--){const r=this.members[n];if(r===e||r===this.lead||r===this.prevLead)continue;const s=r.instance;s&&s.isConnected===!1&&r.isPresent!==!1&&!r.snapshot&&Ba(this.members,r)}e.scheduleRender()}remove(e){if(Ba(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s],o=i.instance;if(i.isPresent!==!1&&(!o||o.isConnected!==!1)){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender();const s=r.options.layoutDependency,i=e.options.layoutDependency;if(!(s!==void 0&&i!==void 0&&s===i)){const l=r.instance;l&&l.isConnected===!1&&!r.snapshot||(e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0))}const{crossfade:a}=e.options;a===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const oa={hasAnimatedSinceResize:!0,hasEverUpdated:!1},Nc=["","X","Y","Z"],O5=1e3;let I5=0;function Tc(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function R_(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=QS(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",ke,!(s||i))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&R_(r)}function O_({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},a=e==null?void 0:e()){this.id=I5++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(L5),this.nodes.forEach(B5),this.nodes.forEach(V5),this.nodes.forEach($5)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new N5)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Uh),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=of(o)&&!M$(o),this.instance=o;const{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),t){let u,h=0;const f=()=>this.root.updateBlockedByResize=!1;ke.read(()=>{h=window.innerWidth}),t(o,()=>{const p=window.innerWidth;p!==h&&(h=p,this.root.updateBlockedByResize=!0,u&&u(),u=T5(f,250),oa.hasAnimatedSinceResize&&(oa.hasAnimatedSinceResize=!1,this.nodes.forEach(Ng)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||c.getDefaultTransition()||G5,{onLayoutAnimationStart:y,onLayoutAnimationComplete:v}=c.getProps(),S=!this.targetLayout||!j_(this.targetLayout,p),E=!h&&f;if(this.options.layoutRoot||this.resumeFrom||E||h&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...Qh(m,"layout"),onPlay:y,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(u,E)}else h||Ng(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),_n(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(W5),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&R_(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ag);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(jg);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(U5),this.nodes.forEach(M5),this.nodes.forEach(D5)):this.nodes.forEach(jg),this.clearAllSnapshots();const a=ct.now();Xe.delta=cn(0,1e3/60,a-Xe.timestamp),Xe.timestamp=a,Xe.isProcessing=!0,Sc.update.process(Xe),Sc.preRender.process(Xe),Sc.render.process(Xe),Xe.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rf.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(F5),this.sharedNodes.forEach(z5)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ke.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ke.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ut(this.snapshot.measuredBox.x)&&!ut(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=We(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!A_(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&this.instance&&(a||ur(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),q5(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:o}=this.options;if(!o)return We();const a=o.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(Y5))){const{scroll:u}=this.root;u&&(cs(a.x,u.offset.x),cs(a.y,u.offset.y))}return a}removeElementScroll(o){var l;const a=We();if(Mt(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&Mt(a,o),cs(a.x,h.offset.x),cs(a.y,h.offset.y))}return a}applyTransform(o,a=!1){const l=We();Mt(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&us(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),ur(u.latestValues)&&us(l,u.latestValues)}return ur(this.latestValues)&&us(l,this.latestValues),l}removeTransform(o){const a=We();Mt(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!ur(c.latestValues))continue;sd(c.latestValues)&&c.updateSnapshot();const u=We(),h=c.measurePageBox();Mt(u,h),bg(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return ur(this.latestValues)&&bg(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Xe.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var p;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!this.layout||!(u||h))return;this.resolvedRelativeTargetAt=Xe.timestamp;const f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=We(),this.targetWithTransforms=We()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),x5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Mt(this.target,this.layout.layoutBox),g_(this.target,this.targetDelta)):Mt(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||sd(this.parent.latestValues)||m_(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,a,l){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=We(),this.relativeTargetOrigin=We(),Ga(this.relativeTargetOrigin,a,l),Mt(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var m;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Xe.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Mt(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;G$(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=We());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(fg(this.prevProjectionDelta.x,this.projectionDelta.x),fg(this.prevProjectionDelta.y,this.projectionDelta.y)),mi(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!kg(this.projectionDelta.x,this.prevProjectionDelta.x)||!kg(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ls(),this.projectionDelta=ls(),this.projectionDeltaWithTransform=ls()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=ls();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=We(),p=l?l.source:void 0,m=this.layout?this.layout.source:void 0,y=p!==m,v=this.getStack(),S=!v||v.members.length<=1,E=!!(y&&!S&&this.options.crossfade===!0&&!this.path.some(K5));this.animationProgress=0;let k;this.mixTargetDelta=g=>{const w=g/1e3;Tg(h.x,o.x,w),Tg(h.y,o.y,w),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ga(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),H5(this.relativeTarget,this.relativeTargetOrigin,f,w),k&&S5(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=We()),Mt(k,this.relativeTarget)),y&&(this.animationValues=u,C5(u,c,this.latestValues,w,E,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=w},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,c;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(c=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||c.stop(),this.pendingAnimation&&(_n(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ke.update(()=>{oa.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ar(0)),this.currentAnimation=A5(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(O5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&I_(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||We();const h=ut(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const f=ut(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+f}Mt(a,l),us(a,u),mi(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new R5),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&Tc("z",o,c,this.animationValues);for(let u=0;u<Nc.length;u++)Tc(`rotate${Nc[u]}`,o,c,this.animationValues),Tc(`skew${Nc[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=ia(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=ia(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!ur(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let h=_5(this.projectionDeltaWithTransform,this.treeScale,u);l&&(h=l(u,h)),o.transform=h;const{x:f,y:p}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in od){if(u[m]===void 0)continue;const{correct:y,applyTo:v,isCSSVariable:S}=od[m],E=h==="none"?u[m]:y(u[m],c);if(v){const k=v.length;for(let g=0;g<k;g++)o[v[g]]=E}else S?this.options.visualElement.renderState.vars[m]=E:o[m]=E}this.options.layoutId&&(o.pointerEvents=c===this?ia(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(Ag),this.root.sharedNodes.clear()}}}function M5(t){t.updateLayout()}function D5(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=e.source!==t.layout.source;i==="size"?Yt(h=>{const f=o?e.measuredBox[h]:e.layoutBox[h],p=ut(f);f.min=r[h].min,f.max=f.min+p}):I_(i,e.layoutBox,r)&&Yt(h=>{const f=o?e.measuredBox[h]:e.layoutBox[h],p=ut(r[h]);f.max=f.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+p)});const a=ls();mi(a,r,e.layoutBox);const l=ls();o?mi(l,t.applyTransform(s,!0),e.measuredBox):mi(l,r,e.layoutBox);const c=!A_(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:p}=h;if(f&&p){const m=We();Ga(m,e.layoutBox,f.layoutBox);const y=We();Ga(y,r,p.layoutBox),j_(m,y)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=y,t.relativeTargetOrigin=m,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function L5(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function $5(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function F5(t){t.clearSnapshot()}function Ag(t){t.clearMeasurements()}function jg(t){t.isLayoutDirty=!1}function U5(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Ng(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function B5(t){t.resolveTargetDelta()}function V5(t){t.calcProjection()}function W5(t){t.resetSkewAndRotation()}function z5(t){t.removeLeadSnapshot()}function Tg(t,e,n){t.translate=Ne(e.translate,0,n),t.scale=Ne(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Rg(t,e,n,r){t.min=Ne(e.min,n.min,r),t.max=Ne(e.max,n.max,r)}function H5(t,e,n,r){Rg(t.x,e.x,n.x,r),Rg(t.y,e.y,n.y,r)}function K5(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const G5={duration:.45,ease:[.4,0,.1,1]},Og=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Ig=Og("applewebkit/")&&!Og("chrome/")?Math.round:Rt;function Mg(t){t.min=Ig(t.min),t.max=Ig(t.max)}function q5(t){Mg(t.x),Mg(t.y)}function I_(t,e,n){return t==="position"||t==="preserve-aspect"&&!y5(_g(e),_g(n),.2)}function Y5(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const J5=O_({attachResizeListener:(t,e)=>Di(t,"resize",e),measureScroll:()=>{var t,e;return{x:document.documentElement.scrollLeft||((t=document.body)==null?void 0:t.scrollLeft)||0,y:document.documentElement.scrollTop||((e=document.body)==null?void 0:e.scrollTop)||0}},checkIsScrollRoot:()=>!0}),Rc={current:void 0},M_=O_({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Rc.current){const t=new J5({});t.mount(window),t.setOptions({layoutScroll:!0}),Rc.current=t}return Rc.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Rl=x.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function Dg(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function X5(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Dg(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Dg(t[s],null)}}}}function Q5(...t){return x.useCallback(X5(...t),t)}class Z5 extends x.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent&&this.props.pop!==!1){const r=n.offsetParent,s=nd(r)&&r.offsetWidth||0,i=nd(r)&&r.offsetHeight||0,o=this.props.sizeRef.current;o.height=n.offsetHeight||0,o.width=n.offsetWidth||0,o.top=n.offsetTop,o.left=n.offsetLeft,o.right=s-o.width-o.left,o.bottom=i-o.height-o.top}return null}componentDidUpdate(){}render(){return this.props.children}}function e3({children:t,isPresent:e,anchorX:n,anchorY:r,root:s,pop:i}){var f;const o=x.useId(),a=x.useRef(null),l=x.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:c}=x.useContext(Rl),u=((f=t.props)==null?void 0:f.ref)??(t==null?void 0:t.ref),h=Q5(a,u);return x.useInsertionEffect(()=>{const{width:p,height:m,top:y,left:v,right:S,bottom:E}=l.current;if(e||i===!1||!a.current||!p||!m)return;const k=n==="left"?`left: ${v}`:`right: ${S}`,g=r==="bottom"?`bottom: ${E}`:`top: ${y}`;a.current.dataset.motionPopId=o;const w=document.createElement("style");c&&(w.nonce=c);const _=s??document.head;return _.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${m}px !important;
            ${k}px !important;
            ${g}px !important;
          }
        `),()=>{_.contains(w)&&_.removeChild(w)}},[e]),d.jsx(Z5,{isPresent:e,childRef:a,sizeRef:l,pop:i,children:i===!1?t:x.cloneElement(t,{ref:h})})}const t3=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o,anchorX:a,anchorY:l,root:c})=>{const u=Tr(n3),h=x.useId();let f=!0,p=x.useMemo(()=>(f=!1,{id:h,initial:e,isPresent:n,custom:s,onExitComplete:m=>{u.set(m,!0);for(const y of u.values())if(!y)return;r&&r()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[n,u,r]);return i&&f&&(p={...p}),x.useMemo(()=>{u.forEach((m,y)=>u.set(y,!1))},[n]),x.useEffect(()=>{!n&&!u.size&&r&&r()},[n]),t=d.jsx(e3,{pop:o==="popLayout",isPresent:n,anchorX:a,anchorY:l,root:c,children:t}),d.jsx(jl.Provider,{value:p,children:t})};function n3(){return new Map}function D_(t=!0){const e=x.useContext(jl);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,i=x.useId();x.useEffect(()=>{if(t)return s(i)},[t]);const o=x.useCallback(()=>t&&r&&r(i),[i,r,t]);return!n&&r?[!1,o]:[!0]}const Oo=t=>t.key||"";function Lg(t){const e=[];return x.Children.forEach(t,n=>{x.isValidElement(n)&&e.push(n)}),e}const ad=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:o=!1,anchorX:a="left",anchorY:l="top",root:c})=>{const[u,h]=D_(o),f=x.useMemo(()=>Lg(t),[t]),p=o&&!u?[]:f.map(Oo),m=x.useRef(!0),y=x.useRef(f),v=Tr(()=>new Map),S=x.useRef(new Set),[E,k]=x.useState(f),[g,w]=x.useState(f);Dh(()=>{m.current=!1,y.current=f;for(let b=0;b<g.length;b++){const C=Oo(g[b]);p.includes(C)?(v.delete(C),S.current.delete(C)):v.get(C)!==!0&&v.set(C,!1)}},[g,p.length,p.join("-")]);const _=[];if(f!==E){let b=[...f];for(let C=0;C<g.length;C++){const A=g[C],N=Oo(A);p.includes(N)||(b.splice(C,0,A),_.push(A))}return i==="wait"&&_.length&&(b=_),w(Lg(b)),k(f),null}const{forceRender:P}=x.useContext(Mh);return d.jsx(d.Fragment,{children:g.map(b=>{const C=Oo(b),A=o&&!u?!1:f===g||p.includes(C),N=()=>{if(S.current.has(C))return;if(S.current.add(C),v.has(C))v.set(C,!0);else return;let O=!0;v.forEach(I=>{I||(O=!1)}),O&&(P==null||P(),w(y.current),o&&(h==null||h()),r&&r())};return d.jsx(t3,{isPresent:A,initial:!m.current||n?void 0:!1,custom:e,presenceAffectsLayout:s,mode:i,root:c,onExitComplete:A?void 0:N,anchorX:a,anchorY:l,children:b},C)})})},L_=x.createContext({strict:!1}),$g={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let Fg=!1;function r3(){if(Fg)return;const t={};for(const e in $g)t[e]={isEnabled:n=>$g[e].some(r=>!!n[r])};h_(t),Fg=!0}function $_(){return r3(),W$()}function s3(t){const e=$_();for(const n in t)e[n]={...e[n],...t[n]};h_(e)}const i3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function qa(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||i3.has(t)}let F_=t=>!qa(t);function o3(t){typeof t=="function"&&(F_=e=>e.startsWith("on")?!qa(e):t(e))}try{o3(require("@emotion/is-prop-valid").default)}catch{}function a3(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(F_(s)||n===!0&&qa(s)||!e&&!qa(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}const Ol=x.createContext({});function l3(t,e){if(Tl(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Mi(n)?n:void 0,animate:Mi(r)?r:void 0}}return t.inherit!==!1?e:{}}function c3(t){const{initial:e,animate:n}=l3(t,x.useContext(Ol));return x.useMemo(()=>({initial:e,animate:n}),[Ug(e),Ug(n)])}function Ug(t){return Array.isArray(t)?t.join(" "):t}const df=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function U_(t,e,n){for(const r in e)!Ze(e[r])&&!b_(r,n)&&(t[r]=e[r])}function u3({transformTemplate:t},e){return x.useMemo(()=>{const n=df();return cf(n,e,t),Object.assign({},n.vars,n.style)},[e])}function d3(t,e){const n=t.style||{},r={};return U_(r,n,t),Object.assign(r,u3(t,e)),r}function h3(t,e){const n={},r=d3(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const B_=()=>({...df(),attrs:{}});function f3(t,e,n,r){const s=x.useMemo(()=>{const i=B_();return w_(i,e,S_(r),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};U_(i,t.style,t),s.style={...i,...s.style}}return s}const p3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function hf(t){return typeof t!="string"||t.includes("-")?!1:!!(p3.indexOf(t)>-1||/[A-Z]/u.test(t))}function m3(t,e,n,{latestValues:r},s,i=!1,o){const l=(o??hf(t)?f3:h3)(e,r,s,t),c=a3(e,typeof t=="string",i),u=t!==x.Fragment?{...c,...l,ref:n}:{},{children:h}=e,f=x.useMemo(()=>Ze(h)?h.get():h,[h]);return x.createElement(t,{...u,children:f})}function g3({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,s){return{latestValues:y3(n,r,s,t),renderState:e()}}function y3(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=ia(i[f]);let{initial:o,animate:a}=t;const l=Tl(t),c=u_(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;if(h&&typeof h!="boolean"&&!Nl(h)){const f=Array.isArray(h)?h:[h];for(let p=0;p<f.length;p++){const m=ef(t,f[p]);if(m){const{transitionEnd:y,transition:v,...S}=m;for(const E in S){let k=S[E];if(Array.isArray(k)){const g=u?k.length-1:0;k=k[g]}k!==null&&(s[E]=k)}for(const E in y)s[E]=y[E]}}}return s}const V_=t=>(e,n)=>{const r=x.useContext(Ol),s=x.useContext(jl),i=()=>g3(t,e,r,s);return n?i():Tr(i)},x3=V_({scrapeMotionValuesFromProps:uf,createRenderState:df}),b3=V_({scrapeMotionValuesFromProps:__,createRenderState:B_}),w3=Symbol.for("motionComponentSymbol");function v3(t,e,n){const r=x.useRef(n);x.useInsertionEffect(()=>{r.current=n});const s=x.useRef(null);return x.useCallback(i=>{var a;i&&((a=t.onMount)==null||a.call(t,i)),e&&(i?e.mount(i):e.unmount());const o=r.current;if(typeof o=="function")if(i){const l=o(i);typeof l=="function"&&(s.current=l)}else s.current?(s.current(),s.current=null):o(i);else o&&(o.current=i)},[e])}const W_=x.createContext({});function ts(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function S3(t,e,n,r,s,i){var k,g;const{visualElement:o}=x.useContext(Ol),a=x.useContext(L_),l=x.useContext(jl),c=x.useContext(Rl),u=c.reducedMotion,h=c.skipAnimations,f=x.useRef(null),p=x.useRef(!1);r=r||a.renderer,!f.current&&r&&(f.current=r(t,{visualState:e,parent:o,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:u,skipAnimations:h,isSVG:i}),p.current&&f.current&&(f.current.manuallyAnimateOnMount=!0));const m=f.current,y=x.useContext(W_);m&&!m.projection&&s&&(m.type==="html"||m.type==="svg")&&_3(f.current,n,s,y);const v=x.useRef(!1);x.useInsertionEffect(()=>{m&&v.current&&m.update(n,l)});const S=n[XS],E=x.useRef(!!S&&!((k=window.MotionHandoffIsComplete)!=null&&k.call(window,S))&&((g=window.MotionHasOptimisedAnimation)==null?void 0:g.call(window,S)));return Dh(()=>{p.current=!0,m&&(v.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),E.current&&m.animationState&&m.animationState.animateChanges())}),x.useEffect(()=>{m&&(!E.current&&m.animationState&&m.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,S)}),E.current=!1),m.enteringChildren=void 0)}),m}function _3(t,e,n,r){const{layoutId:s,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:z_(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||a&&ts(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function z_(t){if(t)return t.options.allowProjection!==!1?t.projection:z_(t.parent)}function Oc(t,{forwardMotionProps:e=!1,type:n}={},r,s){r&&s3(r);const i=n?n==="svg":hf(t),o=i?b3:x3;function a(c,u){let h;const f={...x.useContext(Rl),...c,layoutId:k3(c)},{isStatic:p}=f,m=c3(c),y=o(c,p);if(!p&&dS){C3();const v=E3(f);h=v.MeasureLayout,m.visualElement=S3(t,y,f,s,v.ProjectionNode,i)}return d.jsxs(Ol.Provider,{value:m,children:[h&&m.visualElement?d.jsx(h,{visualElement:m.visualElement,...f}):null,m3(t,c,v3(y,m.visualElement,u),y,p,e,i)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const l=x.forwardRef(a);return l[w3]=t,l}function k3({layoutId:t}){const e=x.useContext(Mh).id;return e&&t!==void 0?e+"-"+t:t}function C3(t,e){x.useContext(L_).strict}function E3(t){const e=$_(),{drag:n,layout:r}=e;if(!n&&!r)return{};const s={...n,...r};return{MeasureLayout:n!=null&&n.isEnabled(t)||r!=null&&r.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function P3(t,e){if(typeof Proxy>"u")return Oc;const n=new Map,r=(i,o)=>Oc(i,o,t,e),s=(i,o)=>r(i,o);return new Proxy(s,{get:(i,o)=>o==="create"?r:(n.has(o)||n.set(o,Oc(o,void 0,t,e)),n.get(o))})}const A3=(t,e)=>e.isSVG??hf(t)?new o5(e):new e5(e,{allowProjection:t!==x.Fragment});class j3 extends Qn{constructor(e){super(e),e.animationState||(e.animationState=d5(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Nl(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let N3=0;class T3 extends Qn{constructor(){super(...arguments),this.id=N3++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const R3={animation:{Feature:j3},exit:{Feature:T3}};function Qi(t){return{point:{x:t.pageX,y:t.pageY}}}const O3=t=>e=>sf(e)&&t(e,Qi(e));function gi(t,e,n,r){return Di(t,e,O3(n),r)}const H_=({current:t})=>t?t.ownerDocument.defaultView:null,Bg=(t,e)=>Math.abs(t-e);function I3(t,e){const n=Bg(t.x,e.x),r=Bg(t.y,e.y);return Math.sqrt(n**2+r**2)}const Vg=new Set(["auto","scroll"]);class K_{constructor(e,n,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3,element:a}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=p=>{this.handleScroll(p.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Mc(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=I3(p.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!y)return;const{point:v}=p,{timestamp:S}=Xe;this.history.push({...v,timestamp:S});const{onStart:E,onMove:k}=this.handlers;m||(E&&E(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,p)},this.handlePointerMove=(p,m)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=Ic(m,this.transformPagePoint),ke.update(this.updatePoint,!0)},this.handlePointerUp=(p,m)=>{this.end();const{onEnd:y,onSessionEnd:v,resumeAnimation:S}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=Mc(p.type==="pointercancel"?this.lastMoveEventInfo:Ic(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(p,E),v&&v(p,E)},!sf(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=s||window;const l=Qi(e),c=Ic(l,this.transformPagePoint),{point:u}=c,{timestamp:h}=Xe;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=n;f&&f(e,Mc(c,this.history)),this.removeListeners=Yi(gi(this.contextWindow,"pointermove",this.handlePointerMove),gi(this.contextWindow,"pointerup",this.handlePointerUp),gi(this.contextWindow,"pointercancel",this.handlePointerUp)),a&&this.startScrollTracking(a)}startScrollTracking(e){let n=e.parentElement;for(;n;){const r=getComputedStyle(n);(Vg.has(r.overflowX)||Vg.has(r.overflowY))&&this.scrollPositions.set(n,{x:n.scrollLeft,y:n.scrollTop}),n=n.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const n=this.scrollPositions.get(e);if(!n)return;const r=e===window,s=r?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},i={x:s.x-n.x,y:s.y-n.y};i.x===0&&i.y===0||(r?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=i.x,this.lastMoveEventInfo.point.y+=i.y):this.history.length>0&&(this.history[0].x-=i.x,this.history[0].y-=i.y),this.scrollPositions.set(e,s),ke.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),_n(this.updatePoint)}}function Ic(t,e){return e?{point:e(t.point)}:t}function Wg(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Mc({point:t},e){return{point:t,delta:Wg(t,G_(e)),offset:Wg(t,M3(e)),velocity:D3(e,.1)}}function M3(t){return t[0]}function G_(t){return t[t.length-1]}function D3(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=G_(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>Vt(e)));)n--;if(!r)return{x:0,y:0};r===t[0]&&t.length>2&&s.timestamp-r.timestamp>Vt(e)*2&&(r=t[1]);const i=Nt(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function L3(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Ne(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Ne(n,t,r.max):Math.min(t,n)),t}function zg(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function $3(t,{top:e,left:n,bottom:r,right:s}){return{x:zg(t.x,n,s),y:zg(t.y,e,r)}}function Hg(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function F3(t,e){return{x:Hg(t.x,e.x),y:Hg(t.y,e.y)}}function U3(t,e){let n=.5;const r=ut(t),s=ut(e);return s>r?n=Ri(e.min,e.max-r,t.min):r>s&&(n=Ri(t.min,t.max-s,e.min)),cn(0,1,n)}function B3(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const ld=.35;function V3(t=ld){return t===!1?t=0:t===!0&&(t=ld),{x:Kg(t,"left","right"),y:Kg(t,"top","bottom")}}function Kg(t,e,n){return{min:Gg(t,e),max:Gg(t,n)}}function Gg(t,e){return typeof t=="number"?t:t[e]||0}const W3=new WeakMap;class z3{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=We(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=h=>{n&&this.snapToCursor(Qi(h).point),this.stopAnimation()},o=(h,f)=>{const{drag:p,dragPropagation:m,onDragStart:y}=this.getProps();if(p&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=x$(p),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Yt(S=>{let E=this.getAxisMotionValue(S).get()||0;if(sn.test(E)){const{projection:k}=this.visualElement;if(k&&k.layout){const g=k.layout.layoutBox[S];g&&(E=ut(g)*(parseFloat(E)/100))}}this.originPoint[S]=E}),y&&ke.update(()=>y(h,f),!1,!0),Zu(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f;const{dragPropagation:p,dragDirectionLock:m,onDirectionLock:y,onDrag:v}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:S}=f;if(m&&this.currentDirection===null){this.currentDirection=K3(S),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",f.point,S),this.updateAxis("y",f.point,S),this.visualElement.render(),v&&ke.update(()=>v(h,f),!1,!0)},l=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f,this.stop(h,f),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>{const{dragSnapToOrigin:h}=this.getProps();(h||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:u}=this.getProps();this.panSession=new K_(e,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:H_(this.visualElement),element:this.visualElement.current})}stop(e,n){const r=e||this.latestPointerEvent,s=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!r)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&ke.postRender(()=>a(r,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Io(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=L3(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;e&&ts(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=$3(r.layoutBox,e):this.constraints=!1,this.elastic=V3(n),s!==this.constraints&&!ts(e)&&r&&this.constraints&&!this.hasMutatedConstraints&&Yt(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=B3(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!ts(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=q$(r,s.root,this.visualElement.getTransformPagePoint());let o=F3(s.layout.layoutBox,i);if(n){const a=n(H$(o));this.hasMutatedConstraints=!!a,a&&(o=p_(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Yt(u=>{if(!Io(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const f=s?200:1e6,p=s?40:1e7,m={type:"inertia",velocity:r?e[u]:0,bounceStiffness:f,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,m)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return Zu(this.visualElement,e),r.start(Zh(e,r,0,n,this.visualElement,!1))}stopAnimation(){Yt(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Yt(n=>{const{drag:r}=this.getProps();if(!Io(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[n],l=i.get()||0;i.set(e[n]-Ne(o,a,.5)+l)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!ts(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Yt(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();s[o]=U3({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.constraints=!1,this.resolveConstraints(),Yt(o=>{if(!Io(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Ne(l,c,s[o]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;W3.set(this.visualElement,this);const e=this.visualElement.current,n=gi(e,"pointerdown",c=>{const{drag:u,dragListener:h=!0}=this.getProps(),f=c.target,p=f!==e&&k$(f);u&&h&&!p&&this.start(c)});let r;const s=()=>{const{dragConstraints:c}=this.getProps();ts(c)&&c.current&&(this.constraints=this.resolveRefConstraints(),r||(r=H3(e,c.current,()=>this.scalePositionWithinConstraints())))},{projection:i}=this.visualElement,o=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),ke.read(s);const a=Di(window,"resize",()=>this.scalePositionWithinConstraints()),l=i.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Yt(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=c[h].translate,f.set(f.get()+c[h].translate))}),this.visualElement.render())}));return()=>{a(),n(),o(),l&&l(),r&&r()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=ld,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function qg(t){let e=!0;return()=>{if(e){e=!1;return}t()}}function H3(t,e,n){const r=tg(t,qg(n)),s=tg(e,qg(n));return()=>{r(),s()}}function Io(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function K3(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class G3 extends Qn{constructor(e){super(e),this.removeGroupControls=Rt,this.removeListeners=Rt,this.controls=new z3(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Rt}update(){const{dragControls:e}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};e!==n&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const Dc=t=>(e,n)=>{t&&ke.update(()=>t(e,n),!1,!0)};class q3 extends Qn{constructor(){super(...arguments),this.removePointerDownListener=Rt}onPointerDown(e){this.session=new K_(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:H_(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:Dc(e),onStart:Dc(n),onMove:Dc(r),onEnd:(i,o)=>{delete this.session,s&&ke.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=gi(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let Lc=!1;class Y3 extends x.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),Lc&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),oa.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:o}=r;return o&&(o.isPresent=i,e.layoutDependency!==n&&o.setOptions({...o.options,layoutDependency:n}),Lc=!0,s||e.layoutDependency!==n||n===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||ke.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),rf.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;Lc=!0,s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function q_(t){const[e,n]=D_(),r=x.useContext(Mh);return d.jsx(Y3,{...t,layoutGroup:r,switchLayoutGroup:x.useContext(W_),isPresent:e,safeToRemove:n})}const J3={pan:{Feature:q3},drag:{Feature:G3,ProjectionNode:M_,MeasureLayout:q_}};function Yg(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ke.postRender(()=>i(e,Qi(e)))}class X3 extends Qn{mount(){const{current:e}=this.node;e&&(this.unmount=w$(e,(n,r)=>(Yg(this.node,r,"Start"),s=>Yg(this.node,s,"End"))))}unmount(){}}class Q3 extends Qn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Yi(Di(this.node.current,"focus",()=>this.onFocus()),Di(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Jg(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ke.postRender(()=>i(e,Qi(e)))}class Z3 extends Qn{mount(){const{current:e}=this.node;if(!e)return;const{globalTapTarget:n,propagate:r}=this.node.props;this.unmount=E$(e,(s,i)=>(Jg(this.node,i,"Start"),(o,{success:a})=>Jg(this.node,o,a?"End":"Cancel")),{useGlobalTarget:n,stopPropagation:(r==null?void 0:r.tap)===!1})}unmount(){}}const cd=new WeakMap,$c=new WeakMap,e4=t=>{const e=cd.get(t.target);e&&e(t)},t4=t=>{t.forEach(e4)};function n4({root:t,...e}){const n=t||document;$c.has(n)||$c.set(n,{});const r=$c.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(t4,{root:t,...e})),r[s]}function r4(t,e,n){const r=n4(e);return cd.set(t,n),r.observe(t),()=>{cd.delete(t),r.unobserve(t)}}const s4={some:0,all:1};class i4 extends Qn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:s4[s]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=c?u:h;f&&f(l)};return r4(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(o4(e,n))&&this.startObserver()}unmount(){}}function o4({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const a4={inView:{Feature:i4},tap:{Feature:Z3},focus:{Feature:Q3},hover:{Feature:X3}},l4={layout:{ProjectionNode:M_,MeasureLayout:q_}},c4={...R3,...a4,...J3,...l4},qn=P3(c4,A3);function Y_(t){const e=Tr(()=>Ar(t)),{isStatic:n}=x.useContext(Rl);if(n){const[,r]=x.useState(t);x.useEffect(()=>e.on("change",r),[])}return e}function J_(t,e){const n=Y_(e()),r=()=>n.set(e());return r(),Dh(()=>{const s=()=>ke.preRender(r,!1,!0),i=t.map(o=>o.on("change",s));return()=>{i.forEach(o=>o()),_n(r)}}),n}function u4(t){pi.current=[],t();const e=J_(pi.current,t);return pi.current=void 0,e}function d4(t,e,n,r){if(typeof t=="function")return u4(t);const i=typeof e=="function"?e:D$(e,n,r),o=Array.isArray(t)?Xg(t,i):Xg([t],([l])=>i(l)),a=Array.isArray(t)?void 0:t.accelerate;return a&&!a.isTransformed&&typeof e!="function"&&Array.isArray(n)&&(r==null?void 0:r.clamp)!==!1&&(o.accelerate={...a,times:e,keyframes:n,isTransformed:!0}),o}function Xg(t,e){const n=Tr(()=>[]);return J_(t,()=>{n.length=0;const r=t.length;for(let s=0;s<r;s++)n[s]=t[s].get();return e(n)})}const X_=x.createContext(null);function h4(t,e,n,r){if(!r)return t;const s=t.findIndex(u=>u.value===e);if(s===-1)return t;const i=r>0?1:-1,o=t[s+i];if(!o)return t;const a=t[s],l=o.layout,c=Ne(l.min,l.max,.5);return i===1&&a.layout.max+n>c||i===-1&&a.layout.min+n<c?gD(t,s,s+i):t}function f4({children:t,as:e="ul",axis:n="y",onReorder:r,values:s,...i},o){const a=Tr(()=>qn[e]),l=[],c=x.useRef(!1),u=x.useRef(null),h={axis:n,groupRef:u,registerItem:(m,y)=>{const v=l.findIndex(S=>m===S.value);v!==-1?l[v].layout=y[n]:l.push({value:m,layout:y[n]}),l.sort(g4)},updateOrder:(m,y,v)=>{if(c.current)return;const S=h4(l,m,y,v);l!==S&&(c.current=!0,r(S.map(m4).filter(E=>s.indexOf(E)!==-1)))}};x.useEffect(()=>{c.current=!1});const f=m=>{u.current=m,typeof o=="function"?o(m):o&&(o.current=m)},p={overflowAnchor:"none",...i.style};return d.jsx(a,{...i,style:p,ref:f,ignoreStrict:!0,children:d.jsx(X_.Provider,{value:h,children:t})})}const p4=x.forwardRef(f4);function m4(t){return t.value}function g4(t,e){return t.layout.min-e.layout.min}const Mo=50,Qg=25,y4=new Set(["auto","scroll"]),yi=new WeakMap,xi=new WeakMap;let ri=null;function x4(){if(ri){const t=ud(ri,"y");t&&(xi.delete(t),yi.delete(t));const e=ud(ri,"x");e&&e!==t&&(xi.delete(e),yi.delete(e)),ri=null}}function b4(t,e){const n=getComputedStyle(t),r=e==="x"?n.overflowX:n.overflowY,s=t===document.body||t===document.documentElement;return y4.has(r)||s}function ud(t,e){let n=t==null?void 0:t.parentElement;for(;n;){if(b4(n,e))return n;n=n.parentElement}return null}function w4(t,e,n){const r=e.getBoundingClientRect(),s=n==="x"?Math.max(0,r.left):Math.max(0,r.top),i=n==="x"?Math.min(window.innerWidth,r.right):Math.min(window.innerHeight,r.bottom),o=t-s,a=i-t;if(o<Mo){const l=1-o/Mo;return{amount:-Qg*l*l,edge:"start"}}else if(a<Mo){const l=1-a/Mo;return{amount:Qg*l*l,edge:"end"}}return{amount:0,edge:null}}function v4(t,e,n,r){if(!t)return;ri=t;const s=ud(t,n);if(!s)return;const i=e-(n==="x"?window.scrollX:window.scrollY),{amount:o,edge:a}=w4(i,s,n);if(a===null){xi.delete(s),yi.delete(s);return}const l=xi.get(s),c=s===document.body||s===document.documentElement;if(l!==a){if(!(a==="start"&&r<0||a==="end"&&r>0))return;xi.set(s,a);const h=n==="x"?s.scrollWidth-(c?window.innerWidth:s.clientWidth):s.scrollHeight-(c?window.innerHeight:s.clientHeight);yi.set(s,h)}if(o>0){const u=yi.get(s);if((n==="x"?c?window.scrollX:s.scrollLeft:c?window.scrollY:s.scrollTop)>=u)return}n==="x"?c?window.scrollBy({left:o}):s.scrollLeft+=o:c?window.scrollBy({top:o}):s.scrollTop+=o}function Zg(t,e=0){return Ze(t)?t:Y_(e)}function S4({children:t,style:e={},value:n,as:r="li",onDrag:s,onDragEnd:i,layout:o=!0,...a},l){const c=Tr(()=>qn[r]),u=x.useContext(X_),h={x:Zg(e.x),y:Zg(e.y)},f=d4([h.x,h.y],([S,E])=>S||E?1:"unset"),{axis:p,registerItem:m,updateOrder:y,groupRef:v}=u;return d.jsx(c,{drag:p,...a,dragSnapToOrigin:!0,style:{...e,x:h.x,y:h.y,zIndex:f},layout:o,onDrag:(S,E)=>{const{velocity:k,point:g}=E,w=h[p].get();y(n,w,k[p]),v4(v.current,g[p],p,k[p]),s&&s(S,E)},onDragEnd:(S,E)=>{x4(),i&&i(S,E)},onLayoutMeasure:S=>{m(n,S)},ref:l,ignoreStrict:!0,children:t})}const _4=x.forwardRef(S4),k4={Happy:"text-yellow-400",Excited:"text-purple-400",Energetic:"text-orange-400",Grateful:"text-pink-400",Inspired:"text-indigo-400",Calm:"text-green-400",Stressed:"text-gray-400",Sad:"text-blue-400",Anxious:"text-slate-400",Angry:"text-red-400",Tired:"text-stone-400",Neutral:"text-zinc-400"};function C4({photo:t,label:e,onClick:n}){return d.jsxs("div",{className:"relative group cursor-pointer",onClick:n,children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gray-900 rounded shadow-2xl z-0 transform -rotate-2 translate-x-2 translate-y-2"}),d.jsx(qn.div,{animate:{rotate:360},transition:{duration:10,repeat:1/0,ease:"linear"},className:"relative w-64 h-64 md:w-80 md:h-80 rounded-full bg-black shadow-2xl p-8 mx-auto z-10 border-4 border-gray-800",style:{backgroundImage:`repeating-radial-gradient(
            #111 0, 
            #111 2px, 
            #222 3px, 
            #222 4px
          )`},children:d.jsxs("div",{className:"w-full h-full rounded-full overflow-hidden border-4 border-gray-900 relative",children:[d.jsx(Ot,{src:t,className:"w-full h-full object-cover"}),d.jsx("div",{className:"absolute top-1/2 left-1/2 w-4 h-4 bg-white rounded-full -translate-x-1/2 -translate-y-1/2 border-2 border-gray-300 z-20"})]})}),d.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx("div",{className:"bg-white/20 backdrop-blur-md p-4 rounded-full",children:d.jsx(L0,{className:"w-8 h-8 text-white fill-current"})})}),d.jsx("div",{className:"absolute -bottom-12 left-0 right-0 text-center",children:d.jsx("p",{className:"font-mono text-sm tracking-widest text-gray-500 uppercase",children:e})})]})}function E4({entries:t}){const{t:e}=Pe(),n=t.slice(0,5);return d.jsxs("div",{className:"bg-black/20 backdrop-blur-md rounded-3xl p-6 border border-white/5",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-6 text-white/50",children:[d.jsx(z1,{className:"w-4 h-4"}),d.jsx("span",{className:"text-xs font-mono uppercase tracking-widest",children:"Side B  Tracklist"})]}),d.jsx("div",{className:"space-y-1",children:n.map((r,s)=>{const i=new Date(r.date);return d.jsxs(qn.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:s*.1},className:"group flex items-center gap-4 p-3 rounded-xl hover:bg-white/5 transition-colors cursor-default",children:[d.jsx("span",{className:"font-mono text-xs text-zinc-600 w-6",children:(s+1).toString().padStart(2,"0")}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-zinc-200 truncate group-hover:text-white transition-colors",children:r.caption||e("common.untitled")}),d.jsxs("div",{className:"text-xs text-zinc-500 truncate flex items-center gap-2",children:[d.jsx("span",{children:xe(i,"MMM d")}),d.jsx("span",{children:""}),d.jsx("span",{children:typeof r.location=="object"?r.location.name||"Unknown":r.location||"Unknown"})]})]}),d.jsx("div",{className:`text-xs ${k4[r.mood]||"text-zinc-500"}`,children:e(`moods.${r.mood.toLowerCase()}`)})]},r.id)})})]})}function P4({entry:t}){return t?d.jsxs("div",{className:"bg-black/20 backdrop-blur-md rounded-3xl p-8 border border-white/5 relative overflow-hidden flex flex-col justify-center min-h-[300px]",children:[d.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:d.jsx(Sf,{className:"w-32 h-32"})}),d.jsxs("div",{className:"relative z-10",children:[d.jsx(Sf,{className:"w-8 h-8 text-white/20 mb-4"}),d.jsxs("p",{className:"text-2xl md:text-3xl font-serif text-white/90 leading-relaxed italic",children:['"',t.caption,'"']}),d.jsxs("div",{className:"mt-6 flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-zinc-700",children:d.jsx(Ot,{src:t.photo,className:"w-full h-full object-cover"})}),d.jsxs("div",{className:"text-xs font-mono text-zinc-500",children:["Recorded on ",xe(new Date(t.date),"MMMM d")]})]})]})]}):null}function A4({entries:t}){const{t:e}=Pe(),[n,r]=x.useState(!1),s=x.useMemo(()=>xe(new Date,"MMMM"),[]),i=x.useMemo(()=>t[0],[t]);if(!t.length)return d.jsxs("div",{className:"text-center py-20 text-gray-400",children:[d.jsx(R0,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),d.jsx("p",{children:e("insights.noData")})]});const a={Happy:"from-yellow-900/50 to-orange-900/50",Excited:"from-purple-900/50 to-pink-900/50",Energetic:"from-orange-900/50 to-red-900/50",Grateful:"from-pink-900/50 to-rose-900/50",Inspired:"from-indigo-900/50 to-blue-900/50",Calm:"from-green-900/50 to-emerald-900/50",Stressed:"from-gray-900/50 to-slate-900/50",Sad:"from-blue-900/50 to-cyan-900/50",Anxious:"from-slate-900/50 to-gray-900/50",Angry:"from-red-900/50 to-orange-900/50",Tired:"from-stone-900/50 to-zinc-900/50",Neutral:"from-zinc-900/50 to-stone-900/50"}[i==null?void 0:i.mood]||"from-zinc-900 to-black";return d.jsxs("div",{className:`pb-32 space-y-8 animate-in fade-in duration-700 min-h-screen bg-gradient-to-b ${a} p-8`,children:[d.jsxs("div",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8 items-start",children:[d.jsxs("div",{className:"lg:col-span-7 flex flex-col items-center justify-center space-y-8 py-20 relative overflow-hidden rounded-[3rem] bg-black/40 backdrop-blur-xl border border-white/5 min-h-[600px]",children:[d.jsxs("div",{className:"absolute inset-0 z-0",children:[d.jsx(Ot,{src:(i==null?void 0:i.photo)||"",className:"w-full h-full object-cover opacity-30 blur-3xl scale-150 animate-pulse-slow"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/60"})]}),d.jsxs("div",{className:"text-center space-y-2 z-10 relative",children:[d.jsxs("h2",{className:"text-5xl font-black tracking-tighter uppercase italic text-white drop-shadow-2xl",children:[s," ",d.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-pink-500",children:"Mixtape"})]}),d.jsxs("p",{className:"text-sm font-mono text-white/60 tracking-[0.3em] uppercase",children:["SIDE A  ",new Date().getFullYear()]})]}),d.jsx("div",{className:"scale-110 transform transition-transform hover:scale-115 duration-500",children:d.jsx(C4,{photo:(i==null?void 0:i.photo)||"https://images.unsplash.com/photo-1614613535308-eb5fbd3d2c17?q=80&w=1000",label:"TAP TO PLAY STORY",onClick:()=>r(!0)})})]}),d.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[d.jsx("div",{className:"h-[320px]",children:d.jsx(P4,{entry:t.find(l=>l.caption&&l.caption.length>10)||t[0]})}),d.jsx(E4,{entries:t})]})]}),d.jsx(ad,{children:n&&d.jsxs(qn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black flex items-center justify-center p-4",children:[d.jsx("button",{onClick:()=>r(!1),className:"absolute top-6 right-6 text-white/50 hover:text-white p-2 z-50",children:d.jsx(Ct,{className:"w-8 h-8"})}),d.jsxs(qn.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"max-w-lg w-full aspect-[9/16] bg-zinc-900 rounded-[2rem] overflow-hidden relative shadow-2xl border border-white/10",children:[d.jsx(Ot,{src:(i==null?void 0:i.photo)||"",className:"w-full h-full object-cover"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/30 via-transparent to-black/90"}),d.jsx("div",{className:"absolute top-8 left-0 right-0 text-center",children:d.jsx("span",{className:"bg-white/20 backdrop-blur-md text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-widest border border-white/10",children:"Monthly Highlight"})}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 text-white",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 backdrop-blur-md flex items-center justify-center border border-white/20",children:d.jsx(W1,{className:"w-5 h-5 animate-spin-slow"})}),d.jsxs("div",{children:[d.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Now Playing"}),d.jsxs("div",{className:"text-sm font-bold",children:[e(`moods.${i==null?void 0:i.mood.toLowerCase()}`)," Vibes"]})]})]}),d.jsxs("h2",{className:"text-2xl font-serif font-bold leading-tight mb-4 line-clamp-3",children:['"',(i==null?void 0:i.caption)||"A moment frozen in time.",'"']}),d.jsxs("div",{className:"flex items-center justify-between border-t border-white/10 pt-4 mt-4",children:[d.jsx("div",{className:"font-mono text-xs text-gray-400",children:xe(new Date((i==null?void 0:i.date)||Date.now()),"yyyy.MM.dd")}),d.jsx("div",{className:"font-mono text-xs text-gray-400",children:typeof(i==null?void 0:i.location)=="object"?i.location.name||"Unknown":(i==null?void 0:i.location)||"Unknown Location"})]})]})]})]})})]})}function j4({entries:t}){const{t:e}=Pe(),[n,r]=x.useState(null),s=[{id:"photo_beginner",titleKey:"milestones.photo.beginner",descKey:"milestones.photo.beginnerDesc",icon:ws,target:5,tags:["photography","photo","camera","shoot","snapshot","picture","image","moment","selfie","portrait","landscape","","","","","","","","","","","","","","","","","","","","","","","",""],category:"skill",color:"text-blue-500 bg-blue-100 dark:bg-blue-900/30"},{id:"photo_master",titleKey:"milestones.photo.master",descKey:"milestones.photo.masterDesc",icon:Vc,target:50,tags:["photography","photo","camera","shoot","snapshot","picture","image","moment","selfie","portrait","landscape","art","gallery","studio","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],category:"skill",color:"text-purple-500 bg-purple-100 dark:bg-purple-900/30"},{id:"fitness_start",titleKey:"milestones.fitness.start",descKey:"milestones.fitness.startDesc",icon:H1,target:10,tags:["fitness","gym","workout","run","sport","yoga","swim","hike","exercise","training","cardio","muscle","health","walk","jogging","pilates","cycling","dance","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],category:"health",color:"text-green-500 bg-green-100 dark:bg-green-900/30"},{id:"reading_worm",titleKey:"milestones.reading.worm",descKey:"milestones.reading.wormDesc",icon:K1,target:12,tags:["book","reading","study","novel","literature","library","learning","knowledge","education","school","class","lesson","paper","article","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],category:"skill",color:"text-amber-500 bg-amber-100 dark:bg-amber-900/30"}],i=(h,f)=>{var y,v;if((((y=h.tags)==null?void 0:y.map(S=>S.toLowerCase()))||[]).some(S=>f.tags.includes(S)))return!0;const m=((v=h.caption)==null?void 0:v.toLowerCase())||"";return!!f.tags.some(S=>m.includes(S))},o=x.useMemo(()=>s.map(h=>{const f=t.filter(m=>i(m,h)),p=f.length;return{...h,current:p,progress:Math.min(100,p/h.target*100),completed:p>=h.target,entries:f}}),[t]),a=o.filter(h=>h.completed).length,l=o.reduce((h,f)=>h+f.progress,0)/s.length,c=n?o.find(h=>h.id===n.id):null,u=x.useMemo(()=>{if(!c)return[];const h=[...c.entries].sort((p,m)=>new Date(m.date).getTime()-new Date(p.date).getTime()),f=[];return h.forEach(p=>{const m=xe(new Date(p.date),"yyyy-MM-dd"),y=f[f.length-1];y&&y.date===m?y.entries.push(p):f.push({date:m,entries:[p]})}),f},[c]);return d.jsxs("div",{className:"max-w-5xl mx-auto pb-20",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"p-4 bg-gradient-to-br from-yellow-100 to-amber-100 dark:from-yellow-900/30 dark:to-amber-900/30 rounded-2xl shadow-sm",children:d.jsx(Wc,{className:"w-10 h-10 text-amber-600 dark:text-amber-400"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:e("milestones.title")}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:e("milestones.subtitle")})]})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 flex items-center gap-6 min-w-[280px]",children:[d.jsxs("div",{className:"relative w-16 h-16 flex items-center justify-center",children:[d.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[d.jsx("circle",{cx:"32",cy:"32",r:"28",stroke:"currentColor",strokeWidth:"6",fill:"none",className:"text-gray-100 dark:text-gray-700"}),d.jsx("circle",{cx:"32",cy:"32",r:"28",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeDasharray:175,strokeDashoffset:175-175*l/100,className:"text-amber-500 transition-all duration-1000 ease-out",strokeLinecap:"round"})]}),d.jsxs("span",{className:"absolute text-sm font-bold text-gray-900 dark:text-white",children:[Math.round(l),"%"]})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("milestones.totalCompleted")}),d.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a," ",d.jsxs("span",{className:"text-sm text-gray-400 font-normal",children:["/ ",s.length]})]})]})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(h=>d.jsxs("div",{onClick:()=>r(h),className:`group relative bg-white dark:bg-gray-800 rounded-3xl p-6 border-2 transition-all duration-300 cursor-pointer ${h.completed?"border-amber-400/50 shadow-lg shadow-amber-100 dark:shadow-none":"border-transparent hover:border-gray-200 dark:hover:border-gray-700 shadow-sm"}`,children:[h.completed&&d.jsx("div",{className:"absolute -top-3 -right-3 bg-amber-500 text-white p-2 rounded-full shadow-md animate-bounce",children:d.jsx(Wc,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex items-start justify-between mb-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`p-3 rounded-2xl ${h.color}`,children:d.jsx(h.icon,{className:"w-6 h-6"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white group-hover:text-blue-600 transition-colors",children:e(h.titleKey)}),d.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[d.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 uppercase tracking-wide",children:h.category}),d.jsxs("span",{className:"text-xs text-gray-400",children:[e("milestones.target"),": ",h.target]})]})]})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("span",{className:`text-2xl font-bold ${h.completed?"text-amber-500":"text-gray-900 dark:text-white"}`,children:h.current}),d.jsxs("span",{className:"text-gray-400 text-sm",children:[" / ",h.target]})]})]}),d.jsx("div",{className:"mb-4",children:d.jsx("div",{className:"h-3 w-full bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:d.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out ${h.completed?"bg-amber-500":"bg-blue-500"}`,style:{width:`${h.progress}%`}})})}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 leading-relaxed mb-4",children:e(h.descKey)}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600 dark:text-blue-400 font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:[d.jsx("span",{children:e("milestones.viewGallery","View Gallery")}),d.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},h.id))}),c&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>r(null),children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-3xl w-full max-w-4xl max-h-[85vh] overflow-hidden shadow-2xl flex flex-col",onClick:h=>h.stopPropagation(),children:[d.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-gray-800 flex items-center justify-between bg-white dark:bg-gray-900 z-10",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`p-3 rounded-2xl ${c.color}`,children:d.jsx(c.icon,{className:"w-6 h-6"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:e(c.titleKey)}),d.jsxs("p",{className:"text-sm text-gray-500",children:[c.current," / ",c.target," ",e("milestones.memories")]})]})]}),d.jsx("button",{onClick:()=>r(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:d.jsx(Ct,{className:"w-6 h-6 text-gray-500"})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50 dark:bg-gray-950",children:u.length>0?d.jsx("div",{className:"space-y-8",children:u.map(h=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-4 sticky top-0 bg-gray-50/95 dark:bg-gray-950/95 backdrop-blur-sm py-2 z-10 -mx-2 px-2",children:[d.jsx("div",{className:`w-3 h-3 rounded-full ${(c==null?void 0:c.color.split(" ")[0].replace("text-","bg-"))||"bg-gray-400"} ring-4 ring-white dark:ring-gray-900`}),d.jsxs("h4",{className:"text-sm font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[xe(new Date(h.date),"MMMM d, yyyy"),d.jsx("span",{className:"text-[10px] font-normal text-gray-500 bg-gray-200 dark:bg-gray-800 px-2 py-0.5 rounded-full",children:h.entries.length})]})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 pl-5 border-l-2 border-gray-200 dark:border-gray-800 ml-1.5 pb-4",children:h.entries.map(f=>d.jsxs("div",{className:"group relative aspect-square rounded-xl overflow-hidden bg-gray-200 dark:bg-gray-800 shadow-sm hover:shadow-md transition-all",children:[d.jsx(Ot,{src:f.photo,alt:f.caption,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),d.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-3",children:[d.jsx("p",{className:"text-white text-xs font-medium line-clamp-1",children:f.caption}),d.jsx("p",{className:"text-white/70 text-[10px]",children:xe(new Date(f.date),"HH:mm")})]})]},f.id))})]},h.date))}):d.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center py-12",children:[d.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:d.jsx(ws,{className:"w-8 h-8 text-gray-400"})}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:e("milestones.noEntries")}),d.jsx("p",{className:"text-gray-500 text-sm max-w-xs",children:e("milestones.noEntriesDesc")})]})})]})})]})}function e0({entries:t}){const{t:e}=Pe(),[n,r]=x.useState(!1),[s,i]=x.useState(!1),o=()=>{r(!0);try{const l=JSON.stringify(t,null,2),c=new Blob([l],{type:"application/json"}),u=URL.createObjectURL(c),h=document.createElement("a");h.href=u,h.download=`photo-diary-backup-${xe(new Date,"yyyy-MM-dd")}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(u),i(!1)}catch(l){console.error("Export failed:",l),alert(e("export.failed"))}finally{r(!1)}},a=async()=>{r(!0);try{const l=new K0,c=l.internal.pageSize.getWidth(),u=l.internal.pageSize.getHeight();let h=20;l.setFontSize(20),l.text("Photo Diary",20,h),h+=10,l.setFontSize(12),l.text(`Exported on ${xe(new Date,"MMMM d, yyyy")}`,20,h),h+=15;const f=[...t].sort((p,m)=>new Date(m.date).getTime()-new Date(p.date).getTime());for(let p=0;p<f.length;p++){const m=f[p],y=xe(new Date(m.date),"MMMM d, yyyy - h:mm a");h>u-40&&(l.addPage(),h=20),l.setFontSize(14),l.text(y,20,h),h+=7,l.setFontSize(10),l.setTextColor(100,100,100),l.text(`${e("filters.mood")}: ${m.mood}`,20,h),l.setTextColor(0,0,0),h+=7,l.setFontSize(11);const v=l.splitTextToSize(m.caption,c-40);l.text(v,20,h),h+=v.length*5+10,h+=5}l.save(`photo-diary-${xe(new Date,"yyyy-MM-dd")}.pdf`),i(!1)}catch(l){console.error("PDF export failed:",l),alert(e("export.failed"))}finally{r(!1)}};return d.jsxs("div",{className:"relative",children:[d.jsxs("button",{onClick:()=>i(!s),className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:[d.jsx(Ja,{className:"w-4 h-4"}),d.jsx("span",{className:"text-sm",children:e("export.button")})]}),s&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),d.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg z-20",children:d.jsxs("div",{className:"p-1",children:[d.jsxs("button",{onClick:a,disabled:n||t.length===0,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[n?d.jsx(_t,{className:"w-4 h-4 animate-spin"}):d.jsx(zc,{className:"w-4 h-4"}),e("export.pdf")]}),d.jsxs("button",{onClick:o,disabled:n||t.length===0,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[n?d.jsx(_t,{className:"w-4 h-4 animate-spin"}):d.jsx(G1,{className:"w-4 h-4"}),e("export.json")]})]})})]})]})}const t0=[{version:"v3.5.0",date:"2026-02-13",titleKey:"changelog.print",icon:bi,color:"bg-cyan-100 text-cyan-700",changesKey:"changelog.features.printShopV2"},{version:"v3.3.0",date:"2026-02-12",titleKey:"changelog.milestones",icon:Kc,color:"bg-amber-100 text-amber-700",changesKey:"changelog.features.milestones"},{version:"v3.1.0",date:"2026-01-22",titleKey:"changelog.garden3d",icon:q1,color:"bg-green-100 text-green-700",changesKey:"changelog.features.garden3d"},{version:"v2.6.0",date:"2026-01-20",titleKey:"changelog.colordna",icon:Y1,color:"bg-purple-100 text-purple-700",changesKey:"changelog.features.colorDna"},{version:"v2.5.0",date:"2026-01-20",titleKey:"changelog.features.i18n",icon:J1,color:"bg-red-100 text-red-700",changesKey:"changelog.features.i18n"},{version:"v2.4.0",date:"2026-01-20",titleKey:"changelog.features.profile",icon:$0,color:"bg-orange-100 text-orange-700",changesKey:"changelog.features.profile"},{version:"v2.3.0",date:"2026-01-19",titleKey:"changelog.share",icon:Ya,color:"bg-green-100 text-green-700",changesKey:"changelog.features.shareCard"},{version:"v2.2.0",date:"2026-01-19",titleKey:"changelog.personalization",icon:_d,color:"bg-indigo-100 text-indigo-700",changesKey:"changelog.features.darkMode"},{version:"v2.1.0",date:"2026-01-19",titleKey:"changelog.ai",icon:on,color:"bg-pink-100 text-pink-700",changesKey:"changelog.features.ai"},{version:"v2.0.0",date:"2026-01-18",titleKey:"changelog.couple",icon:xn,color:"bg-rose-100 text-rose-700",changesKey:"changelog.features.coupleSync"},{version:"v1.9.0",date:"2026-01-18",titleKey:"changelog.insights",icon:X1,color:"bg-yellow-100 text-yellow-700",changesKey:"changelog.features.insightsCharts"},{version:"v1.8.0",date:"2026-01-18",titleKey:"changelog.map",icon:vs,color:"bg-emerald-100 text-emerald-700",changesKey:"changelog.features.mapView"},{version:"v1.7.0",date:"2026-01-18",titleKey:"changelog.print",icon:bi,color:"bg-cyan-100 text-cyan-700",changesKey:"changelog.features.printShop"},{version:"v1.0.0",date:"2026-01-18",titleKey:"changelog.core",icon:Q1,color:"bg-blue-100 text-blue-700",changesKey:"changelog.features.supabase"}];function N4(){const{t}=Pe(),e=n=>n==="v3.5.0"?[t("changelog.features.printShopV2"),t("changelog.features.printEditor"),t("changelog.features.shareOnline")]:n==="v3.4.0"?[t("changelog.features.mapV2"),t("changelog.features.aiV2"),t("changelog.features.visuals")]:n==="v3.3.0"?[t("changelog.features.milestones"),t("changelog.features.smartGallery"),t("changelog.features.smartTags")]:n==="v3.1.0"?[t("changelog.features.dateLocation")]:n==="v3.0.0"?[t("changelog.features.garden3d"),t("changelog.features.weather"),t("changelog.features.models")]:n==="v2.6.0"?[t("changelog.features.colorDna"),t("changelog.features.planetUI")]:n==="v2.5.0"?[t("changelog.features.i18n"),t("changelog.features.polish")]:n==="v2.4.0"?[t("changelog.features.profile")]:n==="v2.3.0"?[t("changelog.features.shareCard"),t("changelog.features.qr"),t("changelog.features.download")]:n==="v2.2.0"?[t("changelog.features.darkMode"),t("changelog.features.theme"),t("changelog.features.ui"),t("changelog.features.readability")]:n==="v2.1.0"?[t("changelog.features.vision"),t("changelog.features.analysis")]:n==="v2.0.0"?[t("changelog.features.coupleSync"),t("changelog.features.coupleShare")]:n==="v1.9.0"?[t("changelog.features.insightsCharts"),t("changelog.features.insightsStreak")]:n==="v1.8.0"?[t("changelog.features.mapView"),t("changelog.features.mapInteraction")]:n==="v1.7.0"?[t("changelog.features.printShop"),t("changelog.features.printCart")]:n==="v1.0.0"?[t("changelog.features.init"),t("changelog.features.basic"),t("changelog.features.responsive"),t("changelog.features.pwa")]:[];return d.jsxs("div",{className:"max-w-3xl mx-auto space-y-8 pb-20",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[d.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:d.jsx(Hc,{className:"w-6 h-6 text-blue-600"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t("changelog.title")}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("changelog.subtitle")})]})]}),d.jsx("div",{className:"space-y-6",children:t0.map((n,r)=>{const s=n.icon,i=e(n.version);return d.jsxs("div",{className:"relative pl-8 sm:pl-0",children:[r!==t0.length-1&&d.jsx("div",{className:"hidden sm:block absolute left-[8.5rem] top-16 bottom-[-2rem] w-px bg-gray-200 dark:bg-gray-700"}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 group",children:[d.jsxs("div",{className:"hidden sm:flex flex-col items-end w-32 pt-2 flex-shrink-0",children:[d.jsx("span",{className:"font-mono text-sm font-medium text-gray-900 dark:text-white",children:n.version}),d.jsx("span",{className:"text-xs text-gray-500",children:n.date})]}),d.jsx("div",{className:`
                  absolute left-0 top-2 sm:static sm:top-0 sm:mt-2 
                  w-8 h-8 rounded-full flex items-center justify-center 
                  border-4 border-white dark:border-gray-800 shadow-sm z-10
                  ${n.color}
                `,children:d.jsx(s,{className:"w-4 h-4"})}),d.jsxs("div",{className:"flex-1 bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-transparent hover:border-blue-100 dark:hover:border-blue-900 hover:shadow-md transition-all",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t(n.titleKey)}),d.jsxs("div",{className:"sm:hidden flex items-center gap-2",children:[d.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded-md text-xs font-mono dark:text-gray-300",children:n.version}),d.jsx("span",{className:"text-xs text-gray-500",children:n.date})]})]}),d.jsx("ul",{className:"space-y-3",children:i.map((o,a)=>d.jsxs("li",{className:"flex items-start gap-3 text-gray-600 dark:text-gray-300 text-sm",children:[d.jsx("span",{className:"mt-1.5 w-1.5 h-1.5 rounded-full bg-gray-300 dark:bg-gray-600 flex-shrink-0 group-hover:bg-blue-400 transition-colors"}),d.jsx("span",{className:"leading-relaxed",children:o})]},a))})]})]})]},n.version)})})]})}function T4(t,e,n,r){var o,a;const s=[];s.push({type:"cover",title:e,subtitle:r("print.storyOfUs"),coverPhoto:((o=t[0])==null?void 0:o.photo)||"https://images.unsplash.com/photo-1511895426328-dc8714191300?w=400&auto=format&fit=crop&q=60"}),s.push({type:"intro",text:r("print.introText",{year:e})});const i=[...t].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());if(n==="classic")i.forEach(l=>{var c;s.push({type:"entry",date:l.date,mood:l.mood,location:((c=l.location)==null?void 0:c.name)||"Unknown Location",photo:l.photo,caption:l.caption})});else if(n==="grid")for(let l=0;l<i.length;l+=4){const c=i.slice(l,l+4);s.push({type:"grid",layout:"grid-4",entries:c})}else if(n==="magazine"){let l=0;for(;l<i.length;){const c=i[l];if(c.caption&&c.caption.length>50)s.push({type:"entry",date:c.date,mood:c.mood,location:(a=c.location)==null?void 0:a.name,photo:c.photo,caption:c.caption}),l++;else{const u=i.length-l,h=Math.min(Math.random()>.5?2:3,u),f=i.slice(l,l+h);s.push({type:"collage",layout:`collage-${h}`,entries:f,caption:f.map(p=>p.caption).join("  ")}),l+=h}}}else if(n==="minimal")for(let l=0;l<i.length;l+=2){const c=i.slice(l,l+2);s.push({type:"grid",layout:"grid-2",entries:c})}return s.push({type:"outro",text:r("print.toBeContinued")}),s}const xs=async t=>{try{const n=await(await fetch(t,{mode:"cors",credentials:"omit"})).blob();return new Promise((r,s)=>{const i=new FileReader;i.onloadend=()=>r(i.result),i.onerror=s,i.readAsDataURL(n)})}catch(e){return console.warn("Failed to load image:",t,e),"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"}},ff=(t,e,n,r,s,i,o="left")=>{const a=t.splitTextToSize(e,s);return t.text(a,n,r,{align:o}),a.length*i},R4=async(t,e,n,r)=>{const s=new K0("p","mm","a4"),i=s.internal.pageSize.getWidth(),o=s.internal.pageSize.getHeight(),a=20;let l=0;const c=t.length;for(const u of t){switch(l>0&&s.addPage(),s.setFillColor(253,251,247),s.rect(0,0,i,o,"F"),u.type){case"cover":await O4(s,u,i,o);break;case"intro":I4(s,u,i);break;case"entry":await M4(s,u,i,o,a);break;case"grid":await D4(s,u,i,o,a);break;case"collage":await L4(s,u,i,o,a);break;case"outro":$4(s,u,i,o);break}u.type!=="cover"&&(s.setFontSize(10),s.setTextColor(150),s.text(`${l+1}`,i/2,o-10,{align:"center"})),l++,r(l/c)}return s};async function O4(t,e,n,r){if(t.setFillColor(30,58,138),t.rect(0,0,n,r,"F"),t.setDrawColor(23,37,84),t.setLineWidth(4),t.rect(10,10,n-20,r-20),t.setDrawColor(251,191,36),t.setLineWidth(1),t.rect(20,20,n-40,r-40),t.setTextColor(251,191,36),t.setFontSize(16),t.text(e.subtitle||"The Year Of",n/2,60,{align:"center"}),t.setTextColor(254,243,199),t.setFontSize(60),t.text(e.title||"2025",n/2,90,{align:"center"}),e.coverPhoto)try{const s=await xs(e.coverPhoto),i=80,o=(n-i)/2,a=110,l=s.startsWith("data:image/png")?"PNG":"JPEG";t.addImage(s,l,o,a,i,i),t.setDrawColor(254,243,199),t.setLineWidth(2),t.rect(o,a,i,i)}catch(s){console.error("Cover image error",s)}t.setFontSize(14),t.setTextColor(253,230,138),t.text("My Photo Diary",n/2,r-40,{align:"center"})}function I4(t,e,n,r){t.setTextColor(31,41,55),t.setFontSize(24),t.text("Introduction",n/2,60,{align:"center"}),t.setFontSize(14),t.setTextColor(75,85,99),e.text&&ff(t,e.text,n/2,90,120,7,"center")}async function M4(t,e,n,r,s){const i=e.date?xe(new Date(e.date),"MMMM d, yyyy"):"";if(t.setFontSize(20),t.setTextColor(17,24,39),t.text(i,s,s+10),t.setFontSize(12),t.setTextColor(107,114,128),e.location&&t.text(e.location,n-s,s+10,{align:"right"}),t.setDrawColor(229,231,235),t.line(s,s+15,n-s,s+15),e.photo)try{const a=await xs(e.photo),l=n-s*2,c=l*.6,u=a.startsWith("data:image/png")?"PNG":"JPEG";t.addImage(a,u,s,s+25,l,c)}catch(a){console.error("Entry image error",a)}const o=s+25+(n-s*2)*.6+15;e.caption&&(t.setFontSize(14),t.setTextColor(55,65,81),ff(t,e.caption,s,o,n-s*2,7)),e.mood&&(t.setFontSize(10),t.setTextColor(156,163,175),t.text(`Mood: ${e.mood}`,s,r-s))}async function D4(t,e,n,r,s){const i=e.entries||[],o=5,a=2,l=(n-s*2-o*(a-1))/a,c=l;let u=0;for(const h of i){if(u>=4)break;const f=u%a,p=Math.floor(u/a),m=s+f*(l+o),y=s+20+p*(c+o);if(h.photo)try{const v=await xs(h.photo),S=v.startsWith("data:image/png")?"PNG":"JPEG";t.addImage(v,S,m,y,l,c)}catch{}u++}}async function L4(t,e,n,r,s){var a,l,c;const i=e.entries||[];if(i.length===0)return;if((a=i[0])!=null&&a.photo)try{const u=await xs(i[0].photo),h=u.startsWith("data:image/png")?"PNG":"JPEG";t.addImage(u,h,s,s+10,n-s*2,100)}catch{}const o=(n-s*2-5)/2;if((l=i[1])!=null&&l.photo)try{const u=await xs(i[1].photo),h=u.startsWith("data:image/png")?"PNG":"JPEG";t.addImage(u,h,s,s+115,o,o)}catch{}if((c=i[2])!=null&&c.photo)try{const u=await xs(i[2].photo),h=u.startsWith("data:image/png")?"PNG":"JPEG";t.addImage(u,h,s+o+5,s+115,o,o)}catch{}e.caption&&(t.setFontSize(12),t.setTextColor(55),ff(t,e.caption,s,s+115+o+10,n-s*2,6))}function $4(t,e,n,r){t.setTextColor(107,114,128),t.setFontSize(16),t.text(e.text||"The End",n/2,r/2,{align:"center"})}async function F4(t,e,n){const{data:{user:r}}=await ye.auth.getUser();if(!r)throw new Error("User not authenticated");const{data:s,error:i}=await ye.from("shared_books").insert({user_id:r.id,year:t,style:e,pages:n}).select().single();if(i)throw console.error("Error sharing book:",i),new Error("Failed to share book");return s}async function U4(t){const{data:e,error:n}=await ye.from("shared_books").select("*").eq("id",t).single();if(n)throw console.error("Error fetching shared book:",n),new Error("Failed to fetch shared book");return e}var si={exports:{}},B4=si.exports,n0;function V4(){return n0||(n0=1,(function(t,e){(function(n,r){r(e)})(B4,(function(n){class r{constructor(g,w){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=w,this.nowDrawingDensity=this.createdDensity,this.render=g}setDensity(g){this.createdDensity=g,this.nowDrawingDensity=g}setDrawingDensity(g){this.nowDrawingDensity=g}setPosition(g){this.state.position=g}setAngle(g){this.state.angle=g}setArea(g){this.state.area=g}setHardDrawingAngle(g){this.state.hardDrawingAngle=g}setHardAngle(g){this.state.hardAngle=g,this.state.hardDrawingAngle=g}setOrientation(g){this.orientation=g}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class s extends r{constructor(g,w,_){super(g,_),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=w}draw(g){const w=this.render.getContext(),_=this.render.convertToGlobal(this.state.position),P=this.render.getRect().pageWidth,b=this.render.getRect().height;w.save(),w.translate(_.x,_.y),w.beginPath();for(let C of this.state.area)C!==null&&(C=this.render.convertToGlobal(C),w.lineTo(C.x-_.x,C.y-_.y));w.rotate(this.state.angle),w.clip(),this.isLoad?w.drawImage(this.image,0,0,P,b):this.drawLoader(w,{x:0,y:0},P,b),w.restore()}simpleDraw(g){const w=this.render.getRect(),_=this.render.getContext(),P=w.pageWidth,b=w.height,C=g===1?w.left+w.pageWidth:w.left,A=w.top;this.isLoad?_.drawImage(this.image,C,A,P,b):this.drawLoader(_,{x:C,y:A},P,b)}drawLoader(g,w,_,P){g.beginPath(),g.strokeStyle="rgb(200, 200, 200)",g.fillStyle="rgb(255, 255, 255)",g.lineWidth=1,g.rect(w.x+1,w.y+1,_-1,P-1),g.stroke(),g.fill();const b={x:w.x+_/2,y:w.y+P/2};g.beginPath(),g.lineWidth=10,g.arc(b.x,b.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),g.stroke(),g.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class i{constructor(g,w){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=w,this.app=g,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let w=0;w<this.pages.length;w++)this.portraitSpread.push([w]);let g=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([g]),g++);for(let w=g;w<this.pages.length;w+=2)w<this.pages.length-1?this.landscapeSpread.push([w,w+1]):(this.landscapeSpread.push([w]),this.pages[w].setDensity("hard"))}getSpread(){return this.render.getOrientation()==="landscape"?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(g){const w=this.getSpread();for(let _=0;_<w.length;_++)if(g===w[_][0]||g===w[_][1])return _;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(g){if(g>=0&&g<this.pages.length)return this.pages[g];throw new Error("Invalid page number")}nextBy(g){const w=this.pages.indexOf(g);return w<this.pages.length-1?this.pages[w+1]:null}prevBy(g){const w=this.pages.indexOf(g);return w>0?this.pages[w-1]:null}getFlippingPage(g){const w=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return g===0?this.pages[w].newTemporaryCopy():this.pages[w-1];{const _=g===0?this.getSpread()[w+1]:this.getSpread()[w-1];return _.length===1||g===0?this.pages[_[0]]:this.pages[_[1]]}}getBottomPage(g){const w=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return g===0?this.pages[w+1]:this.pages[w-1];{const _=g===0?this.getSpread()[w+1]:this.getSpread()[w-1];return _.length===1?this.pages[_[0]]:g===0?this.pages[_[1]]:this.pages[_[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(g=null){if(g===null&&(g=this.currentPageIndex),g<0||g>=this.pages.length)return;const w=this.getSpreadIndexByPage(g);w!==null&&(this.currentSpreadIndex=w,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(g){if(!(g>=0&&g<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=g}showSpread(){const g=this.getSpread()[this.currentSpreadIndex];g.length===2?(this.render.setLeftPage(this.pages[g[0]]),this.render.setRightPage(this.pages[g[1]])):this.render.getOrientation()==="landscape"&&g[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[g[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[g[0]])),this.currentPageIndex=g[0],this.app.updatePageIndex(this.currentPageIndex)}}class o extends i{constructor(g,w,_){super(g,w),this.imagesHref=_}load(){for(const g of this.imagesHref){const w=new s(this.render,g,"soft");w.load(),this.pages.push(w)}this.createSpread()}}class a{static GetDistanceBetweenTwoPoint(g,w){return g===null||w===null?1/0:Math.sqrt(Math.pow(w.x-g.x,2)+Math.pow(w.y-g.y,2))}static GetSegmentLength(g){return a.GetDistanceBetweenTwoPoint(g[0],g[1])}static GetAngleBetweenTwoLine(g,w){const _=g[0].y-g[1].y,P=w[0].y-w[1].y,b=g[1].x-g[0].x,C=w[1].x-w[0].x;return Math.acos((_*P+b*C)/(Math.sqrt(_*_+b*b)*Math.sqrt(P*P+C*C)))}static PointInRect(g,w){return w===null?null:w.x>=g.left&&w.x<=g.width+g.left&&w.y>=g.top&&w.y<=g.top+g.height?w:null}static GetRotatedPoint(g,w,_){return{x:g.x*Math.cos(_)+g.y*Math.sin(_)+w.x,y:g.y*Math.cos(_)-g.x*Math.sin(_)+w.y}}static LimitPointToCircle(g,w,_){if(a.GetDistanceBetweenTwoPoint(g,_)<=w)return _;const P=g.x,b=g.y,C=_.x,A=_.y;let N=Math.sqrt(Math.pow(w,2)*Math.pow(P-C,2)/(Math.pow(P-C,2)+Math.pow(b-A,2)))+P;_.x<0&&(N*=-1);let O=(N-P)*(b-A)/(P-C)+b;return P-C+b===0&&(O=w),{x:N,y:O}}static GetIntersectBetweenTwoSegment(g,w,_){return a.PointInRect(g,a.GetIntersectBeetwenTwoLine(w,_))}static GetIntersectBeetwenTwoLine(g,w){const _=g[0].y-g[1].y,P=w[0].y-w[1].y,b=g[1].x-g[0].x,C=w[1].x-w[0].x,A=g[0].x*g[1].y-g[1].x*g[0].y,N=w[0].x*w[1].y-w[1].x*w[0].y,O=_*N-P*A,I=b*N-C*A,T=-(A*C-N*b)/(_*C-P*b),M=-(_*N-P*A)/(_*C-P*b);if(isFinite(T)&&isFinite(M))return{x:T,y:M};if(Math.abs(O-I)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(g,w){const _=Math.abs(g.x-w.x),P=Math.abs(g.y-w.y),b=Math.max(_,P),C=[g];function A(N,O,I,T,M){return O>N?N+M*(I/T):O<N?N-M*(I/T):N}for(let N=1;N<=b;N+=1)C.push({x:A(g.x,w.x,_,b,N),y:A(g.y,w.y,P,b,N)});return C}}class l extends r{constructor(g,w,_){super(g,_),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=w,this.element.classList.add("stf__item"),this.element.classList.add("--"+_)}newTemporaryCopy(){return this.nowDrawingDensity==="hard"?this:(this.temporaryCopy===null&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new l(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){this.temporaryCopy!==null&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(g){const w=g||this.nowDrawingDensity,_=this.render.convertToGlobal(this.state.position),P=this.render.getRect().pageWidth,b=this.render.getRect().height;this.element.classList.remove("--simple");const C=`
            display: block;
            z-index: ${this.element.style.zIndex};
            left: 0;
            top: 0;
            width: ${P}px;
            height: ${b}px;
        `;w==="hard"?this.drawHard(C):this.drawSoft(_,C)}drawHard(g=""){const w=this.render.getRect().left+this.render.getRect().width/2,_=this.state.hardDrawingAngle,P=g+`
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                clip-path: none;
                -webkit-clip-path: none;
            `+(this.orientation===0?`transform-origin: ${this.render.getRect().pageWidth}px 0; 
                   transform: translate3d(0, 0, 0) rotateY(${_}deg);`:`transform-origin: 0 0; 
                   transform: translate3d(${w}px, 0, 0) rotateY(${_}deg);`);this.element.style.cssText=P}drawSoft(g,w=""){let _="polygon( ";for(const b of this.state.area)if(b!==null){let C=this.render.getDirection()===1?{x:-b.x+this.state.position.x,y:b.y-this.state.position.y}:{x:b.x-this.state.position.x,y:b.y-this.state.position.y};C=a.GetRotatedPoint(C,{x:0,y:0},this.state.angle),_+=C.x+"px "+C.y+"px, "}_=_.slice(0,-2),_+=")";const P=w+`transform-origin: 0 0; clip-path: ${_}; -webkit-clip-path: ${_};`+(this.render.isSafari()&&this.state.angle===0?`transform: translate(${g.x}px, ${g.y}px);`:`transform: translate3d(${g.x}px, ${g.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=P}simpleDraw(g){const w=this.render.getRect(),_=w.pageWidth,P=w.height,b=g===1?w.left+w.pageWidth:w.left,C=w.top;this.element.classList.add("--simple"),this.element.style.cssText=`
            position: absolute; 
            display: block; 
            height: ${P}px; 
            left: ${b}px; 
            top: ${C}px; 
            width: ${_}px; 
            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(g){super.setOrientation(g),this.element.classList.remove("--left","--right"),this.element.classList.add(g===1?"--right":"--left")}setDrawingDensity(g){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+g),super.setDrawingDensity(g)}}class c extends i{constructor(g,w,_,P){super(g,w),this.element=_,this.pagesElement=P}load(){for(const g of this.pagesElement){const w=new l(this.render,g,g.dataset.density==="hard"?"hard":"soft");w.load(),this.pages.push(w)}this.createSpread()}}class u{constructor(g,w,_,P){this.direction=g,this.corner=w,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(_,10),this.pageHeight=parseInt(P,10)}calc(g){try{return this.position=this.calcAngleAndPosition(g),this.calculateIntersectPoint(this.position),!0}catch{return!1}}getFlippingClipArea(){const g=[];let w=!1;return g.push(this.rect.topLeft),g.push(this.topIntersectPoint),this.sideIntersectPoint===null?w=!0:(g.push(this.sideIntersectPoint),this.bottomIntersectPoint===null&&(w=!1)),g.push(this.bottomIntersectPoint),(w||this.corner==="bottom")&&g.push(this.rect.bottomLeft),g}getBottomClipArea(){const g=[];return g.push(this.topIntersectPoint),this.corner==="top"?g.push({x:this.pageWidth,y:0}):(this.topIntersectPoint!==null&&g.push({x:this.pageWidth,y:0}),g.push({x:this.pageWidth,y:this.pageHeight})),this.sideIntersectPoint!==null?a.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&g.push(this.sideIntersectPoint):this.corner==="top"&&g.push({x:this.pageWidth,y:this.pageHeight}),g.push(this.bottomIntersectPoint),g.push(this.topIntersectPoint),g}getAngle(){return this.direction===0?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return this.direction===0?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return this.direction===1?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return this.corner==="top"?this.topIntersectPoint:this.sideIntersectPoint!==null?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const g=a.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return this.direction===0?g:Math.PI-g}calcAngleAndPosition(g){let w=g;if(this.updateAngleAndGeometry(w),w=this.corner==="top"?this.checkPositionAtCenterLine(w,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(w,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(w.x-this.pageWidth)<1&&Math.abs(w.y)<1)throw new Error("Point is too small");return w}updateAngleAndGeometry(g){this.angle=this.calculateAngle(g),this.rect=this.getPageRect(g)}calculateAngle(g){const w=this.pageWidth-g.x+1,_=this.corner==="bottom"?this.pageHeight-g.y:g.y;let P=2*Math.acos(w/Math.sqrt(_*_+w*w));_<0&&(P=-P);const b=Math.PI-P;if(!isFinite(P)||b>=0&&b<.003)throw new Error("The G point is too small");return this.corner==="bottom"&&(P=-P),P}getPageRect(g){return this.corner==="top"?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],g):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],g)}getRectFromBasePoint(g,w){return{topLeft:this.getRotatedPoint(g[0],w),topRight:this.getRotatedPoint(g[1],w),bottomLeft:this.getRotatedPoint(g[2],w),bottomRight:this.getRotatedPoint(g[3],w)}}getRotatedPoint(g,w){return{x:g.x*Math.cos(this.angle)+g.y*Math.sin(this.angle)+w.x,y:g.y*Math.cos(this.angle)-g.x*Math.sin(this.angle)+w.y}}calculateIntersectPoint(g){const w={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};this.corner==="top"?(this.topIntersectPoint=a.GetIntersectBetweenTwoSegment(w,[g,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=a.GetIntersectBetweenTwoSegment(w,[g,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=a.GetIntersectBetweenTwoSegment(w,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=a.GetIntersectBetweenTwoSegment(w,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=a.GetIntersectBetweenTwoSegment(w,[g,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=a.GetIntersectBetweenTwoSegment(w,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(g,w,_){let P=g;const b=a.LimitPointToCircle(w,this.pageWidth,P);P!==b&&(P=b,this.updateAngleAndGeometry(P));const C=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let A=this.rect.bottomRight,N=this.rect.topLeft;if(this.corner==="bottom"&&(A=this.rect.topRight,N=this.rect.bottomLeft),A.x<=0){const O=a.LimitPointToCircle(_,C,N);O!==P&&(P=O,this.updateAngleAndGeometry(P))}return P}getSegmentToShadowLine(){const g=this.getShadowStartPoint();return[g,g!==this.sideIntersectPoint&&this.sideIntersectPoint!==null?this.sideIntersectPoint:this.bottomIntersectPoint]}}class h{constructor(g,w){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=g,this.app=w}fold(g){this.setState("user_fold"),this.calc===null&&this.start(g),this.do(this.render.convertToPage(g))}flip(g){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(g)||(this.calc!==null&&this.render.finishAnimation(),!this.start(g)))return;const w=this.getBoundsRect();this.setState("flipping");const _=w.height/10,P=this.calc.getCorner()==="bottom"?w.height-_:_,b=this.calc.getCorner()==="bottom"?w.height:0;this.calc.calc({x:w.pageWidth-_,y:P}),this.animateFlippingTo({x:w.pageWidth-_,y:P},{x:-w.pageWidth,y:b},!0)}start(g){this.reset();const w=this.render.convertToBook(g),_=this.getBoundsRect(),P=this.getDirectionByPoint(w),b=w.y>=_.height/2?"bottom":"top";if(!this.checkDirection(P))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(P),this.bottomPage=this.app.getPageCollection().getBottomPage(P),this.render.getOrientation()==="landscape")if(P===1){const C=this.app.getPageCollection().nextBy(this.flippingPage);C!==null&&this.flippingPage.getDensity()!==C.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),C.setDrawingDensity("hard"))}else{const C=this.app.getPageCollection().prevBy(this.flippingPage);C!==null&&this.flippingPage.getDensity()!==C.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),C.setDrawingDensity("hard"))}return this.render.setDirection(P),this.calc=new u(P,b,_.pageWidth.toString(10),_.height.toString(10)),!0}catch{return!1}}do(g){if(this.calc!==null&&this.calc.calc(g)){const w=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),this.calc.getDirection()===0?this.flippingPage.setHardAngle(90*(200-2*w)/100):this.flippingPage.setHardAngle(-90*(200-2*w)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),w,this.calc.getDirection())}}flipToPage(g,w){const _=this.app.getPageCollection().getCurrentSpreadIndex(),P=this.app.getPageCollection().getSpreadIndexByPage(g);try{P>_&&(this.app.getPageCollection().setCurrentSpreadIndex(P-1),this.flipNext(w)),P<_&&(this.app.getPageCollection().setCurrentSpreadIndex(P+1),this.flipPrev(w))}catch{}}flipNext(g){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:g==="top"?1:this.render.getRect().height-2})}flipPrev(g){this.flip({x:10,y:g==="top"?1:this.render.getRect().height-2})}stopMove(){if(this.calc===null)return;const g=this.calc.getPosition(),w=this.getBoundsRect(),_=this.calc.getCorner()==="bottom"?w.height:0;g.x<=0?this.animateFlippingTo(g,{x:-w.pageWidth,y:_},!0):this.animateFlippingTo(g,{x:w.pageWidth,y:_},!1)}showCorner(g){if(!this.checkState("read","fold_corner"))return;const w=this.getBoundsRect(),_=w.pageWidth;if(this.isPointOnCorners(g))if(this.calc===null){if(!this.start(g))return;this.setState("fold_corner"),this.calc.calc({x:_-1,y:1});const P=50,b=this.calc.getCorner()==="bottom"?w.height-1:1,C=this.calc.getCorner()==="bottom"?w.height-P:P;this.animateFlippingTo({x:_-1,y:b},{x:_-P,y:C},!1,!1)}else this.do(this.render.convertToPage(g));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(g,w,_,P=!0){const b=a.GetCordsFromTwoPoint(g,w),C=[];for(const N of b)C.push(()=>this.do(N));const A=this.getAnimationDuration(b.length);this.render.startAnimation(C,A,()=>{this.calc&&(_&&(this.calc.getDirection()===1?this.app.turnToPrevPage():this.app.turnToNextPage()),P&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))})}getCalculation(){return this.calc}getState(){return this.state}setState(g){this.state!==g&&(this.app.updateState(g),this.state=g)}getDirectionByPoint(g){const w=this.getBoundsRect();if(this.render.getOrientation()==="portrait"){if(g.x-w.pageWidth<=w.width/5)return 1}else if(g.x<w.width/2)return 1;return 0}getAnimationDuration(g){const w=this.app.getSettings().flippingTime;return g>=1e3?w:g/1e3*w}checkDirection(g){return g===0?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...g){for(const w of g)if(this.state===w)return!0;return!1}isPointOnCorners(g){const w=this.getBoundsRect(),_=w.pageWidth,P=Math.sqrt(Math.pow(_,2)+Math.pow(w.height,2))/5,b=this.render.convertToBook(g);return b.x>0&&b.y>0&&b.x<w.width&&b.y<w.height&&(b.x<P||b.x>w.width-P)&&(b.y<P||b.y>w.height-P)}}class f{constructor(g,w){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=w,this.app=g;const _=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=_.exec(window.navigator.userAgent)!==null}render(g){if(this.animation!==null){const w=Math.round((g-this.animation.startedAt)/this.animation.durationFrame);w<this.animation.frames.length?this.animation.frames[w]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=g,this.drawFrame()}start(){this.update();const g=w=>{this.render(w),requestAnimationFrame(g)};requestAnimationFrame(g)}startAnimation(g,w,_){this.finishAnimation(),this.animation={frames:g,duration:w,durationFrame:w/g.length,onAnimateEnd:_,startedAt:this.timer}}finishAnimation(){this.animation!==null&&(this.animation.frames[this.animation.frames.length-1](),this.animation.onAnimateEnd!==null&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const g=this.calculateBoundsRect();this.orientation!==g&&(this.orientation=g,this.app.updateOrientation(g))}calculateBoundsRect(){let g="landscape";const w=this.getBlockWidth(),_=w/2,P=this.getBlockHeight()/2,b=this.setting.width/this.setting.height;let C=this.setting.width,A=this.setting.height,N=_-C;return this.setting.size==="stretch"?(w<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(g="portrait"),C=g==="portrait"?this.getBlockWidth():this.getBlockWidth()/2,C>this.setting.maxWidth&&(C=this.setting.maxWidth),A=C/b,A>this.getBlockHeight()&&(A=this.getBlockHeight(),C=A*b),N=g==="portrait"?_-C/2-C:_-C):w<2*C&&this.app.getSettings().usePortrait&&(g="portrait",N=_-C/2-C),this.boundsRect={left:N,top:P-A/2,width:2*C,height:A,pageWidth:C},g}setShadowData(g,w,_,P){if(!this.app.getSettings().drawShadow)return;const b=100*this.getSettings().maxShadowOpacity;this.shadow={pos:g,angle:w,width:3*this.getRect().pageWidth/4*_/100,opacity:(100-_)*b/100/100,direction:P,progress:2*_}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return this.boundsRect===null&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(g){this.pageRect=g}setDirection(g){this.direction=g}setRightPage(g){g!==null&&g.setOrientation(1),this.rightPage=g}setLeftPage(g){g!==null&&g.setOrientation(0),this.leftPage=g}setBottomPage(g){g!==null&&g.setOrientation(this.direction===1?0:1),this.bottomPage=g}setFlippingPage(g){g!==null&&g.setOrientation(this.direction===0&&this.orientation!=="portrait"?0:1),this.flippingPage=g}convertToBook(g){const w=this.getRect();return{x:g.x-w.left,y:g.y-w.top}}isSafari(){return this.safari}convertToPage(g,w){w||(w=this.direction);const _=this.getRect();return{x:w===0?g.x-_.left-_.width/2:_.width/2-g.x+_.left,y:g.y-_.top}}convertToGlobal(g,w){if(w||(w=this.direction),g==null)return null;const _=this.getRect();return{x:w===0?g.x+_.left+_.width/2:_.width/2-g.x+_.left,y:g.y+_.top}}convertRectToGlobal(g,w){return w||(w=this.direction),{topLeft:this.convertToGlobal(g.topLeft,w),topRight:this.convertToGlobal(g.topRight,w),bottomLeft:this.convertToGlobal(g.bottomLeft,w),bottomRight:this.convertToGlobal(g.bottomRight,w)}}}class p extends f{constructor(g,w,_){super(g,w),this.canvas=_,this.ctx=_.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),this.orientation!=="portrait"&&this.leftPage!=null&&this.leftPage.simpleDraw(0),this.rightPage!=null&&this.rightPage.simpleDraw(1),this.bottomPage!=null&&this.bottomPage.draw(),this.drawBookShadow(),this.flippingPage!=null&&this.flippingPage.draw(),this.shadow!=null&&(this.drawOuterShadow(),this.drawInnerShadow());const g=this.getRect();this.orientation==="portrait"&&(this.ctx.beginPath(),this.ctx.rect(g.left+g.pageWidth,g.top,g.width,g.height),this.ctx.clip())}drawBookShadow(){const g=this.getRect();this.ctx.save(),this.ctx.beginPath();const w=g.width/20;this.ctx.rect(g.left,g.top,g.width,g.height);const _={x:g.left+g.width/2-w/2,y:0};this.ctx.translate(_.x,_.y);const P=this.ctx.createLinearGradient(0,0,w,0);P.addColorStop(0,"rgba(0, 0, 0, 0)"),P.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),P.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),P.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),P.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),P.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=P,this.ctx.fillRect(0,0,w,2*g.height),this.ctx.restore()}drawOuterShadow(){const g=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(g.left,g.top,g.width,g.height);const w=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(w.x,w.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const _=this.ctx.createLinearGradient(0,0,this.shadow.width,0);this.shadow.direction===0?(this.ctx.translate(0,-100),_.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),_.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),_.addColorStop(0,"rgba(0, 0, 0, 0)"),_.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=_,this.ctx.fillRect(0,0,this.shadow.width,2*g.height),this.ctx.restore()}drawInnerShadow(){const g=this.getRect();this.ctx.save(),this.ctx.beginPath();const w=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),_=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(_.topLeft.x,_.topLeft.y),this.ctx.lineTo(_.topRight.x,_.topRight.y),this.ctx.lineTo(_.bottomRight.x,_.bottomRight.y),this.ctx.lineTo(_.bottomLeft.x,_.bottomLeft.y),this.ctx.translate(w.x,w.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const P=3*this.shadow.width/4,b=this.ctx.createLinearGradient(0,0,P,0);this.shadow.direction===0?(this.ctx.translate(-P,-100),b.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),b.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),b.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),b.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),b.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=b,this.ctx.fillRect(0,0,P,2*g.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class m{constructor(g,w,_){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=b=>{if(this.checkTarget(b.target)){const C=this.getMousePos(b.clientX,b.clientY);this.app.startUserTouch(C),b.preventDefault()}},this.onTouchStart=b=>{if(this.checkTarget(b.target)&&b.changedTouches.length>0){const C=b.changedTouches[0],A=this.getMousePos(C.clientX,C.clientY);this.touchPoint={point:A,time:Date.now()},setTimeout(()=>{this.touchPoint!==null&&this.app.startUserTouch(A)},this.swipeTimeout),this.app.getSettings().mobileScrollSupport||b.preventDefault()}},this.onMouseUp=b=>{const C=this.getMousePos(b.clientX,b.clientY);this.app.userStop(C)},this.onMouseMove=b=>{const C=this.getMousePos(b.clientX,b.clientY);this.app.userMove(C,!1)},this.onTouchMove=b=>{if(b.changedTouches.length>0){const C=b.changedTouches[0],A=this.getMousePos(C.clientX,C.clientY);this.app.getSettings().mobileScrollSupport?(this.touchPoint!==null&&(Math.abs(this.touchPoint.point.x-A.x)>10||this.app.getState()!=="read")&&b.cancelable&&this.app.userMove(A,!0),this.app.getState()!=="read"&&b.preventDefault()):this.app.userMove(A,!0)}},this.onTouchEnd=b=>{if(b.changedTouches.length>0){const C=b.changedTouches[0],A=this.getMousePos(C.clientX,C.clientY);let N=!1;if(this.touchPoint!==null){const O=A.x-this.touchPoint.point.x,I=Math.abs(A.y-this.touchPoint.point.y);Math.abs(O)>this.swipeDistance&&I<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(O>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),N=!0),this.touchPoint=null}this.app.userStop(A,N)}},this.parentElement=g,g.classList.add("stf__parent"),g.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=g.querySelector(".stf__wrapper"),this.app=w;const P=this.app.getSettings().usePortrait?1:2;g.style.minWidth=_.minWidth*P+"px",g.style.minHeight=_.minHeight+"px",_.size==="fixed"&&(g.style.minWidth=_.width*P+"px",g.style.minHeight=_.height+"px"),_.autoSize&&(g.style.width="100%",g.style.maxWidth=2*_.maxWidth+"px"),g.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=_.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(g){this.wrapper.classList.remove("--portrait","--landscape"),g==="portrait"?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(g,w){const _=this.distElement.getBoundingClientRect();return{x:g-_.left,y:w-_.top}}checkTarget(g){return!this.app.getSettings().clickEventForward||!["a","button"].includes(g.tagName.toLowerCase())}}class y extends m{constructor(g,w,_,P){super(g,w,_),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=g.querySelector(".stf__block"),this.items=P;for(const b of P)this.distElement.appendChild(b);this.setHandlers()}clear(){for(const g of this.items)this.parentElement.appendChild(g)}updateItems(g){this.removeHandlers(),this.distElement.innerHTML="";for(const w of g)this.distElement.appendChild(w);this.items=g,this.setHandlers()}update(){this.app.getRender().update()}}class v extends m{constructor(g,w,_){super(g,w,_),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=g.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const g=getComputedStyle(this.canvas),w=parseInt(g.getPropertyValue("width"),10),_=parseInt(g.getPropertyValue("height"),10);this.canvas.width=w,this.canvas.height=_}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class S extends f{constructor(g,w,_){super(g,w),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=_,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",`<div class="stf__outerShadow"></div>
             <div class="stf__innerShadow"></div>
             <div class="stf__hardShadow"></div>
             <div class="stf__hardInnerShadow"></div>`),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const g=this.getRect(),w=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let _=(100-w)*(2.5*g.pageWidth)/100+20;_>g.pageWidth&&(_=g.pageWidth);let P=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+5).toString(10)};
            width: ${_}px;
            height: ${g.height}px;
            background: linear-gradient(to right,
                rgba(0, 0, 0, ${this.shadow.opacity*w/100}) 5%,
                rgba(0, 0, 0, 0) 100%);
            left: ${g.left+g.width/2}px;
            transform-origin: 0 0;
        `;P+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=P}drawHardOuterShadow(){const g=this.getRect();let w=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*g.pageWidth)/100+20;w>g.pageWidth&&(w=g.pageWidth);let _=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+4).toString(10)};
            width: ${w}px;
            height: ${g.height}px;
            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);
            left: ${g.left+g.width/2}px;
            transform-origin: 0 0;
        `;_+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=_}drawInnerShadow(){const g=this.getRect(),w=3*this.shadow.width/4,_=this.getDirection()===0?w:0,P=this.getDirection()===0?"to left":"to right",b=this.convertToGlobal(this.shadow.pos),C=this.shadow.angle+3*Math.PI/2,A=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let N="polygon( ";for(const I of A){let T=this.getDirection()===1?{x:-I.x+this.shadow.pos.x,y:I.y-this.shadow.pos.y}:{x:I.x-this.shadow.pos.x,y:I.y-this.shadow.pos.y};T=a.GetRotatedPoint(T,{x:_,y:100},C),N+=T.x+"px "+T.y+"px, "}N=N.slice(0,-2),N+=")";const O=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${w}px;
            height: ${2*g.height}px;
            background: linear-gradient(${P},
                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,
                rgba(0, 0, 0, 0.05) 15%,
                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,
                rgba(0, 0, 0, 0) 100%);
            transform-origin: ${_}px 100px;
            transform: translate3d(${b.x-_}px, ${b.y-100}px, 0) rotate(${C}rad);
            clip-path: ${N};
            -webkit-clip-path: ${N};
        `;this.innerShadow.style.cssText=O}drawOuterShadow(){const g=this.getRect(),w=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),_=this.shadow.angle+3*Math.PI/2,P=this.getDirection()===1?this.shadow.width:0,b=this.getDirection()===0?"to right":"to left",C=[{x:0,y:0},{x:g.pageWidth,y:0},{x:g.pageWidth,y:g.height},{x:0,y:g.height}];let A="polygon( ";for(const O of C)if(O!==null){let I=this.getDirection()===1?{x:-O.x+this.shadow.pos.x,y:O.y-this.shadow.pos.y}:{x:O.x-this.shadow.pos.x,y:O.y-this.shadow.pos.y};I=a.GetRotatedPoint(I,{x:P,y:100},_),A+=I.x+"px "+I.y+"px, "}A=A.slice(0,-2),A+=")";const N=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${this.shadow.width}px;
            height: ${2*g.height}px;
            background: linear-gradient(${b}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));
            transform-origin: ${P}px 100px;
            transform: translate3d(${w.x-P}px, ${w.y-100}px, 0) rotate(${_}rad);
            clip-path: ${A};
            -webkit-clip-path: ${A};
        `;this.outerShadow.style.cssText=N}drawLeftPage(){this.orientation!=="portrait"&&this.leftPage!==null&&(this.direction===1&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){this.rightPage!==null&&(this.direction===0&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(this.bottomPage===null)return;const g=this.flippingPage!=null?this.flippingPage.getDrawingDensity():null;this.orientation==="portrait"&&this.direction===1||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(g))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),this.flippingPage!=null&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),this.shadow!=null&&this.flippingPage!==null&&(this.flippingPage.getDrawingDensity()==="soft"?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const g of this.app.getPageCollection().getPages())g!==this.leftPage&&g!==this.rightPage&&g!==this.flippingPage&&g!==this.bottomPage&&(g.getElement().style.cssText="display: none"),g.getTemporaryCopy()!==this.flippingPage&&g.hideTemporaryCopy()}update(){super.update(),this.rightPage!==null&&this.rightPage.setOrientation(1),this.leftPage!==null&&this.leftPage.setOrientation(0)}}class E{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(g){const w=this._default;if(Object.assign(w,g),w.size!=="stretch"&&w.size!=="fixed")throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(w.width<=0||w.height<=0)throw new Error("Invalid width or height");if(w.flippingTime<=0)throw new Error("Invalid flipping time");return w.size==="stretch"?(w.minWidth<=0&&(w.minWidth=100),w.maxWidth<w.minWidth&&(w.maxWidth=2e3),w.minHeight<=0&&(w.minHeight=100),w.maxHeight<w.minHeight&&(w.maxHeight=2e3)):(w.minWidth=w.width,w.maxWidth=w.width,w.minHeight=w.height,w.maxHeight=w.height),w}}(function(k,g){g===void 0&&(g={});var w=g.insertAt;if(typeof document<"u"){var _=document.head||document.getElementsByTagName("head")[0],P=document.createElement("style");P.type="text/css",w==="top"&&_.firstChild?_.insertBefore(P,_.firstChild):_.appendChild(P),P.styleSheet?P.styleSheet.cssText=k:P.appendChild(document.createTextNode(k))}})(`.stf__parent {
  position: relative;
  display: block;
  box-sizing: border-box;
  transform: translateZ(0);

  -ms-touch-action: pan-y;
  touch-action: pan-y;
}

.sft__wrapper {
  position: relative;
  width: 100%;
  box-sizing: border-box;
}

.stf__parent canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}

.stf__block {
  position: absolute;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  perspective: 2000px;
}

.stf__item {
  display: none;
  position: absolute;
  transform-style: preserve-3d;
}

.stf__outerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__innerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardInnerShadow {
  position: absolute;
  left: 0;
  top: 0;
}`),n.PageFlip=class extends class{constructor(){this.events=new Map}on(k,g){return this.events.has(k)?this.events.get(k).push(g):this.events.set(k,[g]),this}off(k){this.events.delete(k)}trigger(k,g,w=null){if(this.events.has(k))for(const _ of this.events.get(k))_({data:w,object:g})}}{constructor(k,g){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=new E().getSettings(g),this.block=k}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(k){this.ui=new v(this.block,this,this.setting);const g=this.ui.getCanvas();this.render=new p(this,this.setting,g),this.flipController=new h(this.render,this),this.pages=new o(this,this.render,k),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}loadFromHTML(k){this.ui=new y(this.block,this,this.setting,k),this.render=new S(this,this.setting,this.ui.getDistElement()),this.flipController=new h(this.render,this),this.pages=new c(this,this.render,this.ui.getDistElement(),k),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}updateFromImages(k){const g=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new o(this,this.render,k),this.pages.load(),this.pages.show(g),this.trigger("update",this,{page:g,mode:this.render.getOrientation()})}updateFromHtml(k){const g=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new c(this,this.render,this.ui.getDistElement(),k),this.pages.load(),this.ui.updateItems(k),this.render.reload(),this.pages.show(g),this.trigger("update",this,{page:g,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(k){this.pages.show(k)}flipNext(k="top"){this.flipController.flipNext(k)}flipPrev(k="top"){this.flipController.flipPrev(k)}flip(k,g="top"){this.flipController.flipToPage(k,g)}updateState(k){this.trigger("changeState",this,k)}updatePageIndex(k){this.trigger("flip",this,k)}updateOrientation(k){this.ui.setOrientationStyle(k),this.update(),this.trigger("changeOrientation",this,k)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(k){return this.pages.getPage(k)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(k){this.mousePosition=k,this.isUserTouch=!0,this.isUserMove=!1}userMove(k,g){this.isUserTouch||g||!this.setting.showPageCorners?this.isUserTouch&&a.GetDistanceBetweenTwoPoint(this.mousePosition,k)>5&&(this.isUserMove=!0,this.flipController.fold(k)):this.flipController.showCorner(k)}userStop(k,g=!1){this.isUserTouch&&(this.isUserTouch=!1,g||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(k)))}},Object.defineProperty(n,"__esModule",{value:!0})}))})(si,si.exports)),si.exports}var W4=V4();const z4=fe.forwardRef((t,e)=>{const n=x.useRef(null),r=x.useRef([]),s=x.useRef(),[i,o]=x.useState([]);x.useImperativeHandle(e,()=>({pageFlip:()=>s.current}));const a=x.useCallback(()=>{s.current&&s.current.clear()},[]),l=x.useCallback(()=>{const c=s.current;c&&(c.off("flip"),c.off("changeOrientation"),c.off("changeState"),c.off("init"),c.off("update"))},[]);return x.useEffect(()=>{if(r.current=[],t.children){const c=fe.Children.map(t.children,u=>fe.cloneElement(u,{ref:h=>{h&&r.current.push(h)}}));(!t.renderOnlyPageLengthChange||i.length!==c.length)&&(c.length<i.length&&a(),o(c))}},[t.children]),x.useEffect(()=>{const c=()=>{const u=s.current;u&&(t.onFlip&&u.on("flip",h=>t.onFlip(h)),t.onChangeOrientation&&u.on("changeOrientation",h=>t.onChangeOrientation(h)),t.onChangeState&&u.on("changeState",h=>t.onChangeState(h)),t.onInit&&u.on("init",h=>t.onInit(h)),t.onUpdate&&u.on("update",h=>t.onUpdate(h)))};i.length>0&&r.current.length>0&&(l(),n.current&&!s.current&&(s.current=new W4.PageFlip(n.current,t)),s.current.getFlipController()?s.current.updateFromHtml(r.current):s.current.loadFromHTML(r.current),c())},[i]),fe.createElement("div",{ref:n,className:t.className,style:t.style},i)}),H4=fe.memo(z4),Fc=x.forwardRef((t,e)=>d.jsx("div",{className:"page bg-white shadow-md h-full",ref:e,children:d.jsx("div",{className:"page-content h-full relative",children:t.children})}));function Q_({year:t,pages:e,onClose:n,readOnly:r=!1}){const{t:s}=Pe(),i=x.useRef(null),[o,a]=x.useState(0),[l,c]=x.useState(0);x.useEffect(()=>{a(e.length+1)},[e]);const u=m=>{c(m.data)},h=()=>{var m,y;(y=(m=i.current)==null?void 0:m.pageFlip())==null||y.flipNext()},f=()=>{var m,y;(y=(m=i.current)==null?void 0:m.pageFlip())==null||y.flipPrev()};x.useEffect(()=>{const m=y=>{y.key==="ArrowRight"&&h(),y.key==="ArrowLeft"&&f(),y.key==="Escape"&&n()};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[]);const p=(m,y)=>{var v;if(m.type==="cover")return d.jsxs("div",{className:"w-full h-full bg-blue-900 text-white flex flex-col items-center justify-center p-8 text-center relative overflow-hidden border-8 border-blue-950",children:[d.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/leather.png')] opacity-20 pointer-events-none"}),d.jsxs("div",{className:"z-10 border-4 border-amber-400/20 p-8 w-full h-full flex flex-col items-center justify-center",children:[d.jsx("div",{className:"text-amber-400 tracking-[0.3em] uppercase text-sm mb-4",children:s("print.theYearOf")||"The Year Of"}),d.jsx("h1",{className:"text-6xl font-serif font-bold text-amber-100 mb-8",children:t}),d.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-amber-100/30 overflow-hidden mb-8",children:d.jsx("img",{src:m.coverPhoto||"https://images.unsplash.com/photo-1511895426328-dc8714191300?w=400&auto=format&fit=crop&q=60",className:"w-full h-full object-cover"})}),d.jsx("p",{className:"text-xl font-light italic text-amber-200",children:m.subtitle})]})]});if(m.type==="intro")return d.jsxs("div",{className:"w-full h-full bg-[#fdfbf7] p-12 flex flex-col items-center justify-center text-center",children:[d.jsx("h2",{className:"text-3xl font-serif text-gray-800 mb-6",children:s("print.introduction")||"Introduction"}),d.jsx("p",{className:"text-lg text-gray-600 italic leading-relaxed max-w-md",children:m.text}),d.jsx("div",{className:"mt-auto text-xs text-gray-400",children:y+1})]});if(m.type==="entry")return d.jsxs("div",{className:"w-full h-full bg-[#fdfbf7] p-8 flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-baseline border-b border-gray-200 pb-4 mb-6",children:[d.jsx("h3",{className:"text-xl font-bold text-gray-900",children:m.date?xe(new Date(m.date),"MMMM d"):""}),d.jsx("span",{className:"text-xs text-gray-500 uppercase",children:m.location})]}),d.jsx("div",{className:"w-full aspect-video bg-gray-100 mb-6 rounded-lg overflow-hidden shadow-sm",children:d.jsx("img",{src:m.photo,className:"w-full h-full object-cover"})}),d.jsx("p",{className:"text-gray-700 font-serif leading-relaxed line-clamp-6",children:m.caption}),d.jsxs("div",{className:"mt-auto pt-4 flex justify-between items-center",children:[d.jsxs("span",{className:"text-xs bg-gray-100 px-3 py-1 rounded-full text-gray-500",children:["Mood: ",m.mood]}),d.jsx("span",{className:"text-xs text-gray-400",children:y+1})]})]});if(m.type==="grid")return d.jsxs("div",{className:"w-full h-full bg-[#fdfbf7] p-8 flex flex-col",children:[d.jsx("div",{className:`grid gap-4 flex-1 content-start ${m.layout==="grid-4"?"grid-cols-2 grid-rows-2":"grid-cols-2"}`,children:(v=m.entries)==null?void 0:v.map((S,E)=>d.jsxs("div",{className:"relative group rounded-lg overflow-hidden shadow-sm aspect-square bg-gray-100",children:[d.jsx("img",{src:S.photo,className:"w-full h-full object-cover"}),d.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-end p-2",children:d.jsx("span",{className:"text-xs text-white opacity-0 group-hover:opacity-100 truncate w-full",children:S.caption})})]},E))}),d.jsx("div",{className:"mt-auto text-right text-xs text-gray-400 pt-4",children:y+1})]});if(m.type==="collage"){const S=m.entries||[],E=S[0],k=S.slice(1);return d.jsxs("div",{className:"w-full h-full bg-[#fdfbf7] p-0 flex flex-col relative overflow-hidden",children:[d.jsxs("div",{className:"h-1/2 w-full relative",children:[d.jsx("img",{src:E==null?void 0:E.photo,className:"w-full h-full object-cover"}),d.jsx("div",{className:"absolute bottom-0 left-0 bg-white px-4 py-2 rounded-tr-xl",children:d.jsx("span",{className:"font-serif italic text-lg",children:E!=null&&E.date?xe(new Date(E.date),"MMM d"):""})})]}),d.jsxs("div",{className:"flex-1 p-6 flex gap-4",children:[d.jsx("div",{className:"flex-1 space-y-4",children:d.jsx("p",{className:"text-sm font-serif leading-relaxed text-gray-600 first-letter:text-3xl first-letter:font-bold first-letter:float-left first-letter:mr-2 first-letter:text-gray-900",children:m.caption})}),d.jsx("div",{className:"w-1/3 flex flex-col gap-2",children:k.map((g,w)=>d.jsx("div",{className:"flex-1 bg-gray-100 rounded-lg overflow-hidden",children:d.jsx("img",{src:g.photo,className:"w-full h-full object-cover"})},w))})]}),d.jsx("div",{className:"absolute bottom-4 right-6 text-xs text-gray-400",children:y+1})]})}return m.type==="outro"?d.jsxs("div",{className:"w-full h-full bg-[#fdfbf7] p-12 flex flex-col items-center justify-center text-center",children:[d.jsx("p",{className:"text-xl font-serif italic text-gray-500",children:m.text}),d.jsx("div",{className:"mt-auto text-xs text-gray-400",children:y+1})]}):null};return d.jsxs("div",{className:"fixed inset-0 z-50 bg-gray-900/95 backdrop-blur-md flex items-center justify-center p-4 overflow-hidden",children:[d.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-white/50 hover:text-white z-50",children:d.jsx(Ct,{className:"w-8 h-8"})}),d.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:d.jsxs(H4,{width:450,height:600,size:"stretch",minWidth:300,maxWidth:600,minHeight:400,maxHeight:800,maxShadowOpacity:.5,showCover:!0,mobileScrollSupport:!0,className:"shadow-2xl",ref:i,onFlip:u,children:[d.jsx(Fc,{children:p(e[0],0)}),e.slice(1).map((m,y)=>d.jsx(Fc,{children:p(m,y+1)},y)),d.jsx(Fc,{children:d.jsxs("div",{className:"w-full h-full bg-blue-900 text-white flex flex-col items-center justify-center border-8 border-blue-950 relative",children:[d.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/leather.png')] opacity-20 pointer-events-none"}),d.jsxs("div",{className:"z-10 text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx(Un,{className:"w-8 h-8 text-amber-100"})}),d.jsx("p",{className:"text-sm opacity-60",children:"The End"}),d.jsx("p",{className:"text-xs opacity-40 mt-2",children:"www.photodiary.com"})]})]})})]})}),d.jsx("div",{className:"absolute bottom-8 text-white/50 text-sm bg-black/50 px-4 py-2 rounded-full pointer-events-none",children:s("print.flipInstruction")||"Use Arrow Keys or Click Corners to Flip"})]})}function r0(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function K4(...t){return e=>{let n=!1;const r=t.map(s=>{const i=r0(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():r0(t[s],null)}}}}function Z_(...t){return x.useCallback(K4(...t),t)}function G4(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,q4(s,...e)]}function q4(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function s0(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function e1(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Y4({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=J4({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,a=e1(n),l=x.useCallback(c=>{if(i){const h=typeof c=="function"?c(t):c;h!==t&&a(h)}else s(c)},[i,t,s,a]);return[o,l]}function J4({defaultProp:t,onChange:e}){const n=x.useState(t),[r]=n,s=x.useRef(r),i=e1(e);return x.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function X4(t){const e=x.useRef({value:t,previous:t});return x.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var i0=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{};function Q4(t,e){return x.useReducer((n,r)=>e[n][r]??n,t)}var t1=t=>{const{present:e,children:n}=t,r=Z4(e),s=typeof n=="function"?n({present:r.isPresent}):x.Children.only(n),i=Z_(r.ref,eF(s));return typeof n=="function"||r.isPresent?x.cloneElement(s,{ref:i}):null};t1.displayName="Presence";function Z4(t){const[e,n]=x.useState(),r=x.useRef({}),s=x.useRef(t),i=x.useRef("none"),o=t?"mounted":"unmounted",[a,l]=Q4(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const c=Do(r.current);i.current=a==="mounted"?c:"none"},[a]),i0(()=>{const c=r.current,u=s.current;if(u!==t){const f=i.current,p=Do(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),i0(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const y=Do(r.current).includes(p.animationName);if(p.target===e&&y&&(l("ANIMATION_END"),!s.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(i.current=Do(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:x.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function Do(t){return(t==null?void 0:t.animationName)||"none"}function eF(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var tF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],n1=tF.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{}),pf="Checkbox",[nF]=G4(pf),[rF,sF]=nF(pf),r1=x.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...h}=t,[f,p]=x.useState(null),m=Z_(e,g=>p(g)),y=x.useRef(!1),v=f?u||!!f.closest("form"):!0,[S=!1,E]=Y4({prop:s,defaultProp:i,onChange:c}),k=x.useRef(S);return x.useEffect(()=>{const g=f==null?void 0:f.form;if(g){const w=()=>E(k.current);return g.addEventListener("reset",w),()=>g.removeEventListener("reset",w)}},[f,E]),d.jsxs(rF,{scope:n,state:S,disabled:a,children:[d.jsx(n1.button,{type:"button",role:"checkbox","aria-checked":Vn(S)?"mixed":S,"aria-required":o,"data-state":o1(S),"data-disabled":a?"":void 0,disabled:a,value:l,...h,ref:m,onKeyDown:s0(t.onKeyDown,g=>{g.key==="Enter"&&g.preventDefault()}),onClick:s0(t.onClick,g=>{E(w=>Vn(w)?!0:!w),v&&(y.current=g.isPropagationStopped(),y.current||g.stopPropagation())})}),v&&d.jsx(iF,{control:f,bubbles:!y.current,name:r,value:l,checked:S,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Vn(i)?!1:i})]})});r1.displayName=pf;var s1="CheckboxIndicator",i1=x.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=sF(s1,n);return d.jsx(t1,{present:r||Vn(i.state)||i.state===!0,children:d.jsx(n1.span,{"data-state":o1(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});i1.displayName=s1;var iF=t=>{const{control:e,checked:n,bubbles:r=!0,defaultChecked:s,...i}=t,o=x.useRef(null),a=X4(n),l=hv(e);x.useEffect(()=>{const u=o.current,h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(a!==n&&p){const m=new Event("click",{bubbles:r});u.indeterminate=Vn(n),p.call(u,Vn(n)?!1:n),u.dispatchEvent(m)}},[a,n,r]);const c=x.useRef(Vn(n)?!1:n);return d.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??c.current,...i,tabIndex:-1,ref:o,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Vn(t){return t==="indeterminate"}function o1(t){return Vn(t)?"indeterminate":t?"checked":"unchecked"}var oF=r1,aF=i1;function lF({className:t,...e}){return d.jsx(oF,{"data-slot":"checkbox",className:dt("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...e,children:d.jsx(aF,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:d.jsx(Et,{className:"size-3.5"})})})}function cF({entries:t=[]}){var z;const{t:e}=Pe(),[n,r]=yk(),[s,i]=x.useState(()=>{const U=n.get("year");if(U)return U;try{return new Date().getFullYear().toString()}catch{return"2025"}}),[o,a]=x.useState(()=>n.get("style")||"classic"),[l,c]=x.useState(!1),[u,h]=x.useState(()=>n.get("mode")==="preview"),[f,p]=x.useState(!1),[m,y]=x.useState(!1),[v,S]=x.useState(null),[E,k]=x.useState(!1),[g,w]=x.useState([]),[_,P]=x.useState(new Set),[b,C]=x.useState(null);x.useEffect(()=>{const U=new URLSearchParams(n);U.set("year",s),U.set("style",o),u?U.set("mode","preview"):U.delete("mode"),r(U,{replace:!0})},[s,o,u]);const A=x.useMemo(()=>Array.isArray(t)?t:[],[t]),N=x.useMemo(()=>{try{const U=new Set(A.filter(W=>W&&W.date&&typeof W.date=="string"&&!isNaN(new Date(W.date).getTime())).map(W=>new Date(W.date).getFullYear().toString())),V=Array.from(U).sort().reverse();return V.length===0?[new Date().getFullYear().toString()]:V}catch(U){return console.error("Error calculating years:",U),[new Date().getFullYear().toString()]}},[A]),O=x.useMemo(()=>A.filter(U=>{try{return!U||!U.date?!1:new Date(U.date).getFullYear().toString()===s}catch{return!1}}),[A,s]);x.useEffect(()=>{w(O),P(new Set),C(null)},[O]);const I=x.useMemo(()=>g.filter(U=>!_.has(U.id)),[g,_]),T=x.useMemo(()=>{if(I.length===0)return[];const U=T4(I,s,o,e);return b&&U.length>0&&U[0].type==="cover"&&(U[0].coverPhoto=b),U},[I,s,o,e,b]),M=I.reduce((U,V)=>U+(V!=null&&V.photo?1:0),0),R=M>0?M:0,j=T.length,D=async()=>{try{p(!0),c(!0)}catch(U){console.error(U),le.error(e("common.error"))}finally{p(!1)}},$=async()=>{p(!0),le.loading(e("print.generating"),{id:"pdf-gen"});try{(await R4(T,s,e,V=>{le.loading(`${e("print.generating")} (${Math.round(V*100)}%)`,{id:"pdf-gen"})})).save(`PhotoDiary-${s}-${o}.pdf`),le.success(e("common.success"),{id:"pdf-gen"}),c(!1)}catch(U){console.error(U),le.error(e("export.failed"),{id:"pdf-gen"})}finally{p(!1)}},F=async()=>{try{y(!0),le.loading(e("print.sharing")||"Publishing book...",{id:"share-book"});const U=await F4(s,o,T),V=`${window.location.origin}/share/book/${U.id}`;navigator.clipboard.writeText(V).then(()=>{le.success(e("print.linkCopied")||"Link copied!",{id:"share-book",duration:4e3})}),c(!1)}catch(U){console.error(U),le.error(e("common.error")||"Failed to share",{id:"share-book"})}finally{y(!1)}},K=U=>{const V=new Set(_);V.has(U)?V.delete(U):V.add(U),P(V)};return v?d.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-red-500 p-4",children:[d.jsx(F0,{className:"w-12 h-12 mb-4"}),d.jsx("h3",{className:"text-lg font-bold",children:"Something went wrong"}),d.jsx("p",{className:"text-sm",children:v}),d.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-100 rounded-lg hover:bg-red-200",children:"Reload Page"})]}):d.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 relative",children:[E&&d.jsxs("div",{className:"fixed inset-0 z-50 bg-white dark:bg-gray-900 flex flex-col animate-in fade-in slide-in-from-bottom-10 duration-300",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-800 bg-white dark:bg-gray-900 shadow-sm z-10",children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[d.jsx(_f,{className:"w-5 h-5 text-blue-600"}),e("print.editorTitle")||"Customize Book Content"]}),d.jsxs("p",{className:"text-sm text-gray-500",children:[I.length," photos selected"]})]}),d.jsx("div",{className:"flex gap-2",children:d.jsx("button",{onClick:()=>k(!1),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:e("common.done")||"Done"})})]}),d.jsx("div",{className:"flex-1 flex overflow-hidden",children:d.jsx("div",{className:"flex-1 overflow-y-auto p-8 bg-gray-50 dark:bg-gray-900/50",children:d.jsxs("div",{className:"max-w-3xl mx-auto",children:[d.jsx("div",{className:"mb-4 flex items-center justify-between text-sm text-gray-500",children:d.jsx("span",{children:"Drag to reorder  Uncheck to remove"})}),d.jsx(p4,{axis:"y",values:g,onReorder:w,className:"space-y-3",children:g.map(U=>d.jsxs(_4,{value:U,className:"bg-white dark:bg-gray-800 p-3 rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm flex items-center gap-4 group cursor-grab active:cursor-grabbing",children:[d.jsx("div",{className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600",children:d.jsx(Z1,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[d.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0",children:U.photo&&d.jsx("img",{src:U.photo,className:`w-full h-full object-cover transition-opacity ${_.has(U.id)?"opacity-30 grayscale":""}`})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"font-medium truncate text-gray-900 dark:text-gray-100",children:xe(new Date(U.date),"MMM d, yyyy")}),d.jsx("div",{className:"text-sm text-gray-500 truncate",children:U.caption||"No caption"})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:()=>C(U.photo),className:`p-2 rounded-lg text-xs font-medium transition-colors ${b===U.photo?"bg-amber-100 text-amber-700":"text-gray-400 hover:bg-gray-100"}`,title:"Set as Cover Photo",children:d.jsx(kf,{className:"w-4 h-4"})}),d.jsx(lF,{checked:!_.has(U.id),onCheckedChange:()=>K(U.id)})]})]},U.id))})]})})})]}),d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("h1",{className:"text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-amber-600 to-orange-600 dark:from-amber-400 dark:to-orange-400",children:e("print.title")}),d.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:e("print.subtitle")})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[d.jsxs("div",{className:"relative group perspective-1000 cursor-pointer",onClick:()=>h(!0),children:[d.jsxs("div",{className:"relative w-80 h-[480px] mx-auto transition-transform duration-700 transform-style-3d rotate-y-12 group-hover:rotate-y-0 group-hover:scale-105",children:[d.jsxs("div",{className:"absolute inset-0 bg-blue-900 rounded-r-lg shadow-2xl flex flex-col items-center justify-center p-8 text-center text-white backface-hidden z-20 border-l-4 border-l-gray-800",children:[d.jsxs("div",{className:"w-full h-full border-2 border-amber-400/30 p-6 flex flex-col items-center relative overflow-hidden",children:[d.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/leather.png')] opacity-20 pointer-events-none"}),d.jsx("div",{className:"mt-8 text-xs tracking-[0.2em] text-amber-400 uppercase relative z-10",children:e("print.yearBook")}),d.jsx("div",{className:"mt-4 text-6xl font-serif font-bold text-amber-100 relative z-10",children:s}),d.jsxs("div",{className:"mt-auto mb-12 space-y-2 relative z-10 w-full",children:[d.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 overflow-hidden border-4 border-white/20 mx-auto shadow-inner flex items-center justify-center relative",children:(z=O[0])!=null&&z.photo?d.jsx(Ot,{src:O[0].photo,alt:"Cover",className:"w-full h-full object-cover opacity-80"}):d.jsx(Ot,{src:"https://images.unsplash.com/photo-1511895426328-dc8714191300?w=400&auto=format&fit=crop&q=60",alt:"Default Cover",className:"w-full h-full object-cover opacity-80"})}),d.jsx("p",{className:"font-serif text-lg italic text-amber-100/80",children:e("print.myPhotoDiary")})]})]}),d.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-4 bg-gradient-to-r from-gray-900 to-transparent opacity-50"})]}),d.jsx("div",{className:"absolute right-0 top-2 bottom-2 w-12 bg-white transform rotate-y-90 origin-right translate-x-full shadow-inner flex flex-col justify-between py-1",children:[...Array(20)].map((U,V)=>d.jsx("div",{className:"h-px bg-gray-200 w-full"},V))}),d.jsx("div",{className:"absolute inset-0 bg-blue-900 rounded-l-lg transform translate-z-[-40px] shadow-xl"})]}),d.jsx("div",{className:"absolute bottom-[-40px] left-1/2 -translate-x-1/2 w-64 h-8 bg-black/20 blur-xl rounded-[100%] transition-all duration-700 group-hover:scale-110 group-hover:bg-black/30"}),d.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none z-30",children:d.jsxs("div",{className:"bg-black/50 text-white px-4 py-2 rounded-full backdrop-blur-sm flex items-center gap-2",children:[d.jsx(Un,{className:"w-4 h-4"}),d.jsx("span",{children:e("print.clickToPreview")})]})})]}),d.jsxs("div",{className:"space-y-8 bg-white dark:bg-gray-800 p-8 rounded-3xl shadow-lg border border-gray-100 dark:border-gray-700",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-2xl",children:[d.jsxs("div",{className:"flex items-center gap-2 text-orange-600 dark:text-orange-400 mb-1",children:[d.jsx(ws,{className:"w-4 h-4"}),d.jsx("span",{className:"text-xs font-bold uppercase",children:e("print.photos")})]}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:R})]}),d.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-2xl",children:[d.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 mb-1",children:[d.jsx(zc,{className:"w-4 h-4"}),d.jsx("span",{className:"text-xs font-bold uppercase",children:e("print.pages")})]}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:j})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e("print.selectYear")}),d.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(U=>d.jsx("button",{onClick:()=>i(U),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${s===U?"bg-gray-900 dark:bg-white text-white dark:text-gray-900 shadow-md":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200"}`,children:U},U))})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e("print.content")||"Content"}),d.jsxs("button",{onClick:()=>k(!0),className:"text-sm text-blue-600 font-medium hover:text-blue-700 flex items-center gap-1",children:[d.jsx(_f,{className:"w-3 h-3"}),e("print.customize")||"Customize"]})]}),d.jsxs("div",{className:"p-4 rounded-xl border border-gray-200 bg-gray-50 dark:bg-gray-800 dark:border-gray-700 flex items-center justify-between",children:[d.jsxs("div",{className:"text-sm",children:[d.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:I.length})," photos selected"]}),b&&d.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded-md",children:[d.jsx(kf,{className:"w-3 h-3"}),"Custom Cover"]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e("print.layoutStyle")}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("button",{onClick:()=>a("classic"),className:`p-3 rounded-lg border text-sm flex items-center gap-2 ${o==="classic"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:bg-gray-50"}`,children:[d.jsx("div",{className:"w-4 h-4 border border-current rounded-sm"}),e("print.styles.classic")]}),d.jsxs("button",{onClick:()=>a("grid"),className:`p-3 rounded-lg border text-sm flex items-center gap-2 ${o==="grid"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:bg-gray-50"}`,children:[d.jsxs("div",{className:"w-4 h-4 border border-current rounded-sm grid grid-cols-2 gap-[1px] p-[1px]",children:[d.jsx("div",{className:"bg-current"}),d.jsx("div",{className:"bg-current"}),d.jsx("div",{className:"bg-current"}),d.jsx("div",{className:"bg-current"})]}),e("print.styles.grid")]}),d.jsxs("button",{onClick:()=>a("magazine"),className:`p-3 rounded-lg border text-sm flex items-center gap-2 ${o==="magazine"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:bg-gray-50"}`,children:[d.jsx(ek,{className:"w-4 h-4"}),e("print.styles.magazine")]}),d.jsxs("button",{onClick:()=>a("minimal"),className:`p-3 rounded-lg border text-sm flex items-center gap-2 ${o==="minimal"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:bg-gray-50"}`,children:[d.jsx("div",{className:"w-4 h-4 border border-current rounded-sm flex items-center justify-center",children:d.jsx("div",{className:"w-2 h-2 bg-current rounded-full"})}),e("print.styles.minimal")]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:e("print.format")}),d.jsxs("div",{className:"p-4 rounded-xl border-2 border-blue-500 bg-blue-50 dark:bg-blue-900/20 relative",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[d.jsx(zc,{className:"w-4 h-4 text-blue-500"}),e("print.photobook")]}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e("print.formatDesc")})]}),d.jsx("div",{className:"text-right",children:d.jsx("div",{className:"font-bold text-green-600 text-lg",children:e("print.free")})})]}),d.jsx("div",{className:"absolute top-2 right-2 text-blue-500 opacity-0",children:d.jsx(Et,{className:"w-4 h-4"})})]})]})]}),d.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-700 pt-6",children:[d.jsxs("button",{onClick:D,disabled:f,className:"w-full py-4 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl font-bold text-lg shadow-xl hover:shadow-2xl hover:scale-[1.02] transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[f?d.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}):d.jsx(bi,{className:"w-5 h-5"}),e("print.checkout")]}),d.jsxs("p",{className:"text-center text-xs text-gray-400 mt-3 flex items-center justify-center gap-1",children:[d.jsx(tk,{className:"w-3 h-3"}),"Free digital download & print-ready PDF"]})]})]})]}),d.jsx(dh,{open:l,onOpenChange:c,children:d.jsxs(hh,{children:[d.jsxs(fh,{children:[d.jsxs(mh,{className:"flex items-center gap-2 text-green-600",children:[d.jsx(Et,{className:"w-6 h-6"}),e("print.successTitle")]}),d.jsx(gh,{children:e("print.successDesc")})]}),d.jsxs(ph,{className:"sm:justify-center gap-2 flex-col sm:flex-row",children:[d.jsxs("button",{onClick:$,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[d.jsx(Ja,{className:"w-4 h-4"}),e("print.downloadPDF")]}),d.jsxs("button",{onClick:F,disabled:m,className:"flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors w-full sm:w-auto",children:[m?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):d.jsx(U0,{className:"w-4 h-4"}),e("print.shareOnline")||"Share Online"]}),d.jsxs("button",{onClick:()=>{const U=new URL(window.location.href);U.searchParams.set("year",s),U.searchParams.set("style",o),U.searchParams.set("mode","preview"),navigator.clipboard.writeText(U.toString()).then(()=>{le.success(e("print.linkCopiedLocal")||"Local Link Copied",{icon:"",duration:4e3})}).catch(()=>{le.error(e("common.error"))}),c(!1)},className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors w-full sm:w-auto",children:[d.jsx(Ya,{className:"w-4 h-4"}),e("print.shareLinkLocal")||"Local Link"]})]})]})}),u&&d.jsx(Q_,{year:s,pages:T,onClose:()=>h(!1)})]})}const a1=x.createContext(void 0);function uF({children:t}){const{user:e}=Ps(),[n,r]=x.useState([]),[s,i]=x.useState([]);x.useEffect(()=>{if(!e)return;const h=async()=>{const{data:p,error:m}=await ye.from("friend_requests").select(`
          id,
          status,
          created_at,
          sender:sender_id (id, full_name, email, avatar_url)
        `).eq("receiver_id",e.id).eq("status","pending");p&&i(p.map(S=>({id:S.id,from:{id:S.sender.id,name:S.sender.full_name||"Unknown",email:S.sender.email||"",avatar:S.sender.avatar_url},toId:e.id,status:S.status,date:S.created_at})));const{data:y,error:v}=await ye.from("friend_requests").select(`
          sender_id,
          receiver_id,
          sender:sender_id (id, full_name, email, avatar_url),
          receiver:receiver_id (id, full_name, email, avatar_url)
        `).or(`sender_id.eq.${e.id},receiver_id.eq.${e.id}`).eq("status","accepted");if(y){const S=y.map(k=>{const w=k.sender_id===e.id?k.receiver:k.sender;return{id:w.id,name:w.full_name||"Unknown",email:w.email||"",avatar:w.avatar_url}}),E=Array.from(new Map(S.map(k=>[k.id,k])).values());r(E)}};h();const f=ye.channel("friend_changes").on("postgres_changes",{event:"*",schema:"public",table:"friend_requests"},()=>{h()}).subscribe();return()=>{f.unsubscribe()}},[e]);const o=async h=>{if(!e)return!1;const{data:f,error:p}=await ye.from("profiles").select("id").ilike("email",h).single();if(!f)return alert("User not found."),!1;if(f.id===e.id)return alert("You cannot add yourself."),!1;const{data:m}=await ye.from("friend_requests").select("id, status").or(`and(sender_id.eq.${e.id},receiver_id.eq.${f.id}),and(sender_id.eq.${f.id},receiver_id.eq.${e.id})`).single();if(m)return m.status==="accepted"?alert("Already friends!"):m.status==="pending"?alert("Request already pending."):alert("Request was previously rejected."),!1;const{error:y}=await ye.from("friend_requests").insert({sender_id:e.id,receiver_id:f.id,status:"pending"});return y?(console.error(y),alert("Failed to send request."),!1):(alert("Friend request sent!"),!0)},a=async h=>{await ye.from("friend_requests").update({status:"accepted"}).eq("id",h)},l=async h=>{await ye.from("friend_requests").update({status:"rejected"}).eq("id",h)},c=async h=>{e&&(await ye.from("friend_requests").delete().or(`and(sender_id.eq.${e.id},receiver_id.eq.${h}),and(sender_id.eq.${h},receiver_id.eq.${e.id})`),r(f=>f.filter(p=>p.id!==h)))},u=async h=>{const{data:f}=await ye.from("profiles").select("id, full_name, email, avatar_url").or(`full_name.ilike.%${h}%,email.ilike.%${h}%`).limit(5);return(f||[]).map(p=>({id:p.id,name:p.full_name||"Unknown",email:p.email||"",avatar:p.avatar_url}))};return d.jsx(a1.Provider,{value:{friends:n,friendRequests:s,sendFriendRequest:o,acceptFriendRequest:a,rejectFriendRequest:l,removeFriend:c,searchUsers:u},children:t})}function dF(){const t=x.useContext(a1);if(t===void 0)throw new Error("useFriend must be used within a FriendProvider");return t}const hF=[{id:"first-step",title:"First Memory",description:"Create your first diary entry",icon:ws,color:"text-blue-500 bg-blue-100",condition:t=>t.length>=1,progress:t=>Math.min(t.length,1),maxProgress:1},{id:"streak-7",title:"Week Warrior",description:"Post consecutively for 7 days",icon:D0,color:"text-orange-500 bg-orange-100",condition:t=>o0(t)>=7,progress:t=>Math.min(o0(t),7),maxProgress:7},{id:"mood-explorer",title:"Emotional Spectrum",description:"Log 5 different moods",icon:_d,color:"text-purple-500 bg-purple-100",condition:t=>new Set(t.map(e=>e.mood)).size>=5,progress:t=>Math.min(new Set(t.map(e=>e.mood)).size,5),maxProgress:5},{id:"globetrotter",title:"Globetrotter",description:"Post from 3 different locations",icon:vs,color:"text-green-500 bg-green-100",condition:t=>new Set(t.filter(e=>e.location).map(e=>{var n;return((n=e.location)==null?void 0:n.name)||""})).size>=3,progress:t=>Math.min(new Set(t.filter(e=>e.location).map(e=>{var n;return((n=e.location)==null?void 0:n.name)||""})).size,3),maxProgress:3},{id:"month-master",title:"Dedicated Diarist",description:"Reach 30 total entries",icon:Wc,color:"text-yellow-500 bg-yellow-100",condition:t=>t.length>=30,progress:t=>Math.min(t.length,30),maxProgress:30},{id:"early-bird",title:"Early Bird",description:"Post an entry before 8 AM",icon:bs,color:"text-sky-500 bg-sky-100",condition:t=>t.some(e=>new Date(e.date).getHours()<8),progress:t=>t.some(e=>new Date(e.date).getHours()<8)?1:0,maxProgress:1}];function o0(t){if(t.length===0)return 0;const e=[...t].sort((a,l)=>new Date(l.date).getTime()-new Date(a.date).getTime());let n=0;const r=new Date;r.setHours(0,0,0,0);let s=new Date(e[0].date);s.setHours(0,0,0,0);const i=Math.abs(r.getTime()-s.getTime());if(Math.ceil(i/(1e3*60*60*24))>1)return 0;n=1;for(let a=0;a<e.length-1;a++){const l=new Date(e[a].date);l.setHours(0,0,0,0);const c=new Date(e[a+1].date);c.setHours(0,0,0,0);const u=(l.getTime()-c.getTime())/(1e3*3600*24);if(u===1)n++;else if(u>1)break}return n}function fF({entries:t}){return d.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[d.jsx("div",{className:"flex items-center justify-between mb-6",children:d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Achievements"}),d.jsx("p",{className:"text-sm text-gray-500",children:"Unlock badges by recording your life."})]})}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:hF.map(e=>{const n=e.condition(t),r=e.progress(t),s=Math.round(r/e.maxProgress*100),i=e.icon;return d.jsxs("div",{className:`relative p-5 rounded-2xl border transition-all duration-300 overflow-hidden group ${n?"border-blue-100 bg-gradient-to-br from-white to-blue-50/50 shadow-sm hover:shadow-xl hover:scale-[1.02] hover:border-blue-200":"border-gray-100 bg-gray-50/50 opacity-80"}`,children:[n&&d.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent -translate-x-full group-hover:animate-shine z-0"}),d.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[d.jsx("div",{className:`p-3.5 rounded-2xl shadow-sm transition-transform group-hover:scale-110 duration-300 ${n?`${e.color} shadow-blue-100 ring-2 ring-white`:"bg-gray-100 text-gray-400"}`,children:n?d.jsx(i,{className:"w-6 h-6"}):d.jsx(vd,{className:"w-6 h-6"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h4",{className:`font-bold text-sm mb-0.5 truncate pr-2 ${n?"text-gray-900":"text-gray-500"}`,children:e.title}),n&&d.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 bg-green-100 text-green-700 rounded-full shrink-0",children:"Unlocked"})]}),d.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 h-8 leading-4",children:e.description}),d.jsxs("div",{className:"mt-3",children:[d.jsxs("div",{className:"flex justify-between text-[10px] font-medium mb-1.5 text-gray-400",children:[d.jsx("span",{children:"Progress"}),d.jsxs("span",{className:n?"text-blue-600":"",children:[Math.round(s),"%"]})]}),d.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2 overflow-hidden shadow-inner",children:d.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out relative ${n?"bg-gradient-to-r from-blue-500 to-indigo-500":"bg-gray-300"}`,style:{width:`${s}%`},children:n&&d.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})})]})]})]})]},e.id)})}),d.jsx("style",{children:`
        @keyframes shine {
          0% { transform: translateX(-150%) skewX(-20deg); }
          50% { transform: translateX(150%) skewX(-20deg); }
          100% { transform: translateX(150%) skewX(-20deg); }
        }
        .animate-shine {
          animation: shine 1.5s ease-in-out infinite;
        }
      `})]})}const Il=`${Py}/functions/v1/make-server-9fe38dad`;async function Ml(){const{data:{session:t}}=await ye.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${(t==null?void 0:t.access_token)||Ay}`}}async function l1(){try{const t=await Ml(),e=await fetch(`${Il}/entries`,{headers:t});if(!e.ok){const n=await e.json();throw console.error("Error fetching entries:",n),new Error("Failed to fetch entries")}return await e.json()}catch(t){throw console.error("Error fetching entries:",t),t}}async function a0(t){try{const e=await Ml(),n=await fetch(`${Il}/entries`,{method:"POST",headers:e,body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw console.error("Error creating entry:",r),new Error("Failed to create entry")}return await n.json()}catch(e){throw console.error("Error creating entry:",e),e}}async function l0(t,e){try{const n=await Ml(),r=await fetch(`${Il}/entries/${t}`,{method:"PUT",headers:n,body:JSON.stringify(e)});if(!r.ok){const s=await r.json();throw console.error("Error updating entry:",s),new Error("Failed to update entry")}return await r.json()}catch(n){throw console.error("Error updating entry:",n),n}}async function c0(t){try{const e=await Ml(),n=await fetch(`${Il}/entries/${t}`,{method:"DELETE",headers:e});if(!n.ok){const r=await n.json();throw console.error("Error deleting entry:",r),new Error("Failed to delete entry")}}catch(e){throw console.error("Error deleting entry:",e),e}}function pF({isOpen:t,onClose:e,onProfileUpdate:n}){var k,g,w;const{t:r}=Pe(),{user:s}=Ps(),[i,o]=x.useState(!1),[a,l]=x.useState(""),[c,u]=x.useState(""),[h,f]=x.useState(""),[p,m]=x.useState(!1),y=x.useRef(null);x.useEffect(()=>{s&&t&&v()},[s,t]);async function v(){try{o(!0);const{data:_,error:P}=await ye.from("profiles").select("username, full_name, avatar_url").eq("id",s==null?void 0:s.id).single();P&&console.error("Error fetching profile:",P),_&&(l(_.username||""),u(_.full_name||""),f(_.avatar_url||""))}catch(_){console.error("Error fetching profile:",_)}finally{o(!1)}}async function S(){try{o(!0);const _={id:s==null?void 0:s.id,username:a,full_name:c,avatar_url:h,updated_at:new Date().toISOString()},{error:P}=await ye.from("profiles").upsert(_);if(P)throw P;le.success(r("profile.success")),n(),e()}catch(_){console.error("Error updating profile:",_);let P=_.message||r("profile.error");P.includes("schema cache")&&(P+=" (Database schema update required)"),le.error(P)}finally{o(!1)}}async function E(_){try{if(m(!0),!_.target.files||_.target.files.length===0)throw new Error(r("profile.uploadError"));const P=_.target.files[0],b=P.name.split(".").pop(),A=`${s==null?void 0:s.id}/${Date.now()}.${b}`,{error:N}=await ye.storage.from("avatars").upload(A,P,{cacheControl:"3600",upsert:!1});if(N)throw console.error("Upload error details:",N),N;const{data:O}=ye.storage.from("avatars").getPublicUrl(A);f(O.publicUrl)}catch(P){le.error(P.message)}finally{m(!1)}}return t?d.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-md shadow-xl border border-gray-100 dark:border-gray-700 animate-in fade-in zoom-in-95 duration-200",children:[d.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-gray-700",children:[d.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r("profile.title")}),d.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:d.jsx(Ct,{className:"w-5 h-5 text-gray-500"})})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"flex flex-col items-center gap-4",children:[d.jsxs("div",{className:"relative group",children:[d.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-700 border-4 border-white dark:border-gray-600 shadow-md",children:h?d.jsx("img",{src:h,alt:"Avatar",className:"w-full h-full object-cover"}):d.jsx("div",{className:"w-full h-full flex items-center justify-center text-3xl font-bold text-gray-400",children:((k=c==null?void 0:c[0])==null?void 0:k.toUpperCase())||((w=(g=s==null?void 0:s.email)==null?void 0:g[0])==null?void 0:w.toUpperCase())})}),d.jsx("button",{onClick:()=>{var _;return(_=y.current)==null?void 0:_.click()},disabled:p,className:"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full shadow-lg hover:bg-blue-700 transition-colors disabled:opacity-70",children:p?d.jsx(_t,{className:"w-4 h-4 animate-spin"}):d.jsx(ws,{className:"w-4 h-4"})}),d.jsx("input",{type:"file",ref:y,onChange:E,accept:"image/*",className:"hidden"})]}),d.jsx("p",{className:"text-sm text-gray-500",children:r("profile.changePhoto")})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.fullName")}),d.jsx("input",{type:"text",value:c,onChange:_=>u(_.target.value),className:"w-full px-4 py-2 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:r("profile.placeholderName")})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.username")}),d.jsx("input",{type:"text",value:a,onChange:_=>l(_.target.value.toLowerCase().replace(/\s/g,"")),className:"w-full px-4 py-2 rounded-xl border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 outline-none transition-all",placeholder:r("profile.placeholderUsername")}),d.jsx("p",{className:"text-xs text-gray-400 mt-1",children:r("profile.usernameHint")})]})]})]}),d.jsxs("div",{className:"p-6 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-3",children:[d.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:r("profile.cancel")}),d.jsxs("button",{onClick:S,disabled:i,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-70 shadow-sm shadow-blue-200",children:[i?d.jsx(_t,{className:"w-4 h-4 animate-spin"}):d.jsx(nk,{className:"w-4 h-4"}),r("profile.save")]})]})]})}):null}const{slice:mF,forEach:gF}=[];function yF(t){return gF.call(mF.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}function xF(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(t))}const u0=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,bF=function(t,e){const r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(e);let i=`${t}=${s}`;if(r.maxAge>0){const o=r.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(o)}`}if(r.domain){if(!u0.test(r.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${r.domain}`}if(r.path){if(!u0.test(r.path))throw new TypeError("option path is invalid");i+=`; Path=${r.path}`}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r.partitioned&&(i+="; Partitioned"),i},d0={create(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+n*60*1e3)),r&&(s.domain=r),document.cookie=bF(t,e,s)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){let s=n[r];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return s.substring(e.length,s.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var wF={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return d0.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:r,cookieDomain:s,cookieOptions:i}=e;n&&typeof document<"u"&&d0.create(n,t,r,s,i)}},vF={name:"querystring",lookup(t){var r;let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:s}=window.location;!window.location.search&&((r=window.location.hash)==null?void 0:r.indexOf("?"))>-1&&(s=window.location.hash.substring(window.location.hash.indexOf("?")));const o=s.substring(1).split("&");for(let a=0;a<o.length;a++){const l=o[a].indexOf("=");l>0&&o[a].substring(0,l)===e&&(n=o[a].substring(l+1))}}return n}},SF={name:"hash",lookup(t){var s;let{lookupHash:e,lookupFromHashIndex:n}=t,r;if(typeof window<"u"){const{hash:i}=window.location;if(i&&i.length>2){const o=i.substring(1);if(e){const a=o.split("&");for(let l=0;l<a.length;l++){const c=a[l].indexOf("=");c>0&&a[l].substring(0,c)===e&&(r=a[l].substring(c+1))}}if(r)return r;if(!r&&n>-1){const a=i.match(/\/([a-zA-Z-]*)/g);return Array.isArray(a)?(s=a[typeof n=="number"?n:0])==null?void 0:s.replace("/",""):void 0}}}return r}};let Gr=null;const h0=()=>{if(Gr!==null)return Gr;try{if(Gr=typeof window<"u"&&window.localStorage!==null,!Gr)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Gr=!1}return Gr};var _F={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&h0())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&h0()&&window.localStorage.setItem(n,t)}};let qr=null;const f0=()=>{if(qr!==null)return qr;try{if(qr=typeof window<"u"&&window.sessionStorage!==null,!qr)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{qr=!1}return qr};var kF={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&f0())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&f0()&&window.sessionStorage.setItem(n,t)}},CF={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:r,language:s}=navigator;if(n)for(let i=0;i<n.length;i++)e.push(n[i]);r&&e.push(r),s&&e.push(s)}return e.length>0?e:void 0}},EF={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const r=e||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(n=r.getAttribute("lang")),n}},PF={name:"path",lookup(t){var s;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(s=n[typeof e=="number"?e:0])==null?void 0:s.replace("/",""):void 0}},AF={name:"subdomain",lookup(t){var s,i;let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,r=typeof window<"u"&&((i=(s=window.location)==null?void 0:s.hostname)==null?void 0:i.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(r)return r[n]}};let c1=!1;try{document.cookie,c1=!0}catch{}const u1=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];c1||u1.splice(1,1);const jF=()=>({order:u1,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class d1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=yF(n,this.options||{},jF()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(wF),this.addDetector(vF),this.addDetector(_F),this.addDetector(kF),this.addDetector(CF),this.addDetector(EF),this.addDetector(PF),this.addDetector(AF),this.addDetector(SF)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return e.forEach(r=>{if(this.detectors[r]){let s=this.detectors[r].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(n=n.concat(s))}}),n=n.filter(r=>r!=null&&!xF(r)).map(r=>this.options.convertDetectedLanguage(r)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(r=>{this.detectors[r]&&this.detectors[r].cacheUserLanguage(e,this.options)}))}}d1.type="languageDetector";const NF={en:{translation:{nav:{timeline:"Timeline",calendar:"Calendar",map:"Map",couple:"Couple",milestones:"Life Milestones",insights:"Insights",print:"Print Shop",logs:"Logs",add:"New",account:"Profile"},map:{features:"Map Features",showHeatmap:"Show Heatmap",hideHeatmap:"Hide Heatmap",playRoute:"Play Travel Route",stopPlayback:"Stop Playback",traveling:"Traveling..."},milestones:{title:"Life Milestones",subtitle:"Level up your life, one memory at a time.",target:"Target",current:"Current",totalCompleted:"Total Completed",photo:{beginner:"Shutterbug",beginnerDesc:"Take your first 5 photos to unlock your journey.",master:"Lens Master",masterDesc:"Capture 50 moments. You are becoming a pro!"},fitness:{start:"Fitness Fanatic",startDesc:"Log 10 workouts. Keep moving!"},reading:{worm:"Bookworm",wormDesc:"Read 12 books. Knowledge is power."},viewGallery:"View Gallery",memories:"memories",noEntries:"No memories found",noEntriesDesc:"Start adding photos with relevant tags to fill this milestone!"},export:{button:"Export",pdf:"Export as PDF",json:"Export as JSON",exporting:"Exporting...",failed:"Export failed. Please try again.",success:"Export successful"},legal:{back:"Back",about:{title:"About Photo Diary",intro1:"Photo Diary was born from a simple belief: <strong>every moment matters.</strong>",intro2:"In this fast-paced world, days blend into weeks, and weeks into years. We often forget the small joysa perfect cup of coffee, a beautiful sunset, a laugh shared with a friend. Photo Diary is designed to help you pause, capture, and cherish these fleeting moments.",missionTitle:"Our Mission",missionText:"To provide a private, beautiful, and intelligent space for you to document your life's journey. We believe that by reflecting on our past, we can live more fully in the present."},privacy:{title:"Privacy Policy",lastUpdated:"Last updated: January 2026",intro:"At Photo Diary, we take your privacy seriously. Your memories are personal, and they should stay that way.",collectionTitle:"1. Data Collection",collectionText:"We only collect the information necessary to provide our service: your photos, diary entries, and basic account information. We do not sell your personal data to third parties.",aiTitle:"2. AI Features",aiText:"Our AI features (Smart Tags, Insights) process your data to provide you with better experience. For image recognition, we use local browser-based models where possible to minimize data transmission."},terms:{title:"Terms of Service",lastUpdated:"Last updated: January 2026",acceptanceTitle:"1. Acceptance of Terms",acceptanceText:"By accessing and using Photo Diary, you accept and agree to be bound by the terms and provision of this agreement.",conductTitle:"2. User Conduct",conductText:"You agree to use the service only for lawful purposes. You are responsible for all content you post and activity that occurs under your account."}},welcome:{title:"Welcome to Photo Diary",quote:'"Life is not measured by the number of breaths we take, but by the moments that take our breath away."',subtitle:"Record your life, cherish your memories, and love every moment.",start:"Start My Journey"},groups:{title:"My Groups",join:"Join Group",create:"Create New",private:"Private Space",delete:"Delete Group",leave:"Leave Group",confirmDelete:"Are you sure you want to delete this group?",confirmLeave:"Are you sure you want to leave this group?",inviteCode:"Invite Code",members:"members",owner:"Owner"},filters:{title:"Filters",dateRange:"Date Range",allTime:"All Time",today:"Today",custom:"Custom Range",mood:"Mood",tag:"Tag",searchTags:"Search tags...",found:"{{count}} memories found",noResults:"No memories found"},changelog:{title:"Changelog",subtitle:"Tracking the evolution of Photo Diary",share:"Share Your Moments",milestones:"Life Milestones",garden3d:"Memory Garden 3D",colordna:"Color DNA: Nebula",personalization:"Personalization & Dark Mode",ai:"Real AI Vision Integration",foundation:"Foundation",mobile:"Mobile Experience",features:{milestones:"Life Milestones: Level up your life with achievements",smartGallery:"Specialized Gallery: Auto-organized albums for each milestone",smartTags:"Smart Recognition: Intelligent tagging for fitness, reading, and photography",garden3d:"Immersive 3D Garden: Watch your memories grow in a living ecosystem",weather:"Emotional Weather System: Rain helps you grow",models:"Realistic 3D plant models with interactive details",colorDna:"New Color DNA engine with Nebula Gravity Field UI",planetUI:"3D glass planets & procedural star system",shareCard:'New "Share Card" feature: Generate beautiful Polaroid-style images',qr:"Includes QR code for easy sharing to friends",download:"One-click download for Instagram/WeChat/Twitter sharing",darkMode:"Added Dark Mode support for better night-time experience",theme:"New Theme Selector with 5 accent color options",ui:"Enhanced UI components with smoother transitions",readability:"Improved text readability across all themes",vision:"Integrated Google Vision AI for auto-tagging",analysis:"Smart mood analysis based on photo content",coupleSync:"Couple Space: Real-time dual timeline synchronization",coupleShare:"Private interactions: Comments and reactions for two",insightsCharts:"Mood Heatmap: Visualize your emotional year in pixels",insightsStreak:"Data Statistics: Streaks, top moods, and more",mapView:"Footprint Map: See your journey on the world map",mapInteraction:"Location clustering and smart zooming",printShop:"Print Shop: Turn digital memories into physical books",printCart:"Shopping Cart & Order Management System",init:"The Genesis: Where it all began",basic:"Core timeline and photo upload capabilities",responsive:"Seamless mobile experience across all devices",pwa:"PWA Support: Install as a native app",mapV2:"Map 2.0: Switched to Gaode Map (China-accessible), added Heatmap & Route Playback",aiV2:"AI 2.0: Integrated Qwen (Aliyun) for stable access in China",visuals:"Visuals: Added smooth page transitions and interaction animations",printShopV2:"Print Shop 2.0: High-fidelity Vector PDF Generation",printEditor:"Book Editor: Customize photos, reorder pages, and set custom covers",shareOnline:"Online Sharing: Share your 3D Photo Book with friends via a public link"}},profile:{title:"Edit Profile",changePhoto:"Click camera icon to change photo",fullName:"Full Name",username:"Username (Unique)",usernameHint:"This will be your unique ID for adding friends.",cancel:"Cancel",save:"Save Changes",success:"Profile updated successfully!",error:"Error updating profile",uploadError:"You must select an image to upload.",placeholderName:"Your name",placeholderUsername:"username"},footer:{about:"About Us",privacy:"Privacy Policy",terms:"Terms of Service",contact:"Contact",madeWith:"Made with",forLovers:"for life lovers",rights:"Photo Diary",pricing:"Pricing"},timeline:{title:"Timeline",subtitle:"Your journey, one photo at a time.",empty:"No memories yet",start:"Start by adding your first photo!",search:"Search memories...",filter:"Filter by mood",all:"All Moods",today:"Today",yesterday:"Yesterday"},couple:{title:"Couple Space",subtitle:"Sync your moments. You on the left, them on the right.",noGroup:"No couple group selected. Create one and invite your partner!",selectGroup:"Select a group above to start",noMemories:"No shared memories yet.",startSharing:"Start taking photos to fill your timeline!"},insights:{title:"Insights",subtitle:"Discover patterns in your life.",yearInPixels:"Year in Pixels",pixelDesc:"Every pixel represents a day of your life.",noData:"No Data",mood:"Mood",stats:"Statistics",totalEntries:"Total Entries",totalTags:"Unique Tags",currentStreak:"Current Streak",topMood:"Top Mood",placesVisited:"Places Visited"},form:{titleAdd:"New Memory",titleEdit:"Edit Memory",upload:"Click to upload photo",uploadDesc:"Capture the moment",captionPlaceholder:"Write something about this moment...",locationPlaceholder:"Where was this taken?",moodLabel:"How are you feeling?",dateLabel:"Date",shareLabel:"Share to Group",private:"Private Diary",save:"Save Memory",saving:"Saving...",delete:"Delete Entry",confirmDelete:"Are you sure you want to delete this memory?",aiTags:"AI Tags"},print:{title:"Print Shop",subtitle:"Turn your digital memories into physical keepsakes.",cart:"Cart",addToCart:"Add to Cart",checkout:"Print Now",polaroid:"Polaroid Style",postcard:"Postcard",photobook:"Photo Book",price:"${{price}}",free:"Free",theYearOf:"The Year Of",introduction:"Introduction",mood:"Mood",theEnd:"The End",flipInstruction:"Use Arrow Keys or Click Corners to Flip",layoutStyle:"Layout Style",styles:{classic:"Classic",grid:"Grid",magazine:"Magazine",minimal:"Minimal"},photos:"Photos",pages:"Pages",selectYear:"Select Year",format:"Format",formatDesc:"Includes interactive flipbook link + downloadable PDF",downloadPDF:"Download PDF",shareOnline:"Share Online",shareLinkLocal:"Copy Local Link",linkCopiedLocal:"Local link copied (Only works on this device)",shareLink:"Share Link",linkCopied:"Public link copied! Share it with anyone.",generating:"Generating PDF, please wait...",successTitle:"Ready to Print",successDesc:"Your photo book is ready! You can now download it as a PDF or share the digital version.",storyOfUs:"The Story of Us",introText:"This year was filled with unforgettable moments, laughter, and growth. Here are the highlights of my journey in {{year}}.",toBeContinued:"To be continued...",yearBook:"Year Book",myPhotoDiary:"My Photo Diary",clickToPreview:"Click to Preview",editorTitle:"Customize Book Content",content:"Content",customize:"Customize",photosSelected:"{{count}} photos selected"},account:{title:"Account & Friends",myProfile:"My Profile",achievements:"Achievements",friends:"Friends",signOut:"Sign Out",editProfile:"Edit Profile",friendId:"Friend ID",email:"Email",anonymous:"Anonymous User",noUsername:"no_username",generating:"Generating...",addFriend:"Add New Friend",enterEmail:"Enter friend's email address",sendRequest:"Send Request",friendRequests:"Friend Requests",yourFriends:"Your Friends",noFriends:"No friends yet. Invite someone above!",removeFriend:"Remove Friend",confirmRemove:"Remove {{name}} from friends?",language:"Language",theme:"Theme"},subscription:{title:"Upgrade your Memories",subtitle:"Choose the plan that fits your storytelling journey. Cancel anytime.",monthly:"Monthly",yearly:"Yearly",save:"Save 20%",mostPopular:"Most Popular",currentPlan:"Current Plan",getStarted:"Get Started",features:{photos:"photos per month",filters:"Basic filters & editing",export:"Standard quality export",ads:"Ad-supported experience",unlimited:"Unlimited photo storage",ai:"Advanced AI analysis & tags",quality:"4K quality export",support:"Priority support",noAds:"No ads",lifetime:"Lifetime updates included",badge:'Exclusive "Founder" badge',beta:"Early access to beta features",vip:"VIP Print Shop discounts"},payment:{title:"Checkout",total:"Total Amount",method:"Select Payment Method",card:"Credit Card",wechat:"WeChat Pay",alipay:"Alipay",scan:"Scan QR Code to pay",instant:"Instant payment",cardNumber:"Card Number",expiry:"Expiry",cvc:"CVC",pay:"Pay {{amount}} Securely",processing:"Processing payment...",success:"Payment Successful!",confirmed:"Your order has been confirmed.",secure:"256-bit SSL Encrypted Payment",scanTip:"Scan with App",uploadTip:"Tip: Use a creator platform (e.g., Buy Me a Coffee, Mianbao) to protect privacy.",openLink:"Or Open Payment Link"}},common:{loading:"Loading...",saving:"Saving...",success:"Success",error:"Error",cancel:"Cancel",save:"Save Changes",delete:"Delete",edit:"Edit",back:"Back"},auth:{required:"Please sign in to continue"},moods:{happy:"Happy",sad:"Sad",excited:"Excited",tired:"Tired",neutral:"Neutral",angry:"Angry",grateful:"Grateful",anxious:"Anxious",calm:"Calm",inspired:"Inspired",stressed:"Stressed",energetic:"Energetic"}}},zh:{translation:{nav:{timeline:"",calendar:"",map:"",couple:"",milestones:"",insights:"",print:"",logs:"",add:"",account:""},map:{features:"",showHeatmap:"",hideHeatmap:"",playRoute:"",stopPlayback:"",traveling:"..."},milestones:{title:"",subtitle:"",target:"",current:"",totalCompleted:"",photo:{beginner:"",beginnerDesc:"5",master:"",masterDesc:"50"},fitness:{start:"",startDesc:"10"},reading:{worm:"",wormDesc:"12"},viewGallery:"",memories:"",noEntries:"",noEntriesDesc:""},export:{button:"",pdf:" PDF ()",json:" JSON ()",exporting:"...",failed:"",success:""},legal:{back:"",about:{title:" Photo Diary",intro1:"Photo Diary <strong></strong>",intro2:"Photo Diary ",missionTitle:"",missionText:""},privacy:{title:"",lastUpdated:"20261",intro:" Photo Diary",collectionTitle:"1. ",collectionText:"",aiTitle:"2. AI ",aiText:" AI "},terms:{title:"",lastUpdated:"20261",acceptanceTitle:"1. ",acceptanceText:" Photo Diary",conductTitle:"2. ",conductText:""}},welcome:{title:" Photo Diary",quote:"",subtitle:"",start:""},groups:{title:"",join:"",create:"",private:"",delete:"",leave:"",confirmDelete:"",confirmLeave:"",inviteCode:"",members:"",owner:""},filters:{title:"",dateRange:"",allTime:"",today:"",custom:"",mood:"",tag:"",searchTags:"...",found:" {{count}} ",noResults:""},changelog:{title:"",subtitle:" Photo Diary ",share:"",milestones:"",garden3d:" 3D",colordna:" DNA",personalization:"",ai:"AI ",couple:"",insights:"",map:"",print:"",core:"",features:{milestones:"",smartGallery:"",smartTags:"",garden3d:" 3D ",weather:"",models:" 3D ",colorDna:" DNA ",planetUI:"3D ",shareCard:"",qr:"",download:"//Instagram",darkMode:"",theme:"5",ui:" UI ",readability:"",vision:" Google Vision AI ",analysis:"",coupleSync:"Ta",coupleShare:"",insightsCharts:"",insightsStreak:"",mapView:"",mapInteraction:"/",printShop:"",printCart:"",init:"",basic:"",responsive:"",pwa:"PWA ",mapV2:" 2.0",aiV2:"AI 2.0",visuals:"",printShopV2:" 2.0 PDF ",printEditor:"",shareOnline:" 3D "}},profile:{title:"",changePhoto:"",fullName:"",username:" ()",usernameHint:"",cancel:"",save:"",success:"",error:"",uploadError:"",placeholderName:"",placeholderUsername:""},footer:{about:"",privacy:"",terms:"",contact:"",madeWith:"Made with",forLovers:"for life lovers",rights:"Photo Diary",pricing:""},timeline:{title:"",subtitle:"",empty:"",start:"",search:"...",filter:"",all:"",today:"",yesterday:""},couple:{title:"",subtitle:"Ta",noGroup:"",selectGroup:"",noMemories:"",startSharing:""},insights:{title:"",subtitle:"",yearInPixels:"",pixelDesc:"",noData:"",mood:"",stats:"",totalEntries:"",totalTags:"",currentStreak:"",topMood:"",placesVisited:""},form:{titleAdd:"",titleEdit:"",upload:"",uploadDesc:"",captionPlaceholder:"...",locationPlaceholder:"",moodLabel:"",dateLabel:"",shareLabel:"",private:"",save:"",saving:"...",delete:"",confirmDelete:"",aiTags:"AI "},print:{title:"",subtitle:"",cart:"",addToCart:"",checkout:"",polaroid:"",postcard:"",photobook:"",price:"{{price}}",free:"",theYearOf:"",introduction:"",mood:"",theEnd:"",flipInstruction:"",layoutStyle:"",styles:{classic:"",grid:"",magazine:"",minimal:""},photos:"",pages:"",selectYear:"",format:"",formatDesc:" +  PDF",downloadPDF:" PDF",shareOnline:"",shareLinkLocal:"",linkCopiedLocal:" ()",shareLink:"",linkCopied:"",generating:" PDF...",successTitle:"",successDesc:" PDF ",storyOfUs:"",introText:" {{year}} ",toBeContinued:"...",yearBook:"",myPhotoDiary:"",clickToPreview:"",editorTitle:"",content:"",customize:"",photosSelected:" {{count}} "},account:{title:"",myProfile:"",achievements:"",friends:"",signOut:"",editProfile:"",friendId:" ID",email:"",anonymous:"",noUsername:"",generating:"...",addFriend:"",enterEmail:"",sendRequest:"",friendRequests:"",yourFriends:"",noFriends:"",removeFriend:"",confirmRemove:" {{name}} ",language:"",theme:""},subscription:{title:"",subtitle:"",monthly:"",yearly:"",save:" 20%",mostPopular:"",currentPlan:"",getStarted:"",features:{photos:"",filters:"",export:"",ads:"",unlimited:"",ai:" AI ",quality:"4K ",support:"",noAds:"",lifetime:"",badge:"",beta:"",vip:" VIP "},payment:{title:"",total:"",method:"",card:"",wechat:"",alipay:"",scan:"",instant:"",cardNumber:"",expiry:"",cvc:"",pay:" {{amount}}",processing:"...",success:"",confirmed:"",secure:"256 SSL ",scanTip:"/",uploadTip:"",openLink:""}},common:{loading:"...",saving:"...",success:"",error:"",cancel:"",save:"",delete:"",edit:"",back:""},auth:{required:""},moods:{happy:"",sad:"",excited:"",tired:"",neutral:"",angry:"",grateful:"",anxious:"",calm:"",inspired:"",stressed:"",energetic:""}}},ja:{translation:{nav:{timeline:"",calendar:"",map:"",couple:"",milestones:"",insights:"",print:"",logs:"",add:"",account:""},map:{features:"",showHeatmap:"",hideHeatmap:"",playRoute:"",stopPlayback:"",traveling:"..."},milestones:{title:"",subtitle:"",target:"",current:"",totalCompleted:"",photo:{beginner:"",beginnerDesc:"5",master:"",masterDesc:"50"},fitness:{start:"",startDesc:"10"},reading:{worm:"",wormDesc:"12"},viewGallery:"",memories:"",noEntries:"",noEntriesDesc:""},export:{button:"",pdf:"PDF ()",json:"JSON ()",exporting:"...",failed:"",success:""},legal:{back:"",about:{title:"Photo Diary",intro1:"Photo Diary<strong></strong>",intro2:"Photo Diary",missionTitle:"",missionText:""},privacy:{title:"",lastUpdated:"20261",intro:"Photo Diary",collectionTitle:"1. ",collectionText:"",aiTitle:"2. AI",aiText:"AI"},terms:{title:"",lastUpdated:"20261",acceptanceTitle:"1. ",acceptanceText:"Photo Diary",conductTitle:"2. ",conductText:""}},welcome:{title:"Photo Diary",quote:"",subtitle:"",start:""},groups:{title:"",join:"",create:"",private:"",delete:"",leave:"",confirmDelete:"",confirmLeave:"",inviteCode:"",members:"",owner:""},filters:{title:"",dateRange:"",allTime:"",today:"",custom:"",mood:"",tag:"",searchTags:"...",found:"{{count}} ",noResults:""},changelog:{title:"",subtitle:"Photo Diary",share:"",milestones:"",garden3d:" 3D",colordna:"Color DNA: ",personalization:" & ",ai:"AI",foundation:"",mobile:"",features:{milestones:"",smartGallery:"",smartTags:"",garden3d:"3D",weather:"",models:"3D",colorDna:"Color DNAUI",planetUI:"3D",shareCard:"",qr:"QR",download:"Instagram/Twitter",darkMode:"",theme:"5",ui:"UI",readability:"",vision:"Google Vision AI",analysis:"",coupleSync:"",coupleShare:"",insightsCharts:"",insightsStreak:"",mapView:"",mapInteraction:"",printShop:"",printCart:"",init:"",basic:"",responsive:"",pwa:"PWA",mapV2:" 2.0",aiV2:"AI 2.0QwenAliyun",visuals:"",printShopV2:" 2.0PDF",printEditor:"",shareOnline:"3D"}},profile:{title:"",changePhoto:"",fullName:"",username:" ()",usernameHint:"ID",cancel:"",save:"",success:"",error:"",uploadError:"",placeholderName:"",placeholderUsername:""},footer:{about:"",privacy:"",terms:"",contact:"",madeWith:"Made with",forLovers:"for life lovers",rights:"Photo Diary",pricing:""},timeline:{title:"",subtitle:"",empty:"",start:"1",search:"...",filter:"",all:"",today:"",yesterday:""},couple:{title:"",subtitle:"",noGroup:"",selectGroup:"",noMemories:"",startSharing:""},insights:{title:"",subtitle:"",yearInPixels:"",pixelDesc:"11",noData:"",mood:"",stats:"",totalEntries:"",totalTags:"",currentStreak:"",topMood:"",placesVisited:""},form:{titleAdd:"",titleEdit:"",upload:"",uploadDesc:"",captionPlaceholder:"...",locationPlaceholder:"",moodLabel:"",dateLabel:"",shareLabel:"",private:"",save:"",saving:"...",delete:"",confirmDelete:"",aiTags:"AI"},print:{title:"",subtitle:"",cart:"",addToCart:"",checkout:"",polaroid:"",postcard:"",photobook:"",price:"{{price}}",free:"",theYearOf:"",introduction:"",mood:"",theEnd:"",flipInstruction:"",layoutStyle:"",styles:{classic:"",grid:"",magazine:"",minimal:""},photos:"",pages:"",selectYear:"",format:"",formatDesc:" + PDF",downloadPDF:"PDF",shareOnline:"",shareLinkLocal:"",linkCopiedLocal:" ()",shareLink:"",linkCopied:"",generating:"PDF...",successTitle:"",successDesc:"PDF",storyOfUs:"",introText:" {{year}} ",toBeContinued:"...",yearBook:"",myPhotoDiary:"",clickToPreview:"",editorTitle:"",content:"",customize:"",photosSelected:"{{count}} "},account:{title:"",myProfile:"",achievements:"",friends:"",signOut:"",editProfile:"",friendId:"ID",email:"",anonymous:"",noUsername:"",generating:"...",addFriend:"",enterEmail:"",sendRequest:"",friendRequests:"",yourFriends:"",noFriends:"",removeFriend:"",confirmRemove:" {{name}} ",language:"",theme:""},subscription:{payment:{secure:"256 SSL ",scanTip:"",uploadTip:"",openLink:""}},common:{loading:"...",saving:"...",success:"",error:"",cancel:"",save:"",delete:"",edit:"",back:""},moods:{happy:"",sad:"",excited:"",tired:"",neutral:"",angry:"",grateful:"",anxious:"",calm:"",inspired:"",stressed:"",energetic:""}}},ko:{translation:{nav:{timeline:"",calendar:"",map:"",couple:" ",milestones:" ",insights:" ",print:"",logs:"",add:"",account:" "},map:{features:" ",showHeatmap:" ",hideHeatmap:" ",playRoute:"  ",stopPlayback:" ",traveling:" ..."},milestones:{title:" ",subtitle:"    .",target:"",current:"",totalCompleted:"",photo:{beginner:" ",beginnerDesc:" 5    .",master:" ",masterDesc:"50  .   !"},fitness:{start:" ",startDesc:" 10 .  !"},reading:{worm:"",wormDesc:" 12 .   ."},viewGallery:" ",memories:" ",noEntries:" ",noEntriesDesc:"       !"},export:{button:"",pdf:"PDF  ()",json:"JSON  ()",exporting:" ...",failed:".  .",success:""},legal:{back:"",about:{title:"Photo Diary ",intro1:"Photo Diary   : <strong>  .</strong>",intro2:"      ,    .      ,  ,       . Photo Diary            .",missionTitle:" ",missionText:"           .          ."},privacy:{title:"",lastUpdated:" : 2026 1",intro:"Photo Diary     .     ,   .",collectionTitle:"1.  ",collectionText:"     (,  ,   ) .    3  .",aiTitle:"2. AI ",aiText:" AI ( , )        .   ,           ."},terms:{title:"",lastUpdated:" : 2026 1",acceptanceTitle:"1.  ",acceptanceText:"Photo Diary           .",conductTitle:"2.  ",conductText:"      .           ."}},welcome:{title:"Photo Diary   ",quote:'"     ,      ."',subtitle:"  ,   ,   .",start:" "},groups:{title:" ",join:" ",create:" ",private:" ",delete:" ",leave:" ",confirmDelete:" ?",confirmLeave:" ?",inviteCode:" ",members:"",owner:""},filters:{title:"",dateRange:" ",allTime:" ",today:"",custom:" ",mood:"",tag:"",searchTags:" ...",found:"{{count}} ",noResults:"  "},changelog:{title:" ",subtitle:"Photo Diary  ",share:" ",milestones:" ",garden3d:"  3D",colordna:"Color DNA: ",personalization:" &  ",ai:"AI  ",foundation:"",mobile:" ",features:{milestones:" :    ",smartGallery:" :      ",smartTags:" : , ,     ",garden3d:" 3D :     ",weather:"  :    ",models:" 3D    ",colorDna:" Color DNA :   UI",planetUI:"3D     ",shareCard:' " ":    ',qr:"     QR ",download:"//  ",darkMode:"   ",theme:"5    ",ui:"  UI ",readability:"  ",vision:"   Google Vision AI ",analysis:"     ",coupleSync:" :    ",coupleShare:" :    ",insightsCharts:" :  1  ",insightsStreak:" :  ,   ",mapView:" :    ",mapInteraction:"    ",printShop:":    ",printCart:"    ",init:"The Genesis:   ",basic:"     ",responsive:"    ",pwa:"PWA :   ",mapV2:" 2.0:  (  ) ,     ",aiV2:"AI 2.0:      Qwen(Aliyun) ",visuals:":       ",printShopV2:" 2.0:   PDF  ",printEditor:" :  ,       ",shareOnline:" : 3D     "}},profile:{title:" ",changePhoto:"    ",fullName:"",username:"  ()",usernameHint:"    ID .",cancel:"",save:"",success:" !",error:" ",uploadError:" .",placeholderName:"",placeholderUsername:" "},footer:{about:"",privacy:"",terms:"",contact:"",madeWith:"Made with",forLovers:"for life lovers",rights:"Photo Diary"},timeline:{title:"",subtitle:"   .",empty:"  ",start:"   !",search:" ...",filter:" ",all:" ",today:"",yesterday:""},couple:{title:" ",subtitle:"  .  ,  .",noGroup:"  .    !",selectGroup:"  ",noMemories:"   .",startSharing:"   !"},insights:{title:" ",subtitle:"   .",yearInPixels:" ",pixelDesc:"   .",noData:" ",mood:"",stats:"",totalEntries:" ",totalTags:" ",currentStreak:" ",topMood:" ",placesVisited:" "},form:{titleAdd:" ",titleEdit:" ",upload:" ",uploadDesc:"  ",captionPlaceholder:"    ?",locationPlaceholder:" ?",moodLabel:"  ?",dateLabel:"",shareLabel:" ",private:" ",save:"",saving:" ...",delete:"",confirmDelete:"   ?",aiTags:"AI "},print:{title:" ",subtitle:"   .",cart:"",addToCart:"",checkout:"",polaroid:" ",postcard:"",photobook:"",price:"{{price}}",free:"",theYearOf:"",introduction:"",mood:"",theEnd:"",flipInstruction:"   ",layoutStyle:" ",styles:{classic:"",grid:"",magazine:"",minimal:""},photos:"",pages:" ",selectYear:" ",format:"",formatDesc:"   +   PDF ",downloadPDF:"PDF ",shareOnline:" ",shareLinkLocal:"  ",linkCopiedLocal:"   (  )",shareLink:" ",linkCopied:"  !  .",generating:"PDF  ,  ...",successTitle:"  ",successDesc:" ! PDF      .",storyOfUs:" ",introText:"    ,  . {{year}}  .",toBeContinued:"...",yearBook:"",myPhotoDiary:"  ",clickToPreview:" ",editorTitle:"  ",content:"",customize:"",photosSelected:"{{count}}  "},account:{title:"  ",myProfile:" ",achievements:" ",friends:" ",signOut:"",editProfile:" ",friendId:" ID",email:"",anonymous:" ",noUsername:"  ",generating:" ...",addFriend:" ",enterEmail:"  ",sendRequest:" ",friendRequests:"  ",yourFriends:" ",noFriends:" . !",removeFriend:" ",confirmRemove:"{{name}}    ?",language:" ",theme:""},subscription:{payment:{secure:"256 SSL  ",scanTip:" ",uploadTip:":      QR    .",openLink:"   "}},common:{loading:" ...",saving:" ...",success:"",error:" ",cancel:"",save:"",delete:"",edit:"",back:""},moods:{happy:"",sad:"",excited:"",tired:"",neutral:"",angry:"",grateful:"",anxious:"",calm:"",inspired:"",stressed:"",energetic:""}}}};Ke.use(d1).use(sj).init({resources:NF,fallbackLng:"en",interpolation:{escapeValue:!1}});const h1=x.createContext(void 0);function TF({children:t}){const[e,n]=x.useState(()=>localStorage.getItem("theme")||"light"),[r,s]=x.useState(()=>localStorage.getItem("accentColor")||"blue"),[i,o]=x.useState(()=>{const c=localStorage.getItem("language"),u=navigator.language.split("-")[0];return c||(["en","zh","ja","ko"].includes(u)?u:"en")}),a=c=>{o(c),Ke.changeLanguage(c),localStorage.setItem("language",c)};x.useEffect(()=>{Ke.language!==i&&Ke.changeLanguage(i)},[]),x.useEffect(()=>{const c=window.document.documentElement;c.classList.remove("light","dark"),c.classList.add(e),localStorage.setItem("theme",e)},[e]),x.useEffect(()=>{localStorage.setItem("accentColor",r);const c=window.document.documentElement;let u="#030213",h="oklch(1 0 0)";if(e==="light")switch(r){case"blue":u="#2563eb";break;case"purple":u="#9333ea";break;case"pink":u="#db2777";break;case"orange":u="#ea580c";break;case"green":u="#16a34a";break}else{switch(r){case"blue":u="#60a5fa";break;case"purple":u="#c084fc";break;case"pink":u="#f472b6";break;case"orange":u="#fb923c";break;case"green":u="#4ade80";break}h="oklch(0.205 0 0)"}c.style.setProperty("--primary",u),c.style.setProperty("--primary-foreground",h)},[r,e]);const l=()=>{n(c=>c==="light"?"dark":"light")};return d.jsx(h1.Provider,{value:{theme:e,accentColor:r,language:i,setTheme:n,setAccentColor:s,setLanguage:a,toggleTheme:l},children:t})}function f1(){const t=x.useContext(h1);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}function RF(){var P;const{user:t,signOut:e}=Ps(),{friends:n,friendRequests:r,sendFriendRequest:s,acceptFriendRequest:i,rejectFriendRequest:o,removeFriend:a}=dF(),{language:l,setLanguage:c}=f1(),{t:u}=Pe(),[h,f]=x.useState(""),[p,m]=x.useState("profile"),[y,v]=x.useState([]),[S,E]=x.useState(null),[k,g]=x.useState(!1);x.useEffect(()=>{l1().then(v).catch(console.error),w()},[t]);async function w(){if(!t)return;const{data:b}=await ye.from("profiles").select("*").eq("id",t.id).single();b&&E(b)}const _=async b=>{b.preventDefault(),h.trim()&&(await s(h),f(""))};return d.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:u("account.title")}),d.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 px-4 py-2 rounded-lg transition-colors",children:[d.jsx(M0,{className:"w-4 h-4"}),u("account.signOut")]})]}),d.jsxs("div",{className:"flex gap-4 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("button",{onClick:()=>m("profile"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 ${p==="profile"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:u("account.myProfile")}),d.jsx("button",{onClick:()=>m("achievements"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 ${p==="achievements"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:u("account.achievements")}),d.jsxs("button",{onClick:()=>m("friends"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 ${p==="friends"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:[u("account.friends")," (",n.length,")",r.length>0&&d.jsx("span",{className:"ml-2 bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full",children:r.length})]})]}),p==="profile"?d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:d.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[d.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900 dark:to-purple-900 flex items-center justify-center text-4xl shadow-inner overflow-hidden border-4 border-white dark:border-gray-700",children:S!=null&&S.avatar_url?d.jsx("img",{src:S.avatar_url,alt:"Profile",className:"w-full h-full object-cover"}):((P=t==null?void 0:t.email)==null?void 0:P[0].toUpperCase())||d.jsx(aa,{})}),d.jsxs("div",{className:"flex-1 space-y-4 text-center md:text-left",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(S==null?void 0:S.full_name)||u("account.anonymous")}),d.jsxs("p",{className:"text-sm text-gray-500",children:["@",(S==null?void 0:S.username)||u("account.noUsername")]})]}),d.jsxs("div",{className:"grid grid-cols-1 gap-3 max-w-md",children:[d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[d.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:d.jsx(Gc,{className:"w-4 h-4"})}),d.jsxs("div",{className:"flex-1 text-left",children:[d.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:u("account.email")}),d.jsx("p",{className:"text-sm font-medium truncate",children:t==null?void 0:t.email})]})]}),d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[d.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:d.jsx(rk,{className:"w-4 h-4"})}),d.jsxs("div",{className:"flex-1 text-left",children:[d.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:u("account.friendId")}),d.jsx("p",{className:"text-sm font-mono font-medium tracking-wider",children:(S==null?void 0:S.short_id)||u("account.generating")})]})]})]}),d.jsx("div",{className:"pt-2",children:d.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white hover:bg-blue-700 rounded-xl text-sm font-medium transition-colors shadow-sm shadow-blue-200 mx-auto md:mx-0",children:[d.jsx(T0,{className:"w-4 h-4"}),u("account.editProfile")]})})]})]})}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[d.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[d.jsx(U0,{className:"w-5 h-5 text-indigo-500"}),u("account.language")]}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{code:"en",label:"English",flag:""},{code:"zh",label:"",flag:""},{code:"ja",label:"",flag:""},{code:"ko",label:"",flag:""}].map(b=>d.jsxs("button",{onClick:()=>c(b.code),className:`flex items-center justify-center gap-2 p-3 rounded-xl border transition-all ${l===b.code?"bg-indigo-50 border-indigo-200 text-indigo-700 dark:bg-indigo-900/30 dark:border-indigo-700 dark:text-indigo-300 ring-2 ring-indigo-500 ring-offset-2 dark:ring-offset-gray-800":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[d.jsx("span",{className:"text-lg",children:b.flag}),d.jsx("span",{className:"text-sm font-medium",children:b.label})]},b.code))})]})]}):p==="achievements"?d.jsx(fF,{entries:y}):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[d.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[d.jsx(Cf,{className:"w-5 h-5 text-blue-500"}),"Add New Friend"]}),d.jsxs("form",{onSubmit:_,className:"flex gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Gc,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx("input",{type:"email",value:h,onChange:b=>f(b.target.value),placeholder:"Enter friend's email address",className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"})]}),d.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"Send Request"})]})]}),r.length>0&&d.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-6 border border-blue-100 dark:border-blue-800",children:[d.jsxs("h3",{className:"font-bold text-blue-900 dark:text-blue-100 mb-4 flex items-center gap-2",children:[d.jsx(Et,{className:"w-5 h-5"}),"Friend Requests"]}),d.jsx("div",{className:"space-y-3",children:r.map(b=>d.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-gray-800 p-3 rounded-xl shadow-sm",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 overflow-hidden",children:b.from.avatar?d.jsx("img",{src:b.from.avatar,alt:b.from.name,className:"w-full h-full object-cover"}):d.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500 font-bold",children:b.from.name[0]})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:b.from.name}),d.jsx("div",{className:"text-xs text-gray-500",children:b.from.email})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>i(b.id),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Accept",children:d.jsx(Et,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>o(b.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Reject",children:d.jsx(Ct,{className:"w-4 h-4"})})]})]},b.id))})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700",children:[d.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[d.jsx(aa,{className:"w-5 h-5 text-purple-500"}),"Your Friends"]}),n.length===0?d.jsxs("div",{className:"text-center py-12 text-gray-500",children:[d.jsx(Cf,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),d.jsx("p",{children:"No friends yet. Invite someone above!"})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(b=>d.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl border border-gray-100 dark:border-gray-700 hover:border-blue-200 dark:hover:border-blue-800 transition-all group",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 overflow-hidden",children:b.avatar?d.jsx("img",{src:b.avatar,alt:b.name,className:"w-full h-full object-cover"}):d.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500 font-bold",children:b.name[0]})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-bold text-gray-900 dark:text-white",children:b.name}),d.jsx("div",{className:"text-xs text-gray-500",children:b.email})]})]}),d.jsx("button",{onClick:()=>{confirm(`Remove ${b.name} from friends?`)&&a(b.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg opacity-0 group-hover:opacity-100 transition-all",title:"Remove Friend",children:d.jsx(Sd,{className:"w-4 h-4"})})]},b.id))})]})]}),d.jsx(pF,{isOpen:k,onClose:()=>g(!1),onProfileUpdate:w})]})}function OF(){const{user:t}=Ps(),{groups:e}=Fi(),{t:n}=Pe(),[r,s]=x.useState(""),i=e,o=e.find(l=>l.id===r),a=x.useMemo(()=>{if(!o)return[];const l=[...o.entries].sort((u,h)=>new Date(h.date).getTime()-new Date(u.date).getTime()),c=[];return l.forEach(u=>{const h=xe(Ul(u.date),"yyyy-MM-dd"),f=c[c.length-1];f&&f.date===h?f.entries.push(u):c.push({date:h,entries:[u]})}),c},[o]);return t?d.jsxs("div",{className:"max-w-4xl mx-auto min-h-[80vh] space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20",children:[d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-pink-100 text-pink-600 rounded-full mb-2",children:d.jsx(sk,{className:"w-8 h-8"})}),d.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:n("couple.title")}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:n("couple.subtitle")}),d.jsx("div",{className:"flex justify-center mt-4",children:i.length===0?d.jsx("div",{className:"text-sm text-gray-500 bg-gray-50 px-4 py-2 rounded-lg",children:n("couple.noGroup")}):d.jsx("div",{className:"flex gap-2 overflow-x-auto p-1 max-w-full justify-center",children:i.map(l=>d.jsxs("button",{onClick:()=>s(l.id),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ${r===l.id?"bg-pink-500 text-white shadow-md transform scale-105":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[d.jsx("span",{className:"w-2 h-2 rounded-full bg-white/50"}),l.name]},l.id))})})]}),r?d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gradient-to-b from-pink-200 via-purple-200 to-transparent -translate-x-1/2 hidden md:block"}),d.jsxs("div",{className:"space-y-12",children:[a.map(l=>d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"flex justify-center mb-8 sticky top-20 z-10",children:d.jsx("span",{className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur px-4 py-1.5 rounded-full text-xs font-bold text-gray-500 shadow-sm border border-gray-100 dark:border-gray-700",children:xe(Ul(l.date),"MMMM do, yyyy")})}),d.jsx("div",{className:"space-y-8",children:l.entries.map(c=>{var h;const u=c.userId===t.id;return d.jsxs("div",{className:`flex flex-col md:flex-row items-center gap-4 md:gap-8 ${u?"md:flex-row":"md:flex-row-reverse"}`,children:[d.jsx("div",{className:`flex-1 w-full max-w-sm ${u?"md:text-right":"md:text-left"}`,children:d.jsxs("div",{className:`relative group bg-white dark:bg-gray-800 p-3 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 transition-transform hover:scale-[1.02] ${u?"md:ml-auto":"md:mr-auto"}`,children:[d.jsxs("div",{className:"aspect-[4/3] rounded-xl overflow-hidden mb-3 bg-gray-100 relative",children:[d.jsx(Ot,{src:c.photo,alt:c.caption,className:"w-full h-full object-cover"}),d.jsx("div",{className:"absolute top-2 right-2 bg-black/30 backdrop-blur-md text-white text-[10px] px-2 py-0.5 rounded-full",children:xe(Ul(c.date),"HH:mm")})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 font-medium line-clamp-3",children:c.caption}),d.jsxs("div",{className:`flex items-center gap-2 text-xs text-gray-400 ${u?"md:justify-end":"md:justify-start"}`,children:[c.location&&d.jsxs("span",{className:"flex items-center gap-0.5",children:[d.jsx(j0,{className:"w-3 h-3"}),c.location.name||"Unknown"]}),d.jsx("span",{className:`px-1.5 py-0.5 rounded-md ${u?"bg-blue-50 text-blue-600":"bg-pink-50 text-pink-600"}`,children:n(`moods.${c.mood.toLowerCase()}`,c.mood)})]})]}),d.jsx("div",{className:`absolute -top-3 ${u?"-right-3":"-left-3"} w-8 h-8 rounded-full border-2 border-white shadow-md overflow-hidden bg-gray-200 z-10`,children:c.userAvatar?d.jsx(Ot,{src:c.userAvatar,alt:"avatar",className:"w-full h-full object-cover"}):d.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-400 to-purple-400 text-white text-xs font-bold",children:((h=c.userName)==null?void 0:h[0])||"?"})})]})}),d.jsx("div",{className:"hidden md:flex flex-col items-center justify-center w-8 shrink-0 relative",children:d.jsx("div",{className:`w-3 h-3 rounded-full border-2 border-white shadow-sm z-10 ${u?"bg-blue-400":"bg-pink-400"}`})}),d.jsx("div",{className:"flex-1 w-full hidden md:block"})]},c.id)})})]},l.date)),a.length===0&&d.jsxs("div",{className:"text-center py-12 text-gray-400",children:[d.jsx("p",{children:n("couple.noMemories")}),d.jsx("p",{className:"text-sm mt-2",children:n("couple.startSharing")})]})]})]}):d.jsxs("div",{className:"text-center py-20 bg-white/50 dark:bg-gray-800/50 rounded-3xl border-2 border-dashed border-gray-200 dark:border-gray-700",children:[d.jsx(xn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),d.jsx("p",{className:"text-gray-500",children:n("couple.selectGroup")})]})]}):null}function Wn(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function p0(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function IF(...t){return e=>{let n=!1;const r=t.map(s=>{const i=p0(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():p0(t[s],null)}}}}function Zi(...t){return x.useCallback(IF(...t),t)}function MF(t,e=[]){let n=[];function r(i,o){const a=x.createContext(o),l=n.length;n=[...n,o];const c=h=>{var S;const{scope:f,children:p,...m}=h,y=((S=f==null?void 0:f[t])==null?void 0:S[l])||a,v=x.useMemo(()=>m,Object.values(m));return d.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,m=x.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>x.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return x.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,DF(s,...e)]}function DF(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return x.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var LF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],eo=LF.reduce((t,e)=>{const n=x.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?tt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function $F(t,e){t&&Xa.flushSync(()=>t.dispatchEvent(e))}function to(t){const e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function FF(t,e=globalThis==null?void 0:globalThis.document){const n=to(t);x.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var UF="DismissableLayer",dd="dismissableLayer.update",BF="dismissableLayer.pointerDownOutside",VF="dismissableLayer.focusOutside",m0,p1=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),m1=x.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=x.useContext(p1),[u,h]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=x.useState({}),m=Zi(e,P=>h(P)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),S=y.indexOf(v),E=u?y.indexOf(u):-1,k=c.layersWithOutsidePointerEventsDisabled.size>0,g=E>=S,w=HF(P=>{const b=P.target,C=[...c.branches].some(A=>A.contains(b));!g||C||(s==null||s(P),o==null||o(P),P.defaultPrevented||a==null||a())},f),_=KF(P=>{const b=P.target;[...c.branches].some(A=>A.contains(b))||(i==null||i(P),o==null||o(P),P.defaultPrevented||a==null||a())},f);return FF(P=>{E===c.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&a&&(P.preventDefault(),a()))},f),x.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(m0=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),g0(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=m0)}},[u,f,n,c]),x.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),g0())},[u,c]),x.useEffect(()=>{const P=()=>p({});return document.addEventListener(dd,P),()=>document.removeEventListener(dd,P)},[]),d.jsx(eo.div,{...l,ref:m,style:{pointerEvents:k?g?"auto":"none":void 0,...t.style},onFocusCapture:Wn(t.onFocusCapture,_.onFocusCapture),onBlurCapture:Wn(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Wn(t.onPointerDownCapture,w.onPointerDownCapture)})});m1.displayName=UF;var WF="DismissableLayerBranch",zF=x.forwardRef((t,e)=>{const n=x.useContext(p1),r=x.useRef(null),s=Zi(e,r);return x.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),d.jsx(eo.div,{...t,ref:s})});zF.displayName=WF;function HF(t,e=globalThis==null?void 0:globalThis.document){const n=to(t),r=x.useRef(!1),s=x.useRef(()=>{});return x.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){g1(BF,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function KF(t,e=globalThis==null?void 0:globalThis.document){const n=to(t),r=x.useRef(!1);return x.useEffect(()=>{const s=i=>{i.target&&!r.current&&g1(VF,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function g0(){const t=new CustomEvent(dd);document.dispatchEvent(t)}function g1(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?$F(s,i):s.dispatchEvent(i)}var hd=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},GF="Portal",y1=x.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=x.useState(!1);hd(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?kd.createPortal(d.jsx(eo.div,{...r,ref:e}),o):null});y1.displayName=GF;function qF(t,e){return x.useReducer((n,r)=>e[n][r]??n,t)}var mf=t=>{const{present:e,children:n}=t,r=YF(e),s=typeof n=="function"?n({present:r.isPresent}):x.Children.only(n),i=Zi(r.ref,JF(s));return typeof n=="function"||r.isPresent?x.cloneElement(s,{ref:i}):null};mf.displayName="Presence";function YF(t){const[e,n]=x.useState(),r=x.useRef({}),s=x.useRef(t),i=x.useRef("none"),o=t?"mounted":"unmounted",[a,l]=qF(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const c=Lo(r.current);i.current=a==="mounted"?c:"none"},[a]),hd(()=>{const c=r.current,u=s.current;if(u!==t){const f=i.current,p=Lo(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),hd(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const y=Lo(r.current).includes(p.animationName);if(p.target===e&&y&&(l("ANIMATION_END"),!s.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(i.current=Lo(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:x.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function Lo(t){return(t==null?void 0:t.animationName)||"none"}function JF(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function XF({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=QF({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,a=to(n),l=x.useCallback(c=>{if(i){const h=typeof c=="function"?c(t):c;h!==t&&a(h)}else s(c)},[i,t,s,a]);return[o,l]}function QF({defaultProp:t,onChange:e}){const n=x.useState(t),[r]=n,s=x.useRef(r),i=to(e);return x.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}var gf="Popover",[x1]=MF(gf,[Cl]),no=Cl(),[ZF,Zn]=x1(gf),b1=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=t,a=no(e),l=x.useRef(null),[c,u]=x.useState(!1),[h=!1,f]=XF({prop:r,defaultProp:s,onChange:i});return d.jsx(Sv,{...a,children:d.jsx(ZF,{scope:e,contentId:vr(),triggerRef:l,open:h,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:c,onCustomAnchorAdd:x.useCallback(()=>u(!0),[]),onCustomAnchorRemove:x.useCallback(()=>u(!1),[]),modal:o,children:n})})};b1.displayName=gf;var w1="PopoverAnchor",eU=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Zn(w1,n),i=no(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=s;return x.useEffect(()=>(o(),()=>a()),[o,a]),d.jsx(Ch,{...i,...r,ref:e})});eU.displayName=w1;var v1="PopoverTrigger",S1=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Zn(v1,n),i=no(n),o=Zi(e,s.triggerRef),a=d.jsx(eo.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":P1(s.open),...r,ref:o,onClick:Wn(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?a:d.jsx(Ch,{asChild:!0,...i,children:a})});S1.displayName=v1;var yf="PopoverPortal",[tU,nU]=x1(yf,{forceMount:void 0}),_1=t=>{const{__scopePopover:e,forceMount:n,children:r,container:s}=t,i=Zn(yf,e);return d.jsx(tU,{scope:e,forceMount:n,children:d.jsx(mf,{present:n||i.open,children:d.jsx(y1,{asChild:!0,container:s,children:r})})})};_1.displayName=yf;var _s="PopoverContent",k1=x.forwardRef((t,e)=>{const n=nU(_s,t.__scopePopover),{forceMount:r=n.forceMount,...s}=t,i=Zn(_s,t.__scopePopover);return d.jsx(mf,{present:r||i.open,children:i.modal?d.jsx(rU,{...s,ref:e}):d.jsx(sU,{...s,ref:e})})});k1.displayName=_s;var rU=x.forwardRef((t,e)=>{const n=Zn(_s,t.__scopePopover),r=x.useRef(null),s=Zi(e,r),i=x.useRef(!1);return x.useEffect(()=>{const o=r.current;if(o)return oh(o)},[]),d.jsx(wl,{as:tt,allowPinchZoom:!0,children:d.jsx(C1,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wn(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),i.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wn(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wn(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),sU=x.forwardRef((t,e)=>{const n=Zn(_s,t.__scopePopover),r=x.useRef(!1),s=x.useRef(!1);return d.jsx(C1,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),C1=x.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...h}=t,f=Zn(_s,n),p=no(n);return ih(),d.jsx(yl,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(m1,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:d.jsx(_v,{"data-state":P1(f.open),role:"dialog",id:f.contentId,...p,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),E1="PopoverClose",iU=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Zn(E1,n);return d.jsx(eo.button,{type:"button",...r,ref:e,onClick:Wn(t.onClick,()=>s.onOpenChange(!1))})});iU.displayName=E1;var oU="PopoverArrow",aU=x.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=no(n);return d.jsx(kv,{...s,...r,ref:e})});aU.displayName=oU;function P1(t){return t?"open":"closed"}var lU=b1,cU=S1,uU=_1,dU=k1;function hU({...t}){return d.jsx(lU,{"data-slot":"popover",...t})}function fU({...t}){return d.jsx(cU,{"data-slot":"popover-trigger",...t})}function pU({className:t,align:e="center",sideOffset:n=4,...r}){return d.jsx(uU,{children:d.jsx(dU,{"data-slot":"popover-content",align:e,sideOffset:n,className:dt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...r})})}function y0(){const{theme:t,toggleTheme:e,accentColor:n,setAccentColor:r}=f1(),s=[{name:"blue",class:"bg-blue-500"},{name:"purple",class:"bg-purple-500"},{name:"pink",class:"bg-pink-500"},{name:"orange",class:"bg-orange-500"},{name:"green",class:"bg-green-500"}];return d.jsxs(hU,{children:[d.jsx(fU,{asChild:!0,children:d.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"Theme Settings",children:d.jsx(_d,{className:"w-5 h-5"})})}),d.jsx(pU,{align:"end",className:"w-64 bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Dark Mode"}),d.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${t==="dark"?"bg-blue-600":"bg-gray-200"}`,children:[d.jsx("span",{className:`${t==="dark"?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-200`}),d.jsx("span",{className:"absolute left-1.5 top-1.5 text-[10px] text-gray-500",children:d.jsx(wd,{className:`w-3 h-3 ${t==="dark"?"opacity-0":"opacity-100"}`})}),d.jsx("span",{className:"absolute right-1.5 top-1.5 text-[10px] text-white",children:d.jsx(ik,{className:`w-3 h-3 ${t==="dark"?"opacity-100":"opacity-0"}`})})]})]}),d.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-800"}),d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-3 block",children:"Accent Color"}),d.jsx("div",{className:"flex justify-between gap-2",children:s.map(i=>d.jsx("button",{onClick:()=>r(i.name),className:`w-8 h-8 rounded-full ${i.class} flex items-center justify-center transition-transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-900 focus:ring-gray-400`,children:n===i.name&&d.jsx(Et,{className:"w-4 h-4 text-white"})},i.name))})]})]})})]})}function x0(){const{t}=Pe(),[e,n]=x.useState(null),[r,s]=x.useState(!1);x.useEffect(()=>{const o=a=>{a.preventDefault(),n(a)};return window.addEventListener("beforeinstallprompt",o),window.matchMedia("(display-mode: standalone)").matches&&s(!0),()=>{window.removeEventListener("beforeinstallprompt",o)}},[]);const i=async()=>{if(!e)return;e.prompt();const{outcome:o}=await e.userChoice;console.log(`User response to the install prompt: ${o}`),n(null)};return!e||r?null:d.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors shadow-sm text-sm font-medium animate-pulse",title:"Install as App",children:[d.jsx(Ja,{className:"w-4 h-4"}),d.jsx("span",{className:"hidden sm:inline",children:"Install App"})]})}function mU(){const{t}=Pe(),[e,n]=x.useState(!1);x.useEffect(()=>{if(!localStorage.getItem("hasSeenWelcome_v1")){const i=setTimeout(()=>n(!0),500);return()=>clearTimeout(i)}},[]);const r=()=>{n(!1),localStorage.setItem("hasSeenWelcome_v1","true")};return e?d.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-sm transition-opacity duration-500",onClick:r}),d.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full transform transition-all duration-500 scale-100 overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 -mr-16 -mt-16 w-32 h-32 bg-yellow-100 rounded-full blur-2xl opacity-50"}),d.jsx("div",{className:"absolute bottom-0 left-0 -ml-16 -mb-16 w-32 h-32 bg-pink-100 rounded-full blur-2xl opacity-50"}),d.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:d.jsx(Ct,{className:"w-5 h-5"})}),d.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center space-y-6",children:[d.jsx("div",{className:"bg-gradient-to-br from-pink-100 to-rose-100 p-4 rounded-full shadow-inner",children:d.jsx(xn,{className:"w-8 h-8 text-rose-500 fill-rose-500 animate-pulse"})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("h2",{className:"text-3xl font-bold text-gray-800 font-handwriting",children:t("welcome.title")}),d.jsx("div",{className:"w-16 h-1 bg-rose-200 rounded-full mx-auto"})]}),d.jsx("p",{className:"text-xl text-gray-600 font-handwriting leading-relaxed px-4",children:t("welcome.quote")}),d.jsx("p",{className:"text-gray-500 text-sm",children:t("welcome.subtitle")}),d.jsxs("button",{onClick:r,className:"group relative px-8 py-3 bg-gradient-to-r from-rose-500 to-pink-500 text-white rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 overflow-hidden",children:[d.jsx("span",{className:"relative z-10 font-medium",children:t("welcome.start")}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-600 to-rose-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]})]})]}):null}function gU(){const{t}=Pe(),e=ks(),n=new Date().getFullYear();return d.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-8 mt-auto transition-colors",children:d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:t("footer.rights")}),d.jsxs("span",{children:[" ",n]}),d.jsx("span",{className:"hidden md:inline text-gray-300 dark:text-gray-600",children:"|"}),d.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[t("footer.madeWith")," ",d.jsx(xn,{className:"w-3 h-3 text-red-500 fill-red-500"})," ",t("footer.forLovers")]})]}),d.jsxs("nav",{className:"flex items-center gap-6 text-sm text-gray-500 dark:text-gray-400",children:[d.jsx("button",{onClick:()=>e("/subscription"),className:"hover:text-gray-900 dark:hover:text-white transition-colors text-blue-600 dark:text-blue-400 font-semibold",children:t("footer.pricing")||"Pricing"}),d.jsx("button",{onClick:()=>e("/about"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:t("footer.about")}),d.jsx("button",{onClick:()=>e("/privacy"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:t("footer.privacy")}),d.jsx("button",{onClick:()=>e("/terms"),className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:t("footer.terms")}),d.jsx("a",{href:"mailto:2311752562@qq.com",className:"hover:text-gray-900 dark:hover:text-white transition-colors",children:t("footer.contact")})]})]})})})}function xf({title:t,content:e}){const n=ks(),{t:r}=Pe();return d.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-2xl shadow-sm p-8 my-8",children:[d.jsxs("button",{onClick:()=>n(-1),className:"flex items-center gap-2 text-gray-500 hover:text-gray-900 mb-6 transition-colors",children:[d.jsx(ok,{className:"w-4 h-4"}),r("legal.back")]}),d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8 pb-4 border-b border-gray-100",children:t}),d.jsx("div",{className:"prose prose-gray max-w-none text-gray-600 space-y-4 leading-relaxed",children:e})]})}function yU(){const{t}=Pe();return d.jsx(xf,{title:t("legal.about.title"),content:d.jsxs(d.Fragment,{children:[d.jsx("p",{children:d.jsx(oj,{i18nKey:"legal.about.intro1",components:{strong:d.jsx("strong",{})}})}),d.jsx("p",{children:t("legal.about.intro2")}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800 mt-6 mb-3",children:t("legal.about.missionTitle")}),d.jsx("p",{children:t("legal.about.missionText")})]})})}function xU(){const{t}=Pe();return d.jsx(xf,{title:t("legal.privacy.title"),content:d.jsxs(d.Fragment,{children:[d.jsx("p",{children:t("legal.privacy.lastUpdated")}),d.jsx("p",{children:t("legal.privacy.intro")}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800 mt-6 mb-3",children:t("legal.privacy.collectionTitle")}),d.jsx("p",{children:t("legal.privacy.collectionText")}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800 mt-6 mb-3",children:t("legal.privacy.aiTitle")}),d.jsx("p",{children:t("legal.privacy.aiText")})]})})}function bU(){const{t}=Pe();return d.jsx(xf,{title:t("legal.terms.title"),content:d.jsxs(d.Fragment,{children:[d.jsx("p",{children:t("legal.terms.lastUpdated")}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800 mt-6 mb-3",children:t("legal.terms.acceptanceTitle")}),d.jsx("p",{children:t("legal.terms.acceptanceText")}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800 mt-6 mb-3",children:t("legal.terms.conductTitle")}),d.jsx("p",{children:t("legal.terms.conductText")})]})})}function wU(){const{t}=Pe(),[e,n]=x.useState("yearly"),r=[{id:"free",name:"Starter",price:"0",description:t("subscription.features.unlimited"),features:[t("subscription.features.unlimited"),t("subscription.features.filters"),t("subscription.features.export")],icon:Vc,color:"blue"},{id:"pro",name:"Pro",price:e==="monthly"?"4.99":"3.99",period:"/mo",description:t("subscription.features.ai"),features:[t("subscription.features.unlimited"),t("subscription.features.ai"),t("subscription.features.quality"),t("subscription.features.support")],popular:!0,icon:bd,color:"purple"},{id:"lifetime",name:"Lifetime",price:"149.99",period:"one-time",description:t("subscription.features.lifetime"),features:[t("subscription.features.unlimited"),t("subscription.features.lifetime"),t("subscription.features.badge"),t("subscription.features.beta"),t("subscription.features.vip")],icon:ak,color:"amber"}];return d.jsxs("div",{className:"max-w-6xl mx-auto py-12 px-4 space-y-12 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400",children:t("subscription.title")}),d.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t("subscription.subtitle")}),d.jsxs("div",{className:"flex items-center justify-center gap-4 mt-8",children:[d.jsx("span",{className:`text-sm font-medium ${e==="monthly"?"text-gray-900 dark:text-white":"text-gray-500"}`,children:t("subscription.monthly")}),d.jsx("button",{onClick:()=>n(s=>s==="monthly"?"yearly":"monthly"),className:"w-14 h-8 bg-gray-200 dark:bg-gray-700 rounded-full p-1 relative transition-colors",children:d.jsx("div",{className:`w-6 h-6 bg-white rounded-full shadow-md transition-transform duration-300 ${e==="yearly"?"translate-x-6":""}`})}),d.jsxs("span",{className:`text-sm font-medium ${e==="yearly"?"text-gray-900 dark:text-white":"text-gray-500"}`,children:[t("subscription.yearly")," ",d.jsxs("span",{className:"text-green-500 font-bold ml-1",children:["(",t("subscription.save"),")"]})]})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 pt-8",children:r.map(s=>d.jsxs("div",{className:`relative bg-white dark:bg-gray-800 rounded-3xl p-8 border-2 transition-all duration-300 hover:scale-105 ${s.popular?"border-purple-500 shadow-xl shadow-purple-500/10 z-10":"border-gray-100 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 shadow-lg"}`,children:[s.popular&&d.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-1 rounded-full text-sm font-bold shadow-md",children:t("subscription.mostPopular")}),d.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center mb-6 bg-${s.color}-100 text-${s.color}-600 dark:bg-${s.color}-900/30 dark:text-${s.color}-400`,children:d.jsx(s.icon,{className:"w-6 h-6"})}),d.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:s.name}),d.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-6 min-h-[40px]",children:s.description}),d.jsxs("div",{className:"flex items-baseline gap-1 mb-8",children:[d.jsxs("span",{className:"text-4xl font-bold text-gray-900 dark:text-white",children:["$",s.price]}),s.period&&d.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s.period})]}),d.jsx("button",{onClick:()=>s.price!=="0"&&le("Coming Soon"),className:`w-full py-3 rounded-xl font-bold transition-all ${s.id==="free"?"bg-gray-100 text-gray-900 hover:bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600":"bg-gray-900 text-white hover:bg-gray-800 dark:bg-white dark:text-gray-900 dark:hover:bg-gray-100"}`,children:s.id==="free"?t("subscription.currentPlan"):t("subscription.getStarted")}),d.jsx("div",{className:"mt-8 space-y-4",children:s.features.map((i,o)=>d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(Et,{className:`w-5 h-5 flex-shrink-0 ${s.popular?"text-purple-500":"text-blue-500"}`}),d.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:i})]},o))})]},s.id))}),d.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-8 pt-12 text-gray-400 text-sm",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx($0,{className:"w-4 h-4"}),d.jsx("span",{children:t("subscription.payment.secure")})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Et,{className:"w-4 h-4"}),d.jsxs("span",{children:[t("common.cancel")," Anytime"]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Vc,{className:"w-4 h-4"}),d.jsx("span",{children:"30-Day Money Back"})]})]})]})}function vU({onVerify:t}){const[e,n]=x.useState(0),[r,s]=x.useState(!1),[i,o]=x.useState(0),a=x.useRef(null);x.useEffect(()=>{l()},[]);const l=()=>{n(0),s(!1),t(!1),o(Math.floor(Math.random()*60)+20)},c=h=>{if(r)return;const f=parseInt(h.target.value);n(f)},u=()=>{r||(Math.abs(e-i)<5?(s(!0),t(!0)):n(0))};return d.jsxs("div",{className:"w-full space-y-3 select-none",children:[d.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600 mb-1",children:[d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsx(lk,{className:"w-4 h-4 text-blue-500"}),"Security Check"]}),d.jsxs("button",{type:"button",onClick:l,className:"text-xs text-gray-400 hover:text-gray-600 flex items-center gap-1 transition-colors",disabled:r,children:[d.jsx(ck,{className:"w-3 h-3"}),"Reset"]})]}),d.jsx("div",{ref:a,className:"relative w-full h-12 bg-gray-100 rounded-xl overflow-hidden shadow-inner border border-gray-200",children:r?d.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-green-50 text-green-600 font-medium animate-in fade-in duration-300",children:[d.jsx(uk,{className:"w-5 h-5 mr-2"}),"Verified Successfully"]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(#4b5563 1px, transparent 1px)",backgroundSize:"10px 10px"}}),d.jsx("div",{className:"absolute top-0 bottom-0 w-10 bg-blue-100/50 border-x-2 border-blue-400/30 flex items-center justify-center",style:{left:`${i}%`},children:d.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400/50"})}),d.jsx("div",{className:"absolute top-1 bottom-1 w-10 bg-white shadow-md rounded-lg border border-gray-200 flex items-center justify-center transition-all duration-75 cursor-grab active:cursor-grabbing z-10",style:{left:`${e}%`},children:d.jsx("span",{className:"text-gray-400",children:"|||"})}),d.jsx("input",{type:"range",min:"0",max:"90",value:e,onChange:c,onMouseUp:u,onTouchEnd:u,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20"}),d.jsx("div",{className:"absolute bottom-1 left-0 right-0 text-center text-[10px] text-gray-400 pointer-events-none",children:"Slide to match the blue zone"})]})})]})}function SU(){const[t,e]=x.useState(!1),[n,r]=x.useState(""),[s,i]=x.useState(""),[o,a]=x.useState(!1),[l,c]=x.useState(null),[u,h]=x.useState(!1),f=async m=>{if(m.preventDefault(),a(!0),c(null),t&&!u){c("Please complete the security verification."),a(!1);return}try{if(t){const{error:y}=await ye.auth.signUp({email:n,password:s});if(y)throw y;alert("Check your email for the confirmation link!")}else{const{error:y}=await ye.auth.signInWithPassword({email:n,password:s});if(y)throw y}}catch(y){c(y.message)}finally{a(!1)}},p=async m=>{try{const{error:y}=await ye.auth.signInWithOAuth({provider:m,options:{redirectTo:window.location.origin}});if(y)throw y}catch(y){c(y.message)}};return d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:d.jsx(Un,{className:"w-8 h-8 text-white"})}),d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Photo Diary"}),d.jsx("p",{className:"text-gray-500 mt-2",children:"Sign in to save your memories"})]}),l&&d.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg mb-4 text-sm",children:l}),d.jsxs("form",{onSubmit:f,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),d.jsxs("div",{className:"relative",children:[d.jsx(Gc,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),d.jsx("input",{type:"email",value:n,onChange:m=>r(m.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"your@email.com",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx(vd,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),d.jsx("input",{type:"password",value:s,onChange:m=>i(m.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"",required:!0,minLength:6})]})]}),t&&d.jsx("div",{className:"pt-2",children:d.jsx(vU,{onVerify:h})}),d.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 rounded-xl hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 flex items-center justify-center gap-2",children:o?d.jsx(_t,{className:"w-5 h-5 animate-spin"}):t?"Sign Up":"Sign In"})]}),d.jsxs("div",{className:"mt-6",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-0 flex items-center",children:d.jsx("div",{className:"w-full border-t border-gray-200"})}),d.jsx("div",{className:"relative flex justify-center text-sm",children:d.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),d.jsx("div",{className:"mt-6 grid grid-cols-1 gap-3",children:d.jsxs("button",{onClick:()=>p("github"),className:"w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 shadow-sm bg-white text-sm font-medium rounded-xl text-gray-700 hover:bg-gray-50 transition-colors",children:[d.jsx(dk,{className:"w-5 h-5 mr-2"}),d.jsx("span",{children:"GitHub"})]})})]}),d.jsx("div",{className:"mt-6 text-center text-sm",children:d.jsx("button",{onClick:()=>e(!t),className:"text-blue-600 hover:text-blue-500 font-medium",children:t?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})}const fd=(t,e)=>e.some(n=>t instanceof n);let b0,w0;function _U(){return b0||(b0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kU(){return w0||(w0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pd=new WeakMap,Uc=new WeakMap,Dl=new WeakMap;function CU(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(_r(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return Dl.set(e,t),e}function EU(t){if(pd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});pd.set(t,e)}let md={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return pd.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _r(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function A1(t){md=t(md)}function PU(t){return kU().includes(t)?function(...e){return t.apply(gd(this),e),_r(this.request)}:function(...e){return _r(t.apply(gd(this),e))}}function AU(t){return typeof t=="function"?PU(t):(t instanceof IDBTransaction&&EU(t),fd(t,_U())?new Proxy(t,md):t)}function _r(t){if(t instanceof IDBRequest)return CU(t);if(Uc.has(t))return Uc.get(t);const e=AU(t);return e!==t&&(Uc.set(t,e),Dl.set(e,t)),e}const gd=t=>Dl.get(t);function jU(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=_r(o);return r&&o.addEventListener("upgradeneeded",l=>{r(_r(o.result),l.oldVersion,l.newVersion,_r(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const NU=["get","getKey","getAll","getAllKeys","count"],TU=["put","add","delete","clear"],Bc=new Map;function v0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bc.get(e))return Bc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=TU.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||NU.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return Bc.set(e,i),i}A1(t=>({...t,get:(e,n,r)=>v0(e,n)||t.get(e,n,r),has:(e,n)=>!!v0(e,n)||t.has(e,n)}));const RU=["continue","continuePrimaryKey","advance"],S0={},yd=new WeakMap,j1=new WeakMap,OU={get(t,e){if(!RU.includes(e))return t[e];let n=S0[e];return n||(n=S0[e]=function(...r){yd.set(this,j1.get(this)[e](...r))}),n}};async function*IU(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,OU);for(j1.set(n,e),Dl.set(n,gd(e));e;)yield n,e=await(yd.get(n)||e.continue()),yd.delete(n)}function _0(t,e){return e===Symbol.asyncIterator&&fd(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&fd(t,[IDBIndex,IDBObjectStore])}A1(t=>({...t,get(e,n,r){return _0(e,n)?IU:t.get(e,n,r)},has(e,n){return _0(e,n)||t.has(e,n)}}));const MU="photo-diary-db",DU=1;class LU{constructor(){this.dbPromise=jU(MU,DU,{upgrade(e){e.createObjectStore("entries",{keyPath:"id"}).createIndex("by-date","date"),e.createObjectStore("pending_actions",{keyPath:"id",autoIncrement:!0})}})}async saveEntry(e){await(await this.dbPromise).put("entries",e)}async saveEntries(e){const r=(await this.dbPromise).transaction("entries","readwrite");await Promise.all(e.map(s=>r.store.put(s))),await r.done}async getEntries(){return(await this.dbPromise).getAllFromIndex("entries","by-date")}async getEntry(e){return(await this.dbPromise).get("entries",e)}async deleteEntry(e){await(await this.dbPromise).delete("entries",e)}async addPendingAction(e){return(await this.dbPromise).add("pending_actions",e)}async getPendingActions(){return(await this.dbPromise).getAll("pending_actions")}async removePendingAction(e){await(await this.dbPromise).delete("pending_actions",e)}async clearPendingActions(){await(await this.dbPromise).clear("pending_actions")}}const ft=new LU;function $U(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const c=async(h=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await Dk(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!a)return;a.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),a.addEventListener("installed",h=>{h.isUpdate||r==null||r()}),a.register({immediate:e}).then(h=>{i?i("/sw.js",h):s==null||s(h)}).catch(h=>{o==null||o(h)})}}return l=u(),c}function FU(t={}){const{immediate:e=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t,[a,l]=x.useState(!1),[c,u]=x.useState(!1),[h]=x.useState(()=>$U({immediate:e,onOfflineReady(){u(!0),r==null||r()},onNeedRefresh(){l(!0),n==null||n()},onRegistered:s,onRegisteredSW:i,onRegisterError:o}));return{needRefresh:[a,l],offlineReady:[c,u],updateServiceWorker:h}}function UU(){const{offlineReady:[t],needRefresh:[e],updateServiceWorker:n}=FU({onRegistered(r){console.log("SW Registered: "+r)},onRegisterError(r){console.log("SW registration error",r)}});return x.useEffect(()=>{t&&le.success("App is ready to work offline")},[t]),x.useEffect(()=>{e&&le(r=>d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsx("span",{children:"New content available, click on reload button to update."}),d.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium",onClick:()=>n(!0),children:"Reload"})]}),{duration:1/0})},[e,n]),null}function BU(){const{id:t}=B0(),e=ks(),[n,r]=x.useState(null),[s,i]=x.useState(!0),[o,a]=x.useState(null),[l,c]=x.useState(!0);return x.useEffect(()=>{t&&U4(t).then(r).catch(u=>{console.error(u),a("Book not found or private.")}).finally(()=>i(!1))},[t]),s?d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900",children:[d.jsx(_t,{className:"w-12 h-12 animate-spin text-blue-600 mb-4"}),d.jsx("p",{className:"text-gray-500",children:"Loading Photo Book..."})]}):o||!n?d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900 p-4 text-center",children:[d.jsx(F0,{className:"w-16 h-16 text-red-500 mb-4"}),d.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Oops!"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:o||"This book doesn't exist."}),d.jsx("button",{onClick:()=>e("/"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Go Home"})]}):d.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col items-center justify-center relative overflow-hidden",children:[d.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1544376798-89aa6b82c6cd?q=80&w=2574&auto=format&fit=crop')] bg-cover bg-center opacity-20 blur-sm pointer-events-none"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/80 to-transparent pointer-events-none"}),l?d.jsx(Q_,{year:n.year,pages:n.pages,onClose:()=>c(!1),readOnly:!0}):d.jsxs("div",{className:"z-10 flex flex-col items-center text-center p-8 max-w-2xl animate-in fade-in zoom-in duration-500",children:[d.jsx(Un,{className:"w-20 h-20 text-amber-400 mb-6 drop-shadow-[0_0_15px_rgba(251,191,36,0.5)]"}),d.jsxs("h1",{className:"text-4xl md:text-5xl font-serif font-bold text-white mb-4",children:["Photo Diary ",d.jsx("span",{className:"text-amber-400",children:n.year})]}),d.jsx("p",{className:"text-xl text-gray-300 mb-12 leading-relaxed",children:"Thanks for viewing! This moment is captured forever in time."}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full justify-center",children:[d.jsxs("button",{onClick:()=>c(!0),className:"px-8 py-4 bg-white text-gray-900 rounded-full font-bold hover:bg-gray-100 transition-all transform hover:scale-105 shadow-lg flex items-center justify-center gap-2",children:[d.jsx(Un,{className:"w-5 h-5"}),"Read Again"]}),d.jsx("button",{onClick:()=>e("/"),className:"px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full font-bold hover:from-blue-500 hover:to-indigo-500 transition-all transform hover:scale-105 shadow-lg flex items-center justify-center gap-2",children:"Create Your Own"})]}),d.jsxs("p",{className:"mt-12 text-sm text-gray-500",children:["Powered by ",d.jsx("span",{className:"font-semibold text-gray-400",children:"Photo Diary"})]})]})]})}const rt=({children:t})=>d.jsx(qn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:"easeOut"},children:t});function VU(){return d.jsx(TF,{children:d.jsx(fA,{children:d.jsxs(uF,{children:[d.jsx(WU,{}),d.jsx(UU,{}),d.jsx(EC,{position:"top-center",reverseOrder:!1})]})})})}function WU(){const{t}=Pe(),{user:e,loading:n,signOut:r}=Ps(),{currentGroupId:s}=Fi(),[i,o]=x.useState([]),[a,l]=x.useState(!0),[c,u]=x.useState(!1),[h,f]=x.useState(!1),[p,m]=x.useState(!1),y=ks(),v=xk(),[S]=x.useState(new URLSearchParams(v.search));x.useEffect(()=>{S.get("view")==="print"&&y("/print"+v.search)},[S,y]);const E=()=>d.jsxs("button",{onClick:()=>f(!0),className:"fixed bottom-24 right-6 md:bottom-6 md:right-6 z-40 p-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-full shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 group",children:[d.jsx(N0,{className:"w-6 h-6 animate-pulse"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 px-3 py-1 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"Chat with Memories"})]});x.useEffect(()=>{e!=null&&e.id&&k()},[e==null?void 0:e.id]);async function k(){try{l(!0);try{const b=await ft.getEntries();if(b.length>0)o(b.sort((C,A)=>new Date(A.date).getTime()-new Date(C.date).getTime()));else{const C=localStorage.getItem("photo-diary-entries");if(C)try{const A=JSON.parse(C);o(A),await ft.saveEntries(A)}catch(A){console.error("Error parsing stored entries:",A)}}}catch(b){console.error("Failed to load from offline storage:",b)}if(navigator.onLine){const C=(await l1()).sort((A,N)=>new Date(N.date).getTime()-new Date(A.date).getTime());o(C),await ft.saveEntries(C)}}catch(b){console.error("Failed to load entries from API:",b),le.error("Offline mode: Showing cached entries")}finally{l(!1)}}async function g(b,C=["private"]){try{u(!0);const A={photo:b.photo,caption:b.caption,mood:b.mood,date:b.date,location:b.location,tags:b.tags||[],aiTags:b.aiTags||[],palette:b.palette},N={...b,...A};if(o(T=>[N,...T]),await ft.saveEntry(N),!navigator.onLine){await ft.addPendingAction({type:"create",payload:{entry:N,targetGroups:C},targetGroups:C,timestamp:Date.now()}),le.success("Saved offline. Will sync when online.",{icon:"",style:{borderRadius:"10px",background:"#333",color:"#fff"}}),C.includes("private")&&C.length===1?y("/"):y("/map");return}const O=[];C.includes("private")&&(console.log("Saving to Private Diary..."),O.push(a0(A).then(T=>{})));const I=C.filter(T=>T!=="private");if(I.length>0&&e){console.log("Saving to Groups:",I);const T=I.map(async M=>{const{error:R}=await ye.from("diary_entries").insert({user_id:e.id,group_id:M,photo_url:A.photo,caption:A.caption,mood:A.mood,location:A.location,date:A.date});if(R)throw console.error(`Error saving to group ${M}:`,R),new Error(`Failed to save to group: ${R.message}`)});O.push(...T)}await Promise.all(O),le.success("Memory saved successfully!",{style:{borderRadius:"10px",background:"#333",color:"#fff"}}),C.includes("private")&&C.length===1?y("/"):y("/map")}catch(A){console.error("Failed to create entry:",A),le.error("Network error. Saved offline."),await ft.addPendingAction({type:"create",payload:{entry:{...b,tags:b.tags||[],aiTags:b.aiTags||[]},targetGroups:C},targetGroups:C,timestamp:Date.now()})}finally{u(!1)}}async function w(b,C){try{u(!0);const A={photo:b.photo,caption:b.caption,mood:b.mood,date:b.date,location:b.location,tags:b.tags||[],aiTags:b.aiTags||[],palette:b.palette},N={...b,...A};if(o(O=>O.map(I=>I.id===b.id?N:I)),await ft.saveEntry(N),!navigator.onLine){await ft.addPendingAction({type:"update",payload:{id:b.id,payload:A,targetGroups:C},targetGroups:C,timestamp:Date.now()}),le.success("Updated offline. Will sync when online.",{icon:""}),y("/");return}console.log("Updating entry with payload:",A),await l0(b.id,A),le.success("Memory updated successfully!"),y("/")}catch(A){console.error("Failed to update entry:",A),le.error("Network error. Saved offline."),await ft.addPendingAction({type:"update",payload:{id:b.id,payload:{photo:b.photo,caption:b.caption,mood:b.mood,date:b.date,location:b.location,tags:b.tags||[],aiTags:b.aiTags||[],palette:b.palette},targetGroups:C},targetGroups:C,timestamp:Date.now()})}finally{u(!1)}}async function _(b){try{if(o(C=>C.filter(A=>A.id!==b)),await ft.deleteEntry(b),!navigator.onLine){await ft.addPendingAction({type:"delete",payload:{id:b},targetGroups:["private"],timestamp:Date.now()}),le.success("Deleted locally. Will sync when online.",{icon:""});return}await c0(b),le.success("Memory deleted.")}catch(C){console.error("Failed to delete entry:",C),le.error("Network error. Queued for deletion."),await ft.addPendingAction({type:"delete",payload:{id:b},targetGroups:["private"],timestamp:Date.now()})}}if(x.useEffect(()=>{const b=async()=>{console.log("Online! Syncing pending actions...");const C=await ft.getPendingActions();if(C.length!==0){le.loading(`Syncing ${C.length} pending changes...`,{id:"sync-toast"});for(const A of C)try{if(A.type==="create"){const{entry:N,targetGroups:O}=A.payload;O.includes("private")&&await a0(N);const I=O.filter(T=>T!=="private");I.length>0&&e&&await Promise.all(I.map(T=>ye.from("diary_entries").insert({user_id:e.id,group_id:T,photo_url:N.photo,caption:N.caption,mood:N.mood,location:N.location,date:N.date})))}else if(A.type==="update"){const{id:N,payload:O}=A.payload;await l0(N,O)}else if(A.type==="delete"){const{id:N}=A.payload;await c0(N)}A.id&&await ft.removePendingAction(A.id)}catch(N){console.error("Sync failed for action:",A,N)}le.success("Sync complete!",{id:"sync-toast"}),k()}};return window.addEventListener("online",b),()=>window.removeEventListener("online",b)},[e]),n)return d.jsx("div",{className:"min-h-screen flex items-center justify-center dark:bg-gray-900",children:d.jsx(_t,{className:"w-8 h-8 animate-spin text-blue-600"})});if(!e)return d.jsx(SU,{});const P=v.pathname==="/add"||v.pathname.startsWith("/edit");return d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 transition-colors duration-300",children:[d.jsxs("header",{className:"bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm border-b border-gray-200 dark:border-gray-800 sticky top-0 z-30 transition-colors duration-300",children:[d.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:d.jsxs("div",{className:"flex items-center justify-between gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>y("/"),children:[d.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center shadow-md flex-shrink-0",children:d.jsx(Un,{className:"w-6 h-6 text-white"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white transition-colors",children:"Photo Diary"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 hidden sm:block",children:"Capture your daily moments"})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[d.jsx(x0,{}),d.jsx(y0,{}),!P&&d.jsx(e0,{entries:i})]}),d.jsx("nav",{className:"hidden md:flex gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl transition-colors",children:[{path:"/",icon:Un,label:"nav.timeline"},{path:"/calendar",icon:bs,label:"nav.calendar"},{path:"/map",icon:vs,label:"nav.map"},{path:"/couple",icon:xn,label:"nav.couple",color:"text-pink-600 dark:text-pink-400"},{path:"/milestones",icon:Kc,label:"nav.milestones",color:"text-amber-600 dark:text-amber-400"},{path:"/insights",icon:on,label:"nav.insights"},{path:"/print",icon:bi,label:"nav.print"},{path:"/changelog",icon:Hc,label:"nav.logs"}].map(b=>d.jsxs("button",{onClick:()=>y(b.path),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${v.pathname===b.path?`bg-white dark:bg-gray-700 shadow-sm ${b.color||"text-gray-900 dark:text-white"}`:`${b.color?"text-gray-500 dark:text-gray-400 hover:"+b.color.split(" ")[0]:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`}`,children:[d.jsx(b.icon,{className:"w-4 h-4"}),d.jsx("span",{children:t(b.label)})]},b.path))}),d.jsxs("button",{onClick:()=>y("/add"),className:"hidden md:flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg text-sm font-medium transition-colors",children:[d.jsx(Fl,{className:"w-4 h-4"}),d.jsx("span",{children:t("nav.add")})]}),d.jsx("button",{onClick:()=>y("/account"),className:"hidden md:flex p-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors flex-shrink-0",title:t("nav.account"),children:d.jsx(Ef,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>m(!p),className:"md:hidden p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:p?d.jsx(Ct,{className:"w-6 h-6"}):d.jsx(hk,{className:"w-6 h-6"})})]})]})}),d.jsx(ad,{children:p&&d.jsx(qn.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"md:hidden border-t border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 overflow-hidden shadow-xl",children:d.jsxs("div",{className:"px-4 py-6 space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between gap-4 p-2 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[d.jsx(x0,{}),d.jsx(y0,{}),!P&&d.jsx(e0,{entries:i})]}),d.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{path:"/",icon:Un,label:"nav.timeline"},{path:"/add",icon:Fl,label:"nav.add"},{path:"/calendar",icon:bs,label:"nav.calendar"},{path:"/map",icon:vs,label:"nav.map"},{path:"/couple",icon:xn,label:"nav.couple",color:"text-pink-600 dark:text-pink-400"},{path:"/milestones",icon:Kc,label:"nav.milestones",color:"text-amber-600 dark:text-amber-400"},{path:"/insights",icon:on,label:"nav.insights"},{path:"/print",icon:bi,label:"nav.print"},{path:"/changelog",icon:Hc,label:"nav.logs"},{path:"/account",icon:Ef,label:"nav.account"}].map(b=>d.jsxs("button",{onClick:()=>{y(b.path),m(!1)},className:`flex items-center gap-3 p-4 rounded-xl text-sm transition-all border ${v.pathname===b.path?`bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700 font-medium ${b.color||"text-gray-900 dark:text-white"}`:`border-transparent hover:bg-gray-50 dark:hover:bg-gray-800 ${b.color,"text-gray-600 dark:text-gray-400"}`}`,children:[d.jsx(b.icon,{className:"w-5 h-5"}),d.jsx("span",{children:t(b.label)})]},b.path))})]})})})]}),d.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:d.jsx(ad,{mode:"wait",children:d.jsxs(bk,{location:v,children:[d.jsx(Ge,{path:"/",element:d.jsx(rt,{children:d.jsx(PR,{entries:i,onDeleteEntry:_,loading:a})})}),d.jsx(Ge,{path:"/calendar",element:d.jsx(rt,{children:d.jsx(AR,{entries:i,onDeleteEntry:_})})}),d.jsx(Ge,{path:"/couple",element:d.jsx(rt,{children:d.jsx(OF,{})})}),d.jsx(Ge,{path:"/map",element:d.jsx(rt,{children:d.jsx(mD,{entries:i})})}),d.jsx(Ge,{path:"/insights",element:d.jsx(rt,{children:d.jsx(A4,{entries:i})})}),d.jsx(Ge,{path:"/milestones",element:d.jsx(rt,{children:d.jsx(j4,{entries:i})})}),d.jsx(Ge,{path:"/print",element:d.jsx(rt,{children:d.jsx(cF,{entries:i})})}),d.jsx(Ge,{path:"/account",element:d.jsx(rt,{children:d.jsx(RF,{})})}),d.jsx(Ge,{path:"/changelog",element:d.jsx(rt,{children:d.jsx(N4,{})})}),d.jsx(Ge,{path:"/about",element:d.jsx(rt,{children:d.jsx(yU,{})})}),d.jsx(Ge,{path:"/privacy",element:d.jsx(rt,{children:d.jsx(xU,{})})}),d.jsx(Ge,{path:"/terms",element:d.jsx(rt,{children:d.jsx(bU,{})})}),d.jsx(Ge,{path:"/subscription",element:d.jsx(rt,{children:d.jsx(wU,{})})}),d.jsx(Ge,{path:"/share/book/:id",element:d.jsx(rt,{children:d.jsx(BU,{})})}),d.jsx(Ge,{path:"/add",element:d.jsx(rt,{children:d.jsx("div",{className:"max-w-2xl mx-auto",children:d.jsx(Ky,{onSave:g,saving:c})})})}),d.jsx(Ge,{path:"/edit/:id",element:d.jsx(rt,{children:d.jsx("div",{className:"max-w-2xl mx-auto",children:d.jsx(zU,{entries:i,onSave:w,saving:c,loading:a})})})}),d.jsx(Ge,{path:"*",element:d.jsx(wk,{to:"/",replace:!0})})]},v.pathname)})}),!P&&v.pathname!=="/changelog"&&d.jsx("button",{onClick:()=>y("/add"),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-br from-blue-600 to-purple-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all flex items-center justify-center md:hidden z-50","aria-label":"Add new entry",children:d.jsx(Fl,{className:"w-6 h-6"})}),!P&&d.jsx(E,{}),d.jsx(kN,{entries:i,isOpen:h,onClose:()=>f(!1)}),d.jsx(mU,{}),d.jsx(gU,{})]})}function zU({entries:t,onSave:e,saving:n,loading:r}){const{id:s}=B0(),i=t.find(o=>o.id===s);return r?d.jsx("div",{className:"flex items-center justify-center h-64",children:d.jsx(_t,{className:"w-8 h-8 animate-spin text-blue-600"})}):i?d.jsx(Ky,{initialData:i,onSave:e,saving:n,isEdit:!0}):d.jsxs("div",{className:"text-center py-12",children:[d.jsx("h3",{className:"text-xl text-gray-900",children:"Entry not found"}),d.jsx("p",{className:"text-gray-500 mt-2",children:"The memory you are trying to edit does not exist."})]})}class HU extends fe.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){var e;return this.state.hasError?d.jsxs("div",{style:{padding:20,color:"red"},children:[d.jsx("h1",{children:"Something went wrong."}),d.jsx("pre",{children:(e=this.state.error)==null?void 0:e.toString()}),d.jsx("button",{onClick:()=>window.location.reload(),children:"Reload Page"})]}):this.props.children}}$k.createRoot(document.getElementById("root")).render(d.jsx(HU,{children:d.jsx(vk,{children:d.jsx(hA,{children:d.jsx(VU,{})})})}));
